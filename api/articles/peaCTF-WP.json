{"title":"peaCTF WP","slug":"peaCTF-WP","date":"2019-07-26T07:13:47.000Z","updated":"2019-09-03T14:31:22.422Z","comments":true,"path":"api/articles/peaCTF-WP.json","photos":[],"link":"","excerpt":"和同学报名了这个比赛，全英文果然有压力，半天找不到怎么答题，哭了😭","covers":["http://wx1.sinaimg.cn/mw690/006boCb9ly1g5kb70a11oj30ki0kp41e.jpg"],"content":"<p>和同学报名了这个比赛，全英文果然有压力，半天找不到怎么答题，哭了😭</p>\n<a id=\"more\"></a>\n\n<h2 id=\"RSA\"><a href=\"#RSA\" class=\"headerlink\" title=\"RSA\"></a>RSA</h2><p>题目描述：Can you help Bob retrieve the two messages for a flag? Authenticated Channel Encrypted Channel</p>\n<p>给了两个文件 auth_channel.txt 和  enc_channel.txt</p>\n<pre><code>Authenticated (unhashed) channel:\nn = 59883006898206291499785811163190956754007806709157091648869\ne = 65537\nc = 23731413167627600089782741107678182917228038671345300608183\n\n\nEncrypted channel:\nn = 165481207658568424313022356820498512502867488746572300093793\ne = 65537\nc = 150635433712900935381157860417761227624682377134647578768653</code></pre><p>先分解两个n得到两对p&amp;q</p>\n<pre><code>p = 192355607880290234740980693973\nq = 311314068553039667905603427153\n\n\np1 = 404796306518120759733507156677\nq1 = 408801179738927870766525808109</code></pre><p>对两个文件分别进行常规解密</p>\n<pre><code>import gmpy2\n\nn1 = 165481207658568424313022356820498512502867488746572300093793\ne1 = 65537\nc1 = 150635433712900935381157860417761227624682377134647578768653\n\np1 = 404796306518120759733507156677\nq1 = 408801179738927870766525808109\n\nphin1 = (p-1)*(q-1)\nd1 = gmpy2.invert(e,phin)\nm1 = gmpy2.powmod(c,d,n)\n\nprint m\nflag = hex(m)[2:]\nprint flag.decode(&apos;hex&apos;)</code></pre><p>发现只有第二个文件可以正常解密</p>\n<pre><code>8904929771347223901285886734450\npeaCTF{f4ct0r</code></pre><p>第一个文件报错，奇数长度无法正常decode。</p>\n<p>这个地方卡了一会，还尝试拼接了两段m，哈哈。</p>\n<p>最后看文件名发现是auth，想到RSA数字签名，尝试数字签名解，打印出pow的16进制数据后在数据最后有一个大写的L<code>0x316e67317366756e7dL</code>，遂删掉。将新得到的数据再次解密得到flag的后半段。</p>\n<pre><code>peaCTF{f4ct0r1ng1sfun}</code></pre><h2 id=\"The-Wondeful-Wizard\"><a href=\"#The-Wondeful-Wizard\" class=\"headerlink\" title=\"The Wondeful Wizard\"></a>The Wondeful Wizard</h2><p>打开文件就是一张图片，图片扔进stegslove里跑一下各通道，在蓝色通道发现三行字符串，明显的16进制，试了试解前两个发现是fl,于是菜鸡的我手敲进代码里进行16进制解密</p>\n<p>运行结果：</p>\n<p><img src=\"http://wx1.sinaimg.cn/mw690/006boCb9ly1g5kb70a11oj30ki0kp41e.jpg\" alt></p>\n","categories":[{"name":"WP","slug":"WP","count":7,"path":"api/categories/WP.json"}],"tags":[{"name":"WP","slug":"WP","count":5,"path":"api/tags/WP.json"},{"name":"RSA","slug":"RSA","count":4,"path":"api/tags/RSA.json"}]}