<!DOCTYPE html>
<html lang="en">
<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="对未来的最大慷慨，就是把一切都献给现在。">
    <meta name="keyword" content>
    <link rel="shortcut icon" href="/img/favicon.ico">

    <title>
        
        数据库概论 - undefined
        
    </title>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/aircloud.css">
    <link rel="stylesheet" href="/css/gitment.css">
    <!--<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">-->
    <link href="//at.alicdn.com/t/font_620856_pl6z7sid89qkt9.css" rel="stylesheet" type="text/css">
    <!-- ga & ba script hoook -->
    <script></script>
</head>

<body>

<div class="site-nav-toggle" id="site-nav-toggle">
    <button>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
    </button>
</div>

<div class="index-about">
    <i>  </i>
</div>

<div class="index-container">
    
    <div class="index-left">
        
<div class="nav" id="nav">
    <div class="avatar-name">
        <div class="avatar ">
            <img src="/" />
        </div>
        <div class="name">
            <i>Luc1fer</i>
        </div>
    </div>
    <div class="contents" id="nav-content">
        <ul>
            <li >
                <a href="/">
                    <i class="iconfont icon-shouye1"></i>
                    <span>HOME</span>
                </a>
            </li>
            <li >
                <a href="/tags">
                    <i class="iconfont icon-biaoqian1"></i>
                    <span>TAGS</span>
                </a>
            </li>
            <li >
                <a href="/archives">
                    <i class="iconfont icon-guidang2"></i>
                    <span>ARCHIVES</span>
                </a>
            </li>
            <li >
                <a href="/about/">
                    <i class="iconfont icon-guanyu2"></i>
                    <span>ABOUT</span>
                </a>
            </li>
            
            <li>
                <a id="search">
                    <i class="iconfont icon-sousuo1"></i>
                    <span>SEARCH</span>
                </a>
            </li>
            
        </ul>
    </div>
    
        <div id="toc" class="toc-article">
    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#数据库概论"><span class="toc-text">数据库概论</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#E-R图"><span class="toc-text">E-R图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#增删改查"><span class="toc-text">增删改查</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#创建新表并插入数据"><span class="toc-text">创建新表并插入数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#索引的建立与删除"><span class="toc-text">索引的建立与删除</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#建立索引"><span class="toc-text">建立索引</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#删除索引"><span class="toc-text">删除索引</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#修改索引"><span class="toc-text">修改索引</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#查看索引"><span class="toc-text">查看索引</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修改基本表"><span class="toc-text">修改基本表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#数据查询"><span class="toc-text">数据查询</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#无条件查询"><span class="toc-text">无条件查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#条件查询"><span class="toc-text">条件查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ORDER-BY-字句"><span class="toc-text">ORDER BY 字句</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#集函数的使用"><span class="toc-text">集函数的使用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#连接查询"><span class="toc-text">连接查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#集合查询"><span class="toc-text">集合查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#嵌套查询"><span class="toc-text">嵌套查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#带-IN-和-ALL-的子查询"><span class="toc-text">带 IN 和 ALL 的子查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#基于派生表的查询"><span class="toc-text">基于派生表的查询</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sql高级查询"><span class="toc-text">sql高级查询</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#聚集函数的使用"><span class="toc-text">聚集函数的使用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#查询结果分组"><span class="toc-text">查询结果分组</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#不同表之间的连接查询"><span class="toc-text">不同表之间的连接查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#带谓词-IN-的嵌套查询"><span class="toc-text">带谓词 IN 的嵌套查询</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#视图"><span class="toc-text">视图</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#建立视图"><span class="toc-text">建立视图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#删除视图"><span class="toc-text">删除视图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#查询视图"><span class="toc-text">查询视图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#更新视图"><span class="toc-text">更新视图</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#用户"><span class="toc-text">用户</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#创建用户"><span class="toc-text">创建用户</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#用户权限"><span class="toc-text">用户权限</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#角色"><span class="toc-text">角色</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#数据库完整性"><span class="toc-text">数据库完整性</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#实体完整性"><span class="toc-text">实体完整性</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#实体完整性检查和违约处理"><span class="toc-text">实体完整性检查和违约处理</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#参照完整性"><span class="toc-text">参照完整性</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#参照完整性检查和违约处理"><span class="toc-text">参照完整性检查和违约处理</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#用户定义的完整性"><span class="toc-text">用户定义的完整性</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#属性上的约束条件"><span class="toc-text">属性上的约束条件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#元组上的约束条件"><span class="toc-text">元组上的约束条件</span></a></li></ol></li></ol></li></ol></li></ol>
</div>
    
</div>


<div class="search-field" id="search-field">
    <div class="search-container">
        <div class="search-input">
            <span id="esc-search"> <i class="icon-fanhui iconfont"></i></span>
            <input id="search-input"/>
            <span id="begin-search">search</span>
        </div>
        <div class="search-result-container" id="search-result-container">

        </div>
    </div>
</div>

        <div class="index-about-mobile">
            <i>  </i>
        </div>
    </div>
    
    <div class="index-middle">
        <!-- Main Content -->
        


<div class="post-container">
    <div class="post-title">
        数据库概论
    </div>

    <div class="post-meta">
        <span class="attr">Post：<span>2020-04-29 13:40:34</span></span>
        
        <span class="attr">Tags：/
        
        <a class="tag" href="/tags/#MySql" title="MySql">MySql</a>
        <span>/</span>
        
        
        </span>
        <span class="attr">Visit：<span id="busuanzi_value_page_pv"></span>
</span>
</span>
    </div>
    <div class="post-content ">
        <h1 id="数据库概论"><a href="#数据库概论" class="headerlink" title="数据库概论"></a>数据库概论</h1><h2 id="E-R图"><a href="#E-R图" class="headerlink" title="E-R图"></a>E-R图</h2><h2 id="增删改查"><a href="#增删改查" class="headerlink" title="增删改查"></a>增删改查</h2><h3 id="创建新表并插入数据"><a href="#创建新表并插入数据" class="headerlink" title="创建新表并插入数据"></a>创建新表并插入数据</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show tables;</span><br><span class="line">+<span class="comment">-----------------------+</span></span><br><span class="line">| Tables_in_studentinfo |</span><br><span class="line">+<span class="comment">-----------------------+</span></span><br><span class="line">| course                |</span><br><span class="line">| sc                    |</span><br><span class="line">| studente              |</span><br><span class="line">+<span class="comment">-----------------------+</span></span><br></pre></td></tr></table></figure>

<p>将三个表全部删除然后新建新的表：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; drop table course;</span><br><span class="line">mysql&gt; drop table sc;</span><br><span class="line">mysql&gt; drop table studente;</span><br><span class="line">mysql&gt; show tables;</span><br><span class="line">Empty <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>

<p>要创建的表的属性：</p>
<p><img src="C:%5CUsers%5Cbrian%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20200317092800919.png" alt="image-20200317092800919"></p>
<p><img src="C:%5CUsers%5Cbrian%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20200317092828418.png" alt="image-20200317092828418"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; create table Student</span><br><span class="line">    -&gt; (Sno char(12) PRIMARY KEY, //主键</span><br><span class="line">    -&gt; Sname char(20) UNIQUE NOT NULL, //不为空且取值唯一</span><br><span class="line">    -&gt; Ssex char(8) DEFAULT 'male', //默认值 male</span><br><span class="line">    -&gt; Sage int(4),</span><br><span class="line">    -&gt; Sdept char(15)</span><br><span class="line">    -&gt; );</span><br><span class="line">mysql&gt; desc student;</span><br><span class="line">+<span class="comment">-------+----------+------+-----+---------+-------+</span></span><br><span class="line">| Field | Type     | Null | Key | Default | Extra |</span><br><span class="line">+<span class="comment">-------+----------+------+-----+---------+-------+</span></span><br><span class="line">| Sno   | char(12) | NO   | PRI | NULL    |       |</span><br><span class="line">| Sname | char(20) | NO   | UNI | NULL    |       |</span><br><span class="line">| Ssex  | char(8)  | YES  |     | male    |       |</span><br><span class="line">| Sage  | int(4)   | YES  |     | NULL    |       |</span><br><span class="line">| Sdept | char(15) | YES  |     | NULL    |       |</span><br><span class="line">+<span class="comment">-------+----------+------+-----+---------+-------+</span></span><br><span class="line">5 rows in <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; create table Course</span><br><span class="line">    -&gt; (Cno char(15) PRIMARY KEY,</span><br><span class="line">    -&gt; Cname char(20) NOT NULL,</span><br><span class="line">    -&gt; Cpno char(15),</span><br><span class="line">    -&gt; Credits SMALLINT //小整型</span><br><span class="line">    -&gt; );</span><br><span class="line">Query OK, 0 rows affected (0.48 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; desc course;</span><br><span class="line">+<span class="comment">---------+-------------+------+-----+---------+-------+</span></span><br><span class="line">| Field   | Type        | Null | Key | Default | Extra |</span><br><span class="line">+<span class="comment">---------+-------------+------+-----+---------+-------+</span></span><br><span class="line">| Cno     | char(15)    | NO   | PRI | NULL    |       |</span><br><span class="line">| Cname   | char(20)    | NO   |     | NULL    |       |</span><br><span class="line">| Cpno    | char(15)    | YES  |     | NULL    |       |</span><br><span class="line">| Credits | smallint(6) | YES  |     | NULL    |       |</span><br><span class="line">+<span class="comment">---------+-------------+------+-----+---------+-------+</span></span><br><span class="line">4 rows in <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; CREATE TABLE SC(</span><br><span class="line">    -&gt; Sno char(12),</span><br><span class="line">    -&gt; Cno char(15),</span><br><span class="line">    -&gt; Grade SMALLINT,</span><br><span class="line">    -&gt; PRIMARY KEY(Sno,Cno) //以元组的形式创建多个主键</span><br><span class="line">    -&gt; );</span><br><span class="line">Query OK, 0 rows affected (0.14 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; desc sc;</span><br><span class="line">+<span class="comment">-------+-------------+------+-----+---------+-------+</span></span><br><span class="line">| Field | Type        | Null | Key | Default | Extra |</span><br><span class="line">+<span class="comment">-------+-------------+------+-----+---------+-------+</span></span><br><span class="line">| Sno   | char(12)    | NO   | PRI |         |       |</span><br><span class="line">| Cno   | char(15)    | NO   | PRI |         |       |</span><br><span class="line">| Grade | smallint(6) | YES  |     | NULL    |       |</span><br><span class="line">+<span class="comment">-------+-------------+------+-----+---------+-------+</span></span><br><span class="line">3 rows in <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br></pre></td></tr></table></figure>

<p>向各个表都插入数据</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; INSERT INTO student</span><br><span class="line">    -&gt; (Sno,Sname,Ssex,Sage,Sdept)</span><br><span class="line">    -&gt; VALUES</span><br><span class="line">    -&gt; ('201708034210','LiYong','male',20,'CS');</span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from student;</span><br><span class="line">+<span class="comment">--------------+--------+------+------+-------+</span></span><br><span class="line">| Sno          | Sname  | Ssex | Sage | Sdept |</span><br><span class="line">+<span class="comment">--------------+--------+------+------+-------+</span></span><br><span class="line">| 201708034210 | LiYong | male |   20 | CS    |</span><br><span class="line">+<span class="comment">--------------+--------+------+------+-------+</span></span><br><span class="line">1 row in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>

<p>插入多行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; INSERT INTO student</span><br><span class="line">    -&gt; (Sno,Sname,Ssex,Sage,Sdept)</span><br><span class="line">    -&gt; VALUES</span><br><span class="line">    -&gt; (&apos;201215122&apos;,&apos;LiuChen&apos;,&apos;female&apos;,19,&apos;CS&apos;),</span><br><span class="line">    -&gt; (&apos;201215123&apos;,&apos;WangMin&apos;,&apos;female&apos;,18,&apos;CS&apos;),</span><br><span class="line">    -&gt; (&apos;201215125&apos;,&apos;ZhangLi&apos;,&apos;&apos;,19,&apos;IS&apos;);</span><br><span class="line">mysql&gt; select * from student;</span><br><span class="line">+--------------+---------+--------+------+-------+</span><br><span class="line">| Sno          | Sname   | Ssex   | Sage | Sdept |</span><br><span class="line">+--------------+---------+--------+------+-------+</span><br><span class="line">| 201708034210 | LiYong  | male   |   20 | CS    |</span><br><span class="line">| 201215122    | LiuChen | female |   19 | CS    |</span><br><span class="line">| 201215123    | WangMin | female |   18 | CS    |</span><br><span class="line">| 201215125    | ZhangLi |        |   19 | IS    |</span><br><span class="line">+--------------+---------+--------+------+-------+</span><br><span class="line">4 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; INSERT INTO COURSE</span><br><span class="line">    -&gt; (Cno,Cname,Cpno,Credits)</span><br><span class="line">    -&gt; VALUES</span><br><span class="line">    -&gt; (&apos;2&apos;,&apos;math&apos;,&apos;&apos;,2),</span><br><span class="line">    -&gt; (&apos;3&apos;,&apos;infosystem&apos;,&apos;1&apos;,4),</span><br><span class="line">    -&gt; (&apos;4&apos;,&apos;os&apos;,&apos;6&apos;,3),</span><br><span class="line">    -&gt; (&apos;5&apos;,&apos;datestructure&apos;,&apos;7&apos;,4),</span><br><span class="line">    -&gt; (&apos;6&apos;,&apos;dateprocessing&apos;,&apos;&apos;,2),</span><br><span class="line">    -&gt; (&apos;7&apos;,&apos;python&apos;,&apos;6&apos;,4);</span><br><span class="line">mysql&gt; select * from course;</span><br><span class="line">+-----+----------------+------+---------+</span><br><span class="line">| Cno | Cname          | Cpno | Credits |</span><br><span class="line">+-----+----------------+------+---------+</span><br><span class="line">| 1   | database       | 5    |       4 |</span><br><span class="line">| 2   | math           |      |       2 |</span><br><span class="line">| 3   | infosystem     | 1    |       4 |</span><br><span class="line">| 4   | os             | 6    |       3 |</span><br><span class="line">| 5   | datestructure  | 7    |       4 |</span><br><span class="line">| 6   | dateprocessing |      |       2 |</span><br><span class="line">| 7   | python         | 6    |       4 |</span><br><span class="line">+-----+----------------+------+---------+</span><br><span class="line"></span><br><span class="line">mysql&gt; INSERT INTO sc</span><br><span class="line">    -&gt; (Sno,Cno,Grade)</span><br><span class="line">    -&gt; VALUES</span><br><span class="line">    -&gt; (&apos;201215121&apos;,&apos;1&apos;,92),</span><br><span class="line">    -&gt; (&apos;201215121&apos;,&apos;3&apos;,85),</span><br><span class="line">    -&gt; (&apos;201215121&apos;,&apos;2&apos;,88),</span><br><span class="line">    -&gt; (&apos;201215122&apos;,&apos;2&apos;,90),</span><br><span class="line">    -&gt; (&apos;201215122&apos;,&apos;3&apos;,80);</span><br><span class="line">Query OK, 5 rows affected (0.00 sec)</span><br><span class="line">Records: 5  Duplicates: 0  Warnings: 0</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT * FROM SC;</span><br><span class="line">+-----------+-----+-------+</span><br><span class="line">| Sno       | Cno | Grade |</span><br><span class="line">+-----------+-----+-------+</span><br><span class="line">| 201215121 | 1   |    92 |</span><br><span class="line">| 201215121 | 3   |    85 |</span><br><span class="line">| 201215121 | 2   |    88 |</span><br><span class="line">| 201215122 | 2   |    90 |</span><br><span class="line">| 201215122 | 3   |    80 |</span><br><span class="line">+-----------+-----+-------+</span><br></pre></td></tr></table></figure>

<p>第四条插入时想使用默认值，于是插入了空，但是却没设置为默认值，更新一下这条数据</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> table_name <span class="keyword">SET</span> field1=<span class="keyword">new</span>-value1, field2=<span class="keyword">new</span>-value2</span><br><span class="line">[<span class="keyword">WHERE</span> Clause]</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">UPDATE</span> student <span class="keyword">SET</span> Ssex=<span class="string">'male'</span> <span class="keyword">WHERE</span> Sno=<span class="string">'201215125'</span>;</span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br><span class="line">Rows matched: 1  Changed: 1  Warnings: 0</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from student;</span><br><span class="line">+<span class="comment">--------------+---------+--------+------+-------+</span></span><br><span class="line">| Sno          | Sname   | Ssex   | Sage | Sdept |</span><br><span class="line">+<span class="comment">--------------+---------+--------+------+-------+</span></span><br><span class="line">| 201708034210 | LiYong  | male   |   20 | CS    |</span><br><span class="line">| 201215122    | LiuChen | female |   19 | CS    |</span><br><span class="line">| 201215123    | WangMin | female |   18 | CS    |</span><br><span class="line">| 201215125    | ZhangLi | male   |   19 | IS    |</span><br><span class="line">+<span class="comment">--------------+---------+--------+------+-------+</span></span><br><span class="line">4 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>

<p>正确使用默认值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; INSERT INTO student</span><br><span class="line">    -&gt; (Sno,Sname,Ssex,Sage,Sdept)</span><br><span class="line">    -&gt; VALUES</span><br><span class="line">    -&gt; (&apos;201215124&apos;,&apos;JingYu&apos;,default,27,&apos;MATH&apos;);</span><br><span class="line">    </span><br><span class="line">mysql&gt; select * from student where Sno=&apos;201215124&apos;;</span><br><span class="line">+-----------+--------+------+------+-------+</span><br><span class="line">| Sno       | Sname  | Ssex | Sage | Sdept |</span><br><span class="line">+-----------+--------+------+------+-------+</span><br><span class="line">| 201215124 | JingYu | male |   27 | MATH  |</span><br><span class="line">+-----------+--------+------+------+-------+</span><br></pre></td></tr></table></figure>

<p>删除数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; delete from student where Sno=&apos;s09&apos;;</span><br></pre></td></tr></table></figure>

<h3 id="索引的建立与删除"><a href="#索引的建立与删除" class="headerlink" title="索引的建立与删除"></a>索引的建立与删除</h3><p>建立索引是加快查询速度的有效手段。常见索引包括顺序文件上的索引、B+树索引、散列(hash)索引、位图索引等。索引管理一般由管理员完成，用户不必也不能显式地选择索引。索引属于内模式的范畴。</p>
<h4 id="建立索引"><a href="#建立索引" class="headerlink" title="建立索引"></a>建立索引</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">CREATE [UNIQUE] [CLUSTER] INDEX &lt;索引名&gt; ON &lt;表名&gt;(&lt;列名&gt; [&lt;次序&gt;]...)</span><br><span class="line"></span><br><span class="line">mysql&gt; CREATE UNIQUE INDEX Stusno ON student(Sno);  //ASC 升序（默认）</span><br><span class="line">mysql&gt; CREATE UNIQUE INDEX Coucno ON course(Cno);</span><br><span class="line">mysql&gt; CREATE UNIQUE INDEX SCno ON SC(Sno ASC,Cno DESC); //DESC 降序</span><br></pre></td></tr></table></figure>

<h4 id="删除索引"><a href="#删除索引" class="headerlink" title="删除索引"></a>删除索引</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE table_name DROP INDEX index_name;</span><br><span class="line"></span><br><span class="line">mysql&gt; ALTER TABLE SC DROP INDEX SCno;</span><br></pre></td></tr></table></figure>

<h4 id="修改索引"><a href="#修改索引" class="headerlink" title="修改索引"></a>修改索引</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">MYSQL 没有提供直接修改索引的命令，一般情况下我们需要先删除原索引，再建立新索引</span><br><span class="line"></span><br><span class="line">ALTER TABLE user</span><br><span class="line">DROP INDEX idx_user_username;</span><br><span class="line">--再以修改后的内容创建同名索引</span><br><span class="line">CREATE INDEX idx_user_username ON user (username(8));</span><br></pre></td></tr></table></figure>

<h4 id="查看索引"><a href="#查看索引" class="headerlink" title="查看索引"></a>查看索引</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">--如果查看索引前，没有使用user db_name等命令指定具体的数据库，则必须加上FROM db_name</span><br><span class="line">SHOW INDEX FROM table_name [FROM db_name]</span><br><span class="line">--如果查看索引前，没有使用user db_name等命令指定具体的数据库，则必须加上db_name.前缀</span><br><span class="line">SHOW INDEX FROM [db_name.]table_name</span><br></pre></td></tr></table></figure>

<h3 id="修改基本表"><a href="#修改基本表" class="headerlink" title="修改基本表"></a>修改基本表</h3><blockquote>
<p><strong>2.1</strong> 向基本表Student中增加“入学时间”属性列，其属性名为RegisterDate，数据类型为DATETIME型</p>
<p><strong>2.2</strong> 将Sage(年龄)的数据类型改为SMALLINT型.</p>
<p><strong>2.3</strong> 删除属性列RegisterDate.</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; ALTER TABLE student ADD RegisterDate DATETIME; //新增列</span><br><span class="line">mysql&gt; ALTER TABLE student modify column Sage smallint; //更新数据类型，注意是 modify</span><br><span class="line">mysql&gt; ALTER TABLE student change column RegisterDate RDate time; //同时修改列名和列的数据类型</span><br><span class="line">mysql&gt; desc student;</span><br><span class="line">+-------+-------------+------+-----+---------+-------+</span><br><span class="line">| Field | Type        | Null | Key | Default | Extra |</span><br><span class="line">+-------+-------------+------+-----+---------+-------+</span><br><span class="line">| Sno   | char(12)    | NO   | PRI | NULL    |       |</span><br><span class="line">| Sname | char(20)    | NO   | UNI | NULL    |       |</span><br><span class="line">| Ssex  | char(8)     | YES  |     | male    |       |</span><br><span class="line">| Sage  | smallint(6) | YES  |     | NULL    |       |</span><br><span class="line">| Sdept | char(15)    | YES  |     | NULL    |       |</span><br><span class="line">| RDate | time        | YES  |     | NULL    |       |</span><br><span class="line">+-------+-------------+------+-----+---------+-------+</span><br><span class="line">6 rows in set (0.01 sec)</span><br><span class="line">mysql&gt; ALTER TABLE student drop column RDate; //删除新增的列</span><br></pre></td></tr></table></figure>

<h3 id="数据查询"><a href="#数据查询" class="headerlink" title="数据查询"></a>数据查询</h3><h4 id="无条件查询"><a href="#无条件查询" class="headerlink" title="无条件查询"></a>无条件查询</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select Sname,Sno,Sdept from student; //查询基本信息</span><br><span class="line">mysql&gt; select Sname,2020-Sage from student; //查询计算之后的信息</span><br><span class="line">mysql&gt; select Sname,&apos;Year of Brith:&apos;,2020-Sage,LOWER(Sdept) from student; //查询全体学生的姓名、出生年份和学号，要求用小写字母表示学号中的字母</span><br><span class="line">+---------+----------------+-----------+--------------+</span><br><span class="line">| Sname   | Year of Brith: | 2020-Sage | LOWER(Sdept) |</span><br><span class="line">+---------+----------------+-----------+--------------+</span><br><span class="line">| LiYong  | Year of Brith: |      2000 | cs           |</span><br><span class="line">| LiuChen | Year of Brith: |      2001 | cs           |</span><br><span class="line">| WangMin | Year of Brith: |      2002 | cs           |</span><br><span class="line">| ZhangLi | Year of Brith: |      2001 | is           |</span><br><span class="line">| JingYu  | Year of Brith: |      1993 | math         |</span><br><span class="line">+---------+----------------+-----------+--------------+</span><br><span class="line">5 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select Sname,&apos;Year of Brith:&apos;BIRTH,2020-Sage BIRTHDAY,LOWER(Sdept) DEPARTMENT from student; //给查询结果使用别名</span><br><span class="line">+---------+----------------+----------+------------+</span><br><span class="line">| Sname   | BIRTH          | BIRTHDAY | DEPARTMENT |</span><br><span class="line">+---------+----------------+----------+------------+</span><br><span class="line">| LiYong  | Year of Brith: |     2000 | cs         |</span><br><span class="line">| LiuChen | Year of Brith: |     2001 | cs         |</span><br><span class="line">| WangMin | Year of Brith: |     2002 | cs         |</span><br><span class="line">| ZhangLi | Year of Brith: |     2001 | is         |</span><br><span class="line">| JingYu  | Year of Brith: |     1993 | math       |</span><br><span class="line">+---------+----------------+----------+------------+</span><br><span class="line">5 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT DISTINCT SNO FROM SC; //查询有选修课程的学号并去重</span><br><span class="line">+-----------+                      </span><br><span class="line">| SNO       |                      </span><br><span class="line">+-----------+                      </span><br><span class="line">| 201215121 |                      </span><br><span class="line">| 201215122 |                      </span><br><span class="line">+-----------+                      </span><br><span class="line">2 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h4 id="条件查询"><a href="#条件查询" class="headerlink" title="条件查询"></a>条件查询</h4><p><img src="C:%5CUsers%5Cbrian%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20200317114810992.png" alt="image-20200317114810992"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select Sno,Sname from student where Sdept=&apos;MATH&apos;; //查询数学系学生信息</span><br><span class="line"></span><br><span class="line">mysql&gt; select Sage,Sname from student where Sage BETWEEN 18 AND 22; //查询年龄区间 18-22 的学生信息</span><br><span class="line">mysql&gt; select Sage,Sname from student where Sage NOT BETWEEN 18 AND 22; // 查询年龄范围之外的学生信息</span><br><span class="line"></span><br><span class="line">mysql&gt; select Sname,Sno from student where Sdept in(&apos;CS&apos;,&apos;MATH&apos;,&apos;OS&apos;); // 查询目标院系学生信息</span><br><span class="line">mysql&gt; select Sname,Sno from student where Sdept NOT in(&apos;CS&apos;,&apos;MATH&apos;,&apos;OS&apos;);</span><br><span class="line"></span><br><span class="line">mysql&gt; select Sname,Sno from student where Sname like &apos;Liu%&apos;; //查询姓名以 Liu 开头的学生信息。 % 代表任意长度</span><br><span class="line">mysql&gt; select Sname,Sno from student where Sname like &apos;Liu___&apos;; //查询限定长度的姓名信息。_ 代表任意单个字符</span><br></pre></td></tr></table></figure>

<p>如果要查询的字符串本身含有通配符 <code>%</code> 或 <code>_</code> ,这时就要使用 <code>ESCAPE</code> 对其转义处理。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT Cno,Credits FROM Course where Cname LIKE &apos;DB/_Design&apos; ESCAPE &apos;/&apos;;</span><br><span class="line">mysql&gt; SELECT Cno,Credits FROM Course where Cname LIKE &apos;DB/_%i_&apos; ESCAPE &apos;/&apos;; DB开头，倒数第二个为 i 。</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT Sno,Cno</span><br><span class="line">    -&gt; FROM SC</span><br><span class="line">    -&gt; WHERE Grade IS NULL;  // 参加考试但没有考试成绩</span><br><span class="line">mysql&gt; SELECT Sno,Cno</span><br><span class="line">    -&gt; FROM SC</span><br><span class="line">    -&gt; WHERE Grade IS NOT NULL; // 所有有成绩的学生信息</span><br></pre></td></tr></table></figure>

<h4 id="ORDER-BY-字句"><a href="#ORDER-BY-字句" class="headerlink" title="ORDER BY 字句"></a>ORDER BY 字句</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT Sno,Grade FROM SC WHERE Cno=&apos;3&apos; order by Grade desc; // 按成绩降序排列选修 Cno=3 的学生信息</span><br><span class="line">mysql&gt; SELECT * FROM student ORDER BY Sdept,Sage DESC; // 所在系号升序，同一系学生年龄按降序。</span><br><span class="line">+-----------+---------+--------+------+-------+</span><br><span class="line">| Sno       | Sname   | Ssex   | Sage | Sdept |</span><br><span class="line">+-----------+---------+--------+------+-------+</span><br><span class="line">| 201215121 | LiYong  | male   |   20 | CS    |</span><br><span class="line">| 201215122 | LiuChen | female |   19 | CS    |</span><br><span class="line">| 201215123 | WangMin | female |   18 | CS    |</span><br><span class="line">| 201215125 | ZhangLi | male   |   19 | IS    |</span><br><span class="line">| 201215124 | JingYu  | male   |   27 | MATH  |</span><br><span class="line">+-----------+---------+--------+------+-------+</span><br><span class="line"></span><br><span class="line">未对查询结果分组，聚集函数将作用于整个查询结果。分组后将作用于每一组。</span><br><span class="line">mysql&gt; select Cno,count(Sno) from sc group by Cno; //求各个课程号(Cno)及相应的选课人数</span><br><span class="line"></span><br><span class="line">mysql&gt; select Sno from sc group by Sno HAVING COUNT(*) &gt;=3;</span><br><span class="line">+-----------+</span><br><span class="line">| Sno       |</span><br><span class="line">+-----------+</span><br><span class="line">| 201215121 |</span><br><span class="line">+-----------+</span><br><span class="line">1 row in set (0.00 sec) //查询选修了3门或3门以上课程的学生学号(Sno)</span><br><span class="line">WHERE 子句作用于基本表或视图，从中选择满足条件的元组，HAVING  短语作用于组，从中选择满足条件的组。</span><br></pre></td></tr></table></figure>

<h4 id="集函数的使用"><a href="#集函数的使用" class="headerlink" title="集函数的使用"></a>集函数的使用</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">SQL提供许多聚集函数，主要有：</span><br><span class="line">- COUNT(*)                     统计元组个数</span><br><span class="line">- COUNT([DISTINCT|ALL] &lt;列名&gt;) 统计一列中值的个数</span><br><span class="line">- SUM([DISTINCT|ALL] &lt;列名&gt;)   计算一列值的总和，列必须是数值型</span><br><span class="line">- AVG([DISTINCT|ALL] &lt;列名&gt;)   计算一列值的平均值，列必须是数值型</span><br><span class="line">- MAX([DISTINCT|ALL] &lt;列名&gt;)   求一列值中的最大值</span><br><span class="line">- MIN([DISTINCT|ALL] &lt;列名&gt;)   求一列值中的最小值</span><br><span class="line">DISTINCT 短语对结果去重，默认 ALL</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">select count(*) from student;  //查询学生总人数</span><br><span class="line"></span><br><span class="line">mysql&gt; select count(DISTINCT Sdept) from student; //查询有多少个专业</span><br><span class="line"></span><br><span class="line">mysql&gt; select AVG(Grade) from sc where Cno=&apos;1&apos;; //计算选修C01号课程的学生平均成绩。</span><br><span class="line"></span><br><span class="line">mysql&gt; select MAX(Grade) from sc where Cno=&apos;1&apos;; //查询选修C01号课程的学生最高分数。</span><br></pre></td></tr></table></figure>

<h4 id="连接查询"><a href="#连接查询" class="headerlink" title="连接查询"></a>连接查询</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT Sname from student,sc where student.Sno=SC.Sno AND cno=&apos;2&apos; and Grade&gt;=90; // 查询选2门课且成绩大于90</span><br><span class="line"></span><br><span class="line">mysql&gt; select first.Cno,second.Cpno from course first,course second where first.Cpno=second.Cno; //自身连接 找到选修的选修课</span><br><span class="line">+-----+------+</span><br><span class="line">| Cno | Cpno |</span><br><span class="line">+-----+------+</span><br><span class="line">| 1   | 7    |</span><br><span class="line">| 3   | 5    |</span><br><span class="line">| 4   |      |</span><br><span class="line">| 5   | 6    |</span><br><span class="line">| 7   |      |</span><br><span class="line">+-----+------+</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT Sname,Sage </span><br><span class="line">from student,course,sc </span><br><span class="line">where student.Sno=sc.Sno AND sc.Cno=course.Cno </span><br><span class="line">AND Cname=&apos;database&apos;;//三表连接查询，查询选修了课程名为“数据结构”的学生学号(Sno)和姓名(Sname)。</span><br><span class="line"></span><br><span class="line">mysql&gt; select Sname,Sage from student,sc where sc.Sno=student.Sno;  //查询每个学生及其选修课程的情况。</span><br><span class="line"></span><br><span class="line">mysql&gt; select student.Sno,Sname,Cname,Grade from student,sc,course where student.Sno=sc.Sno AND sc.Cno=course.Cno; </span><br><span class="line">//查询每个学生的学号(Sno)、姓名(Sname)、选修的课程名(Cname)及成绩(Grade)。 这里 Sno 值不唯一，因此要加上前缀</span><br></pre></td></tr></table></figure>

<h4 id="集合查询"><a href="#集合查询" class="headerlink" title="集合查询"></a>集合查询</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from student where Sdept=&apos;CS&apos; union select * from student where Sage&lt;=19; //UNION 联合查询，自动去重 查询计算机科学系的学生或年龄不大于20岁的学生信息。</span><br><span class="line"></span><br><span class="line">mysql&gt; select Sname,Ssex,Sage,Sdept from student where Sdept=&apos;CS&apos; or Sage&lt;=&apos;20&apos;; //查询计算机科学系的学生或年龄不大于20岁的学生信息</span><br><span class="line"></span><br><span class="line">mysql&gt; select Sname,Ssex,Sage,Sdept from student where Sdept=&apos;math&apos; and Sage&lt;=&apos;20&apos;; //查询数学系的学生且年龄不大于20岁的学生的交集，这实际上就是查询数学系中年龄不大于20岁的学生。</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from student where Sdept=&apos;math&apos; intersect select * from student where Sage&lt;=19; //查询数学系的学生且年龄不大于20岁的学生的交集，这实际上就是查询数学系中年龄不大于20岁的学生。</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from student where Sdept=&apos;math&apos; execpt select * from student where Sage&lt;=19;//查询数学系的学生与年龄不大于20岁的学生的差集。</span><br><span class="line"></span><br><span class="line">INTERSECT 交操作 &amp; EXCEPT 差操作，在mysql中还不支持，一般用 not in 代替实现</span><br></pre></td></tr></table></figure>

<h4 id="嵌套查询"><a href="#嵌套查询" class="headerlink" title="嵌套查询"></a>嵌套查询</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT Sname,Sage </span><br><span class="line">FROM student </span><br><span class="line">WHERE Sno IN </span><br><span class="line">    (SELECT Sno </span><br><span class="line">    from sc </span><br><span class="line">    WHERE Cno IN </span><br><span class="line">        (SELECT Cno </span><br><span class="line">        from course </span><br><span class="line">        where Cname=&apos;database&apos;</span><br><span class="line">        )</span><br><span class="line">    ); //跨三个表查询，实现的效果与多表连接效果一样。查询选修了课程名为“数据结构”的学生学号(Sno)和姓名(Sname)。</span><br><span class="line">    </span><br><span class="line">mysql&gt; select student.Sno,Sname from student,course,sc where student.Sno=sc.Sno AND sc.Cno=course.Cno AND course.Cname=&apos;math&apos;; //查询选修了课程名为“数据结构”的学生学号(Sno)和姓名(Sname)。</span><br></pre></td></tr></table></figure>

<h4 id="带-IN-和-ALL-的子查询"><a href="#带-IN-和-ALL-的子查询" class="headerlink" title="带 IN 和 ALL 的子查询"></a>带 <code>IN</code> 和 <code>ALL</code> 的子查询</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select Sname,Sage from student where Sage &lt;= ANY (select Sage from student where Sdept=&apos;IS&apos;); //查询非自动化系的不超过自动化系所有学生的年龄的学生姓名(Sname)和年龄(Sage)。</span><br><span class="line"></span><br><span class="line">mysql&gt; select Sname,Sdept from student where Sno in (select Sno from sc where Cno=&apos;2&apos;); //查询选修了编号为“C02”的课程的学生姓名(Sname)和所在系(Sdept)。</span><br><span class="line"></span><br><span class="line">mysql&gt; select Sno,Sname,Sdept from student where Sdept in (select sdept from student where Sname=&apos;WangMin&apos;);</span><br><span class="line">//查询与“李伟”在同一个系学习的学生学号(Sno)、姓名(Sname)和系名(Sdept)。</span><br><span class="line">此查询为不相关子查询，子查询条件不依赖于父条件。</span><br></pre></td></tr></table></figure>

<h4 id="基于派生表的查询"><a href="#基于派生表的查询" class="headerlink" title="基于派生表的查询"></a>基于派生表的查询</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="sql高级查询"><a href="#sql高级查询" class="headerlink" title="sql高级查询"></a><code>sql</code>高级查询</h3><h4 id="聚集函数的使用"><a href="#聚集函数的使用" class="headerlink" title="聚集函数的使用"></a>聚集函数的使用</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">SQL提供许多聚集函数，主要有：</span><br><span class="line">- COUNT(*)                     统计元组个数</span><br><span class="line">- COUNT([DISTINCT|ALL] &lt;列名&gt;) 统计一列中值的个数</span><br><span class="line">- SUM([DISTINCT|ALL] &lt;列名&gt;)   计算一列值的总和，列必须是数值型</span><br><span class="line">- AVG([DISTINCT|ALL] &lt;列名&gt;)   计算一列值的平均值，列必须是数值型</span><br><span class="line">- MAX([DISTINCT|ALL] &lt;列名&gt;)   求一列值中的最大值</span><br><span class="line">- MIN([DISTINCT|ALL] &lt;列名&gt;)   求一列值中的最小值</span><br><span class="line">DISTINCT 短语对结果去重，默认 ALL</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">select count(*) from student;  //查询学生总人数</span><br><span class="line"></span><br><span class="line">mysql&gt; select count(DISTINCT Sdept) from student; //查询有多少个专业</span><br><span class="line"></span><br><span class="line">mysql&gt; select AVG(Grade) from sc where Cno=&apos;1&apos;; //计算选修C01号课程的学生平均成绩。</span><br><span class="line"></span><br><span class="line">mysql&gt; select MAX(Grade) from sc where Cno=&apos;1&apos;; //查询选修C01号课程的学生最高分数。</span><br></pre></td></tr></table></figure>

<h4 id="查询结果分组"><a href="#查询结果分组" class="headerlink" title="查询结果分组"></a>查询结果分组</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select Cno,count(Sno) from sc group by Cno;</span><br><span class="line">//求每门课的课程号(Cno)及相应的选课人数。</span><br><span class="line"></span><br><span class="line">mysql&gt; select Sno from sc having count(Cno)&gt;=3;</span><br><span class="line">//查询选修了3门或3门以上课程的学生学号(Sno)。</span><br><span class="line">这个是不对的，只是结果看起来对</span><br><span class="line"></span><br><span class="line">mysql&gt; select Sno from sc group by Sno having count(*)=3; //查询选修了3门或3门以上课程的学生学号(Sno)。</span><br></pre></td></tr></table></figure>

<h4 id="不同表之间的连接查询"><a href="#不同表之间的连接查询" class="headerlink" title="不同表之间的连接查询"></a>不同表之间的连接查询</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select student.Sname,student.Sdept,course.Cname from student,course,sc where student.Sno=sc.Sno and sc.Cno=course.Cno; //查询每个学生及其选修课程的情况。</span><br><span class="line"></span><br><span class="line">mysql&gt; select student.Sno,Sname,Cname,Grade from student,sc,course where student.Sno=sc.Sno AND sc.Cno=course.Cno; </span><br><span class="line">//查询每个学生的学号(Sno)、姓名(Sname)、选修的课程名(Cname)及成绩(Grade)。 这里 Sno 值不唯一，因此要加上前缀</span><br><span class="line"></span><br><span class="line">mysql&gt; select student.Sno,student.Sname,course.Cname,sc.Grade from student,course,sc where student.Sno=sc.Sno and sc.Cno=course.Cno and sc.Grade&gt;=90;//查询考试成绩在90分以上的学生学号(Sno)、姓名(Sname)、选修的课程名(Cname)</span><br></pre></td></tr></table></figure>

<h4 id="带谓词-IN-的嵌套查询"><a href="#带谓词-IN-的嵌套查询" class="headerlink" title="带谓词 IN 的嵌套查询"></a>带谓词 IN 的嵌套查询</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select Sname,Sdept from student where Sno in (select Sno from sc where Cno=&apos;2&apos;); //查询选修了编号为“C02”的课程的学生姓名(Sname)和所在系(Sdept)。</span><br><span class="line"></span><br><span class="line">mysql&gt; select Sno,Sname,Sdept from student where Sdept in (select sdept from student where Sname=&apos;WangMin&apos;);</span><br><span class="line">//查询与“李伟”在同一个系学习的学生学号(Sno)、姓名(Sname)和系名(Sdept)。</span><br></pre></td></tr></table></figure>

<h2 id="视图"><a href="#视图" class="headerlink" title="视图"></a>视图</h2><h3 id="建立视图"><a href="#建立视图" class="headerlink" title="建立视图"></a>建立视图</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">1.1	建立数学系学生的视图math_stu，并要求进行修改和插入操作时仍需保证该视图只有数学系的学生，视图的属性名为Sno，Sname，Sage，Sdept。</span><br><span class="line">mysql&gt; create view math_stu</span><br><span class="line">    -&gt; as select</span><br><span class="line">    -&gt; Sno,Sname,Sage,Sdept</span><br><span class="line">    -&gt; from student where Sdept=&apos;MATH&apos;;</span><br><span class="line">Query OK, 0 rows affected (0.16 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from math_stu;</span><br><span class="line">+-----------+--------+------+-------+</span><br><span class="line">| Sno       | Sname  | Sage | Sdept |</span><br><span class="line">+-----------+--------+------+-------+</span><br><span class="line">| 201215124 | JingYu |   27 | MATH  |</span><br><span class="line">+-----------+--------+------+-------+</span><br><span class="line">1 row in set (0.10 sec)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">1.2  建立学生的学号(Sno)、姓名(Sname)、选修课程名(Cname)及成绩(Grade)的视图grade_stu。</span><br><span class="line">mysql&gt; create view grade_stu</span><br><span class="line">    -&gt; as select</span><br><span class="line">    -&gt; s.Sno,s.Sname,c.Cname,sc.Grade</span><br><span class="line">    -&gt; from student s,course c,sc;</span><br><span class="line">Query OK, 0 rows affected (0.12 sec)</span><br><span class="line"></span><br><span class="line">这种方法创建完之后我们发现存在大量重复且错误的数据,猜想是因为没有指定表之间的关系导致的。下面这个是正确的查询方式。</span><br><span class="line">mysql&gt; create view grade_stu</span><br><span class="line">    -&gt; as select</span><br><span class="line">    -&gt; s.Sno,s.Sname,c.Cname,sc.Grade</span><br><span class="line">    -&gt; from student s,course c,sc</span><br><span class="line">    -&gt; where s.Sno=sc.Sno and c.Cno=sc.Cno;</span><br><span class="line">Query OK, 0 rows affected (0.12 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from grade_stu;</span><br><span class="line">+-----------+---------+------------+-------+</span><br><span class="line">| Sno       | Sname   | Cname      | Grade |</span><br><span class="line">+-----------+---------+------------+-------+</span><br><span class="line">| 201215121 | LiYong  | database   |    92 |</span><br><span class="line">| 201215121 | LiYong  | infosystem |    85 |</span><br><span class="line">| 201215121 | LiYong  | math       |    88 |</span><br><span class="line">| 201215122 | LiuChen | math       |    90 |</span><br><span class="line">| 201215122 | LiuChen | infosystem |    80 |</span><br><span class="line">+-----------+---------+------------+-------+</span><br><span class="line">5 rows in set (0.33 sec)</span><br><span class="line"></span><br><span class="line">我们还可以尝试 left join &amp; right join 的方式，本质上完全一样：</span><br><span class="line"></span><br><span class="line">mysql&gt; create view grade_stu</span><br><span class="line">    -&gt; as select</span><br><span class="line">    -&gt; s.Sno,s.Sname,c.Cname,sc.Grade</span><br><span class="line">    -&gt; from sc</span><br><span class="line">    -&gt; left join student s on s.Sno=sc.Sno</span><br><span class="line">    -&gt; left join course c on c.Cno=sc.Cno;</span><br><span class="line">Query OK, 0 rows affected (0.11 sec)</span><br><span class="line"></span><br><span class="line">1.3  定义一个反映学生出生年份的视图Student_birth。</span><br><span class="line">mysql&gt; create view Student_brith (s_name,s_brith) as select Sname,2020-student.Sage from student;</span><br><span class="line"></span><br><span class="line">1.4 定义一个视图AVGG，视图列中有课程号、这门课程的平均成绩，且平均成绩大于80分。</span><br><span class="line">mysql&gt; create view AVGG (cno,avg_grade) as select Cno,AVG(Grade) from sc group by Cno HAVING AVG(Grade)&gt;80;</span><br></pre></td></tr></table></figure>

<h3 id="删除视图"><a href="#删除视图" class="headerlink" title="删除视图"></a>删除视图</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; drop view if exists grade_stu;</span><br></pre></td></tr></table></figure>

<h3 id="查询视图"><a href="#查询视图" class="headerlink" title="查询视图"></a>查询视图</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">3.1 在数学系的学生视图math_stu中找出年龄(Sage)小于20岁的学生姓名(Sname)和年龄(Sage)。</span><br><span class="line">mysql&gt; select Sname,Sage from math_stu where Sage&lt;20;</span><br><span class="line"></span><br><span class="line">3.2  在grade_stu视图中查询成绩在85分以上的学生学号(Sno)、姓名(Sname)和课程名称(Cname)。</span><br><span class="line">mysql&gt; select Sno,Sname,Cname from grade_stu where Grade&gt;85;</span><br></pre></td></tr></table></figure>

<h3 id="更新视图"><a href="#更新视图" class="headerlink" title="更新视图"></a>更新视图</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">语法：ALTER VIEW &lt;视图名&gt; AS &lt;SELECT语句&gt;</span><br></pre></td></tr></table></figure>

<p>需要注意的是，对于 ALTER VIEW 语句的使用，需要用户具有针对视图的 CREATE VIEW 和 DROP 权限，以及由 SELECT 语句选择的每一列上的某些权限。</p>
<p> 修改视图的定义，除了可以通过 ALTER VIEW 外，也可以使用 DROP VIEW 语句先删除视图，再使用 CREATE VIEW 语句来实现。</p>
<p>视图是一个虚拟表，实际的数据来自于基本表，所以通过插入、修改和删除操作更新视图中的数据，实质上是在更新视图所引用的基本表的数据。</p>
<p>注意：对视图的修改就是对基本表的修改，因此在修改时，要满足基本表的数据定义。</p>
<p>某些视图是可更新的。也就是说，可以使用 UPDATE、DELETE 或 INSERT 等语句更新基本表的内容。对于可更新的视图，视图中的行和基本表的行之间必须具有一对一的关系。</p>
<p>还有一些特定的其他结构，这些结构会使得视图不可更新。更具体地讲，如果视图包含以下结构中的任何一种，它就是不可更新的：</p>
<ul>
<li>聚合函数 SUM()、MIN()、MAX()、COUNT() 等。</li>
<li>DISTINCT 关键字。</li>
<li>GROUP BY 子句。</li>
<li>HAVING 子句。</li>
<li>UNION 或 UNION ALL 运算符。</li>
<li>位于选择列表中的子查询。</li>
<li>FROM 子句中的不可更新视图或包含多个表。</li>
<li>WHERE 子句中的子查询，引用 FROM 子句中的表。</li>
<li>ALGORITHM 选项为 TEMPTABLE（使用临时表总会使视图成为不可更新的）的时候。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">4.1 将数学系学生视图math_stu中学号为200215123的学生姓名改为“黄海”。</span><br><span class="line">mysql&gt; update math_stu set Sname=&apos;huanghai&apos; where Sno=&apos;201215124&apos;;</span><br><span class="line">我们再去查询基本表发现 studnet 表中的数据已经被修改。</span><br><span class="line"></span><br><span class="line">4.2  向数学系学生视图math_stu中插入一个新的学生记录，其中学号为“S09”，姓名为“王海”，年龄为20岁。</span><br><span class="line">mysql&gt; INSERT INTO math_stu (Sno,Sname,Sage,Sdept) values (&apos;s09&apos;,&apos;wanghai&apos;,20,&apos;MATH&apos;);</span><br></pre></td></tr></table></figure>

<h2 id="用户"><a href="#用户" class="headerlink" title="用户"></a>用户</h2><h3 id="创建用户"><a href="#创建用户" class="headerlink" title="创建用户"></a>创建用户</h3><p>可以使用 CREATE USER 语句来创建一个或多个 MySQL 账户，并设置相应的口令。</p>
<p> 语法格式：</p>
<p><code>CREATE USER &lt;用户名&gt; [ IDENTIFIED ] BY [ PASSWORD ] &lt;口令&gt;</code></p>
<p>语法说明如下：</p>
<p> 1) &lt;用户名&gt;</p>
<p>指定创建用户账号，格式为 ‘user_name’@’host_name’。这里<code>user_name</code>是用户名，<code>host_name</code>为主机名，即用户连接 MySQL 时所在主机的名字。若在创建的过程中，只给出了账户的用户名，而没指定主机名，则主机名默认为“%”，表示一组主机。</p>
<p> 2) PASSWORD</p>
<p>可选项，用于指定散列口令，即若使用明文设置口令，则需忽略<code>PASSWORD</code>关键字；若不想以明文设置口令，且知道 PASSWORD() 函数返回给密码的散列值，则可以在口令设置语句中指定此散列值，但需要加上关键字<code>PASSWORD</code>。</p>
<p> 3) IDENTIFIED BY子句</p>
<p>用于指定用户账号对应的口令，若该用户账号无口令，则可省略此子句。</p>
<p> 4) &lt;口令&gt;</p>
<p>指定用户账号的口令，在<code>IDENTIFIED BY</code>关键字或<code>PASSWOED</code>关键字之后。给定的口令值可以是只由字母和数字组成的明文，也可以是通过 PASSWORD() 函数得到的散列值。</p>
<p> 使用 CREATE USER 语句应该注意以下几点：</p>
<ul>
<li>如果使用 CREATE USER 语句时没有为用户指定口令，那么 MySQL 允许该用户可以不使用口令登录系统，然而从安全的角度而言，不推荐这种做法。</li>
<li>使用 CREATE USER 语句必须拥有 MySQL 中 MySQL 数据库的 INSERT 权限或全局 CREATE USER 权限。</li>
<li>使用 CREATE USER 语句创建一个用户账号后，会在系统自身的 MySQL 数据库的 user 表中添加一条新记录。若创建的账户已经存在，则语句执行时会出现错误。</li>
<li>新创建的用户拥有的权限很少。他们可以登录 MySQL，只允许进行不需要权限的操作，如使用 SHOW 语句查询所有存储引擎和字符集的列表等。</li>
</ul>
<p> 如果两个用户具有相同的用户名和不同的主机名，MySQL 会将他们视为不同的用户，并允许为这两个用户分配不同的权限集合。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">5.1创建两个用户，一个以你的名字（汉语拼音）命名的用户，登陆名也为你的名字（汉语拼音），另一个为你同学（汉语拼音）的名字命名的一个用户，登录名为你同学的名字（汉语拼音）。</span><br><span class="line">mysql&gt; create user &apos;brain&apos;@&apos;localhost&apos; identified by &apos;123456&apos;;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; create user &apos;fuck&apos;@&apos;localhost&apos; identified by &apos;321654&apos;;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br></pre></td></tr></table></figure>

<h3 id="用户权限"><a href="#用户权限" class="headerlink" title="用户权限"></a>用户权限</h3><h3 id="角色"><a href="#角色" class="headerlink" title="角色"></a>角色</h3><p>通常，MySQL 数据库拥有多个相同权限集合的用户。以前，向多个用户授予和撤销权限的唯一方法是单独更改每个用户的权限，假如用户数量比较多的时候，这是非常耗时的。<a href="https://www.yiibai.com/mysql/roles.html" target="_blank" rel="noopener">MySql 角色</a></p>
<p>为了用户权限管理更容易，MySQL提供了一个名为<code>role</code>的新对象，它是一个命名的特权集合。</p>
<p>如果要向多个用户授予相同的权限集，则应如下所示：</p>
<ul>
<li><em>首先</em>，创建新的角色。</li>
<li><em>第二</em>，授予角色权限。</li>
<li><em>第三</em>，授予用户角色。</li>
</ul>
<p>如果要更改用户的权限，则需要仅更改授权角色的权限。这些更改角色的权限将对授予角色的所有用户生效。</p>
<p>假设您开发了一个使用<code>crmdb</code>数据库的应用程序。要与<code>crmdb</code>数据库进行交互，您需要为需要完全访问数据库的开发人员创建帐户。此外，需要为仅需读取访问权限的用户创建帐户，以及为读取/写入访问权限的用户创建帐户。</p>
<p>要避免单独为每个用户帐户授予权限，您可以创建一组角色，并为每个用户帐户授予相应的角色。</p>
<p>要创建新角色，请使用<code>CREATE ROLE</code>语句</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">5.2在学生管理数据库上创建两个角色R1和R2，把你这个用户放入R1和把你同学的用户放入角色R2中。</span><br><span class="line">create role if not exists &apos;R1&apos;,&apos;R2&apos;；</span><br><span class="line">GRANT R1 TO brain@localhost;</span><br><span class="line">GRANT R2 TO fuck@localhost;</span><br><span class="line"></span><br><span class="line">5.3给角色R1授权，使其可以查询学生管理数据库中的student表以及查询视图math_stu。</span><br><span class="line">grant select on studentinfo.student to R1;</span><br><span class="line">set default role R1 to brain@localhost;</span><br><span class="line">要在每次用户帐户连接到数据库服务器时指定哪些角色应该处于活动状态，请使用SET DEFAULT ROLE语句。</span><br><span class="line"></span><br><span class="line">5.4给角色R2授权，使其可以插入和更新学生管理数据库中的student表</span><br><span class="line">grant insert,update on studentinfo.student to R2;</span><br><span class="line">set default role R2 to fuck@localhost;</span><br><span class="line"></span><br><span class="line">5.5请分别以你自己名字命名的用户和你同学（汉语拼音）的名字命名的用户分别登录学生管理数据库对student表查询，再对student表进行插入和更新，看看分别是什么结果。</span><br><span class="line"> mysql -h localhost -u brain -p 123456</span><br><span class="line"> select * from student; //此时用户是R1，查询成功，但是无法使用 insert 或者 update 因为我们只赋予了他一个权限。</span><br><span class="line"> </span><br><span class="line">5.6 把角色R1的中对student表查询的权限收回。</span><br><span class="line">REVOKE SELECT ON studentinfo.student from R1;</span><br><span class="line"></span><br><span class="line">5.7再次以你自己名字命名的用户登录学生管理数据库对student表查询看是什么结果。</span><br></pre></td></tr></table></figure>

<h2 id="数据库完整性"><a href="#数据库完整性" class="headerlink" title="数据库完整性"></a>数据库完整性</h2><p>数据库的完整性 ( integrity ) 是指数据的正确性 ( correctness) 和相容性 (compat-ability) .</p>
<p>为了维护数据库的完整性，需要实现：</p>
<ul>
<li>提供定义完整性约束条件的机制</li>
<li>提供完整性检查方法：一般在 <code>INSERT,UPDATE,DELETE</code> 语句执行后开始检查，也可以在事务提交时检查。</li>
<li>进行违约处理</li>
</ul>
<p>关系数据库管理系统使得完整性控制成为其核心支持的功能，从而能够为所有用户和应用提供一致的数据库完整性。</p>
<h3 id="实体完整性"><a href="#实体完整性" class="headerlink" title="实体完整性"></a>实体完整性</h3><p>关系模型的实体完整性在 <code>CREATE TABLE</code> 中用 <code>PRIMARY KEY</code> 定义。单属性码有两种说明方法：列级约束条件和表级约束条件；多属性码只有表级约束条件。</p>
<h4 id="实体完整性检查和违约处理"><a href="#实体完整性检查和违约处理" class="headerlink" title="实体完整性检查和违约处理"></a>实体完整性检查和违约处理</h4><p>定义完关系的主码之后，每当用户程序对基本表插入一条记录或者对主码列进行更新操作时，会进行实体完整性检查：</p>
<ul>
<li>检查主码是否唯一，不唯一则拒绝插入或修改</li>
<li>检查主码的各个属性是否为空，有一个为空就拒绝插入或修改</li>
</ul>
<p>使用<code>B+</code> 索引树来查找基本表是否已经存在新的主码值。</p>
<h3 id="参照完整性"><a href="#参照完整性" class="headerlink" title="参照完整性"></a>参照完整性</h3><p>关系模型的参照完整性在 <code>CREATE TABLE</code> 中用 <code>FOREIGN KEY</code> 短语定义哪些列为外码，用 <code>PERFERENCES</code> 短语指明这些外码参照哪些表的主码。</p>
<h4 id="参照完整性检查和违约处理"><a href="#参照完整性检查和违约处理" class="headerlink" title="参照完整性检查和违约处理"></a>参照完整性检查和违约处理</h4><p>参照完整性将两个表中的相应元组联系起来了。因此，对被参照表和参照表进行增删改操作可能破坏参照完整性，必须检查两个表的相容性。</p>
<p>当相容性发生不一致时，系统可以采用一下策略加以处理：</p>
<ul>
<li>拒绝执行- <code>NO ACTION</code> ：默认操作</li>
<li>级联操作- <code>CASCADE</code> : 当删除或修改被参照表的一个元组导致与参照表的不一致时，删除或修改参照表中的所有导致不一致的元组。</li>
<li>设置为空值 ：当删除或修改被参照表的一个元组时造成了不一致，则将参照表中的所有造成不一致的元组的对应属性设置为空值。</li>
</ul>
<p>对于参照完整性，除了应该定义外码，还应定义外码是否允许空值。</p>
<h3 id="用户定义的完整性"><a href="#用户定义的完整性" class="headerlink" title="用户定义的完整性"></a>用户定义的完整性</h3><p>针对某一具体应用的数据必须满足的语义条件。</p>
<h4 id="属性上的约束条件"><a href="#属性上的约束条件" class="headerlink" title="属性上的约束条件"></a>属性上的约束条件</h4><ul>
<li><code>NOT NULL</code> 列值非空</li>
<li><code>UNIQUE</code> 列值唯一</li>
<li><code>CHECK</code> 检查列值是否满足一个条件表达式</li>
</ul>
<p>插入元组或修改属性的值时，关系数据库管理系统将检查属性上的约束条件是否被满足，不满足则操作被拒绝执行。</p>
<h4 id="元组上的约束条件"><a href="#元组上的约束条件" class="headerlink" title="元组上的约束条件"></a>元组上的约束条件</h4><p>在 <code>CREATE TABLE</code> 中可以用<code>CHECK</code> 短句定义元组上的约束条件，即元组级的限制。元组级的限制可以设置不同属性之间的取值的相互约束条件。</p>
<p>插入元组或修改属性的值时，关系数据库管理系统将检查元组上的约束条件是否被满足，不满足则操作被拒绝执行。</p>

        
        <br />
        <div id="comment-container">
        </div>
        <div id="disqus_thread"></div>

        <div id="lv-container">
        </div>

    </div>
</div>

    </div>
</div>


<footer class="footer">
    <ul class="list-inline text-center">
        
        

        

        

        

        

    </ul>
    
    <p>
        <span id="busuanzi_container_site_pv">
            <span id="busuanzi_value_site_pv"></span>PV
        </span>
        <span id="busuanzi_container_site_uv">
            <span id="busuanzi_value_site_uv"></span>UV
        </span>
        Created By <a href="https://hexo.io/">Hexo</a>  Theme <a href="https://github.com/aircloud/hexo-theme-aircloud">AirCloud</a></p>
</footer>




</body>

<script>
    // We expose some of the variables needed by the front end
    window.hexo_search_path = "./public/search.xml"
    window.hexo_root = "/"
    window.isPost = true
</script>
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
<script src="/js/index.js"></script>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




</html>
